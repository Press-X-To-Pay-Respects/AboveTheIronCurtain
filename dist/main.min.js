(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"./src/js/main.js":[function(require,module,exports){
'use strict';

var game = new Phaser.Game(800, 800, Phaser.AUTO, 'atic-game');

window.playerState = {
    currentLevel: 'Game'
};

game.state.add('Boot', require('./states/boot'));
game.state.add('Splash', require('./states/splash'));
game.state.add('Preloader', require('./states/preloader'));
game.state.add('Menu', require('./states/menu'));
game.state.add('Game', require('./states/game'));

game.state.start('Boot');
},{"./states/boot":"C:\\Users\\Zachary\\Documents\\!cmpm20\\AboveTheIronCurtain\\src\\js\\states\\boot.js","./states/game":"C:\\Users\\Zachary\\Documents\\!cmpm20\\AboveTheIronCurtain\\src\\js\\states\\game.js","./states/menu":"C:\\Users\\Zachary\\Documents\\!cmpm20\\AboveTheIronCurtain\\src\\js\\states\\menu.js","./states/preloader":"C:\\Users\\Zachary\\Documents\\!cmpm20\\AboveTheIronCurtain\\src\\js\\states\\preloader.js","./states/splash":"C:\\Users\\Zachary\\Documents\\!cmpm20\\AboveTheIronCurtain\\src\\js\\states\\splash.js"}],"C:\\Users\\Zachary\\Documents\\!cmpm20\\AboveTheIronCurtain\\src\\js\\entities\\Hackable.js":[function(require,module,exports){
/*
Defines a hackable object.
*/

var Hackable = function (game, x, y, sprite, hackDistance) {
    Phaser.Sprite.call(this, game, x, y, sprite);
    game.add.existing(this);
	this.hackDistance;
	var scale = 0.5;
    this.scale.x = scale;
    this.scale.y = scale;
    this.anchor.setTo(0.5, 0.5);
    game.physics.p2.enable(this);
    this.body.onBeginContact.add(this.cubeCollide, this);
    this.body.damping = 0.9;
    this.body.angularDamping = 0.9;
};

Hackable.prototype = Object.create(Phaser.Sprite.prototype);
Hackable.prototype.constructor = Hackable;

/**
 * Automatically called by World.update
 */
Hackable.prototype.update = function() {
};


Hackable.prototype.cubeCollide = function(other) {
/*   if (this.group === undefined) {
      return;
   }
   this.group.handleCollision(this, other.sprite);*/
};

module.exports = Hackable;
},{}],"C:\\Users\\Zachary\\Documents\\!cmpm20\\AboveTheIronCurtain\\src\\js\\entities\\Module.js":[function(require,module,exports){
//Don't use this function to create modules, instead use moduleBuilder()
var Module = function(setType, setCube) {
	this.type = setType;
	this.cube = setCube;
};

Module.prototype.constructor = Module;

module.exports = Module;
},{}],"C:\\Users\\Zachary\\Documents\\!cmpm20\\AboveTheIronCurtain\\src\\js\\entities\\ModuleBuilder.js":[function(require,module,exports){
var Cube = require('./cube');
var Module = require('./Module');

//Use this to create a moduleBuilder- only need to create one instance of it
var ModuleBuilder = function(setGameState) {
	//Ensure that cannot create multiple instances of this class
	if(ModuleBuilder.prototype.exists) {
		return ModuleBuilder.prototype.existingReference;
	}
		
	this.gameState = setGameState;
	this.coreExists = false;	//records if core has been created
	this.core = null;			//stores core when it is created
	ModuleBuilder.prototype.exists = true;
	ModuleBuilder.prototype.existingReference = this;
};

ModuleBuilder.prototype.constructor = ModuleBuilder;

//These var's help create the singleton functionality
ModuleBuilder.prototype.exists = false;
ModuleBuilder.prototype.existingReference = null;

//call this function from ModuleBuilder to construct modules
//TYPES: 'core' 'shield' 'thruster' 'solarPannel'
ModuleBuilder.prototype.build = function(type, x, y) {
	//Check if core has been created
	if(type == 'core' && this.coreExists) {
		//if so, return existing core b/c is singleton
		//b/c of this, can call ModuleBuilder.build('core') to access reference to existing core
		return this.core;
	}
	
	//Create cube object to be stored within module
	//Sprite names for modules are directly mapped to module names, so just pass 'type' as sprite name
	var newCube = new Cube(this.gameState.game, x, y, type);
    var scale = 0.5;
    newCube.name = this.gameState.debugNum++;
    newCube.scale.x = scale;
    newCube.scale.y = scale;
    newCube.anchor.setTo(0.5, 0.5);
    this.gameState.game.physics.p2.enable(newCube);
    newCube.body.onBeginContact.add(newCube.cubeCollide, newCube);
    newCube.body.damping = 0.9;
    newCube.body.angularDamping = 0.9;
    if (!this.gameState.rootSpawned) {
       newCube.root = true;
       this.gameState.rootSpawned = true;
    }
	
	//Create module to wrap around cube class
	var newModule = new Module(type, newCube);
		
	//TODO: edit special module atributes based on 'type'
	
	//Store module if it is core
	if(type == 'core')
	{
		this.core = newModule;
		this.coreExists = true;
	}
	
	//Return the module object
	return newModule;
};


module.exports = ModuleBuilder;
},{"./Module":"C:\\Users\\Zachary\\Documents\\!cmpm20\\AboveTheIronCurtain\\src\\js\\entities\\Module.js","./cube":"C:\\Users\\Zachary\\Documents\\!cmpm20\\AboveTheIronCurtain\\src\\js\\entities\\cube.js"}],"C:\\Users\\Zachary\\Documents\\!cmpm20\\AboveTheIronCurtain\\src\\js\\entities\\cube.js":[function(require,module,exports){
/*
Defines a cube module.
*/

var Cube = function (game, x, y, sprite) {
    Phaser.Sprite.call(this, game, x, y, sprite);
    game.add.existing(this);
    this.group = undefined;
};

Cube.prototype = Object.create(Phaser.Sprite.prototype);
Cube.prototype.constructor = Cube;

/**
 * Automatically called by World.update
 */
Cube.prototype.update = function() {
};

Cube.prototype.cubeCollide = function(other) {
   if (this.group === undefined) {
      return;
   }
   this.group.handleCollision(this, other.sprite);
};

Cube.prototype.toString = function() {
   var string = '';
   string += this.concat('name', this.name);
   return string;
};

Cube.prototype.concat = function(string, val) {
   return string + ': ' + val + '\n';
};

module.exports = Cube;















},{}],"C:\\Users\\Zachary\\Documents\\!cmpm20\\AboveTheIronCurtain\\src\\js\\entities\\cube_group.js":[function(require,module,exports){
/*
Defines a cube group.
*/

var CubeGroup = function (game, root) {
   this.game = game;
   this.root = root;
   this.cubes = [];
   var col = [];
   col.push(this.root);
   this.cubes.push(col);
   this.root.group = this;
   this.DIR = {NORTH: 0, EAST: 1, SOUTH: 2, WEST: 3};
   this.offset = 2;
};

CubeGroup.prototype.constructor = CubeGroup;

/**
 * Automatically called by World.update
 */
CubeGroup.prototype.update = function() {
};

CubeGroup.prototype.add = function(cube) {
  cube.group = this; 
};

CubeGroup.prototype.handleCollision = function(origin, other) {
   // stop if other does not exist, either is not a cube, both are in same gruop
   if (other === null || origin.prototype !== other.prototype || origin.group === other.group) {
      return;
   }
   var relSide = this.relativeSide(origin.body, other.body);
   var originLoc = this.find(origin);
   var otherLoc = this.adjust(originLoc, relSide);
   // console.log('hm', originLoc.x, originLoc.y);
   if (this.getCube(otherLoc)) {
      return;
   }
   switch (relSide) {
      case this.DIR.NORTH:
      if (originLoc.y === this.cubesHeight() - 1) {
         this.addTopRow();
      }
      this.game.physics.p2.createLockConstraint(origin.body, other.body, [0, origin.width + this.offset]);
      break;
      case this.DIR.EAST:
      if (originLoc.x === this.cubesWidth() - 1) {
         this.addRightCol();
      }
      this.game.physics.p2.createLockConstraint(origin.body, other.body, [-origin.width - this.offset, 0]);
      break;
      case this.DIR.SOUTH:
      if (originLoc.y === 0) {
         this.addBotRow();
      }
      this.game.physics.p2.createLockConstraint(other.body, origin.body, [0, origin.width + this.offset]);
      break;
      case this.DIR.WEST:
      if (originLoc.x === 0) {
         this.addLeftCol();
      }
      this.game.physics.p2.createLockConstraint(other.body, origin.body, [-origin.width - this.offset, 0]);
      break;
   }
   // console.log('end');
   originLoc = this.find(origin);
   otherLoc = this.adjust(originLoc, relSide);
   if (!otherLoc) {
      console.log('hande collision failed to find second other loc');
      return;
   }
   this.set(otherLoc, other);
   // console.log('add: ' + other.name + ' at ' + otherLoc.x + ', ' + otherLoc.y);
   // this.displayCubes();
   other.group = this;
};

CubeGroup.prototype.relativeSide = function(thisBody, otherBody) {
  var thisPoint = new Phaser.Point(thisBody.x, thisBody.y);
  var otherPoint = new Phaser.Point(otherBody.x, otherBody.y);
  var angleToOther = Phaser.Point.angle(thisPoint, otherPoint);
  if (angleToOther < 0) { // fix dumb part of Phaser.Point.angle()
     angleToOther = 2 * Math.PI + angleToOther;
  }
  angleToOther = (angleToOther + 3/2 * Math.PI) % (2 * Math.PI); // rotate 90 d clockwise
  var diffAngle = angleToOther - thisBody.rotation;
   if (diffAngle < 1 / 4 * Math.PI || diffAngle > 7 / 4 * Math.PI) { // north
     return this.DIR.NORTH;
  } else if (diffAngle >= 1 / 4 * Math.PI && diffAngle < 3 / 4 * Math.PI) { // east
     return this.DIR.EAST;
  } else if (diffAngle >= 3 / 4 * Math.PI && diffAngle < 5 / 4 * Math.PI) { // south
     return this.DIR.SOUTH;
  } else if (diffAngle >= 5 / 4 * Math.PI && diffAngle < 7 / 4 * Math.PI) { // west
     return this.DIR.WEST;
  }
};

CubeGroup.prototype.find = function(cube) {
   // console.log('find', cube.name);
   for (var row = 0; row < this.cubesWidth(); row++) {
      for (var col = 0; col < this.cubesHeight(); col++) {
         if (this.cubes[row][col] === cube) {
            // console.log('found at', row, col);
            return new Phaser.Point(row, col);
         }
      }
   }
   console.log('could not find cube', cube.name);
   this.displayCubes();
   return undefined;
};

CubeGroup.prototype.cubesWidth = function() {
   return this.cubes.length;
};

CubeGroup.prototype.cubesHeight = function() {
   return this.cubes[0].length;
};

/*
[0,height] ...  [width, height]
.                 
.               .
.               .
[0,1] [1,1] ... .
[0,0] [1,0] ... [width,0]
*/
CubeGroup.prototype.addTopRow = function() {
   // console.log('add top');
   // this.displayCubes();
   for (var row = 0; row < this.cubesWidth(); row++) {
      this.cubes[row].push(undefined);
   }
   // console.log('end add top');
   // this.displayCubes();
};

CubeGroup.prototype.addRightCol = function() {
   // console.log('add right');
   var newCol = new Array(this.cubesHeight);
   this.cubes.push(newCol);
};

CubeGroup.prototype.addBotRow = function() {
   // console.log('add bot');
   // this.displayCubes();
   for (var row = 0; row < this.cubesWidth(); row++) {
      this.cubes[row].unshift(undefined);
   }
   // console.log('end add bot');
   // this.displayCubes();
};

CubeGroup.prototype.addLeftCol = function() {
   // console.log('add left');
   // this.displayCubes();
   // console.log('height is ' + this.cubesHeight());
   var newCol = new Array(this.cubesHeight());
   this.cubes.unshift(newCol);
   // console.log('end add left');
   // this.displayCubes();
};

CubeGroup.prototype.getCube = function(point) {
   if (this.outOfBounds(point)) {
      return undefined;
   }
   return this.cubes[point.x][point.y];
};

CubeGroup.prototype.adjust = function(point, dir) {
  if (!point) {
     console.log('adjust given undefined point');
     return;
  }
  var newPoint = new Phaser.Point(point.x, point.y);
  switch (dir) {
      case this.DIR.NORTH:
      newPoint.y++;
      break;
      case this.DIR.EAST:
      newPoint.x++;
      break;
      case this.DIR.SOUTH:
      newPoint.y--;
      break;
      case this.DIR.WEST:
      newPoint.x--;
      break;
   }
   return newPoint;
};

CubeGroup.prototype.set = function(point, cube) {
   if (!point) {
      console.log('set given undefined point');
      return;
   }
   if (this.outOfBounds(point)) {
      return;
   }
   this.cubes[point.x][point.y] = cube;
};

CubeGroup.prototype.outOfBounds = function(point) {
   if (!point) {
      console.log('out of bounds given undefined point');
      return;
   }
   if (point.x < 0 || point.x >= this.cubesWidth() || point.y < 0 || point.y >= this.cubesHeight()) {
      return true;
   }
   return false;
};

CubeGroup.prototype.displayCubes = function() {
   for (var row = 0; row < this.cubesWidth(); row++) {
      var string = '';
      for (var col = 0; col < this.cubesHeight(); col++) {
         var cube = this.cubes[row][col];
         if (cube) {
            string += this.cubes[row][col].name + ' ';
         } else {
            string += 'empty' + ' ';
         }
      }
      console.log('row ' + row + ': ' + string + '| ' + this.cubes[row].length);
   }
};

module.exports = CubeGroup;

















},{}],"C:\\Users\\Zachary\\Documents\\!cmpm20\\AboveTheIronCurtain\\src\\js\\functionAccess\\Renderables.js":[function(require,module,exports){
var Renderables = function() {
	if(Renderables.prototype.exists) {
		return Renderables.prototype.existingReference;
	}
	
	this.list = [];
	Renderables.prototype.exists = true;
	Renderables.prototype.existingReference = this;
};

Renderables.prototype.constructor = Renderables;
//These var's help create the singleton functionality
Renderables.prototype.exists = false;
Renderables.prototype.existingReference = null;

Renderables.prototype.subscribe = function(subscriber) {
	this.list.push(subscriber);
};

Renderables.prototype.unsubscribe = function(unsubscriber) {
	for(var i = 0; i < this.list.length; i++) {
		if(this.list[i] === unsubscriber) {
			this.list[i] = false;
		}
	}
};

Renderables.prototype.renderAll = function() {
	for(var i = 0; i < this.list.length; i++) {
		if(this.list[i] === false) {
			continue;
		}
		this.list[i].render();
	}
};

module.exports = Renderables;
},{}],"C:\\Users\\Zachary\\Documents\\!cmpm20\\AboveTheIronCurtain\\src\\js\\states\\boot.js":[function(require,module,exports){
var Boot = function () {};

module.exports = Boot;

Boot.prototype = {

  preload: function () {
    this.load.image('preloader', 'assets/preloader.gif');
  },

  create: function () {
    this.game.input.maxPointers = 1;

    if (this.game.device.desktop) {
      this.game.stage.scale.pageAlignHorizontally = true;
    } else {
      this.game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;
      this.game.scale.minWidth =  480;
      this.game.scale.minHeight = 260;
      this.game.scale.maxWidth = 640;
      this.game.scale.maxHeight = 480;
      this.game.scale.forceLandscape = true;
      this.game.scale.pageAlignHorizontally = true;
      this.game.scale.setScreenSize(true);
    }

    this.game.state.start('Preloader');
  }
};

},{}],"C:\\Users\\Zachary\\Documents\\!cmpm20\\AboveTheIronCurtain\\src\\js\\states\\game.js":[function(require,module,exports){
/*
Main testing environment.
*/

var Renderables = require('../functionAccess/Renderables');
var ModuleBuilder = require('../entities/ModuleBuilder');
var UIBuilder = require('../ui/UIBuilder');
var Cube = require('../entities/cube');
var ModuleBuilder = require('../entities/ModuleBuilder');
var Utils = require('../utils');
var CubeGroup = require('../entities/cube_group');
var Hackable = require('../entities/Hackable');

var mouseBody; // physics body for mouse

var Game = function () {
  this.testentity = null;
};

module.exports = Game;

Game.prototype = {
	
  create: function () {
    this.game.physics.startSystem(Phaser.Physics.P2JS);
    this.game.physics.p2.setImpactEvents(true);
    mouseBody = new p2.Body(); // jshint ignore:line
    this.game.physics.p2.world.addBody(mouseBody);
    
	//create Renderables class
	this.renderables = new Renderables();
	//create the UIBuilder
	this.uiBuilder = new UIBuilder(this, this.renderables);
	//create ModuleBuilder and store it in this game state object
	this.moduleBuilder = new ModuleBuilder(this);
	//create and store the core module
	this.coreModule = this.moduleBuilder.build('core', 200, 200);
	this.player = new CubeGroup(this, this.coreModule.cube);
   
	this.testUI = this.uiBuilder.buildProgressBar('growing', 200, 50, 50, 100, 10);
	this.testUI.value = 50;
	this.testUI.onEvent = function() {
		this.destroy();
	};
	
	//DEBUGGING LISTENERS- allow you to create modules by pressing keys
	//core
	// this.placeCoreKey = this.game.input.keyboard.addKey(Phaser.Keyboard.P);
   // this.placeCoreKey.onDown.add(this.addCore, this);
	//shield
	this.placeShieldKey = this.game.input.keyboard.addKey(Phaser.Keyboard.O);
    this.placeShieldKey.onDown.add(this.addShield, this);
	//thruster
	this.placeThrusterKey = this.game.input.keyboard.addKey(Phaser.Keyboard.I);
    this.placeThrusterKey.onDown.add(this.addThruster, this);
	//solarPannel
	this.placeSPKey = this.game.input.keyboard.addKey(Phaser.Keyboard.U);
    this.placeSPKey.onDown.add(this.addSP, this);
	//hacker
	this.placeHackKey = this.game.input.keyboard.addKey(Phaser.Keyboard.Y);
	this.placeHackKey.onDown.add(this.addHack, this);
	//END
    
    this.mouseX = 0;
    this.mouseY = 0;
    
    this.input.onDown.add(this.click, this);
    this.input.onUp.add(this.release, this);
    this.input.addMoveCallback(this.move, this);
    this.grabbed = undefined;
    this.line = new Phaser.Line(0, 0, 0, 0);
    
    this.rootSpawned = false;
    
    this.debugNum = 0;
    this.myRoot = undefined;
    
	this.testHack = new Hackable(this.game, 90,90, 'hackable1');
	
    // this.playerCommand = this.placeCubeSpec(300, 300);
    // this.player = new CubeGroup(this, this.playerCommand);
    
     // var polygonTest = this.game.add.sprite(60, 60, 'testsprite');
     // this.game.physics.p2.enableBody(polygonTest, true);
     // polygonTest.body.clearShapes();
     // polygonTest.body.loadPolygon('module_physics', 'test2');
  },

  update: function () {
    if (this.grabbed) {
      var angle = Math.atan2(this.grabbed.sprite.y - this.input.position.y, this.grabbed.sprite.x - this.input.position.x) + Math.PI;
      var dist = Utils.distance(this.grabbed.sprite.x, this.grabbed.sprite.y, this.input.position.x, this.input.position.y);
      var weight = 10;
      this.grabbed.force.x = Math.cos(angle) * dist * weight;
      this.grabbed.force.y = Math.sin(angle) * dist * weight;
      this.line.setTo(this.grabbed.sprite.x, this.grabbed.sprite.y, this.input.position.x, this.input.position.y);
    } else {
       this.line.setTo(0, 0, 0, 0);
    }
	this.testUI.addValue(0.8);
  },
  
  render: function () {
    this.game.debug.geom(this.line);
	this.renderables.renderAll();
  },

  click: function (pointer) {
    var bodies = this.game.physics.p2.hitTest(pointer.position);
    if (bodies.length)
    {
        this.grabbed = bodies[0].parent;
    }
  },
  
  release: function () {
     if (this.grabbed) {
        this.grabbed = undefined;
     }
  },
  
  move: function (pointer) {
    // p2 uses different coordinate system, so convert the pointer position to p2's coordinate system
    mouseBody.position[0] = this.game.physics.p2.pxmi(pointer.position.x);
    mouseBody.position[1] = this.game.physics.p2.pxmi(pointer.position.y);
    this.mouseX = pointer.position.x;
    this.mouseY = pointer.position.y;
  },
  
  //DEBUG FUNCTIONS- event functions called from listeners that allow you to create modules with key presses
  addCore: function () {
	//Attempts to create more core modules here will only return the existing core
	this.moduleBuilder.build('core', this.mouseX, this.mouseY);
  },
  addShield: function () {
	this.moduleBuilder.build('shield', this.mouseX, this.mouseY);
  },
  addThruster: function () {
	this.moduleBuilder.build('thruster', this.mouseX, this.mouseY);
  },
  addSP: function () {
	this.moduleBuilder.build('solarPannel', this.mouseX, this.mouseY);
  },
  addHack: function () {
	this.moduleBuilder.build('hacker', this.mouseX, this.mouseY);
  },
  placeCube: function () {
    var entity = new Cube(this.game, this.mouseX, this.mouseY);
    var scale = 0.5;
    entity.name = this.debugNum++;
    entity.scale.x = scale;
    entity.scale.y = scale;
    entity.anchor.setTo(0.5, 0.5);
    this.game.physics.p2.enable(entity);
    entity.body.onBeginContact.add(entity.cubeCollide, entity);
    entity.body.damping = 0.9;
    entity.body.angularDamping = 0.9;
    if (!this.rootSpawned) {
       entity.root = true;
       this.rootSpawned = true;
    }
  },
  /*
  placeCubeSpec: function (x, y) {
    var entity = new Cube(this.game, x, y);
    var scale = 0.5;
    entity.name = this.debugNum++;
    entity.scale.x = scale;
    entity.scale.y = scale;
    entity.anchor.setTo(0.5, 0.5);
    this.game.physics.p2.enable(entity);
    entity.body.onBeginContact.add(entity.cubeCollide, entity);
    entity.body.damping = 0.9;
    entity.body.angularDamping = 0.9;
    if (!this.rootSpawned) {
       entity.root = true;
       this.rootSpawned = true;
    }
    return entity;
  },
  */
  
  //DEBUG FUNCTIONS- event functions called from listeners that allow you to create modules with key presses
  addCore: function () {
	//Attempts to create more core modules here will only return the existing core
	this.moduleBuilder.build('core', this.mouseX, this.mouseY);
  },
  addShield: function () {
	this.moduleBuilder.build('shield', this.mouseX, this.mouseY);
  },
  addThruster: function () {
	this.moduleBuilder.build('thruster', this.mouseX, this.mouseY);
  },
  addSP: function () {
	this.moduleBuilder.build('solarPannel', this.mouseX, this.mouseY);
  }
  //END
  
};




























},{"../entities/Hackable":"C:\\Users\\Zachary\\Documents\\!cmpm20\\AboveTheIronCurtain\\src\\js\\entities\\Hackable.js","../entities/ModuleBuilder":"C:\\Users\\Zachary\\Documents\\!cmpm20\\AboveTheIronCurtain\\src\\js\\entities\\ModuleBuilder.js","../entities/cube":"C:\\Users\\Zachary\\Documents\\!cmpm20\\AboveTheIronCurtain\\src\\js\\entities\\cube.js","../entities/cube_group":"C:\\Users\\Zachary\\Documents\\!cmpm20\\AboveTheIronCurtain\\src\\js\\entities\\cube_group.js","../functionAccess/Renderables":"C:\\Users\\Zachary\\Documents\\!cmpm20\\AboveTheIronCurtain\\src\\js\\functionAccess\\Renderables.js","../ui/UIBuilder":"C:\\Users\\Zachary\\Documents\\!cmpm20\\AboveTheIronCurtain\\src\\js\\ui\\UIBuilder.js","../utils":"C:\\Users\\Zachary\\Documents\\!cmpm20\\AboveTheIronCurtain\\src\\js\\utils.js"}],"C:\\Users\\Zachary\\Documents\\!cmpm20\\AboveTheIronCurtain\\src\\js\\states\\menu.js":[function(require,module,exports){
var Menu = function () {
  this.text = null;
};

module.exports = Menu;

Menu.prototype = {

  create: function () {
    var x = this.game.width / 2;
    var y = this.game.height / 2;

    var style = { font: '65px Arial', fill: '#ffffff', align: 'center' };

    this.text = this.add.text(x - 300, y - 200, 'Press to Start', style);

    this.input.onDown.add(this.onDown, this);
  },

  update: function () {
  },

  onDown: function () {
    this.game.state.start(playerState.currentLevel); // jshint ignore:line
  }
};

},{}],"C:\\Users\\Zachary\\Documents\\!cmpm20\\AboveTheIronCurtain\\src\\js\\states\\preloader.js":[function(require,module,exports){
var Preloader = function (game) {
  game = null;
  this.asset = null;
  this.ready = false;
};

module.exports = Preloader;

Preloader.prototype = {

  preload: function () {
    this.asset = this.add.sprite(320, 240, 'preloader');
    this.asset.anchor.setTo(0.5, 0.5);

    this.load.onLoadComplete.addOnce(this.onLoadComplete, this);
    this.load.setPreloadSprite(this.asset);
    this.load.image('testsprite', 'assets/test2.png');
	this.load.image('core', 'assets/core.png');
	this.load.image('thruster', 'assets/thruster.png');
	this.load.image('shield', 'assets/shield.png');
	this.load.image('solarPannel', 'assets/solarPannel.png');
	this.load.image('hacker', 'assets/hacker.png');
	this.load.image('hackable1', 'assets/hackable1.png');
	
    this.load.physics('module_physics', 'assets/module_physics.json');
  },

  create: function () {
    this.asset.cropEnabled = false;
  },

  update: function () {
    if (!!this.ready) {
      // this.game.state.start('Menu');
      this.game.state.start(playerState.currentLevel); // jshint ignore:line
    }
  },

  onLoadComplete: function () {
    this.ready = true;
  }
};

},{}],"C:\\Users\\Zachary\\Documents\\!cmpm20\\AboveTheIronCurtain\\src\\js\\states\\splash.js":[function(require,module,exports){
var Splash = function () {
};

module.exports = Splash;

Splash.prototype = {
  create: function () {
  }
};
},{}],"C:\\Users\\Zachary\\Documents\\!cmpm20\\AboveTheIronCurtain\\src\\js\\ui\\ProgressBar.js":[function(require,module,exports){
//NOTE: DON'T USE this code to create a ProgressBar. Instead, use the UIBuilder object and call buildProgressBar

var ProgressBar = function(setType, setMaxValue, setGraphics, setRenderables) {
	this.type = setType; //Two types, "growing" (starts at 0, triggers event when full) 
						 //and "shrinking" (starts full, triggers at 0)
	this.x = null;
	this.y = null;
	this.width = null;
	this.height = null;
	this.maxValue = setMaxValue;
	this.graphics = setGraphics; //store graphics class (used to draw bar)
	this.renderables = setRenderables;
	
	this.onEvent = function() {}; //overwrite this function to make whatever you want happen when progressBar reaches limit
	
	//switch(this.type) {
	//case 'growing' : 
	if(setType == 'growing') {
		this.value = 0;
		//tryTrigger is called automatically when you add/subtract value, and will trigger the onEvent() function
		this.tryTrigger = function() {
			if(this.value >= this.maxValue) {
				this.onEvent();
			}
		};
		//break;
	}
	else if(setType == 'shrinking') {
	//case 'shrinking' :
		this.value = this.maxValue;
		this.tryTrigger = function() {
			if(this.value <= 0) {
				this.onEvent();
			}
		};
	//}
	}
};

ProgressBar.prototype.constructor = ProgressBar;

ProgressBar.prototype.destroy = function() {
	this.graphics.clear();
	this.renderables.unsubscribe(this);
};

//To subtract value, just use negative numbers as argument i.e. foo.addValue(-5);
ProgressBar.prototype.addValue = function (addThis) {
	this.value += addThis;
	if(this.value > this.maxValue) {
		this.value = this.maxValue;
	}
	if(this.value < 0) {
		this.value = 0;
	}
	this.tryTrigger();
};

//Sets the location where progress bar is rendered
ProgressBar.prototype.setLocation = function(setX, setY) {
	this.x = setX;
	this.y = setY;
};

//Sets the size of the progress bar
ProgressBar.prototype.setSize = function(setWidth, setHeight) {
	this.width = setWidth;
	this.height = setHeight;
};

//Renders progressBar
ProgressBar.prototype.render = function() {
	console.log('rendered');
	this.graphics.clear();
	//Draw background of bar
	this.graphics.lineStyle(2, 0xAAAAAA, 1);
	this.graphics.beginFill(0x888888);
	this.graphics.drawRect(this.x-this.width/2, this.y-this.height/2, this.width, this.height);
	this.graphics.endFill();
	//Draw value of bar
	var percentage = this.value / this.maxValue;
	var barWidth = this.width - 5;
	var barHeight = this.height - 5;
	this.graphics.lineStyle(1, 0x8888FF, 1);
	this.graphics.beginFill(0x000099);
	this.graphics.drawRect(this.x-(barWidth/2), this.y-(barHeight/2), barWidth*percentage, barHeight);
	this.graphics.endFill();
};

module.exports = ProgressBar;
},{}],"C:\\Users\\Zachary\\Documents\\!cmpm20\\AboveTheIronCurtain\\src\\js\\ui\\UIBuilder.js":[function(require,module,exports){
var ProgressBar = require('./ProgressBar');

var UIBuilder = function(setGameState, setRenderables) {
	//Ensure that cannot create multiple instances of this class
	if(UIBuilder.prototype.exists) {
		return UIBuilder.prototype.existingReference;
	}
	
	this.gameState = setGameState;
	this.renderables = setRenderables;
	//Create and store a graphics object (used for stuff like drawing rectangles)
	UIBuilder.prototype.exists = true;
	UIBuilder.prototype.existingReference = this;
};

UIBuilder.prototype.constructor = UIBuilder;
//These var's help create the singleton functionality
UIBuilder.prototype.exists = false;
UIBuilder.prototype.existingReference = null;

//Use this function to create a progress bar
//Usage: type: can be "growing" or "shrinking", this will effect if bar starts at 0 and goes up or vis versa
//		 maxValue: sets the max value of the progress bar, i.e. using 100 creates a bar from 0 to 100
//		 x,y: sets location
//		 DON'T FORGET to overwrite the onEvent() function for the progress bar after creating it
//			-onEvent() is automatically called when bar fills/shrinks past limit (depending on bar type)
UIBuilder.prototype.buildProgressBar = function(type, maxValue, x, y, width, height) {
	//create and format new prog bar
	var graphics = this.gameState.game.add.graphics(0,0);
	var newProgBar = new ProgressBar(type, maxValue, graphics, this.renderables);
	newProgBar.setLocation(x,y);
	newProgBar.setSize(width, height);
	//subscribe to 'renderables' so that render() is called automatically
	this.renderables.subscribe(newProgBar);
	return newProgBar;
};

module.exports = UIBuilder;
},{"./ProgressBar":"C:\\Users\\Zachary\\Documents\\!cmpm20\\AboveTheIronCurtain\\src\\js\\ui\\ProgressBar.js"}],"C:\\Users\\Zachary\\Documents\\!cmpm20\\AboveTheIronCurtain\\src\\js\\utils.js":[function(require,module,exports){
/*
Collection of utility functions.
*/

var Utils = {
    containsObject: function(obj, list) {
        var i;
        for (i = 0; i < list.length; i++) {
            if (list[i] === obj) {
                return true;
            }
        }

        return false;
    },
    distance: function(x1, y1, x2, y2) {
       return Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2));
    }
};

module.exports = Utils;
},{}]},{},["./src/js/main.js"])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlc1xcYnJvd3NlcmlmeVxcbm9kZV9tb2R1bGVzXFxicm93c2VyLXBhY2tcXF9wcmVsdWRlLmpzIiwic3JjL2pzL21haW4uanMiLCJzcmMvanMvZW50aXRpZXMvSGFja2FibGUuanMiLCJzcmMvanMvZW50aXRpZXMvTW9kdWxlLmpzIiwic3JjL2pzL2VudGl0aWVzL01vZHVsZUJ1aWxkZXIuanMiLCJzcmMvanMvZW50aXRpZXMvY3ViZS5qcyIsInNyYy9qcy9lbnRpdGllcy9jdWJlX2dyb3VwLmpzIiwic3JjL2pzL2Z1bmN0aW9uQWNjZXNzL1JlbmRlcmFibGVzLmpzIiwic3JjL2pzL3N0YXRlcy9ib290LmpzIiwic3JjL2pzL3N0YXRlcy9nYW1lLmpzIiwic3JjL2pzL3N0YXRlcy9tZW51LmpzIiwic3JjL2pzL3N0YXRlcy9wcmVsb2FkZXIuanMiLCJzcmMvanMvc3RhdGVzL3NwbGFzaC5qcyIsInNyYy9qcy91aS9Qcm9ncmVzc0Jhci5qcyIsInNyYy9qcy91aS9VSUJ1aWxkZXIuanMiLCJzcmMvanMvdXRpbHMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDZEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25DQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDUkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMVBBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbE9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNSQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIndXNlIHN0cmljdCc7XHJcblxyXG52YXIgZ2FtZSA9IG5ldyBQaGFzZXIuR2FtZSg4MDAsIDgwMCwgUGhhc2VyLkFVVE8sICdhdGljLWdhbWUnKTtcclxuXHJcbndpbmRvdy5wbGF5ZXJTdGF0ZSA9IHtcclxuICAgIGN1cnJlbnRMZXZlbDogJ0dhbWUnXHJcbn07XHJcblxyXG5nYW1lLnN0YXRlLmFkZCgnQm9vdCcsIHJlcXVpcmUoJy4vc3RhdGVzL2Jvb3QnKSk7XHJcbmdhbWUuc3RhdGUuYWRkKCdTcGxhc2gnLCByZXF1aXJlKCcuL3N0YXRlcy9zcGxhc2gnKSk7XHJcbmdhbWUuc3RhdGUuYWRkKCdQcmVsb2FkZXInLCByZXF1aXJlKCcuL3N0YXRlcy9wcmVsb2FkZXInKSk7XHJcbmdhbWUuc3RhdGUuYWRkKCdNZW51JywgcmVxdWlyZSgnLi9zdGF0ZXMvbWVudScpKTtcclxuZ2FtZS5zdGF0ZS5hZGQoJ0dhbWUnLCByZXF1aXJlKCcuL3N0YXRlcy9nYW1lJykpO1xyXG5cclxuZ2FtZS5zdGF0ZS5zdGFydCgnQm9vdCcpOyIsIi8qXHJcbkRlZmluZXMgYSBoYWNrYWJsZSBvYmplY3QuXHJcbiovXHJcblxyXG52YXIgSGFja2FibGUgPSBmdW5jdGlvbiAoZ2FtZSwgeCwgeSwgc3ByaXRlLCBoYWNrRGlzdGFuY2UpIHtcclxuICAgIFBoYXNlci5TcHJpdGUuY2FsbCh0aGlzLCBnYW1lLCB4LCB5LCBzcHJpdGUpO1xyXG4gICAgZ2FtZS5hZGQuZXhpc3RpbmcodGhpcyk7XHJcblx0dGhpcy5oYWNrRGlzdGFuY2U7XHJcblx0dmFyIHNjYWxlID0gMC41O1xyXG4gICAgdGhpcy5zY2FsZS54ID0gc2NhbGU7XHJcbiAgICB0aGlzLnNjYWxlLnkgPSBzY2FsZTtcclxuICAgIHRoaXMuYW5jaG9yLnNldFRvKDAuNSwgMC41KTtcclxuICAgIGdhbWUucGh5c2ljcy5wMi5lbmFibGUodGhpcyk7XHJcbiAgICB0aGlzLmJvZHkub25CZWdpbkNvbnRhY3QuYWRkKHRoaXMuY3ViZUNvbGxpZGUsIHRoaXMpO1xyXG4gICAgdGhpcy5ib2R5LmRhbXBpbmcgPSAwLjk7XHJcbiAgICB0aGlzLmJvZHkuYW5ndWxhckRhbXBpbmcgPSAwLjk7XHJcbn07XHJcblxyXG5IYWNrYWJsZS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBoYXNlci5TcHJpdGUucHJvdG90eXBlKTtcclxuSGFja2FibGUucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gSGFja2FibGU7XHJcblxyXG4vKipcclxuICogQXV0b21hdGljYWxseSBjYWxsZWQgYnkgV29ybGQudXBkYXRlXHJcbiAqL1xyXG5IYWNrYWJsZS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7XHJcbn07XHJcblxyXG5cclxuSGFja2FibGUucHJvdG90eXBlLmN1YmVDb2xsaWRlID0gZnVuY3Rpb24ob3RoZXIpIHtcclxuLyogICBpZiAodGhpcy5ncm91cCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgfVxyXG4gICB0aGlzLmdyb3VwLmhhbmRsZUNvbGxpc2lvbih0aGlzLCBvdGhlci5zcHJpdGUpOyovXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEhhY2thYmxlOyIsIi8vRG9uJ3QgdXNlIHRoaXMgZnVuY3Rpb24gdG8gY3JlYXRlIG1vZHVsZXMsIGluc3RlYWQgdXNlIG1vZHVsZUJ1aWxkZXIoKVxyXG52YXIgTW9kdWxlID0gZnVuY3Rpb24oc2V0VHlwZSwgc2V0Q3ViZSkge1xyXG5cdHRoaXMudHlwZSA9IHNldFR5cGU7XHJcblx0dGhpcy5jdWJlID0gc2V0Q3ViZTtcclxufTtcclxuXHJcbk1vZHVsZS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBNb2R1bGU7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IE1vZHVsZTsiLCJ2YXIgQ3ViZSA9IHJlcXVpcmUoJy4vY3ViZScpO1xyXG52YXIgTW9kdWxlID0gcmVxdWlyZSgnLi9Nb2R1bGUnKTtcclxuXHJcbi8vVXNlIHRoaXMgdG8gY3JlYXRlIGEgbW9kdWxlQnVpbGRlci0gb25seSBuZWVkIHRvIGNyZWF0ZSBvbmUgaW5zdGFuY2Ugb2YgaXRcclxudmFyIE1vZHVsZUJ1aWxkZXIgPSBmdW5jdGlvbihzZXRHYW1lU3RhdGUpIHtcclxuXHQvL0Vuc3VyZSB0aGF0IGNhbm5vdCBjcmVhdGUgbXVsdGlwbGUgaW5zdGFuY2VzIG9mIHRoaXMgY2xhc3NcclxuXHRpZihNb2R1bGVCdWlsZGVyLnByb3RvdHlwZS5leGlzdHMpIHtcclxuXHRcdHJldHVybiBNb2R1bGVCdWlsZGVyLnByb3RvdHlwZS5leGlzdGluZ1JlZmVyZW5jZTtcclxuXHR9XHJcblx0XHRcclxuXHR0aGlzLmdhbWVTdGF0ZSA9IHNldEdhbWVTdGF0ZTtcclxuXHR0aGlzLmNvcmVFeGlzdHMgPSBmYWxzZTtcdC8vcmVjb3JkcyBpZiBjb3JlIGhhcyBiZWVuIGNyZWF0ZWRcclxuXHR0aGlzLmNvcmUgPSBudWxsO1x0XHRcdC8vc3RvcmVzIGNvcmUgd2hlbiBpdCBpcyBjcmVhdGVkXHJcblx0TW9kdWxlQnVpbGRlci5wcm90b3R5cGUuZXhpc3RzID0gdHJ1ZTtcclxuXHRNb2R1bGVCdWlsZGVyLnByb3RvdHlwZS5leGlzdGluZ1JlZmVyZW5jZSA9IHRoaXM7XHJcbn07XHJcblxyXG5Nb2R1bGVCdWlsZGVyLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IE1vZHVsZUJ1aWxkZXI7XHJcblxyXG4vL1RoZXNlIHZhcidzIGhlbHAgY3JlYXRlIHRoZSBzaW5nbGV0b24gZnVuY3Rpb25hbGl0eVxyXG5Nb2R1bGVCdWlsZGVyLnByb3RvdHlwZS5leGlzdHMgPSBmYWxzZTtcclxuTW9kdWxlQnVpbGRlci5wcm90b3R5cGUuZXhpc3RpbmdSZWZlcmVuY2UgPSBudWxsO1xyXG5cclxuLy9jYWxsIHRoaXMgZnVuY3Rpb24gZnJvbSBNb2R1bGVCdWlsZGVyIHRvIGNvbnN0cnVjdCBtb2R1bGVzXHJcbi8vVFlQRVM6ICdjb3JlJyAnc2hpZWxkJyAndGhydXN0ZXInICdzb2xhclBhbm5lbCdcclxuTW9kdWxlQnVpbGRlci5wcm90b3R5cGUuYnVpbGQgPSBmdW5jdGlvbih0eXBlLCB4LCB5KSB7XHJcblx0Ly9DaGVjayBpZiBjb3JlIGhhcyBiZWVuIGNyZWF0ZWRcclxuXHRpZih0eXBlID09ICdjb3JlJyAmJiB0aGlzLmNvcmVFeGlzdHMpIHtcclxuXHRcdC8vaWYgc28sIHJldHVybiBleGlzdGluZyBjb3JlIGIvYyBpcyBzaW5nbGV0b25cclxuXHRcdC8vYi9jIG9mIHRoaXMsIGNhbiBjYWxsIE1vZHVsZUJ1aWxkZXIuYnVpbGQoJ2NvcmUnKSB0byBhY2Nlc3MgcmVmZXJlbmNlIHRvIGV4aXN0aW5nIGNvcmVcclxuXHRcdHJldHVybiB0aGlzLmNvcmU7XHJcblx0fVxyXG5cdFxyXG5cdC8vQ3JlYXRlIGN1YmUgb2JqZWN0IHRvIGJlIHN0b3JlZCB3aXRoaW4gbW9kdWxlXHJcblx0Ly9TcHJpdGUgbmFtZXMgZm9yIG1vZHVsZXMgYXJlIGRpcmVjdGx5IG1hcHBlZCB0byBtb2R1bGUgbmFtZXMsIHNvIGp1c3QgcGFzcyAndHlwZScgYXMgc3ByaXRlIG5hbWVcclxuXHR2YXIgbmV3Q3ViZSA9IG5ldyBDdWJlKHRoaXMuZ2FtZVN0YXRlLmdhbWUsIHgsIHksIHR5cGUpO1xyXG4gICAgdmFyIHNjYWxlID0gMC41O1xyXG4gICAgbmV3Q3ViZS5uYW1lID0gdGhpcy5nYW1lU3RhdGUuZGVidWdOdW0rKztcclxuICAgIG5ld0N1YmUuc2NhbGUueCA9IHNjYWxlO1xyXG4gICAgbmV3Q3ViZS5zY2FsZS55ID0gc2NhbGU7XHJcbiAgICBuZXdDdWJlLmFuY2hvci5zZXRUbygwLjUsIDAuNSk7XHJcbiAgICB0aGlzLmdhbWVTdGF0ZS5nYW1lLnBoeXNpY3MucDIuZW5hYmxlKG5ld0N1YmUpO1xyXG4gICAgbmV3Q3ViZS5ib2R5Lm9uQmVnaW5Db250YWN0LmFkZChuZXdDdWJlLmN1YmVDb2xsaWRlLCBuZXdDdWJlKTtcclxuICAgIG5ld0N1YmUuYm9keS5kYW1waW5nID0gMC45O1xyXG4gICAgbmV3Q3ViZS5ib2R5LmFuZ3VsYXJEYW1waW5nID0gMC45O1xyXG4gICAgaWYgKCF0aGlzLmdhbWVTdGF0ZS5yb290U3Bhd25lZCkge1xyXG4gICAgICAgbmV3Q3ViZS5yb290ID0gdHJ1ZTtcclxuICAgICAgIHRoaXMuZ2FtZVN0YXRlLnJvb3RTcGF3bmVkID0gdHJ1ZTtcclxuICAgIH1cclxuXHRcclxuXHQvL0NyZWF0ZSBtb2R1bGUgdG8gd3JhcCBhcm91bmQgY3ViZSBjbGFzc1xyXG5cdHZhciBuZXdNb2R1bGUgPSBuZXcgTW9kdWxlKHR5cGUsIG5ld0N1YmUpO1xyXG5cdFx0XHJcblx0Ly9UT0RPOiBlZGl0IHNwZWNpYWwgbW9kdWxlIGF0cmlidXRlcyBiYXNlZCBvbiAndHlwZSdcclxuXHRcclxuXHQvL1N0b3JlIG1vZHVsZSBpZiBpdCBpcyBjb3JlXHJcblx0aWYodHlwZSA9PSAnY29yZScpXHJcblx0e1xyXG5cdFx0dGhpcy5jb3JlID0gbmV3TW9kdWxlO1xyXG5cdFx0dGhpcy5jb3JlRXhpc3RzID0gdHJ1ZTtcclxuXHR9XHJcblx0XHJcblx0Ly9SZXR1cm4gdGhlIG1vZHVsZSBvYmplY3RcclxuXHRyZXR1cm4gbmV3TW9kdWxlO1xyXG59O1xyXG5cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gTW9kdWxlQnVpbGRlcjsiLCIvKlxyXG5EZWZpbmVzIGEgY3ViZSBtb2R1bGUuXHJcbiovXHJcblxyXG52YXIgQ3ViZSA9IGZ1bmN0aW9uIChnYW1lLCB4LCB5LCBzcHJpdGUpIHtcclxuICAgIFBoYXNlci5TcHJpdGUuY2FsbCh0aGlzLCBnYW1lLCB4LCB5LCBzcHJpdGUpO1xyXG4gICAgZ2FtZS5hZGQuZXhpc3RpbmcodGhpcyk7XHJcbiAgICB0aGlzLmdyb3VwID0gdW5kZWZpbmVkO1xyXG59O1xyXG5cclxuQ3ViZS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBoYXNlci5TcHJpdGUucHJvdG90eXBlKTtcclxuQ3ViZS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBDdWJlO1xyXG5cclxuLyoqXHJcbiAqIEF1dG9tYXRpY2FsbHkgY2FsbGVkIGJ5IFdvcmxkLnVwZGF0ZVxyXG4gKi9cclxuQ3ViZS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7XHJcbn07XHJcblxyXG5DdWJlLnByb3RvdHlwZS5jdWJlQ29sbGlkZSA9IGZ1bmN0aW9uKG90aGVyKSB7XHJcbiAgIGlmICh0aGlzLmdyb3VwID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICB9XHJcbiAgIHRoaXMuZ3JvdXAuaGFuZGxlQ29sbGlzaW9uKHRoaXMsIG90aGVyLnNwcml0ZSk7XHJcbn07XHJcblxyXG5DdWJlLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xyXG4gICB2YXIgc3RyaW5nID0gJyc7XHJcbiAgIHN0cmluZyArPSB0aGlzLmNvbmNhdCgnbmFtZScsIHRoaXMubmFtZSk7XHJcbiAgIHJldHVybiBzdHJpbmc7XHJcbn07XHJcblxyXG5DdWJlLnByb3RvdHlwZS5jb25jYXQgPSBmdW5jdGlvbihzdHJpbmcsIHZhbCkge1xyXG4gICByZXR1cm4gc3RyaW5nICsgJzogJyArIHZhbCArICdcXG4nO1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBDdWJlO1xyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbiIsIi8qXHJcbkRlZmluZXMgYSBjdWJlIGdyb3VwLlxyXG4qL1xyXG5cclxudmFyIEN1YmVHcm91cCA9IGZ1bmN0aW9uIChnYW1lLCByb290KSB7XHJcbiAgIHRoaXMuZ2FtZSA9IGdhbWU7XHJcbiAgIHRoaXMucm9vdCA9IHJvb3Q7XHJcbiAgIHRoaXMuY3ViZXMgPSBbXTtcclxuICAgdmFyIGNvbCA9IFtdO1xyXG4gICBjb2wucHVzaCh0aGlzLnJvb3QpO1xyXG4gICB0aGlzLmN1YmVzLnB1c2goY29sKTtcclxuICAgdGhpcy5yb290Lmdyb3VwID0gdGhpcztcclxuICAgdGhpcy5ESVIgPSB7Tk9SVEg6IDAsIEVBU1Q6IDEsIFNPVVRIOiAyLCBXRVNUOiAzfTtcclxuICAgdGhpcy5vZmZzZXQgPSAyO1xyXG59O1xyXG5cclxuQ3ViZUdyb3VwLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IEN1YmVHcm91cDtcclxuXHJcbi8qKlxyXG4gKiBBdXRvbWF0aWNhbGx5IGNhbGxlZCBieSBXb3JsZC51cGRhdGVcclxuICovXHJcbkN1YmVHcm91cC5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7XHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uKGN1YmUpIHtcclxuICBjdWJlLmdyb3VwID0gdGhpczsgXHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLmhhbmRsZUNvbGxpc2lvbiA9IGZ1bmN0aW9uKG9yaWdpbiwgb3RoZXIpIHtcclxuICAgLy8gc3RvcCBpZiBvdGhlciBkb2VzIG5vdCBleGlzdCwgZWl0aGVyIGlzIG5vdCBhIGN1YmUsIGJvdGggYXJlIGluIHNhbWUgZ3J1b3BcclxuICAgaWYgKG90aGVyID09PSBudWxsIHx8IG9yaWdpbi5wcm90b3R5cGUgIT09IG90aGVyLnByb3RvdHlwZSB8fCBvcmlnaW4uZ3JvdXAgPT09IG90aGVyLmdyb3VwKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgfVxyXG4gICB2YXIgcmVsU2lkZSA9IHRoaXMucmVsYXRpdmVTaWRlKG9yaWdpbi5ib2R5LCBvdGhlci5ib2R5KTtcclxuICAgdmFyIG9yaWdpbkxvYyA9IHRoaXMuZmluZChvcmlnaW4pO1xyXG4gICB2YXIgb3RoZXJMb2MgPSB0aGlzLmFkanVzdChvcmlnaW5Mb2MsIHJlbFNpZGUpO1xyXG4gICAvLyBjb25zb2xlLmxvZygnaG0nLCBvcmlnaW5Mb2MueCwgb3JpZ2luTG9jLnkpO1xyXG4gICBpZiAodGhpcy5nZXRDdWJlKG90aGVyTG9jKSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgIH1cclxuICAgc3dpdGNoIChyZWxTaWRlKSB7XHJcbiAgICAgIGNhc2UgdGhpcy5ESVIuTk9SVEg6XHJcbiAgICAgIGlmIChvcmlnaW5Mb2MueSA9PT0gdGhpcy5jdWJlc0hlaWdodCgpIC0gMSkge1xyXG4gICAgICAgICB0aGlzLmFkZFRvcFJvdygpO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuZ2FtZS5waHlzaWNzLnAyLmNyZWF0ZUxvY2tDb25zdHJhaW50KG9yaWdpbi5ib2R5LCBvdGhlci5ib2R5LCBbMCwgb3JpZ2luLndpZHRoICsgdGhpcy5vZmZzZXRdKTtcclxuICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgdGhpcy5ESVIuRUFTVDpcclxuICAgICAgaWYgKG9yaWdpbkxvYy54ID09PSB0aGlzLmN1YmVzV2lkdGgoKSAtIDEpIHtcclxuICAgICAgICAgdGhpcy5hZGRSaWdodENvbCgpO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuZ2FtZS5waHlzaWNzLnAyLmNyZWF0ZUxvY2tDb25zdHJhaW50KG9yaWdpbi5ib2R5LCBvdGhlci5ib2R5LCBbLW9yaWdpbi53aWR0aCAtIHRoaXMub2Zmc2V0LCAwXSk7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIHRoaXMuRElSLlNPVVRIOlxyXG4gICAgICBpZiAob3JpZ2luTG9jLnkgPT09IDApIHtcclxuICAgICAgICAgdGhpcy5hZGRCb3RSb3coKTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLmdhbWUucGh5c2ljcy5wMi5jcmVhdGVMb2NrQ29uc3RyYWludChvdGhlci5ib2R5LCBvcmlnaW4uYm9keSwgWzAsIG9yaWdpbi53aWR0aCArIHRoaXMub2Zmc2V0XSk7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIHRoaXMuRElSLldFU1Q6XHJcbiAgICAgIGlmIChvcmlnaW5Mb2MueCA9PT0gMCkge1xyXG4gICAgICAgICB0aGlzLmFkZExlZnRDb2woKTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLmdhbWUucGh5c2ljcy5wMi5jcmVhdGVMb2NrQ29uc3RyYWludChvdGhlci5ib2R5LCBvcmlnaW4uYm9keSwgWy1vcmlnaW4ud2lkdGggLSB0aGlzLm9mZnNldCwgMF0pO1xyXG4gICAgICBicmVhaztcclxuICAgfVxyXG4gICAvLyBjb25zb2xlLmxvZygnZW5kJyk7XHJcbiAgIG9yaWdpbkxvYyA9IHRoaXMuZmluZChvcmlnaW4pO1xyXG4gICBvdGhlckxvYyA9IHRoaXMuYWRqdXN0KG9yaWdpbkxvYywgcmVsU2lkZSk7XHJcbiAgIGlmICghb3RoZXJMb2MpIHtcclxuICAgICAgY29uc29sZS5sb2coJ2hhbmRlIGNvbGxpc2lvbiBmYWlsZWQgdG8gZmluZCBzZWNvbmQgb3RoZXIgbG9jJyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgfVxyXG4gICB0aGlzLnNldChvdGhlckxvYywgb3RoZXIpO1xyXG4gICAvLyBjb25zb2xlLmxvZygnYWRkOiAnICsgb3RoZXIubmFtZSArICcgYXQgJyArIG90aGVyTG9jLnggKyAnLCAnICsgb3RoZXJMb2MueSk7XHJcbiAgIC8vIHRoaXMuZGlzcGxheUN1YmVzKCk7XHJcbiAgIG90aGVyLmdyb3VwID0gdGhpcztcclxufTtcclxuXHJcbkN1YmVHcm91cC5wcm90b3R5cGUucmVsYXRpdmVTaWRlID0gZnVuY3Rpb24odGhpc0JvZHksIG90aGVyQm9keSkge1xyXG4gIHZhciB0aGlzUG9pbnQgPSBuZXcgUGhhc2VyLlBvaW50KHRoaXNCb2R5LngsIHRoaXNCb2R5LnkpO1xyXG4gIHZhciBvdGhlclBvaW50ID0gbmV3IFBoYXNlci5Qb2ludChvdGhlckJvZHkueCwgb3RoZXJCb2R5LnkpO1xyXG4gIHZhciBhbmdsZVRvT3RoZXIgPSBQaGFzZXIuUG9pbnQuYW5nbGUodGhpc1BvaW50LCBvdGhlclBvaW50KTtcclxuICBpZiAoYW5nbGVUb090aGVyIDwgMCkgeyAvLyBmaXggZHVtYiBwYXJ0IG9mIFBoYXNlci5Qb2ludC5hbmdsZSgpXHJcbiAgICAgYW5nbGVUb090aGVyID0gMiAqIE1hdGguUEkgKyBhbmdsZVRvT3RoZXI7XHJcbiAgfVxyXG4gIGFuZ2xlVG9PdGhlciA9IChhbmdsZVRvT3RoZXIgKyAzLzIgKiBNYXRoLlBJKSAlICgyICogTWF0aC5QSSk7IC8vIHJvdGF0ZSA5MCBkIGNsb2Nrd2lzZVxyXG4gIHZhciBkaWZmQW5nbGUgPSBhbmdsZVRvT3RoZXIgLSB0aGlzQm9keS5yb3RhdGlvbjtcclxuICAgaWYgKGRpZmZBbmdsZSA8IDEgLyA0ICogTWF0aC5QSSB8fCBkaWZmQW5nbGUgPiA3IC8gNCAqIE1hdGguUEkpIHsgLy8gbm9ydGhcclxuICAgICByZXR1cm4gdGhpcy5ESVIuTk9SVEg7XHJcbiAgfSBlbHNlIGlmIChkaWZmQW5nbGUgPj0gMSAvIDQgKiBNYXRoLlBJICYmIGRpZmZBbmdsZSA8IDMgLyA0ICogTWF0aC5QSSkgeyAvLyBlYXN0XHJcbiAgICAgcmV0dXJuIHRoaXMuRElSLkVBU1Q7XHJcbiAgfSBlbHNlIGlmIChkaWZmQW5nbGUgPj0gMyAvIDQgKiBNYXRoLlBJICYmIGRpZmZBbmdsZSA8IDUgLyA0ICogTWF0aC5QSSkgeyAvLyBzb3V0aFxyXG4gICAgIHJldHVybiB0aGlzLkRJUi5TT1VUSDtcclxuICB9IGVsc2UgaWYgKGRpZmZBbmdsZSA+PSA1IC8gNCAqIE1hdGguUEkgJiYgZGlmZkFuZ2xlIDwgNyAvIDQgKiBNYXRoLlBJKSB7IC8vIHdlc3RcclxuICAgICByZXR1cm4gdGhpcy5ESVIuV0VTVDtcclxuICB9XHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLmZpbmQgPSBmdW5jdGlvbihjdWJlKSB7XHJcbiAgIC8vIGNvbnNvbGUubG9nKCdmaW5kJywgY3ViZS5uYW1lKTtcclxuICAgZm9yICh2YXIgcm93ID0gMDsgcm93IDwgdGhpcy5jdWJlc1dpZHRoKCk7IHJvdysrKSB7XHJcbiAgICAgIGZvciAodmFyIGNvbCA9IDA7IGNvbCA8IHRoaXMuY3ViZXNIZWlnaHQoKTsgY29sKyspIHtcclxuICAgICAgICAgaWYgKHRoaXMuY3ViZXNbcm93XVtjb2xdID09PSBjdWJlKSB7XHJcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdmb3VuZCBhdCcsIHJvdywgY29sKTtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQaGFzZXIuUG9pbnQocm93LCBjb2wpO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBjb25zb2xlLmxvZygnY291bGQgbm90IGZpbmQgY3ViZScsIGN1YmUubmFtZSk7XHJcbiAgIHRoaXMuZGlzcGxheUN1YmVzKCk7XHJcbiAgIHJldHVybiB1bmRlZmluZWQ7XHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLmN1YmVzV2lkdGggPSBmdW5jdGlvbigpIHtcclxuICAgcmV0dXJuIHRoaXMuY3ViZXMubGVuZ3RoO1xyXG59O1xyXG5cclxuQ3ViZUdyb3VwLnByb3RvdHlwZS5jdWJlc0hlaWdodCA9IGZ1bmN0aW9uKCkge1xyXG4gICByZXR1cm4gdGhpcy5jdWJlc1swXS5sZW5ndGg7XHJcbn07XHJcblxyXG4vKlxyXG5bMCxoZWlnaHRdIC4uLiAgW3dpZHRoLCBoZWlnaHRdXHJcbi4gICAgICAgICAgICAgICAgIFxyXG4uICAgICAgICAgICAgICAgLlxyXG4uICAgICAgICAgICAgICAgLlxyXG5bMCwxXSBbMSwxXSAuLi4gLlxyXG5bMCwwXSBbMSwwXSAuLi4gW3dpZHRoLDBdXHJcbiovXHJcbkN1YmVHcm91cC5wcm90b3R5cGUuYWRkVG9wUm93ID0gZnVuY3Rpb24oKSB7XHJcbiAgIC8vIGNvbnNvbGUubG9nKCdhZGQgdG9wJyk7XHJcbiAgIC8vIHRoaXMuZGlzcGxheUN1YmVzKCk7XHJcbiAgIGZvciAodmFyIHJvdyA9IDA7IHJvdyA8IHRoaXMuY3ViZXNXaWR0aCgpOyByb3crKykge1xyXG4gICAgICB0aGlzLmN1YmVzW3Jvd10ucHVzaCh1bmRlZmluZWQpO1xyXG4gICB9XHJcbiAgIC8vIGNvbnNvbGUubG9nKCdlbmQgYWRkIHRvcCcpO1xyXG4gICAvLyB0aGlzLmRpc3BsYXlDdWJlcygpO1xyXG59O1xyXG5cclxuQ3ViZUdyb3VwLnByb3RvdHlwZS5hZGRSaWdodENvbCA9IGZ1bmN0aW9uKCkge1xyXG4gICAvLyBjb25zb2xlLmxvZygnYWRkIHJpZ2h0Jyk7XHJcbiAgIHZhciBuZXdDb2wgPSBuZXcgQXJyYXkodGhpcy5jdWJlc0hlaWdodCk7XHJcbiAgIHRoaXMuY3ViZXMucHVzaChuZXdDb2wpO1xyXG59O1xyXG5cclxuQ3ViZUdyb3VwLnByb3RvdHlwZS5hZGRCb3RSb3cgPSBmdW5jdGlvbigpIHtcclxuICAgLy8gY29uc29sZS5sb2coJ2FkZCBib3QnKTtcclxuICAgLy8gdGhpcy5kaXNwbGF5Q3ViZXMoKTtcclxuICAgZm9yICh2YXIgcm93ID0gMDsgcm93IDwgdGhpcy5jdWJlc1dpZHRoKCk7IHJvdysrKSB7XHJcbiAgICAgIHRoaXMuY3ViZXNbcm93XS51bnNoaWZ0KHVuZGVmaW5lZCk7XHJcbiAgIH1cclxuICAgLy8gY29uc29sZS5sb2coJ2VuZCBhZGQgYm90Jyk7XHJcbiAgIC8vIHRoaXMuZGlzcGxheUN1YmVzKCk7XHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLmFkZExlZnRDb2wgPSBmdW5jdGlvbigpIHtcclxuICAgLy8gY29uc29sZS5sb2coJ2FkZCBsZWZ0Jyk7XHJcbiAgIC8vIHRoaXMuZGlzcGxheUN1YmVzKCk7XHJcbiAgIC8vIGNvbnNvbGUubG9nKCdoZWlnaHQgaXMgJyArIHRoaXMuY3ViZXNIZWlnaHQoKSk7XHJcbiAgIHZhciBuZXdDb2wgPSBuZXcgQXJyYXkodGhpcy5jdWJlc0hlaWdodCgpKTtcclxuICAgdGhpcy5jdWJlcy51bnNoaWZ0KG5ld0NvbCk7XHJcbiAgIC8vIGNvbnNvbGUubG9nKCdlbmQgYWRkIGxlZnQnKTtcclxuICAgLy8gdGhpcy5kaXNwbGF5Q3ViZXMoKTtcclxufTtcclxuXHJcbkN1YmVHcm91cC5wcm90b3R5cGUuZ2V0Q3ViZSA9IGZ1bmN0aW9uKHBvaW50KSB7XHJcbiAgIGlmICh0aGlzLm91dE9mQm91bmRzKHBvaW50KSkge1xyXG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICB9XHJcbiAgIHJldHVybiB0aGlzLmN1YmVzW3BvaW50LnhdW3BvaW50LnldO1xyXG59O1xyXG5cclxuQ3ViZUdyb3VwLnByb3RvdHlwZS5hZGp1c3QgPSBmdW5jdGlvbihwb2ludCwgZGlyKSB7XHJcbiAgaWYgKCFwb2ludCkge1xyXG4gICAgIGNvbnNvbGUubG9nKCdhZGp1c3QgZ2l2ZW4gdW5kZWZpbmVkIHBvaW50Jyk7XHJcbiAgICAgcmV0dXJuO1xyXG4gIH1cclxuICB2YXIgbmV3UG9pbnQgPSBuZXcgUGhhc2VyLlBvaW50KHBvaW50LngsIHBvaW50LnkpO1xyXG4gIHN3aXRjaCAoZGlyKSB7XHJcbiAgICAgIGNhc2UgdGhpcy5ESVIuTk9SVEg6XHJcbiAgICAgIG5ld1BvaW50LnkrKztcclxuICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgdGhpcy5ESVIuRUFTVDpcclxuICAgICAgbmV3UG9pbnQueCsrO1xyXG4gICAgICBicmVhaztcclxuICAgICAgY2FzZSB0aGlzLkRJUi5TT1VUSDpcclxuICAgICAgbmV3UG9pbnQueS0tO1xyXG4gICAgICBicmVhaztcclxuICAgICAgY2FzZSB0aGlzLkRJUi5XRVNUOlxyXG4gICAgICBuZXdQb2ludC54LS07XHJcbiAgICAgIGJyZWFrO1xyXG4gICB9XHJcbiAgIHJldHVybiBuZXdQb2ludDtcclxufTtcclxuXHJcbkN1YmVHcm91cC5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24ocG9pbnQsIGN1YmUpIHtcclxuICAgaWYgKCFwb2ludCkge1xyXG4gICAgICBjb25zb2xlLmxvZygnc2V0IGdpdmVuIHVuZGVmaW5lZCBwb2ludCcpO1xyXG4gICAgICByZXR1cm47XHJcbiAgIH1cclxuICAgaWYgKHRoaXMub3V0T2ZCb3VuZHMocG9pbnQpKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgfVxyXG4gICB0aGlzLmN1YmVzW3BvaW50LnhdW3BvaW50LnldID0gY3ViZTtcclxufTtcclxuXHJcbkN1YmVHcm91cC5wcm90b3R5cGUub3V0T2ZCb3VuZHMgPSBmdW5jdGlvbihwb2ludCkge1xyXG4gICBpZiAoIXBvaW50KSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdvdXQgb2YgYm91bmRzIGdpdmVuIHVuZGVmaW5lZCBwb2ludCcpO1xyXG4gICAgICByZXR1cm47XHJcbiAgIH1cclxuICAgaWYgKHBvaW50LnggPCAwIHx8IHBvaW50LnggPj0gdGhpcy5jdWJlc1dpZHRoKCkgfHwgcG9pbnQueSA8IDAgfHwgcG9pbnQueSA+PSB0aGlzLmN1YmVzSGVpZ2h0KCkpIHtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgIH1cclxuICAgcmV0dXJuIGZhbHNlO1xyXG59O1xyXG5cclxuQ3ViZUdyb3VwLnByb3RvdHlwZS5kaXNwbGF5Q3ViZXMgPSBmdW5jdGlvbigpIHtcclxuICAgZm9yICh2YXIgcm93ID0gMDsgcm93IDwgdGhpcy5jdWJlc1dpZHRoKCk7IHJvdysrKSB7XHJcbiAgICAgIHZhciBzdHJpbmcgPSAnJztcclxuICAgICAgZm9yICh2YXIgY29sID0gMDsgY29sIDwgdGhpcy5jdWJlc0hlaWdodCgpOyBjb2wrKykge1xyXG4gICAgICAgICB2YXIgY3ViZSA9IHRoaXMuY3ViZXNbcm93XVtjb2xdO1xyXG4gICAgICAgICBpZiAoY3ViZSkge1xyXG4gICAgICAgICAgICBzdHJpbmcgKz0gdGhpcy5jdWJlc1tyb3ddW2NvbF0ubmFtZSArICcgJztcclxuICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgc3RyaW5nICs9ICdlbXB0eScgKyAnICc7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBjb25zb2xlLmxvZygncm93ICcgKyByb3cgKyAnOiAnICsgc3RyaW5nICsgJ3wgJyArIHRoaXMuY3ViZXNbcm93XS5sZW5ndGgpO1xyXG4gICB9XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEN1YmVHcm91cDtcclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbiIsInZhciBSZW5kZXJhYmxlcyA9IGZ1bmN0aW9uKCkge1xyXG5cdGlmKFJlbmRlcmFibGVzLnByb3RvdHlwZS5leGlzdHMpIHtcclxuXHRcdHJldHVybiBSZW5kZXJhYmxlcy5wcm90b3R5cGUuZXhpc3RpbmdSZWZlcmVuY2U7XHJcblx0fVxyXG5cdFxyXG5cdHRoaXMubGlzdCA9IFtdO1xyXG5cdFJlbmRlcmFibGVzLnByb3RvdHlwZS5leGlzdHMgPSB0cnVlO1xyXG5cdFJlbmRlcmFibGVzLnByb3RvdHlwZS5leGlzdGluZ1JlZmVyZW5jZSA9IHRoaXM7XHJcbn07XHJcblxyXG5SZW5kZXJhYmxlcy5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBSZW5kZXJhYmxlcztcclxuLy9UaGVzZSB2YXIncyBoZWxwIGNyZWF0ZSB0aGUgc2luZ2xldG9uIGZ1bmN0aW9uYWxpdHlcclxuUmVuZGVyYWJsZXMucHJvdG90eXBlLmV4aXN0cyA9IGZhbHNlO1xyXG5SZW5kZXJhYmxlcy5wcm90b3R5cGUuZXhpc3RpbmdSZWZlcmVuY2UgPSBudWxsO1xyXG5cclxuUmVuZGVyYWJsZXMucHJvdG90eXBlLnN1YnNjcmliZSA9IGZ1bmN0aW9uKHN1YnNjcmliZXIpIHtcclxuXHR0aGlzLmxpc3QucHVzaChzdWJzY3JpYmVyKTtcclxufTtcclxuXHJcblJlbmRlcmFibGVzLnByb3RvdHlwZS51bnN1YnNjcmliZSA9IGZ1bmN0aW9uKHVuc3Vic2NyaWJlcikge1xyXG5cdGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLmxpc3QubGVuZ3RoOyBpKyspIHtcclxuXHRcdGlmKHRoaXMubGlzdFtpXSA9PT0gdW5zdWJzY3JpYmVyKSB7XHJcblx0XHRcdHRoaXMubGlzdFtpXSA9IGZhbHNlO1xyXG5cdFx0fVxyXG5cdH1cclxufTtcclxuXHJcblJlbmRlcmFibGVzLnByb3RvdHlwZS5yZW5kZXJBbGwgPSBmdW5jdGlvbigpIHtcclxuXHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5saXN0Lmxlbmd0aDsgaSsrKSB7XHJcblx0XHRpZih0aGlzLmxpc3RbaV0gPT09IGZhbHNlKSB7XHJcblx0XHRcdGNvbnRpbnVlO1xyXG5cdFx0fVxyXG5cdFx0dGhpcy5saXN0W2ldLnJlbmRlcigpO1xyXG5cdH1cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gUmVuZGVyYWJsZXM7IiwidmFyIEJvb3QgPSBmdW5jdGlvbiAoKSB7fTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gQm9vdDtcclxuXHJcbkJvb3QucHJvdG90eXBlID0ge1xyXG5cclxuICBwcmVsb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ3ByZWxvYWRlcicsICdhc3NldHMvcHJlbG9hZGVyLmdpZicpO1xyXG4gIH0sXHJcblxyXG4gIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5nYW1lLmlucHV0Lm1heFBvaW50ZXJzID0gMTtcclxuXHJcbiAgICBpZiAodGhpcy5nYW1lLmRldmljZS5kZXNrdG9wKSB7XHJcbiAgICAgIHRoaXMuZ2FtZS5zdGFnZS5zY2FsZS5wYWdlQWxpZ25Ib3Jpem9udGFsbHkgPSB0cnVlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5nYW1lLnNjYWxlLnNjYWxlTW9kZSA9IFBoYXNlci5TY2FsZU1hbmFnZXIuU0hPV19BTEw7XHJcbiAgICAgIHRoaXMuZ2FtZS5zY2FsZS5taW5XaWR0aCA9ICA0ODA7XHJcbiAgICAgIHRoaXMuZ2FtZS5zY2FsZS5taW5IZWlnaHQgPSAyNjA7XHJcbiAgICAgIHRoaXMuZ2FtZS5zY2FsZS5tYXhXaWR0aCA9IDY0MDtcclxuICAgICAgdGhpcy5nYW1lLnNjYWxlLm1heEhlaWdodCA9IDQ4MDtcclxuICAgICAgdGhpcy5nYW1lLnNjYWxlLmZvcmNlTGFuZHNjYXBlID0gdHJ1ZTtcclxuICAgICAgdGhpcy5nYW1lLnNjYWxlLnBhZ2VBbGlnbkhvcml6b250YWxseSA9IHRydWU7XHJcbiAgICAgIHRoaXMuZ2FtZS5zY2FsZS5zZXRTY3JlZW5TaXplKHRydWUpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuZ2FtZS5zdGF0ZS5zdGFydCgnUHJlbG9hZGVyJyk7XHJcbiAgfVxyXG59O1xyXG4iLCIvKlxyXG5NYWluIHRlc3RpbmcgZW52aXJvbm1lbnQuXHJcbiovXHJcblxyXG52YXIgUmVuZGVyYWJsZXMgPSByZXF1aXJlKCcuLi9mdW5jdGlvbkFjY2Vzcy9SZW5kZXJhYmxlcycpO1xyXG52YXIgTW9kdWxlQnVpbGRlciA9IHJlcXVpcmUoJy4uL2VudGl0aWVzL01vZHVsZUJ1aWxkZXInKTtcclxudmFyIFVJQnVpbGRlciA9IHJlcXVpcmUoJy4uL3VpL1VJQnVpbGRlcicpO1xyXG52YXIgQ3ViZSA9IHJlcXVpcmUoJy4uL2VudGl0aWVzL2N1YmUnKTtcclxudmFyIE1vZHVsZUJ1aWxkZXIgPSByZXF1aXJlKCcuLi9lbnRpdGllcy9Nb2R1bGVCdWlsZGVyJyk7XHJcbnZhciBVdGlscyA9IHJlcXVpcmUoJy4uL3V0aWxzJyk7XHJcbnZhciBDdWJlR3JvdXAgPSByZXF1aXJlKCcuLi9lbnRpdGllcy9jdWJlX2dyb3VwJyk7XHJcbnZhciBIYWNrYWJsZSA9IHJlcXVpcmUoJy4uL2VudGl0aWVzL0hhY2thYmxlJyk7XHJcblxyXG52YXIgbW91c2VCb2R5OyAvLyBwaHlzaWNzIGJvZHkgZm9yIG1vdXNlXHJcblxyXG52YXIgR2FtZSA9IGZ1bmN0aW9uICgpIHtcclxuICB0aGlzLnRlc3RlbnRpdHkgPSBudWxsO1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBHYW1lO1xyXG5cclxuR2FtZS5wcm90b3R5cGUgPSB7XHJcblx0XHJcbiAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLmdhbWUucGh5c2ljcy5zdGFydFN5c3RlbShQaGFzZXIuUGh5c2ljcy5QMkpTKTtcclxuICAgIHRoaXMuZ2FtZS5waHlzaWNzLnAyLnNldEltcGFjdEV2ZW50cyh0cnVlKTtcclxuICAgIG1vdXNlQm9keSA9IG5ldyBwMi5Cb2R5KCk7IC8vIGpzaGludCBpZ25vcmU6bGluZVxyXG4gICAgdGhpcy5nYW1lLnBoeXNpY3MucDIud29ybGQuYWRkQm9keShtb3VzZUJvZHkpO1xyXG4gICAgXHJcblx0Ly9jcmVhdGUgUmVuZGVyYWJsZXMgY2xhc3NcclxuXHR0aGlzLnJlbmRlcmFibGVzID0gbmV3IFJlbmRlcmFibGVzKCk7XHJcblx0Ly9jcmVhdGUgdGhlIFVJQnVpbGRlclxyXG5cdHRoaXMudWlCdWlsZGVyID0gbmV3IFVJQnVpbGRlcih0aGlzLCB0aGlzLnJlbmRlcmFibGVzKTtcclxuXHQvL2NyZWF0ZSBNb2R1bGVCdWlsZGVyIGFuZCBzdG9yZSBpdCBpbiB0aGlzIGdhbWUgc3RhdGUgb2JqZWN0XHJcblx0dGhpcy5tb2R1bGVCdWlsZGVyID0gbmV3IE1vZHVsZUJ1aWxkZXIodGhpcyk7XHJcblx0Ly9jcmVhdGUgYW5kIHN0b3JlIHRoZSBjb3JlIG1vZHVsZVxyXG5cdHRoaXMuY29yZU1vZHVsZSA9IHRoaXMubW9kdWxlQnVpbGRlci5idWlsZCgnY29yZScsIDIwMCwgMjAwKTtcclxuXHR0aGlzLnBsYXllciA9IG5ldyBDdWJlR3JvdXAodGhpcywgdGhpcy5jb3JlTW9kdWxlLmN1YmUpO1xyXG4gICBcclxuXHR0aGlzLnRlc3RVSSA9IHRoaXMudWlCdWlsZGVyLmJ1aWxkUHJvZ3Jlc3NCYXIoJ2dyb3dpbmcnLCAyMDAsIDUwLCA1MCwgMTAwLCAxMCk7XHJcblx0dGhpcy50ZXN0VUkudmFsdWUgPSA1MDtcclxuXHR0aGlzLnRlc3RVSS5vbkV2ZW50ID0gZnVuY3Rpb24oKSB7XHJcblx0XHR0aGlzLmRlc3Ryb3koKTtcclxuXHR9O1xyXG5cdFxyXG5cdC8vREVCVUdHSU5HIExJU1RFTkVSUy0gYWxsb3cgeW91IHRvIGNyZWF0ZSBtb2R1bGVzIGJ5IHByZXNzaW5nIGtleXNcclxuXHQvL2NvcmVcclxuXHQvLyB0aGlzLnBsYWNlQ29yZUtleSA9IHRoaXMuZ2FtZS5pbnB1dC5rZXlib2FyZC5hZGRLZXkoUGhhc2VyLktleWJvYXJkLlApO1xyXG4gICAvLyB0aGlzLnBsYWNlQ29yZUtleS5vbkRvd24uYWRkKHRoaXMuYWRkQ29yZSwgdGhpcyk7XHJcblx0Ly9zaGllbGRcclxuXHR0aGlzLnBsYWNlU2hpZWxkS2V5ID0gdGhpcy5nYW1lLmlucHV0LmtleWJvYXJkLmFkZEtleShQaGFzZXIuS2V5Ym9hcmQuTyk7XHJcbiAgICB0aGlzLnBsYWNlU2hpZWxkS2V5Lm9uRG93bi5hZGQodGhpcy5hZGRTaGllbGQsIHRoaXMpO1xyXG5cdC8vdGhydXN0ZXJcclxuXHR0aGlzLnBsYWNlVGhydXN0ZXJLZXkgPSB0aGlzLmdhbWUuaW5wdXQua2V5Ym9hcmQuYWRkS2V5KFBoYXNlci5LZXlib2FyZC5JKTtcclxuICAgIHRoaXMucGxhY2VUaHJ1c3RlcktleS5vbkRvd24uYWRkKHRoaXMuYWRkVGhydXN0ZXIsIHRoaXMpO1xyXG5cdC8vc29sYXJQYW5uZWxcclxuXHR0aGlzLnBsYWNlU1BLZXkgPSB0aGlzLmdhbWUuaW5wdXQua2V5Ym9hcmQuYWRkS2V5KFBoYXNlci5LZXlib2FyZC5VKTtcclxuICAgIHRoaXMucGxhY2VTUEtleS5vbkRvd24uYWRkKHRoaXMuYWRkU1AsIHRoaXMpO1xyXG5cdC8vaGFja2VyXHJcblx0dGhpcy5wbGFjZUhhY2tLZXkgPSB0aGlzLmdhbWUuaW5wdXQua2V5Ym9hcmQuYWRkS2V5KFBoYXNlci5LZXlib2FyZC5ZKTtcclxuXHR0aGlzLnBsYWNlSGFja0tleS5vbkRvd24uYWRkKHRoaXMuYWRkSGFjaywgdGhpcyk7XHJcblx0Ly9FTkRcclxuICAgIFxyXG4gICAgdGhpcy5tb3VzZVggPSAwO1xyXG4gICAgdGhpcy5tb3VzZVkgPSAwO1xyXG4gICAgXHJcbiAgICB0aGlzLmlucHV0Lm9uRG93bi5hZGQodGhpcy5jbGljaywgdGhpcyk7XHJcbiAgICB0aGlzLmlucHV0Lm9uVXAuYWRkKHRoaXMucmVsZWFzZSwgdGhpcyk7XHJcbiAgICB0aGlzLmlucHV0LmFkZE1vdmVDYWxsYmFjayh0aGlzLm1vdmUsIHRoaXMpO1xyXG4gICAgdGhpcy5ncmFiYmVkID0gdW5kZWZpbmVkO1xyXG4gICAgdGhpcy5saW5lID0gbmV3IFBoYXNlci5MaW5lKDAsIDAsIDAsIDApO1xyXG4gICAgXHJcbiAgICB0aGlzLnJvb3RTcGF3bmVkID0gZmFsc2U7XHJcbiAgICBcclxuICAgIHRoaXMuZGVidWdOdW0gPSAwO1xyXG4gICAgdGhpcy5teVJvb3QgPSB1bmRlZmluZWQ7XHJcbiAgICBcclxuXHR0aGlzLnRlc3RIYWNrID0gbmV3IEhhY2thYmxlKHRoaXMuZ2FtZSwgOTAsOTAsICdoYWNrYWJsZTEnKTtcclxuXHRcclxuICAgIC8vIHRoaXMucGxheWVyQ29tbWFuZCA9IHRoaXMucGxhY2VDdWJlU3BlYygzMDAsIDMwMCk7XHJcbiAgICAvLyB0aGlzLnBsYXllciA9IG5ldyBDdWJlR3JvdXAodGhpcywgdGhpcy5wbGF5ZXJDb21tYW5kKTtcclxuICAgIFxyXG4gICAgIC8vIHZhciBwb2x5Z29uVGVzdCA9IHRoaXMuZ2FtZS5hZGQuc3ByaXRlKDYwLCA2MCwgJ3Rlc3RzcHJpdGUnKTtcclxuICAgICAvLyB0aGlzLmdhbWUucGh5c2ljcy5wMi5lbmFibGVCb2R5KHBvbHlnb25UZXN0LCB0cnVlKTtcclxuICAgICAvLyBwb2x5Z29uVGVzdC5ib2R5LmNsZWFyU2hhcGVzKCk7XHJcbiAgICAgLy8gcG9seWdvblRlc3QuYm9keS5sb2FkUG9seWdvbignbW9kdWxlX3BoeXNpY3MnLCAndGVzdDInKTtcclxuICB9LFxyXG5cclxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcclxuICAgIGlmICh0aGlzLmdyYWJiZWQpIHtcclxuICAgICAgdmFyIGFuZ2xlID0gTWF0aC5hdGFuMih0aGlzLmdyYWJiZWQuc3ByaXRlLnkgLSB0aGlzLmlucHV0LnBvc2l0aW9uLnksIHRoaXMuZ3JhYmJlZC5zcHJpdGUueCAtIHRoaXMuaW5wdXQucG9zaXRpb24ueCkgKyBNYXRoLlBJO1xyXG4gICAgICB2YXIgZGlzdCA9IFV0aWxzLmRpc3RhbmNlKHRoaXMuZ3JhYmJlZC5zcHJpdGUueCwgdGhpcy5ncmFiYmVkLnNwcml0ZS55LCB0aGlzLmlucHV0LnBvc2l0aW9uLngsIHRoaXMuaW5wdXQucG9zaXRpb24ueSk7XHJcbiAgICAgIHZhciB3ZWlnaHQgPSAxMDtcclxuICAgICAgdGhpcy5ncmFiYmVkLmZvcmNlLnggPSBNYXRoLmNvcyhhbmdsZSkgKiBkaXN0ICogd2VpZ2h0O1xyXG4gICAgICB0aGlzLmdyYWJiZWQuZm9yY2UueSA9IE1hdGguc2luKGFuZ2xlKSAqIGRpc3QgKiB3ZWlnaHQ7XHJcbiAgICAgIHRoaXMubGluZS5zZXRUbyh0aGlzLmdyYWJiZWQuc3ByaXRlLngsIHRoaXMuZ3JhYmJlZC5zcHJpdGUueSwgdGhpcy5pbnB1dC5wb3NpdGlvbi54LCB0aGlzLmlucHV0LnBvc2l0aW9uLnkpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgIHRoaXMubGluZS5zZXRUbygwLCAwLCAwLCAwKTtcclxuICAgIH1cclxuXHR0aGlzLnRlc3RVSS5hZGRWYWx1ZSgwLjgpO1xyXG4gIH0sXHJcbiAgXHJcbiAgcmVuZGVyOiBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLmdhbWUuZGVidWcuZ2VvbSh0aGlzLmxpbmUpO1xyXG5cdHRoaXMucmVuZGVyYWJsZXMucmVuZGVyQWxsKCk7XHJcbiAgfSxcclxuXHJcbiAgY2xpY2s6IGZ1bmN0aW9uIChwb2ludGVyKSB7XHJcbiAgICB2YXIgYm9kaWVzID0gdGhpcy5nYW1lLnBoeXNpY3MucDIuaGl0VGVzdChwb2ludGVyLnBvc2l0aW9uKTtcclxuICAgIGlmIChib2RpZXMubGVuZ3RoKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuZ3JhYmJlZCA9IGJvZGllc1swXS5wYXJlbnQ7XHJcbiAgICB9XHJcbiAgfSxcclxuICBcclxuICByZWxlYXNlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgaWYgKHRoaXMuZ3JhYmJlZCkge1xyXG4gICAgICAgIHRoaXMuZ3JhYmJlZCA9IHVuZGVmaW5lZDtcclxuICAgICB9XHJcbiAgfSxcclxuICBcclxuICBtb3ZlOiBmdW5jdGlvbiAocG9pbnRlcikge1xyXG4gICAgLy8gcDIgdXNlcyBkaWZmZXJlbnQgY29vcmRpbmF0ZSBzeXN0ZW0sIHNvIGNvbnZlcnQgdGhlIHBvaW50ZXIgcG9zaXRpb24gdG8gcDIncyBjb29yZGluYXRlIHN5c3RlbVxyXG4gICAgbW91c2VCb2R5LnBvc2l0aW9uWzBdID0gdGhpcy5nYW1lLnBoeXNpY3MucDIucHhtaShwb2ludGVyLnBvc2l0aW9uLngpO1xyXG4gICAgbW91c2VCb2R5LnBvc2l0aW9uWzFdID0gdGhpcy5nYW1lLnBoeXNpY3MucDIucHhtaShwb2ludGVyLnBvc2l0aW9uLnkpO1xyXG4gICAgdGhpcy5tb3VzZVggPSBwb2ludGVyLnBvc2l0aW9uLng7XHJcbiAgICB0aGlzLm1vdXNlWSA9IHBvaW50ZXIucG9zaXRpb24ueTtcclxuICB9LFxyXG4gIFxyXG4gIC8vREVCVUcgRlVOQ1RJT05TLSBldmVudCBmdW5jdGlvbnMgY2FsbGVkIGZyb20gbGlzdGVuZXJzIHRoYXQgYWxsb3cgeW91IHRvIGNyZWF0ZSBtb2R1bGVzIHdpdGgga2V5IHByZXNzZXNcclxuICBhZGRDb3JlOiBmdW5jdGlvbiAoKSB7XHJcblx0Ly9BdHRlbXB0cyB0byBjcmVhdGUgbW9yZSBjb3JlIG1vZHVsZXMgaGVyZSB3aWxsIG9ubHkgcmV0dXJuIHRoZSBleGlzdGluZyBjb3JlXHJcblx0dGhpcy5tb2R1bGVCdWlsZGVyLmJ1aWxkKCdjb3JlJywgdGhpcy5tb3VzZVgsIHRoaXMubW91c2VZKTtcclxuICB9LFxyXG4gIGFkZFNoaWVsZDogZnVuY3Rpb24gKCkge1xyXG5cdHRoaXMubW9kdWxlQnVpbGRlci5idWlsZCgnc2hpZWxkJywgdGhpcy5tb3VzZVgsIHRoaXMubW91c2VZKTtcclxuICB9LFxyXG4gIGFkZFRocnVzdGVyOiBmdW5jdGlvbiAoKSB7XHJcblx0dGhpcy5tb2R1bGVCdWlsZGVyLmJ1aWxkKCd0aHJ1c3RlcicsIHRoaXMubW91c2VYLCB0aGlzLm1vdXNlWSk7XHJcbiAgfSxcclxuICBhZGRTUDogZnVuY3Rpb24gKCkge1xyXG5cdHRoaXMubW9kdWxlQnVpbGRlci5idWlsZCgnc29sYXJQYW5uZWwnLCB0aGlzLm1vdXNlWCwgdGhpcy5tb3VzZVkpO1xyXG4gIH0sXHJcbiAgYWRkSGFjazogZnVuY3Rpb24gKCkge1xyXG5cdHRoaXMubW9kdWxlQnVpbGRlci5idWlsZCgnaGFja2VyJywgdGhpcy5tb3VzZVgsIHRoaXMubW91c2VZKTtcclxuICB9LFxyXG4gIHBsYWNlQ3ViZTogZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGVudGl0eSA9IG5ldyBDdWJlKHRoaXMuZ2FtZSwgdGhpcy5tb3VzZVgsIHRoaXMubW91c2VZKTtcclxuICAgIHZhciBzY2FsZSA9IDAuNTtcclxuICAgIGVudGl0eS5uYW1lID0gdGhpcy5kZWJ1Z051bSsrO1xyXG4gICAgZW50aXR5LnNjYWxlLnggPSBzY2FsZTtcclxuICAgIGVudGl0eS5zY2FsZS55ID0gc2NhbGU7XHJcbiAgICBlbnRpdHkuYW5jaG9yLnNldFRvKDAuNSwgMC41KTtcclxuICAgIHRoaXMuZ2FtZS5waHlzaWNzLnAyLmVuYWJsZShlbnRpdHkpO1xyXG4gICAgZW50aXR5LmJvZHkub25CZWdpbkNvbnRhY3QuYWRkKGVudGl0eS5jdWJlQ29sbGlkZSwgZW50aXR5KTtcclxuICAgIGVudGl0eS5ib2R5LmRhbXBpbmcgPSAwLjk7XHJcbiAgICBlbnRpdHkuYm9keS5hbmd1bGFyRGFtcGluZyA9IDAuOTtcclxuICAgIGlmICghdGhpcy5yb290U3Bhd25lZCkge1xyXG4gICAgICAgZW50aXR5LnJvb3QgPSB0cnVlO1xyXG4gICAgICAgdGhpcy5yb290U3Bhd25lZCA9IHRydWU7XHJcbiAgICB9XHJcbiAgfSxcclxuICAvKlxyXG4gIHBsYWNlQ3ViZVNwZWM6IGZ1bmN0aW9uICh4LCB5KSB7XHJcbiAgICB2YXIgZW50aXR5ID0gbmV3IEN1YmUodGhpcy5nYW1lLCB4LCB5KTtcclxuICAgIHZhciBzY2FsZSA9IDAuNTtcclxuICAgIGVudGl0eS5uYW1lID0gdGhpcy5kZWJ1Z051bSsrO1xyXG4gICAgZW50aXR5LnNjYWxlLnggPSBzY2FsZTtcclxuICAgIGVudGl0eS5zY2FsZS55ID0gc2NhbGU7XHJcbiAgICBlbnRpdHkuYW5jaG9yLnNldFRvKDAuNSwgMC41KTtcclxuICAgIHRoaXMuZ2FtZS5waHlzaWNzLnAyLmVuYWJsZShlbnRpdHkpO1xyXG4gICAgZW50aXR5LmJvZHkub25CZWdpbkNvbnRhY3QuYWRkKGVudGl0eS5jdWJlQ29sbGlkZSwgZW50aXR5KTtcclxuICAgIGVudGl0eS5ib2R5LmRhbXBpbmcgPSAwLjk7XHJcbiAgICBlbnRpdHkuYm9keS5hbmd1bGFyRGFtcGluZyA9IDAuOTtcclxuICAgIGlmICghdGhpcy5yb290U3Bhd25lZCkge1xyXG4gICAgICAgZW50aXR5LnJvb3QgPSB0cnVlO1xyXG4gICAgICAgdGhpcy5yb290U3Bhd25lZCA9IHRydWU7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZW50aXR5O1xyXG4gIH0sXHJcbiAgKi9cclxuICBcclxuICAvL0RFQlVHIEZVTkNUSU9OUy0gZXZlbnQgZnVuY3Rpb25zIGNhbGxlZCBmcm9tIGxpc3RlbmVycyB0aGF0IGFsbG93IHlvdSB0byBjcmVhdGUgbW9kdWxlcyB3aXRoIGtleSBwcmVzc2VzXHJcbiAgYWRkQ29yZTogZnVuY3Rpb24gKCkge1xyXG5cdC8vQXR0ZW1wdHMgdG8gY3JlYXRlIG1vcmUgY29yZSBtb2R1bGVzIGhlcmUgd2lsbCBvbmx5IHJldHVybiB0aGUgZXhpc3RpbmcgY29yZVxyXG5cdHRoaXMubW9kdWxlQnVpbGRlci5idWlsZCgnY29yZScsIHRoaXMubW91c2VYLCB0aGlzLm1vdXNlWSk7XHJcbiAgfSxcclxuICBhZGRTaGllbGQ6IGZ1bmN0aW9uICgpIHtcclxuXHR0aGlzLm1vZHVsZUJ1aWxkZXIuYnVpbGQoJ3NoaWVsZCcsIHRoaXMubW91c2VYLCB0aGlzLm1vdXNlWSk7XHJcbiAgfSxcclxuICBhZGRUaHJ1c3RlcjogZnVuY3Rpb24gKCkge1xyXG5cdHRoaXMubW9kdWxlQnVpbGRlci5idWlsZCgndGhydXN0ZXInLCB0aGlzLm1vdXNlWCwgdGhpcy5tb3VzZVkpO1xyXG4gIH0sXHJcbiAgYWRkU1A6IGZ1bmN0aW9uICgpIHtcclxuXHR0aGlzLm1vZHVsZUJ1aWxkZXIuYnVpbGQoJ3NvbGFyUGFubmVsJywgdGhpcy5tb3VzZVgsIHRoaXMubW91c2VZKTtcclxuICB9XHJcbiAgLy9FTkRcclxuICBcclxufTtcclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuIiwidmFyIE1lbnUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgdGhpcy50ZXh0ID0gbnVsbDtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gTWVudTtcclxuXHJcbk1lbnUucHJvdG90eXBlID0ge1xyXG5cclxuICBjcmVhdGU6IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciB4ID0gdGhpcy5nYW1lLndpZHRoIC8gMjtcclxuICAgIHZhciB5ID0gdGhpcy5nYW1lLmhlaWdodCAvIDI7XHJcblxyXG4gICAgdmFyIHN0eWxlID0geyBmb250OiAnNjVweCBBcmlhbCcsIGZpbGw6ICcjZmZmZmZmJywgYWxpZ246ICdjZW50ZXInIH07XHJcblxyXG4gICAgdGhpcy50ZXh0ID0gdGhpcy5hZGQudGV4dCh4IC0gMzAwLCB5IC0gMjAwLCAnUHJlc3MgdG8gU3RhcnQnLCBzdHlsZSk7XHJcblxyXG4gICAgdGhpcy5pbnB1dC5vbkRvd24uYWRkKHRoaXMub25Eb3duLCB0aGlzKTtcclxuICB9LFxyXG5cclxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcclxuICB9LFxyXG5cclxuICBvbkRvd246IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMuZ2FtZS5zdGF0ZS5zdGFydChwbGF5ZXJTdGF0ZS5jdXJyZW50TGV2ZWwpOyAvLyBqc2hpbnQgaWdub3JlOmxpbmVcclxuICB9XHJcbn07XHJcbiIsInZhciBQcmVsb2FkZXIgPSBmdW5jdGlvbiAoZ2FtZSkge1xyXG4gIGdhbWUgPSBudWxsO1xyXG4gIHRoaXMuYXNzZXQgPSBudWxsO1xyXG4gIHRoaXMucmVhZHkgPSBmYWxzZTtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gUHJlbG9hZGVyO1xyXG5cclxuUHJlbG9hZGVyLnByb3RvdHlwZSA9IHtcclxuXHJcbiAgcHJlbG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5hc3NldCA9IHRoaXMuYWRkLnNwcml0ZSgzMjAsIDI0MCwgJ3ByZWxvYWRlcicpO1xyXG4gICAgdGhpcy5hc3NldC5hbmNob3Iuc2V0VG8oMC41LCAwLjUpO1xyXG5cclxuICAgIHRoaXMubG9hZC5vbkxvYWRDb21wbGV0ZS5hZGRPbmNlKHRoaXMub25Mb2FkQ29tcGxldGUsIHRoaXMpO1xyXG4gICAgdGhpcy5sb2FkLnNldFByZWxvYWRTcHJpdGUodGhpcy5hc3NldCk7XHJcbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ3Rlc3RzcHJpdGUnLCAnYXNzZXRzL3Rlc3QyLnBuZycpO1xyXG5cdHRoaXMubG9hZC5pbWFnZSgnY29yZScsICdhc3NldHMvY29yZS5wbmcnKTtcclxuXHR0aGlzLmxvYWQuaW1hZ2UoJ3RocnVzdGVyJywgJ2Fzc2V0cy90aHJ1c3Rlci5wbmcnKTtcclxuXHR0aGlzLmxvYWQuaW1hZ2UoJ3NoaWVsZCcsICdhc3NldHMvc2hpZWxkLnBuZycpO1xyXG5cdHRoaXMubG9hZC5pbWFnZSgnc29sYXJQYW5uZWwnLCAnYXNzZXRzL3NvbGFyUGFubmVsLnBuZycpO1xyXG5cdHRoaXMubG9hZC5pbWFnZSgnaGFja2VyJywgJ2Fzc2V0cy9oYWNrZXIucG5nJyk7XHJcblx0dGhpcy5sb2FkLmltYWdlKCdoYWNrYWJsZTEnLCAnYXNzZXRzL2hhY2thYmxlMS5wbmcnKTtcclxuXHRcclxuICAgIHRoaXMubG9hZC5waHlzaWNzKCdtb2R1bGVfcGh5c2ljcycsICdhc3NldHMvbW9kdWxlX3BoeXNpY3MuanNvbicpO1xyXG4gIH0sXHJcblxyXG4gIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5hc3NldC5jcm9wRW5hYmxlZCA9IGZhbHNlO1xyXG4gIH0sXHJcblxyXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgaWYgKCEhdGhpcy5yZWFkeSkge1xyXG4gICAgICAvLyB0aGlzLmdhbWUuc3RhdGUuc3RhcnQoJ01lbnUnKTtcclxuICAgICAgdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KHBsYXllclN0YXRlLmN1cnJlbnRMZXZlbCk7IC8vIGpzaGludCBpZ25vcmU6bGluZVxyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIG9uTG9hZENvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLnJlYWR5ID0gdHJ1ZTtcclxuICB9XHJcbn07XHJcbiIsInZhciBTcGxhc2ggPSBmdW5jdGlvbiAoKSB7XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFNwbGFzaDtcclxuXHJcblNwbGFzaC5wcm90b3R5cGUgPSB7XHJcbiAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgfVxyXG59OyIsIi8vTk9URTogRE9OJ1QgVVNFIHRoaXMgY29kZSB0byBjcmVhdGUgYSBQcm9ncmVzc0Jhci4gSW5zdGVhZCwgdXNlIHRoZSBVSUJ1aWxkZXIgb2JqZWN0IGFuZCBjYWxsIGJ1aWxkUHJvZ3Jlc3NCYXJcclxuXHJcbnZhciBQcm9ncmVzc0JhciA9IGZ1bmN0aW9uKHNldFR5cGUsIHNldE1heFZhbHVlLCBzZXRHcmFwaGljcywgc2V0UmVuZGVyYWJsZXMpIHtcclxuXHR0aGlzLnR5cGUgPSBzZXRUeXBlOyAvL1R3byB0eXBlcywgXCJncm93aW5nXCIgKHN0YXJ0cyBhdCAwLCB0cmlnZ2VycyBldmVudCB3aGVuIGZ1bGwpIFxyXG5cdFx0XHRcdFx0XHQgLy9hbmQgXCJzaHJpbmtpbmdcIiAoc3RhcnRzIGZ1bGwsIHRyaWdnZXJzIGF0IDApXHJcblx0dGhpcy54ID0gbnVsbDtcclxuXHR0aGlzLnkgPSBudWxsO1xyXG5cdHRoaXMud2lkdGggPSBudWxsO1xyXG5cdHRoaXMuaGVpZ2h0ID0gbnVsbDtcclxuXHR0aGlzLm1heFZhbHVlID0gc2V0TWF4VmFsdWU7XHJcblx0dGhpcy5ncmFwaGljcyA9IHNldEdyYXBoaWNzOyAvL3N0b3JlIGdyYXBoaWNzIGNsYXNzICh1c2VkIHRvIGRyYXcgYmFyKVxyXG5cdHRoaXMucmVuZGVyYWJsZXMgPSBzZXRSZW5kZXJhYmxlcztcclxuXHRcclxuXHR0aGlzLm9uRXZlbnQgPSBmdW5jdGlvbigpIHt9OyAvL292ZXJ3cml0ZSB0aGlzIGZ1bmN0aW9uIHRvIG1ha2Ugd2hhdGV2ZXIgeW91IHdhbnQgaGFwcGVuIHdoZW4gcHJvZ3Jlc3NCYXIgcmVhY2hlcyBsaW1pdFxyXG5cdFxyXG5cdC8vc3dpdGNoKHRoaXMudHlwZSkge1xyXG5cdC8vY2FzZSAnZ3Jvd2luZycgOiBcclxuXHRpZihzZXRUeXBlID09ICdncm93aW5nJykge1xyXG5cdFx0dGhpcy52YWx1ZSA9IDA7XHJcblx0XHQvL3RyeVRyaWdnZXIgaXMgY2FsbGVkIGF1dG9tYXRpY2FsbHkgd2hlbiB5b3UgYWRkL3N1YnRyYWN0IHZhbHVlLCBhbmQgd2lsbCB0cmlnZ2VyIHRoZSBvbkV2ZW50KCkgZnVuY3Rpb25cclxuXHRcdHRoaXMudHJ5VHJpZ2dlciA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRpZih0aGlzLnZhbHVlID49IHRoaXMubWF4VmFsdWUpIHtcclxuXHRcdFx0XHR0aGlzLm9uRXZlbnQoKTtcclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHRcdC8vYnJlYWs7XHJcblx0fVxyXG5cdGVsc2UgaWYoc2V0VHlwZSA9PSAnc2hyaW5raW5nJykge1xyXG5cdC8vY2FzZSAnc2hyaW5raW5nJyA6XHJcblx0XHR0aGlzLnZhbHVlID0gdGhpcy5tYXhWYWx1ZTtcclxuXHRcdHRoaXMudHJ5VHJpZ2dlciA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRpZih0aGlzLnZhbHVlIDw9IDApIHtcclxuXHRcdFx0XHR0aGlzLm9uRXZlbnQoKTtcclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHQvL31cclxuXHR9XHJcbn07XHJcblxyXG5Qcm9ncmVzc0Jhci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBQcm9ncmVzc0JhcjtcclxuXHJcblByb2dyZXNzQmFyLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24oKSB7XHJcblx0dGhpcy5ncmFwaGljcy5jbGVhcigpO1xyXG5cdHRoaXMucmVuZGVyYWJsZXMudW5zdWJzY3JpYmUodGhpcyk7XHJcbn07XHJcblxyXG4vL1RvIHN1YnRyYWN0IHZhbHVlLCBqdXN0IHVzZSBuZWdhdGl2ZSBudW1iZXJzIGFzIGFyZ3VtZW50IGkuZS4gZm9vLmFkZFZhbHVlKC01KTtcclxuUHJvZ3Jlc3NCYXIucHJvdG90eXBlLmFkZFZhbHVlID0gZnVuY3Rpb24gKGFkZFRoaXMpIHtcclxuXHR0aGlzLnZhbHVlICs9IGFkZFRoaXM7XHJcblx0aWYodGhpcy52YWx1ZSA+IHRoaXMubWF4VmFsdWUpIHtcclxuXHRcdHRoaXMudmFsdWUgPSB0aGlzLm1heFZhbHVlO1xyXG5cdH1cclxuXHRpZih0aGlzLnZhbHVlIDwgMCkge1xyXG5cdFx0dGhpcy52YWx1ZSA9IDA7XHJcblx0fVxyXG5cdHRoaXMudHJ5VHJpZ2dlcigpO1xyXG59O1xyXG5cclxuLy9TZXRzIHRoZSBsb2NhdGlvbiB3aGVyZSBwcm9ncmVzcyBiYXIgaXMgcmVuZGVyZWRcclxuUHJvZ3Jlc3NCYXIucHJvdG90eXBlLnNldExvY2F0aW9uID0gZnVuY3Rpb24oc2V0WCwgc2V0WSkge1xyXG5cdHRoaXMueCA9IHNldFg7XHJcblx0dGhpcy55ID0gc2V0WTtcclxufTtcclxuXHJcbi8vU2V0cyB0aGUgc2l6ZSBvZiB0aGUgcHJvZ3Jlc3MgYmFyXHJcblByb2dyZXNzQmFyLnByb3RvdHlwZS5zZXRTaXplID0gZnVuY3Rpb24oc2V0V2lkdGgsIHNldEhlaWdodCkge1xyXG5cdHRoaXMud2lkdGggPSBzZXRXaWR0aDtcclxuXHR0aGlzLmhlaWdodCA9IHNldEhlaWdodDtcclxufTtcclxuXHJcbi8vUmVuZGVycyBwcm9ncmVzc0JhclxyXG5Qcm9ncmVzc0Jhci5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24oKSB7XHJcblx0Y29uc29sZS5sb2coJ3JlbmRlcmVkJyk7XHJcblx0dGhpcy5ncmFwaGljcy5jbGVhcigpO1xyXG5cdC8vRHJhdyBiYWNrZ3JvdW5kIG9mIGJhclxyXG5cdHRoaXMuZ3JhcGhpY3MubGluZVN0eWxlKDIsIDB4QUFBQUFBLCAxKTtcclxuXHR0aGlzLmdyYXBoaWNzLmJlZ2luRmlsbCgweDg4ODg4OCk7XHJcblx0dGhpcy5ncmFwaGljcy5kcmF3UmVjdCh0aGlzLngtdGhpcy53aWR0aC8yLCB0aGlzLnktdGhpcy5oZWlnaHQvMiwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xyXG5cdHRoaXMuZ3JhcGhpY3MuZW5kRmlsbCgpO1xyXG5cdC8vRHJhdyB2YWx1ZSBvZiBiYXJcclxuXHR2YXIgcGVyY2VudGFnZSA9IHRoaXMudmFsdWUgLyB0aGlzLm1heFZhbHVlO1xyXG5cdHZhciBiYXJXaWR0aCA9IHRoaXMud2lkdGggLSA1O1xyXG5cdHZhciBiYXJIZWlnaHQgPSB0aGlzLmhlaWdodCAtIDU7XHJcblx0dGhpcy5ncmFwaGljcy5saW5lU3R5bGUoMSwgMHg4ODg4RkYsIDEpO1xyXG5cdHRoaXMuZ3JhcGhpY3MuYmVnaW5GaWxsKDB4MDAwMDk5KTtcclxuXHR0aGlzLmdyYXBoaWNzLmRyYXdSZWN0KHRoaXMueC0oYmFyV2lkdGgvMiksIHRoaXMueS0oYmFySGVpZ2h0LzIpLCBiYXJXaWR0aCpwZXJjZW50YWdlLCBiYXJIZWlnaHQpO1xyXG5cdHRoaXMuZ3JhcGhpY3MuZW5kRmlsbCgpO1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBQcm9ncmVzc0JhcjsiLCJ2YXIgUHJvZ3Jlc3NCYXIgPSByZXF1aXJlKCcuL1Byb2dyZXNzQmFyJyk7XHJcblxyXG52YXIgVUlCdWlsZGVyID0gZnVuY3Rpb24oc2V0R2FtZVN0YXRlLCBzZXRSZW5kZXJhYmxlcykge1xyXG5cdC8vRW5zdXJlIHRoYXQgY2Fubm90IGNyZWF0ZSBtdWx0aXBsZSBpbnN0YW5jZXMgb2YgdGhpcyBjbGFzc1xyXG5cdGlmKFVJQnVpbGRlci5wcm90b3R5cGUuZXhpc3RzKSB7XHJcblx0XHRyZXR1cm4gVUlCdWlsZGVyLnByb3RvdHlwZS5leGlzdGluZ1JlZmVyZW5jZTtcclxuXHR9XHJcblx0XHJcblx0dGhpcy5nYW1lU3RhdGUgPSBzZXRHYW1lU3RhdGU7XHJcblx0dGhpcy5yZW5kZXJhYmxlcyA9IHNldFJlbmRlcmFibGVzO1xyXG5cdC8vQ3JlYXRlIGFuZCBzdG9yZSBhIGdyYXBoaWNzIG9iamVjdCAodXNlZCBmb3Igc3R1ZmYgbGlrZSBkcmF3aW5nIHJlY3RhbmdsZXMpXHJcblx0VUlCdWlsZGVyLnByb3RvdHlwZS5leGlzdHMgPSB0cnVlO1xyXG5cdFVJQnVpbGRlci5wcm90b3R5cGUuZXhpc3RpbmdSZWZlcmVuY2UgPSB0aGlzO1xyXG59O1xyXG5cclxuVUlCdWlsZGVyLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFVJQnVpbGRlcjtcclxuLy9UaGVzZSB2YXIncyBoZWxwIGNyZWF0ZSB0aGUgc2luZ2xldG9uIGZ1bmN0aW9uYWxpdHlcclxuVUlCdWlsZGVyLnByb3RvdHlwZS5leGlzdHMgPSBmYWxzZTtcclxuVUlCdWlsZGVyLnByb3RvdHlwZS5leGlzdGluZ1JlZmVyZW5jZSA9IG51bGw7XHJcblxyXG4vL1VzZSB0aGlzIGZ1bmN0aW9uIHRvIGNyZWF0ZSBhIHByb2dyZXNzIGJhclxyXG4vL1VzYWdlOiB0eXBlOiBjYW4gYmUgXCJncm93aW5nXCIgb3IgXCJzaHJpbmtpbmdcIiwgdGhpcyB3aWxsIGVmZmVjdCBpZiBiYXIgc3RhcnRzIGF0IDAgYW5kIGdvZXMgdXAgb3IgdmlzIHZlcnNhXHJcbi8vXHRcdCBtYXhWYWx1ZTogc2V0cyB0aGUgbWF4IHZhbHVlIG9mIHRoZSBwcm9ncmVzcyBiYXIsIGkuZS4gdXNpbmcgMTAwIGNyZWF0ZXMgYSBiYXIgZnJvbSAwIHRvIDEwMFxyXG4vL1x0XHQgeCx5OiBzZXRzIGxvY2F0aW9uXHJcbi8vXHRcdCBET04nVCBGT1JHRVQgdG8gb3ZlcndyaXRlIHRoZSBvbkV2ZW50KCkgZnVuY3Rpb24gZm9yIHRoZSBwcm9ncmVzcyBiYXIgYWZ0ZXIgY3JlYXRpbmcgaXRcclxuLy9cdFx0XHQtb25FdmVudCgpIGlzIGF1dG9tYXRpY2FsbHkgY2FsbGVkIHdoZW4gYmFyIGZpbGxzL3Nocmlua3MgcGFzdCBsaW1pdCAoZGVwZW5kaW5nIG9uIGJhciB0eXBlKVxyXG5VSUJ1aWxkZXIucHJvdG90eXBlLmJ1aWxkUHJvZ3Jlc3NCYXIgPSBmdW5jdGlvbih0eXBlLCBtYXhWYWx1ZSwgeCwgeSwgd2lkdGgsIGhlaWdodCkge1xyXG5cdC8vY3JlYXRlIGFuZCBmb3JtYXQgbmV3IHByb2cgYmFyXHJcblx0dmFyIGdyYXBoaWNzID0gdGhpcy5nYW1lU3RhdGUuZ2FtZS5hZGQuZ3JhcGhpY3MoMCwwKTtcclxuXHR2YXIgbmV3UHJvZ0JhciA9IG5ldyBQcm9ncmVzc0Jhcih0eXBlLCBtYXhWYWx1ZSwgZ3JhcGhpY3MsIHRoaXMucmVuZGVyYWJsZXMpO1xyXG5cdG5ld1Byb2dCYXIuc2V0TG9jYXRpb24oeCx5KTtcclxuXHRuZXdQcm9nQmFyLnNldFNpemUod2lkdGgsIGhlaWdodCk7XHJcblx0Ly9zdWJzY3JpYmUgdG8gJ3JlbmRlcmFibGVzJyBzbyB0aGF0IHJlbmRlcigpIGlzIGNhbGxlZCBhdXRvbWF0aWNhbGx5XHJcblx0dGhpcy5yZW5kZXJhYmxlcy5zdWJzY3JpYmUobmV3UHJvZ0Jhcik7XHJcblx0cmV0dXJuIG5ld1Byb2dCYXI7XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFVJQnVpbGRlcjsiLCIvKlxyXG5Db2xsZWN0aW9uIG9mIHV0aWxpdHkgZnVuY3Rpb25zLlxyXG4qL1xyXG5cclxudmFyIFV0aWxzID0ge1xyXG4gICAgY29udGFpbnNPYmplY3Q6IGZ1bmN0aW9uKG9iaiwgbGlzdCkge1xyXG4gICAgICAgIHZhciBpO1xyXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChsaXN0W2ldID09PSBvYmopIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9LFxyXG4gICAgZGlzdGFuY2U6IGZ1bmN0aW9uKHgxLCB5MSwgeDIsIHkyKSB7XHJcbiAgICAgICByZXR1cm4gTWF0aC5zcXJ0KE1hdGgucG93KHgxIC0geDIsIDIpICsgTWF0aC5wb3coeTEgLSB5MiwgMikpO1xyXG4gICAgfVxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBVdGlsczsiXX0=
