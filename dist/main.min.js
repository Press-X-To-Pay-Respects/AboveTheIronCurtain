(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"./src/js/main.js":[function(require,module,exports){
'use strict';

var game = new Phaser.Game(800, 800, Phaser.AUTO, 'atic-game');

window.playerState = {
    currentLevel: 'Game'
};

game.state.add('Boot', require('./states/boot'));
game.state.add('Splash', require('./states/splash'));
game.state.add('Preloader', require('./states/preloader'));
game.state.add('Menu', require('./states/menu'));
game.state.add('Game', require('./states/game'));

game.state.start('Boot');
},{"./states/boot":"C:\\Users\\mattd_000\\Documents\\GitHub\\AboveTheIronCurtain\\src\\js\\states\\boot.js","./states/game":"C:\\Users\\mattd_000\\Documents\\GitHub\\AboveTheIronCurtain\\src\\js\\states\\game.js","./states/menu":"C:\\Users\\mattd_000\\Documents\\GitHub\\AboveTheIronCurtain\\src\\js\\states\\menu.js","./states/preloader":"C:\\Users\\mattd_000\\Documents\\GitHub\\AboveTheIronCurtain\\src\\js\\states\\preloader.js","./states/splash":"C:\\Users\\mattd_000\\Documents\\GitHub\\AboveTheIronCurtain\\src\\js\\states\\splash.js"}],"C:\\Users\\mattd_000\\Documents\\GitHub\\AboveTheIronCurtain\\src\\js\\entities\\cube.js":[function(require,module,exports){
/*
Defines a cube module for a cubesat.
*/

var Cube = function (game, x, y) {
    Phaser.Sprite.call(this, game, x, y, 'testsprite');
    game.add.existing(this);
    this.north = undefined;
    this.east = undefined;
    this.south = undefined;
    this.west = undefined;
    this.root = false;
    this.DIR = {NORTH: 0, EAST: 1, SOUTH: 2, WEST: 3};
};

Cube.prototype = Object.create(Phaser.Sprite.prototype);
Cube.prototype.constructor = Cube;

/**
 * Automatically called by World.update
 */
Cube.prototype.update = function() {
};

Cube.prototype.addConnection = function(other) {
  var offset = 2;
  var thisSide = this.relativeSide(this.body, other);
  var otherSide = this.relativeSide(other, this.body);
  // console.log(thisSide, otherSide);
  if (this.getSide(thisSide)) {
     return;
  }
  if (other.sprite.getSide(otherSide)) {
     return;
  }
  switch (thisSide) {
     case this.DIR.NORTH:
     this.game.physics.p2.createLockConstraint(this.body, other, [0, this.width + offset]);
     this.north = other.sprite;
     break;
     case this.DIR.EAST:
     this.game.physics.p2.createLockConstraint(this.body, other, [-this.width - offset, 0]);
     this.east = other.sprite;
     break;
     case this.DIR.SOUTH:
     this.game.physics.p2.createLockConstraint(this.body, other, [0, -this.width - offset]);
     this.south = other.sprite;
     break;
     case this.DIR.WEST:
     this.game.physics.p2.createLockConstraint(this.body, other, [this.width + offset, 0]);
     this.west = other.sprite;
     break;
  }
  switch (otherSide) {
     case this.DIR.NORTH:
     other.sprite.north = this;
     break;
     case this.DIR.EAST:
     other.sprite.east = this;
     break;
     case this.DIR.SOUTH:
     other.sprite.south = this;
     break;
     case this.DIR.WEST:
     other.sprite.west = this;
     break;
  }
};

Cube.prototype.relativeSide = function(thisBody, otherBody) {
  var thisPoint = new Phaser.Point(thisBody.x, thisBody.y);
  var otherPoint = new Phaser.Point(otherBody.x, otherBody.y);
  var angleToOther = Phaser.Point.angle(thisPoint, otherPoint);
  if (angleToOther < 0) { // fix dumb part of Phaser.Point.angle()
     angleToOther = 2 * Math.PI + angleToOther;
  }
  angleToOther = (angleToOther + 3/2 * Math.PI) % (2 * Math.PI); // rotate 90 d clockwise
  var diffAngle = angleToOther - thisBody.rotation;
   if (diffAngle < 1 / 4 * Math.PI || diffAngle > 7 / 4 * Math.PI) { // north
     return this.DIR.NORTH;
  } else if (diffAngle >= 1 / 4 * Math.PI && diffAngle < 3 / 4 * Math.PI) { // east
     return this.DIR.EAST;
  } else if (diffAngle >= 3 / 4 * Math.PI && diffAngle < 5 / 4 * Math.PI) { // south
     return this.DIR.SOUTH;
  } else if (diffAngle >= 5 / 4 * Math.PI && diffAngle < 7 / 4 * Math.PI) { // west
     return this.DIR.WEST;
  }
};

Cube.prototype.cubeCollide = function(other) {
   if (other === null || this.prototype !== other.prototype) {
      return;
   }
   // if (this.hasRoot()) {
   if (this.myRoot) {
      if (other.sprite.myRoot && this.myRoot === other.sprite.myRoot) {
         return;
      }
   } else {
      if (this.root) {
         this.myRoot = this.name;
      }
   }
   if (this.hasRoot() && !other.sprite.hasRoot()) {
      this.addConnection(other);
   }
};

Cube.prototype.hasRoot = function() {
  /*
  if (this.root) {
     return true;
  }
  if (this.hasRootR(this.DIR.NORTH, this)) {
      return true;
  } else if (this.hasRootR(this.DIR.EAST, this)) {
     return true;
  } else if (this.hasRootR(this.DIR.SOUTH, this)) {
      return true;
  } else if (this.hasRootR(this.DIR.WEST, this)) {
     return true;
  }
  return false;
  */
  // console.log('root test');
  if (this.root) {
     return true;
  }
  var visited = [];
  visited.push(this);
  if (this.north && this.hasRootR(visited, this.north)) {
    return true;  
  }
  if (this.east && this.hasRootR(visited, this.east)) {
    return true;  
  }
  if (this.south && this.hasRootR(visited, this.south)) {
    return true;  
  }
  if (this.west && this.hasRootR(visited, this.west)) {
    return true;
  }
};

Cube.prototype.hasRootR = function(visited, cur) {
   // console.log(cur);
   if (cur.root) {
      if (!this.myRoot) {
         this.myRoot = cur.name;
      }
      return true;
   }
   visited.push(cur);
   if (cur.north && !this.contains(visited, cur.north) && this.hasRootR(visited, cur.north)) {
    return true;  
  }
  if (cur.east && !this.contains(visited, cur.east) && this.hasRootR(visited, cur.east)) {
    return true;  
  }
  if (cur.south && !this.contains(visited, cur.south) && this.hasRootR(visited, cur.south)) {
    return true;  
  }
  if (cur.west && !this.contains(visited, cur.west) && this.hasRootR(visited, cur.west)) {
    return true;  
  }
};

Cube.prototype.contains = function (array, obj) {
  for (var i = 0; i < array.length; i++) {
      if (array[i] === obj) {
         return true;
      }
  }  
   return false;
};

/*
Cube.prototype.hasRootR = function(dir, obj) {
   if (obj.root) {
      return true;
   }
   switch (dir) {
      case this.DIR.NORTH:
      if (obj.north && this.hasRootR(this.DIR.NORTH, obj.north)) {
         return true;
      }
      if (obj.east && this.hasRootR(this.DIR.EAST, obj.east)) {
         return true;
      }
      if (obj.west && this.hasRootR(this.DIR.WEST, obj.west)) {
         return true;
      }
      return false;
      case this.DIR.EAST:
      if (obj.north && this.hasRootR(this.DIR.NORTH, obj.north)) {
         return true;
      }
      if (obj.east && this.hasRootR(this.DIR.EAST, obj.east)) {
         return true;
      }
      if (obj.south && this.hasRootR(this.DIR.SOUTH, obj.south)) {
         return true;
      }
      return false;
      case this.DIR.SOUTH:
      if (obj.east && this.hasRootR(this.DIR.EAST, obj.east)) {
         return true;
      }
      if (obj.south && this.hasRootR(this.DIR.SOUTH, obj.south)) {
         return true;
      }
      if (obj.west && this.hasRootR(this.DIR.WEST, obj.west)) {
         return true;
      }
      return false;
      case this.DIR.WEST:
      if (obj.north && this.hasRootR(this.DIR.NORTH, obj.north)) {
         return true;
      }
      if (obj.south && this.hasRootR(this.DIR.SOUTH, obj.south)) {
         return true;
      }
      if (obj.west && this.hasRootR(this.DIR.WEST, obj.west)) {
         return true;
      }
      return false;
   }
   return false;
};
*/

Cube.prototype.getSide = function(side) {
   switch (side) {
     case this.DIR.NORTH:
     return this.north;
     case this.DIR.EAST:
     return this.east;
     case this.DIR.SOUTH:
     return this.south;
     case this.DIR.WEST:
     return this.west;
  }
  return undefined;
};

Cube.prototype.toString = function() {
   var string = '';
   string += this.concat('name', this.name);
   string += this.concat('isRoot', this.root);
   string += this.concat('myRoot', this.myRoot);
   string += this.concat('north', this.north != undefined);
   string += this.concat('east', this.east != undefined);
   string += this.concat('south', this.south != undefined);
   string += this.concat('west', this.west != undefined);
   return string;
}

Cube.prototype.concat = function(string, val) {
   return string + ': ' + val + '\n';
}

module.exports = Cube;















},{}],"C:\\Users\\mattd_000\\Documents\\GitHub\\AboveTheIronCurtain\\src\\js\\states\\boot.js":[function(require,module,exports){
var Boot = function () {};

module.exports = Boot;

Boot.prototype = {

  preload: function () {
    this.load.image('preloader', 'assets/preloader.gif');
  },

  create: function () {
    this.game.input.maxPointers = 1;

    if (this.game.device.desktop) {
      this.game.stage.scale.pageAlignHorizontally = true;
    } else {
      this.game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;
      this.game.scale.minWidth =  480;
      this.game.scale.minHeight = 260;
      this.game.scale.maxWidth = 640;
      this.game.scale.maxHeight = 480;
      this.game.scale.forceLandscape = true;
      this.game.scale.pageAlignHorizontally = true;
      this.game.scale.setScreenSize(true);
    }

    this.game.state.start('Preloader');
  }
};

},{}],"C:\\Users\\mattd_000\\Documents\\GitHub\\AboveTheIronCurtain\\src\\js\\states\\game.js":[function(require,module,exports){
/*
Main testing environment.
*/

var Cube = require('../entities/cube');

var Utils = require('../utils');

var mouseBody; // physics body for mouse

var Game = function () {
  this.testentity = null;
};

module.exports = Game;

Game.prototype = {

  create: function () {
    this.game.physics.startSystem(Phaser.Physics.P2JS);
    this.game.physics.p2.setImpactEvents(true);
    mouseBody = new p2.Body(); // jshint ignore:line
    this.game.physics.p2.world.addBody(mouseBody);
    this.placeKey = this.game.input.keyboard.addKey(Phaser.Keyboard.P);
    this.placeKey.onDown.add(this.placeCube, this);
    
    this.mouseX = 0;
    this.mouseY = 0;
    
    this.input.onDown.add(this.click, this);
    this.input.onUp.add(this.release, this);
    this.input.addMoveCallback(this.move, this);
    this.grabbed = undefined;
    this.line = new Phaser.Line(0, 0, 0, 0);
    
    this.rootSpawned = false;
    
    this.debugNum = 0;
    this.myRoot = undefined;
    
     // var thisPoint = new Phaser.Point(10, 10);
     // var otherPoint = new Phaser.Point(10, 11);
     // var angleToOther = Phaser.Point.angle(thisPoint, otherPoint);
     // console.log(angleToOther);
     
     // var polygonTest = this.game.add.sprite(60, 60, 'testsprite');
     // this.game.physics.p2.enableBody(polygonTest, true);
     // polygonTest.body.clearShapes();
     // polygonTest.body.loadPolygon('module_physics', 'test2');
  },

  update: function () {
    if (this.grabbed) {
      var angle = Math.atan2(this.grabbed.sprite.y - this.input.position.y, this.grabbed.sprite.x - this.input.position.x) + Math.PI;
      var dist = Utils.distance(this.grabbed.sprite.x, this.grabbed.sprite.y, this.input.position.x, this.input.position.y);
      var weight = 10;
      this.grabbed.force.x = Math.cos(angle) * dist * weight;
      this.grabbed.force.y = Math.sin(angle) * dist * weight;
      this.line.setTo(this.grabbed.sprite.x, this.grabbed.sprite.y, this.input.position.x, this.input.position.y);
    } else {
       this.line.setTo(0, 0, 0, 0);
    }
  },
  
  render: function () {
    this.game.debug.geom(this.line);
  },

  click: function (pointer) {
    // console.log(this.grabbed);
    var bodies = this.game.physics.p2.hitTest(pointer.position);
    if (bodies.length)
    {
        this.grabbed = bodies[0].parent;
        //console.log(this.grabbed.sprite.name, this.grabbed.sprite.north, this.grabbed.sprite.east, this.grabbed.sprite.south, this.grabbed.sprite.west);
        console.log(this.grabbed.sprite.toString());
    }
  },
  
  release: function () {
     if (this.grabbed) {
        this.grabbed = undefined;
     }
  },
  
  move: function (pointer) {
    // p2 uses different coordinate system, so convert the pointer position to p2's coordinate system
    mouseBody.position[0] = this.game.physics.p2.pxmi(pointer.position.x);
    mouseBody.position[1] = this.game.physics.p2.pxmi(pointer.position.y);
    this.mouseX = pointer.position.x;
    this.mouseY = pointer.position.y;
  },
  
  placeCube: function () {
    var entity = new Cube(this.game, this.mouseX, this.mouseY);
    var scale = 0.5;
    entity.name = this.debugNum++;
    entity.scale.x = scale;
    entity.scale.y = scale;
    entity.anchor.setTo(0.5, 0.5);
    this.game.physics.p2.enable(entity, true);
    entity.body.onBeginContact.add(entity.cubeCollide, entity);
    entity.body.damping = 0.9;
    entity.body.angularDamping = 0.9;
    if (!this.rootSpawned) {
       entity.root = true;
       this.rootSpawned = true;
    }
  }
};




























},{"../entities/cube":"C:\\Users\\mattd_000\\Documents\\GitHub\\AboveTheIronCurtain\\src\\js\\entities\\cube.js","../utils":"C:\\Users\\mattd_000\\Documents\\GitHub\\AboveTheIronCurtain\\src\\js\\utils.js"}],"C:\\Users\\mattd_000\\Documents\\GitHub\\AboveTheIronCurtain\\src\\js\\states\\menu.js":[function(require,module,exports){
var Menu = function () {
  this.text = null;
};

module.exports = Menu;

Menu.prototype = {

  create: function () {
    var x = this.game.width / 2;
    var y = this.game.height / 2;

    var style = { font: '65px Arial', fill: '#ffffff', align: 'center' };

    this.text = this.add.text(x - 300, y - 200, 'Press to Start', style);

    this.input.onDown.add(this.onDown, this);
  },

  update: function () {
  },

  onDown: function () {
    this.game.state.start(playerState.currentLevel); // jshint ignore:line
  }
};

},{}],"C:\\Users\\mattd_000\\Documents\\GitHub\\AboveTheIronCurtain\\src\\js\\states\\preloader.js":[function(require,module,exports){
var Preloader = function (game) {
  game = null;
  this.asset = null;
  this.ready = false;
};

module.exports = Preloader;

Preloader.prototype = {

  preload: function () {
    this.asset = this.add.sprite(320, 240, 'preloader');
    this.asset.anchor.setTo(0.5, 0.5);

    this.load.onLoadComplete.addOnce(this.onLoadComplete, this);
    this.load.setPreloadSprite(this.asset);
    this.load.image('testsprite', 'assets/test2.png');
    this.load.physics('module_physics', 'assets/module_physics.json');
  },

  create: function () {
    this.asset.cropEnabled = false;
  },

  update: function () {
    if (!!this.ready) {
      // this.game.state.start('Menu');
      this.game.state.start(playerState.currentLevel); // jshint ignore:line
    }
  },

  onLoadComplete: function () {
    this.ready = true;
  }
};

},{}],"C:\\Users\\mattd_000\\Documents\\GitHub\\AboveTheIronCurtain\\src\\js\\states\\splash.js":[function(require,module,exports){
var Splash = function () {
};

module.exports = Splash;

Splash.prototype = {
  create: function () {
  }
};
},{}],"C:\\Users\\mattd_000\\Documents\\GitHub\\AboveTheIronCurtain\\src\\js\\utils.js":[function(require,module,exports){
/*
Collection of utility functions.
*/

var Utils = {
    containsObject: function(obj, list) {
        var i;
        for (i = 0; i < list.length; i++) {
            if (list[i] === obj) {
                return true;
            }
        }

        return false;
    },
    distance: function(x1, y1, x2, y2) {
       return Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2));
    }
};

module.exports = Utils;
},{}]},{},["./src/js/main.js"])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlc1xcYnJvd3NlcmlmeVxcbm9kZV9tb2R1bGVzXFxicm93c2VyLXBhY2tcXF9wcmVsdWRlLmpzIiwic3JjL2pzL21haW4uanMiLCJzcmMvanMvZW50aXRpZXMvY3ViZS5qcyIsInNyYy9qcy9zdGF0ZXMvYm9vdC5qcyIsInNyYy9qcy9zdGF0ZXMvZ2FtZS5qcyIsInNyYy9qcy9zdGF0ZXMvbWVudS5qcyIsInNyYy9qcy9zdGF0ZXMvcHJlbG9hZGVyLmpzIiwic3JjL2pzL3N0YXRlcy9zcGxhc2guanMiLCJzcmMvanMvdXRpbHMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDZEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcFJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIndXNlIHN0cmljdCc7XHJcblxyXG52YXIgZ2FtZSA9IG5ldyBQaGFzZXIuR2FtZSg4MDAsIDgwMCwgUGhhc2VyLkFVVE8sICdhdGljLWdhbWUnKTtcclxuXHJcbndpbmRvdy5wbGF5ZXJTdGF0ZSA9IHtcclxuICAgIGN1cnJlbnRMZXZlbDogJ0dhbWUnXHJcbn07XHJcblxyXG5nYW1lLnN0YXRlLmFkZCgnQm9vdCcsIHJlcXVpcmUoJy4vc3RhdGVzL2Jvb3QnKSk7XHJcbmdhbWUuc3RhdGUuYWRkKCdTcGxhc2gnLCByZXF1aXJlKCcuL3N0YXRlcy9zcGxhc2gnKSk7XHJcbmdhbWUuc3RhdGUuYWRkKCdQcmVsb2FkZXInLCByZXF1aXJlKCcuL3N0YXRlcy9wcmVsb2FkZXInKSk7XHJcbmdhbWUuc3RhdGUuYWRkKCdNZW51JywgcmVxdWlyZSgnLi9zdGF0ZXMvbWVudScpKTtcclxuZ2FtZS5zdGF0ZS5hZGQoJ0dhbWUnLCByZXF1aXJlKCcuL3N0YXRlcy9nYW1lJykpO1xyXG5cclxuZ2FtZS5zdGF0ZS5zdGFydCgnQm9vdCcpOyIsIi8qXHJcbkRlZmluZXMgYSBjdWJlIG1vZHVsZSBmb3IgYSBjdWJlc2F0LlxyXG4qL1xyXG5cclxudmFyIEN1YmUgPSBmdW5jdGlvbiAoZ2FtZSwgeCwgeSkge1xyXG4gICAgUGhhc2VyLlNwcml0ZS5jYWxsKHRoaXMsIGdhbWUsIHgsIHksICd0ZXN0c3ByaXRlJyk7XHJcbiAgICBnYW1lLmFkZC5leGlzdGluZyh0aGlzKTtcclxuICAgIHRoaXMubm9ydGggPSB1bmRlZmluZWQ7XHJcbiAgICB0aGlzLmVhc3QgPSB1bmRlZmluZWQ7XHJcbiAgICB0aGlzLnNvdXRoID0gdW5kZWZpbmVkO1xyXG4gICAgdGhpcy53ZXN0ID0gdW5kZWZpbmVkO1xyXG4gICAgdGhpcy5yb290ID0gZmFsc2U7XHJcbiAgICB0aGlzLkRJUiA9IHtOT1JUSDogMCwgRUFTVDogMSwgU09VVEg6IDIsIFdFU1Q6IDN9O1xyXG59O1xyXG5cclxuQ3ViZS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBoYXNlci5TcHJpdGUucHJvdG90eXBlKTtcclxuQ3ViZS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBDdWJlO1xyXG5cclxuLyoqXHJcbiAqIEF1dG9tYXRpY2FsbHkgY2FsbGVkIGJ5IFdvcmxkLnVwZGF0ZVxyXG4gKi9cclxuQ3ViZS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7XHJcbn07XHJcblxyXG5DdWJlLnByb3RvdHlwZS5hZGRDb25uZWN0aW9uID0gZnVuY3Rpb24ob3RoZXIpIHtcclxuICB2YXIgb2Zmc2V0ID0gMjtcclxuICB2YXIgdGhpc1NpZGUgPSB0aGlzLnJlbGF0aXZlU2lkZSh0aGlzLmJvZHksIG90aGVyKTtcclxuICB2YXIgb3RoZXJTaWRlID0gdGhpcy5yZWxhdGl2ZVNpZGUob3RoZXIsIHRoaXMuYm9keSk7XHJcbiAgLy8gY29uc29sZS5sb2codGhpc1NpZGUsIG90aGVyU2lkZSk7XHJcbiAgaWYgKHRoaXMuZ2V0U2lkZSh0aGlzU2lkZSkpIHtcclxuICAgICByZXR1cm47XHJcbiAgfVxyXG4gIGlmIChvdGhlci5zcHJpdGUuZ2V0U2lkZShvdGhlclNpZGUpKSB7XHJcbiAgICAgcmV0dXJuO1xyXG4gIH1cclxuICBzd2l0Y2ggKHRoaXNTaWRlKSB7XHJcbiAgICAgY2FzZSB0aGlzLkRJUi5OT1JUSDpcclxuICAgICB0aGlzLmdhbWUucGh5c2ljcy5wMi5jcmVhdGVMb2NrQ29uc3RyYWludCh0aGlzLmJvZHksIG90aGVyLCBbMCwgdGhpcy53aWR0aCArIG9mZnNldF0pO1xyXG4gICAgIHRoaXMubm9ydGggPSBvdGhlci5zcHJpdGU7XHJcbiAgICAgYnJlYWs7XHJcbiAgICAgY2FzZSB0aGlzLkRJUi5FQVNUOlxyXG4gICAgIHRoaXMuZ2FtZS5waHlzaWNzLnAyLmNyZWF0ZUxvY2tDb25zdHJhaW50KHRoaXMuYm9keSwgb3RoZXIsIFstdGhpcy53aWR0aCAtIG9mZnNldCwgMF0pO1xyXG4gICAgIHRoaXMuZWFzdCA9IG90aGVyLnNwcml0ZTtcclxuICAgICBicmVhaztcclxuICAgICBjYXNlIHRoaXMuRElSLlNPVVRIOlxyXG4gICAgIHRoaXMuZ2FtZS5waHlzaWNzLnAyLmNyZWF0ZUxvY2tDb25zdHJhaW50KHRoaXMuYm9keSwgb3RoZXIsIFswLCAtdGhpcy53aWR0aCAtIG9mZnNldF0pO1xyXG4gICAgIHRoaXMuc291dGggPSBvdGhlci5zcHJpdGU7XHJcbiAgICAgYnJlYWs7XHJcbiAgICAgY2FzZSB0aGlzLkRJUi5XRVNUOlxyXG4gICAgIHRoaXMuZ2FtZS5waHlzaWNzLnAyLmNyZWF0ZUxvY2tDb25zdHJhaW50KHRoaXMuYm9keSwgb3RoZXIsIFt0aGlzLndpZHRoICsgb2Zmc2V0LCAwXSk7XHJcbiAgICAgdGhpcy53ZXN0ID0gb3RoZXIuc3ByaXRlO1xyXG4gICAgIGJyZWFrO1xyXG4gIH1cclxuICBzd2l0Y2ggKG90aGVyU2lkZSkge1xyXG4gICAgIGNhc2UgdGhpcy5ESVIuTk9SVEg6XHJcbiAgICAgb3RoZXIuc3ByaXRlLm5vcnRoID0gdGhpcztcclxuICAgICBicmVhaztcclxuICAgICBjYXNlIHRoaXMuRElSLkVBU1Q6XHJcbiAgICAgb3RoZXIuc3ByaXRlLmVhc3QgPSB0aGlzO1xyXG4gICAgIGJyZWFrO1xyXG4gICAgIGNhc2UgdGhpcy5ESVIuU09VVEg6XHJcbiAgICAgb3RoZXIuc3ByaXRlLnNvdXRoID0gdGhpcztcclxuICAgICBicmVhaztcclxuICAgICBjYXNlIHRoaXMuRElSLldFU1Q6XHJcbiAgICAgb3RoZXIuc3ByaXRlLndlc3QgPSB0aGlzO1xyXG4gICAgIGJyZWFrO1xyXG4gIH1cclxufTtcclxuXHJcbkN1YmUucHJvdG90eXBlLnJlbGF0aXZlU2lkZSA9IGZ1bmN0aW9uKHRoaXNCb2R5LCBvdGhlckJvZHkpIHtcclxuICB2YXIgdGhpc1BvaW50ID0gbmV3IFBoYXNlci5Qb2ludCh0aGlzQm9keS54LCB0aGlzQm9keS55KTtcclxuICB2YXIgb3RoZXJQb2ludCA9IG5ldyBQaGFzZXIuUG9pbnQob3RoZXJCb2R5LngsIG90aGVyQm9keS55KTtcclxuICB2YXIgYW5nbGVUb090aGVyID0gUGhhc2VyLlBvaW50LmFuZ2xlKHRoaXNQb2ludCwgb3RoZXJQb2ludCk7XHJcbiAgaWYgKGFuZ2xlVG9PdGhlciA8IDApIHsgLy8gZml4IGR1bWIgcGFydCBvZiBQaGFzZXIuUG9pbnQuYW5nbGUoKVxyXG4gICAgIGFuZ2xlVG9PdGhlciA9IDIgKiBNYXRoLlBJICsgYW5nbGVUb090aGVyO1xyXG4gIH1cclxuICBhbmdsZVRvT3RoZXIgPSAoYW5nbGVUb090aGVyICsgMy8yICogTWF0aC5QSSkgJSAoMiAqIE1hdGguUEkpOyAvLyByb3RhdGUgOTAgZCBjbG9ja3dpc2VcclxuICB2YXIgZGlmZkFuZ2xlID0gYW5nbGVUb090aGVyIC0gdGhpc0JvZHkucm90YXRpb247XHJcbiAgIGlmIChkaWZmQW5nbGUgPCAxIC8gNCAqIE1hdGguUEkgfHwgZGlmZkFuZ2xlID4gNyAvIDQgKiBNYXRoLlBJKSB7IC8vIG5vcnRoXHJcbiAgICAgcmV0dXJuIHRoaXMuRElSLk5PUlRIO1xyXG4gIH0gZWxzZSBpZiAoZGlmZkFuZ2xlID49IDEgLyA0ICogTWF0aC5QSSAmJiBkaWZmQW5nbGUgPCAzIC8gNCAqIE1hdGguUEkpIHsgLy8gZWFzdFxyXG4gICAgIHJldHVybiB0aGlzLkRJUi5FQVNUO1xyXG4gIH0gZWxzZSBpZiAoZGlmZkFuZ2xlID49IDMgLyA0ICogTWF0aC5QSSAmJiBkaWZmQW5nbGUgPCA1IC8gNCAqIE1hdGguUEkpIHsgLy8gc291dGhcclxuICAgICByZXR1cm4gdGhpcy5ESVIuU09VVEg7XHJcbiAgfSBlbHNlIGlmIChkaWZmQW5nbGUgPj0gNSAvIDQgKiBNYXRoLlBJICYmIGRpZmZBbmdsZSA8IDcgLyA0ICogTWF0aC5QSSkgeyAvLyB3ZXN0XHJcbiAgICAgcmV0dXJuIHRoaXMuRElSLldFU1Q7XHJcbiAgfVxyXG59O1xyXG5cclxuQ3ViZS5wcm90b3R5cGUuY3ViZUNvbGxpZGUgPSBmdW5jdGlvbihvdGhlcikge1xyXG4gICBpZiAob3RoZXIgPT09IG51bGwgfHwgdGhpcy5wcm90b3R5cGUgIT09IG90aGVyLnByb3RvdHlwZSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgIH1cclxuICAgLy8gaWYgKHRoaXMuaGFzUm9vdCgpKSB7XHJcbiAgIGlmICh0aGlzLm15Um9vdCkge1xyXG4gICAgICBpZiAob3RoZXIuc3ByaXRlLm15Um9vdCAmJiB0aGlzLm15Um9vdCA9PT0gb3RoZXIuc3ByaXRlLm15Um9vdCkge1xyXG4gICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgfSBlbHNlIHtcclxuICAgICAgaWYgKHRoaXMucm9vdCkge1xyXG4gICAgICAgICB0aGlzLm15Um9vdCA9IHRoaXMubmFtZTtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIGlmICh0aGlzLmhhc1Jvb3QoKSAmJiAhb3RoZXIuc3ByaXRlLmhhc1Jvb3QoKSkge1xyXG4gICAgICB0aGlzLmFkZENvbm5lY3Rpb24ob3RoZXIpO1xyXG4gICB9XHJcbn07XHJcblxyXG5DdWJlLnByb3RvdHlwZS5oYXNSb290ID0gZnVuY3Rpb24oKSB7XHJcbiAgLypcclxuICBpZiAodGhpcy5yb290KSB7XHJcbiAgICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG4gIGlmICh0aGlzLmhhc1Jvb3RSKHRoaXMuRElSLk5PUlRILCB0aGlzKSkge1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICB9IGVsc2UgaWYgKHRoaXMuaGFzUm9vdFIodGhpcy5ESVIuRUFTVCwgdGhpcykpIHtcclxuICAgICByZXR1cm4gdHJ1ZTtcclxuICB9IGVsc2UgaWYgKHRoaXMuaGFzUm9vdFIodGhpcy5ESVIuU09VVEgsIHRoaXMpKSB7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gIH0gZWxzZSBpZiAodGhpcy5oYXNSb290Uih0aGlzLkRJUi5XRVNULCB0aGlzKSkge1xyXG4gICAgIHJldHVybiB0cnVlO1xyXG4gIH1cclxuICByZXR1cm4gZmFsc2U7XHJcbiAgKi9cclxuICAvLyBjb25zb2xlLmxvZygncm9vdCB0ZXN0Jyk7XHJcbiAgaWYgKHRoaXMucm9vdCkge1xyXG4gICAgIHJldHVybiB0cnVlO1xyXG4gIH1cclxuICB2YXIgdmlzaXRlZCA9IFtdO1xyXG4gIHZpc2l0ZWQucHVzaCh0aGlzKTtcclxuICBpZiAodGhpcy5ub3J0aCAmJiB0aGlzLmhhc1Jvb3RSKHZpc2l0ZWQsIHRoaXMubm9ydGgpKSB7XHJcbiAgICByZXR1cm4gdHJ1ZTsgIFxyXG4gIH1cclxuICBpZiAodGhpcy5lYXN0ICYmIHRoaXMuaGFzUm9vdFIodmlzaXRlZCwgdGhpcy5lYXN0KSkge1xyXG4gICAgcmV0dXJuIHRydWU7ICBcclxuICB9XHJcbiAgaWYgKHRoaXMuc291dGggJiYgdGhpcy5oYXNSb290Uih2aXNpdGVkLCB0aGlzLnNvdXRoKSkge1xyXG4gICAgcmV0dXJuIHRydWU7ICBcclxuICB9XHJcbiAgaWYgKHRoaXMud2VzdCAmJiB0aGlzLmhhc1Jvb3RSKHZpc2l0ZWQsIHRoaXMud2VzdCkpIHtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH1cclxufTtcclxuXHJcbkN1YmUucHJvdG90eXBlLmhhc1Jvb3RSID0gZnVuY3Rpb24odmlzaXRlZCwgY3VyKSB7XHJcbiAgIC8vIGNvbnNvbGUubG9nKGN1cik7XHJcbiAgIGlmIChjdXIucm9vdCkge1xyXG4gICAgICBpZiAoIXRoaXMubXlSb290KSB7XHJcbiAgICAgICAgIHRoaXMubXlSb290ID0gY3VyLm5hbWU7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgIH1cclxuICAgdmlzaXRlZC5wdXNoKGN1cik7XHJcbiAgIGlmIChjdXIubm9ydGggJiYgIXRoaXMuY29udGFpbnModmlzaXRlZCwgY3VyLm5vcnRoKSAmJiB0aGlzLmhhc1Jvb3RSKHZpc2l0ZWQsIGN1ci5ub3J0aCkpIHtcclxuICAgIHJldHVybiB0cnVlOyAgXHJcbiAgfVxyXG4gIGlmIChjdXIuZWFzdCAmJiAhdGhpcy5jb250YWlucyh2aXNpdGVkLCBjdXIuZWFzdCkgJiYgdGhpcy5oYXNSb290Uih2aXNpdGVkLCBjdXIuZWFzdCkpIHtcclxuICAgIHJldHVybiB0cnVlOyAgXHJcbiAgfVxyXG4gIGlmIChjdXIuc291dGggJiYgIXRoaXMuY29udGFpbnModmlzaXRlZCwgY3VyLnNvdXRoKSAmJiB0aGlzLmhhc1Jvb3RSKHZpc2l0ZWQsIGN1ci5zb3V0aCkpIHtcclxuICAgIHJldHVybiB0cnVlOyAgXHJcbiAgfVxyXG4gIGlmIChjdXIud2VzdCAmJiAhdGhpcy5jb250YWlucyh2aXNpdGVkLCBjdXIud2VzdCkgJiYgdGhpcy5oYXNSb290Uih2aXNpdGVkLCBjdXIud2VzdCkpIHtcclxuICAgIHJldHVybiB0cnVlOyAgXHJcbiAgfVxyXG59O1xyXG5cclxuQ3ViZS5wcm90b3R5cGUuY29udGFpbnMgPSBmdW5jdGlvbiAoYXJyYXksIG9iaikge1xyXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHtcclxuICAgICAgaWYgKGFycmF5W2ldID09PSBvYmopIHtcclxuICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuICB9ICBcclxuICAgcmV0dXJuIGZhbHNlO1xyXG59O1xyXG5cclxuLypcclxuQ3ViZS5wcm90b3R5cGUuaGFzUm9vdFIgPSBmdW5jdGlvbihkaXIsIG9iaikge1xyXG4gICBpZiAob2JqLnJvb3QpIHtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgIH1cclxuICAgc3dpdGNoIChkaXIpIHtcclxuICAgICAgY2FzZSB0aGlzLkRJUi5OT1JUSDpcclxuICAgICAgaWYgKG9iai5ub3J0aCAmJiB0aGlzLmhhc1Jvb3RSKHRoaXMuRElSLk5PUlRILCBvYmoubm9ydGgpKSB7XHJcbiAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChvYmouZWFzdCAmJiB0aGlzLmhhc1Jvb3RSKHRoaXMuRElSLkVBU1QsIG9iai5lYXN0KSkge1xyXG4gICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgICBpZiAob2JqLndlc3QgJiYgdGhpcy5oYXNSb290Uih0aGlzLkRJUi5XRVNULCBvYmoud2VzdCkpIHtcclxuICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICBjYXNlIHRoaXMuRElSLkVBU1Q6XHJcbiAgICAgIGlmIChvYmoubm9ydGggJiYgdGhpcy5oYXNSb290Uih0aGlzLkRJUi5OT1JUSCwgb2JqLm5vcnRoKSkge1xyXG4gICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgICBpZiAob2JqLmVhc3QgJiYgdGhpcy5oYXNSb290Uih0aGlzLkRJUi5FQVNULCBvYmouZWFzdCkpIHtcclxuICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKG9iai5zb3V0aCAmJiB0aGlzLmhhc1Jvb3RSKHRoaXMuRElSLlNPVVRILCBvYmouc291dGgpKSB7XHJcbiAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgY2FzZSB0aGlzLkRJUi5TT1VUSDpcclxuICAgICAgaWYgKG9iai5lYXN0ICYmIHRoaXMuaGFzUm9vdFIodGhpcy5ESVIuRUFTVCwgb2JqLmVhc3QpKSB7XHJcbiAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChvYmouc291dGggJiYgdGhpcy5oYXNSb290Uih0aGlzLkRJUi5TT1VUSCwgb2JqLnNvdXRoKSkge1xyXG4gICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgICBpZiAob2JqLndlc3QgJiYgdGhpcy5oYXNSb290Uih0aGlzLkRJUi5XRVNULCBvYmoud2VzdCkpIHtcclxuICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICBjYXNlIHRoaXMuRElSLldFU1Q6XHJcbiAgICAgIGlmIChvYmoubm9ydGggJiYgdGhpcy5oYXNSb290Uih0aGlzLkRJUi5OT1JUSCwgb2JqLm5vcnRoKSkge1xyXG4gICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgICBpZiAob2JqLnNvdXRoICYmIHRoaXMuaGFzUm9vdFIodGhpcy5ESVIuU09VVEgsIG9iai5zb3V0aCkpIHtcclxuICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKG9iai53ZXN0ICYmIHRoaXMuaGFzUm9vdFIodGhpcy5ESVIuV0VTVCwgb2JqLndlc3QpKSB7XHJcbiAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgfVxyXG4gICByZXR1cm4gZmFsc2U7XHJcbn07XHJcbiovXHJcblxyXG5DdWJlLnByb3RvdHlwZS5nZXRTaWRlID0gZnVuY3Rpb24oc2lkZSkge1xyXG4gICBzd2l0Y2ggKHNpZGUpIHtcclxuICAgICBjYXNlIHRoaXMuRElSLk5PUlRIOlxyXG4gICAgIHJldHVybiB0aGlzLm5vcnRoO1xyXG4gICAgIGNhc2UgdGhpcy5ESVIuRUFTVDpcclxuICAgICByZXR1cm4gdGhpcy5lYXN0O1xyXG4gICAgIGNhc2UgdGhpcy5ESVIuU09VVEg6XHJcbiAgICAgcmV0dXJuIHRoaXMuc291dGg7XHJcbiAgICAgY2FzZSB0aGlzLkRJUi5XRVNUOlxyXG4gICAgIHJldHVybiB0aGlzLndlc3Q7XHJcbiAgfVxyXG4gIHJldHVybiB1bmRlZmluZWQ7XHJcbn07XHJcblxyXG5DdWJlLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xyXG4gICB2YXIgc3RyaW5nID0gJyc7XHJcbiAgIHN0cmluZyArPSB0aGlzLmNvbmNhdCgnbmFtZScsIHRoaXMubmFtZSk7XHJcbiAgIHN0cmluZyArPSB0aGlzLmNvbmNhdCgnaXNSb290JywgdGhpcy5yb290KTtcclxuICAgc3RyaW5nICs9IHRoaXMuY29uY2F0KCdteVJvb3QnLCB0aGlzLm15Um9vdCk7XHJcbiAgIHN0cmluZyArPSB0aGlzLmNvbmNhdCgnbm9ydGgnLCB0aGlzLm5vcnRoICE9IHVuZGVmaW5lZCk7XHJcbiAgIHN0cmluZyArPSB0aGlzLmNvbmNhdCgnZWFzdCcsIHRoaXMuZWFzdCAhPSB1bmRlZmluZWQpO1xyXG4gICBzdHJpbmcgKz0gdGhpcy5jb25jYXQoJ3NvdXRoJywgdGhpcy5zb3V0aCAhPSB1bmRlZmluZWQpO1xyXG4gICBzdHJpbmcgKz0gdGhpcy5jb25jYXQoJ3dlc3QnLCB0aGlzLndlc3QgIT0gdW5kZWZpbmVkKTtcclxuICAgcmV0dXJuIHN0cmluZztcclxufVxyXG5cclxuQ3ViZS5wcm90b3R5cGUuY29uY2F0ID0gZnVuY3Rpb24oc3RyaW5nLCB2YWwpIHtcclxuICAgcmV0dXJuIHN0cmluZyArICc6ICcgKyB2YWwgKyAnXFxuJztcclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBDdWJlO1xyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbiIsInZhciBCb290ID0gZnVuY3Rpb24gKCkge307XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEJvb3Q7XHJcblxyXG5Cb290LnByb3RvdHlwZSA9IHtcclxuXHJcbiAgcHJlbG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5sb2FkLmltYWdlKCdwcmVsb2FkZXInLCAnYXNzZXRzL3ByZWxvYWRlci5naWYnKTtcclxuICB9LFxyXG5cclxuICBjcmVhdGU6IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMuZ2FtZS5pbnB1dC5tYXhQb2ludGVycyA9IDE7XHJcblxyXG4gICAgaWYgKHRoaXMuZ2FtZS5kZXZpY2UuZGVza3RvcCkge1xyXG4gICAgICB0aGlzLmdhbWUuc3RhZ2Uuc2NhbGUucGFnZUFsaWduSG9yaXpvbnRhbGx5ID0gdHJ1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuZ2FtZS5zY2FsZS5zY2FsZU1vZGUgPSBQaGFzZXIuU2NhbGVNYW5hZ2VyLlNIT1dfQUxMO1xyXG4gICAgICB0aGlzLmdhbWUuc2NhbGUubWluV2lkdGggPSAgNDgwO1xyXG4gICAgICB0aGlzLmdhbWUuc2NhbGUubWluSGVpZ2h0ID0gMjYwO1xyXG4gICAgICB0aGlzLmdhbWUuc2NhbGUubWF4V2lkdGggPSA2NDA7XHJcbiAgICAgIHRoaXMuZ2FtZS5zY2FsZS5tYXhIZWlnaHQgPSA0ODA7XHJcbiAgICAgIHRoaXMuZ2FtZS5zY2FsZS5mb3JjZUxhbmRzY2FwZSA9IHRydWU7XHJcbiAgICAgIHRoaXMuZ2FtZS5zY2FsZS5wYWdlQWxpZ25Ib3Jpem9udGFsbHkgPSB0cnVlO1xyXG4gICAgICB0aGlzLmdhbWUuc2NhbGUuc2V0U2NyZWVuU2l6ZSh0cnVlKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQoJ1ByZWxvYWRlcicpO1xyXG4gIH1cclxufTtcclxuIiwiLypcclxuTWFpbiB0ZXN0aW5nIGVudmlyb25tZW50LlxyXG4qL1xyXG5cclxudmFyIEN1YmUgPSByZXF1aXJlKCcuLi9lbnRpdGllcy9jdWJlJyk7XHJcblxyXG52YXIgVXRpbHMgPSByZXF1aXJlKCcuLi91dGlscycpO1xyXG5cclxudmFyIG1vdXNlQm9keTsgLy8gcGh5c2ljcyBib2R5IGZvciBtb3VzZVxyXG5cclxudmFyIEdhbWUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgdGhpcy50ZXN0ZW50aXR5ID0gbnVsbDtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gR2FtZTtcclxuXHJcbkdhbWUucHJvdG90eXBlID0ge1xyXG5cclxuICBjcmVhdGU6IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMuZ2FtZS5waHlzaWNzLnN0YXJ0U3lzdGVtKFBoYXNlci5QaHlzaWNzLlAySlMpO1xyXG4gICAgdGhpcy5nYW1lLnBoeXNpY3MucDIuc2V0SW1wYWN0RXZlbnRzKHRydWUpO1xyXG4gICAgbW91c2VCb2R5ID0gbmV3IHAyLkJvZHkoKTsgLy8ganNoaW50IGlnbm9yZTpsaW5lXHJcbiAgICB0aGlzLmdhbWUucGh5c2ljcy5wMi53b3JsZC5hZGRCb2R5KG1vdXNlQm9keSk7XHJcbiAgICB0aGlzLnBsYWNlS2V5ID0gdGhpcy5nYW1lLmlucHV0LmtleWJvYXJkLmFkZEtleShQaGFzZXIuS2V5Ym9hcmQuUCk7XHJcbiAgICB0aGlzLnBsYWNlS2V5Lm9uRG93bi5hZGQodGhpcy5wbGFjZUN1YmUsIHRoaXMpO1xyXG4gICAgXHJcbiAgICB0aGlzLm1vdXNlWCA9IDA7XHJcbiAgICB0aGlzLm1vdXNlWSA9IDA7XHJcbiAgICBcclxuICAgIHRoaXMuaW5wdXQub25Eb3duLmFkZCh0aGlzLmNsaWNrLCB0aGlzKTtcclxuICAgIHRoaXMuaW5wdXQub25VcC5hZGQodGhpcy5yZWxlYXNlLCB0aGlzKTtcclxuICAgIHRoaXMuaW5wdXQuYWRkTW92ZUNhbGxiYWNrKHRoaXMubW92ZSwgdGhpcyk7XHJcbiAgICB0aGlzLmdyYWJiZWQgPSB1bmRlZmluZWQ7XHJcbiAgICB0aGlzLmxpbmUgPSBuZXcgUGhhc2VyLkxpbmUoMCwgMCwgMCwgMCk7XHJcbiAgICBcclxuICAgIHRoaXMucm9vdFNwYXduZWQgPSBmYWxzZTtcclxuICAgIFxyXG4gICAgdGhpcy5kZWJ1Z051bSA9IDA7XHJcbiAgICB0aGlzLm15Um9vdCA9IHVuZGVmaW5lZDtcclxuICAgIFxyXG4gICAgIC8vIHZhciB0aGlzUG9pbnQgPSBuZXcgUGhhc2VyLlBvaW50KDEwLCAxMCk7XHJcbiAgICAgLy8gdmFyIG90aGVyUG9pbnQgPSBuZXcgUGhhc2VyLlBvaW50KDEwLCAxMSk7XHJcbiAgICAgLy8gdmFyIGFuZ2xlVG9PdGhlciA9IFBoYXNlci5Qb2ludC5hbmdsZSh0aGlzUG9pbnQsIG90aGVyUG9pbnQpO1xyXG4gICAgIC8vIGNvbnNvbGUubG9nKGFuZ2xlVG9PdGhlcik7XHJcbiAgICAgXHJcbiAgICAgLy8gdmFyIHBvbHlnb25UZXN0ID0gdGhpcy5nYW1lLmFkZC5zcHJpdGUoNjAsIDYwLCAndGVzdHNwcml0ZScpO1xyXG4gICAgIC8vIHRoaXMuZ2FtZS5waHlzaWNzLnAyLmVuYWJsZUJvZHkocG9seWdvblRlc3QsIHRydWUpO1xyXG4gICAgIC8vIHBvbHlnb25UZXN0LmJvZHkuY2xlYXJTaGFwZXMoKTtcclxuICAgICAvLyBwb2x5Z29uVGVzdC5ib2R5LmxvYWRQb2x5Z29uKCdtb2R1bGVfcGh5c2ljcycsICd0ZXN0MicpO1xyXG4gIH0sXHJcblxyXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgaWYgKHRoaXMuZ3JhYmJlZCkge1xyXG4gICAgICB2YXIgYW5nbGUgPSBNYXRoLmF0YW4yKHRoaXMuZ3JhYmJlZC5zcHJpdGUueSAtIHRoaXMuaW5wdXQucG9zaXRpb24ueSwgdGhpcy5ncmFiYmVkLnNwcml0ZS54IC0gdGhpcy5pbnB1dC5wb3NpdGlvbi54KSArIE1hdGguUEk7XHJcbiAgICAgIHZhciBkaXN0ID0gVXRpbHMuZGlzdGFuY2UodGhpcy5ncmFiYmVkLnNwcml0ZS54LCB0aGlzLmdyYWJiZWQuc3ByaXRlLnksIHRoaXMuaW5wdXQucG9zaXRpb24ueCwgdGhpcy5pbnB1dC5wb3NpdGlvbi55KTtcclxuICAgICAgdmFyIHdlaWdodCA9IDEwO1xyXG4gICAgICB0aGlzLmdyYWJiZWQuZm9yY2UueCA9IE1hdGguY29zKGFuZ2xlKSAqIGRpc3QgKiB3ZWlnaHQ7XHJcbiAgICAgIHRoaXMuZ3JhYmJlZC5mb3JjZS55ID0gTWF0aC5zaW4oYW5nbGUpICogZGlzdCAqIHdlaWdodDtcclxuICAgICAgdGhpcy5saW5lLnNldFRvKHRoaXMuZ3JhYmJlZC5zcHJpdGUueCwgdGhpcy5ncmFiYmVkLnNwcml0ZS55LCB0aGlzLmlucHV0LnBvc2l0aW9uLngsIHRoaXMuaW5wdXQucG9zaXRpb24ueSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgdGhpcy5saW5lLnNldFRvKDAsIDAsIDAsIDApO1xyXG4gICAgfVxyXG4gIH0sXHJcbiAgXHJcbiAgcmVuZGVyOiBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLmdhbWUuZGVidWcuZ2VvbSh0aGlzLmxpbmUpO1xyXG4gIH0sXHJcblxyXG4gIGNsaWNrOiBmdW5jdGlvbiAocG9pbnRlcikge1xyXG4gICAgLy8gY29uc29sZS5sb2codGhpcy5ncmFiYmVkKTtcclxuICAgIHZhciBib2RpZXMgPSB0aGlzLmdhbWUucGh5c2ljcy5wMi5oaXRUZXN0KHBvaW50ZXIucG9zaXRpb24pO1xyXG4gICAgaWYgKGJvZGllcy5sZW5ndGgpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5ncmFiYmVkID0gYm9kaWVzWzBdLnBhcmVudDtcclxuICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMuZ3JhYmJlZC5zcHJpdGUubmFtZSwgdGhpcy5ncmFiYmVkLnNwcml0ZS5ub3J0aCwgdGhpcy5ncmFiYmVkLnNwcml0ZS5lYXN0LCB0aGlzLmdyYWJiZWQuc3ByaXRlLnNvdXRoLCB0aGlzLmdyYWJiZWQuc3ByaXRlLndlc3QpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMuZ3JhYmJlZC5zcHJpdGUudG9TdHJpbmcoKSk7XHJcbiAgICB9XHJcbiAgfSxcclxuICBcclxuICByZWxlYXNlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgaWYgKHRoaXMuZ3JhYmJlZCkge1xyXG4gICAgICAgIHRoaXMuZ3JhYmJlZCA9IHVuZGVmaW5lZDtcclxuICAgICB9XHJcbiAgfSxcclxuICBcclxuICBtb3ZlOiBmdW5jdGlvbiAocG9pbnRlcikge1xyXG4gICAgLy8gcDIgdXNlcyBkaWZmZXJlbnQgY29vcmRpbmF0ZSBzeXN0ZW0sIHNvIGNvbnZlcnQgdGhlIHBvaW50ZXIgcG9zaXRpb24gdG8gcDIncyBjb29yZGluYXRlIHN5c3RlbVxyXG4gICAgbW91c2VCb2R5LnBvc2l0aW9uWzBdID0gdGhpcy5nYW1lLnBoeXNpY3MucDIucHhtaShwb2ludGVyLnBvc2l0aW9uLngpO1xyXG4gICAgbW91c2VCb2R5LnBvc2l0aW9uWzFdID0gdGhpcy5nYW1lLnBoeXNpY3MucDIucHhtaShwb2ludGVyLnBvc2l0aW9uLnkpO1xyXG4gICAgdGhpcy5tb3VzZVggPSBwb2ludGVyLnBvc2l0aW9uLng7XHJcbiAgICB0aGlzLm1vdXNlWSA9IHBvaW50ZXIucG9zaXRpb24ueTtcclxuICB9LFxyXG4gIFxyXG4gIHBsYWNlQ3ViZTogZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGVudGl0eSA9IG5ldyBDdWJlKHRoaXMuZ2FtZSwgdGhpcy5tb3VzZVgsIHRoaXMubW91c2VZKTtcclxuICAgIHZhciBzY2FsZSA9IDAuNTtcclxuICAgIGVudGl0eS5uYW1lID0gdGhpcy5kZWJ1Z051bSsrO1xyXG4gICAgZW50aXR5LnNjYWxlLnggPSBzY2FsZTtcclxuICAgIGVudGl0eS5zY2FsZS55ID0gc2NhbGU7XHJcbiAgICBlbnRpdHkuYW5jaG9yLnNldFRvKDAuNSwgMC41KTtcclxuICAgIHRoaXMuZ2FtZS5waHlzaWNzLnAyLmVuYWJsZShlbnRpdHksIHRydWUpO1xyXG4gICAgZW50aXR5LmJvZHkub25CZWdpbkNvbnRhY3QuYWRkKGVudGl0eS5jdWJlQ29sbGlkZSwgZW50aXR5KTtcclxuICAgIGVudGl0eS5ib2R5LmRhbXBpbmcgPSAwLjk7XHJcbiAgICBlbnRpdHkuYm9keS5hbmd1bGFyRGFtcGluZyA9IDAuOTtcclxuICAgIGlmICghdGhpcy5yb290U3Bhd25lZCkge1xyXG4gICAgICAgZW50aXR5LnJvb3QgPSB0cnVlO1xyXG4gICAgICAgdGhpcy5yb290U3Bhd25lZCA9IHRydWU7XHJcbiAgICB9XHJcbiAgfVxyXG59O1xyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4iLCJ2YXIgTWVudSA9IGZ1bmN0aW9uICgpIHtcclxuICB0aGlzLnRleHQgPSBudWxsO1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBNZW51O1xyXG5cclxuTWVudS5wcm90b3R5cGUgPSB7XHJcblxyXG4gIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHggPSB0aGlzLmdhbWUud2lkdGggLyAyO1xyXG4gICAgdmFyIHkgPSB0aGlzLmdhbWUuaGVpZ2h0IC8gMjtcclxuXHJcbiAgICB2YXIgc3R5bGUgPSB7IGZvbnQ6ICc2NXB4IEFyaWFsJywgZmlsbDogJyNmZmZmZmYnLCBhbGlnbjogJ2NlbnRlcicgfTtcclxuXHJcbiAgICB0aGlzLnRleHQgPSB0aGlzLmFkZC50ZXh0KHggLSAzMDAsIHkgLSAyMDAsICdQcmVzcyB0byBTdGFydCcsIHN0eWxlKTtcclxuXHJcbiAgICB0aGlzLmlucHV0Lm9uRG93bi5hZGQodGhpcy5vbkRvd24sIHRoaXMpO1xyXG4gIH0sXHJcblxyXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xyXG4gIH0sXHJcblxyXG4gIG9uRG93bjogZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KHBsYXllclN0YXRlLmN1cnJlbnRMZXZlbCk7IC8vIGpzaGludCBpZ25vcmU6bGluZVxyXG4gIH1cclxufTtcclxuIiwidmFyIFByZWxvYWRlciA9IGZ1bmN0aW9uIChnYW1lKSB7XHJcbiAgZ2FtZSA9IG51bGw7XHJcbiAgdGhpcy5hc3NldCA9IG51bGw7XHJcbiAgdGhpcy5yZWFkeSA9IGZhbHNlO1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBQcmVsb2FkZXI7XHJcblxyXG5QcmVsb2FkZXIucHJvdG90eXBlID0ge1xyXG5cclxuICBwcmVsb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLmFzc2V0ID0gdGhpcy5hZGQuc3ByaXRlKDMyMCwgMjQwLCAncHJlbG9hZGVyJyk7XHJcbiAgICB0aGlzLmFzc2V0LmFuY2hvci5zZXRUbygwLjUsIDAuNSk7XHJcblxyXG4gICAgdGhpcy5sb2FkLm9uTG9hZENvbXBsZXRlLmFkZE9uY2UodGhpcy5vbkxvYWRDb21wbGV0ZSwgdGhpcyk7XHJcbiAgICB0aGlzLmxvYWQuc2V0UHJlbG9hZFNwcml0ZSh0aGlzLmFzc2V0KTtcclxuICAgIHRoaXMubG9hZC5pbWFnZSgndGVzdHNwcml0ZScsICdhc3NldHMvdGVzdDIucG5nJyk7XHJcbiAgICB0aGlzLmxvYWQucGh5c2ljcygnbW9kdWxlX3BoeXNpY3MnLCAnYXNzZXRzL21vZHVsZV9waHlzaWNzLmpzb24nKTtcclxuICB9LFxyXG5cclxuICBjcmVhdGU6IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMuYXNzZXQuY3JvcEVuYWJsZWQgPSBmYWxzZTtcclxuICB9LFxyXG5cclxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcclxuICAgIGlmICghIXRoaXMucmVhZHkpIHtcclxuICAgICAgLy8gdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdNZW51Jyk7XHJcbiAgICAgIHRoaXMuZ2FtZS5zdGF0ZS5zdGFydChwbGF5ZXJTdGF0ZS5jdXJyZW50TGV2ZWwpOyAvLyBqc2hpbnQgaWdub3JlOmxpbmVcclxuICAgIH1cclxuICB9LFxyXG5cclxuICBvbkxvYWRDb21wbGV0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5yZWFkeSA9IHRydWU7XHJcbiAgfVxyXG59O1xyXG4iLCJ2YXIgU3BsYXNoID0gZnVuY3Rpb24gKCkge1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBTcGxhc2g7XHJcblxyXG5TcGxhc2gucHJvdG90eXBlID0ge1xyXG4gIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xyXG4gIH1cclxufTsiLCIvKlxyXG5Db2xsZWN0aW9uIG9mIHV0aWxpdHkgZnVuY3Rpb25zLlxyXG4qL1xyXG5cclxudmFyIFV0aWxzID0ge1xyXG4gICAgY29udGFpbnNPYmplY3Q6IGZ1bmN0aW9uKG9iaiwgbGlzdCkge1xyXG4gICAgICAgIHZhciBpO1xyXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChsaXN0W2ldID09PSBvYmopIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9LFxyXG4gICAgZGlzdGFuY2U6IGZ1bmN0aW9uKHgxLCB5MSwgeDIsIHkyKSB7XHJcbiAgICAgICByZXR1cm4gTWF0aC5zcXJ0KE1hdGgucG93KHgxIC0geDIsIDIpICsgTWF0aC5wb3coeTEgLSB5MiwgMikpO1xyXG4gICAgfVxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBVdGlsczsiXX0=
