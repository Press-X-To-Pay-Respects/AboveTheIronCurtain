(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"./src/js/main.js":[function(require,module,exports){
var game = new Phaser.Game(window.innerWidth, window.innerHeigh, Phaser.AUTO, 'atic-game');

window.playerState = {
    currentLevel: 'Game'
};

//  The Google WebFont Loader will look for this object, so create it before loading the script.
WebFontConfig = { // jshint ignore:line
    //  The Google Fonts we want to load (specify as many as you like in the array)
    google: {
      families: ['Roboto::latin', 'VT323::latin']
    }
};

game.state.add('Boot', require('./states/boot'));
game.state.add('Splash', require('./states/splash'));
game.state.add('Preloader', require('./states/preloader'));
game.state.add('Menu', require('./states/menu'));
game.state.add('Game', require('./states/game'));

game.state.start('Boot');
},{"./states/boot":"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\states\\boot.js","./states/game":"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\states\\game.js","./states/menu":"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\states\\menu.js","./states/preloader":"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\states\\preloader.js","./states/splash":"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\states\\splash.js"}],"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\effects\\BinaryParticle.js":[function(require,module,exports){
var BinaryParticle = function(game, targetObj, x, y, tarOffsetX, tarOffsetY) {
	var style = {font: '20px Avant Garde', fill: '#EEEE33', align: 'center'};
	var byteSymbol = Math.random() >= 0.5 ? '1' : '0';
	Phaser.Text.call(this, game, x, y, byteSymbol, style);
	game.add.existing(this);
	this.targetObj = targetObj;
	this.speed = 3.6;
	this.tarOffsetX = tarOffsetX;
	this.tarOffsetY = tarOffsetY;
};

BinaryParticle.prototype = Object.create(Phaser.Text.prototype);
BinaryParticle.prototype.constructor = BinaryParticle;

BinaryParticle.prototype.update = function() {
	//Get delta vector to target object
	var delta = [this.targetObj.x + this.tarOffsetX - this.x, this.targetObj.y + this.tarOffsetY - this.y];
	//Get distance and check if we've reached target distance
	var dist = Math.sqrt(Math.pow(delta[0], 2) + Math.pow(delta[1], 2));
	if(dist <= this.speed) {
		this.destroy();
		return;
	}
	//Normalize delta vector
	delta = [delta[0]/dist, delta[1]/dist];
	//Update position
	this.x = this.x + this.speed*delta[0];
	this.y = this.y + this.speed*delta[1];
};

module.exports = BinaryParticle;
},{}],"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\effects\\Emitter.js":[function(require,module,exports){
var BinaryParticle = require('./BinaryParticle');

var Emitter = function(gameState) {
	this.gameState = gameState;
};

Emitter.prototype.constructor = Emitter;

Emitter.prototype.emitBinary = function (targetObj, x, y, spacing) {
	var offsetX = (Math.random()-0.5)*spacing;
	var offsetY = (Math.random()-0.5)*spacing;
	var newParticle = new BinaryParticle(this.gameState.game, targetObj, x, y, offsetX, offsetY);
};

module.exports = Emitter;
},{"./BinaryParticle":"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\effects\\BinaryParticle.js"}],"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\entities\\Bullet.js":[function(require,module,exports){
//Bullets are tagged as 'playerBullet' or 'enemyBullet'
var Bullet = function(gameState, x, y, direction, inhertitSpeed, tag) {
    Phaser.Sprite.call(this, gameState.game, x, y, 'bullet');
	this.direction = direction; //Unit vector representing direction bullet is travelling;
	this.speed = 300 + inhertitSpeed;				//Speed bullet is travelling;
	this.tag = tag;
	this.game = gameState.game;
	this.game.add.existing(this);
	this.lifeTime = 300;
	var scale = 0.5;
	this.scale.x = scale;
	this.scale.y = scale;
	this.anchor.setTo(0.5, 0.5);
	
	//set physics
	gameState.game.physics.p2.enable(this);
	this.body.setCollisionGroup(gameState.collisionGroup);
	this.body.collides(gameState.collisionGroup);
	//Set proper collision function by determining type from 'tag'
	if(this.tag === 'enemyBullet') {
		this.collision = function(other) {
			if(other.sprite.tag === 'module') {
				other.sprite.takeDamage(0.5);
			}
			this.destroy();
		};
	}
	else if(this.tag === 'playerBullet') {
		this.collision = function(other) {
			if(other) {
				if(other.sprite){
					if(other.sprite.tag) {
						if(other.sprite.tag === 'enemy_module') {
							other.sprite.takeDamage(0.5);
						}
					}
				}
			}
			this.destroy();
		};
	}
	this.body.onBeginContact.add(this.collision, this);
	this.body.setZeroDamping();
	this.body.mass = 0.1;
	this.body.velocity.x = direction[0]*this.speed;
	this.body.velocity.y = direction[1]*this.speed;
};

Bullet.prototype = Object.create(Phaser.Sprite.prototype);
Bullet.prototype.constructor = Bullet;

Bullet.prototype.update = function() {/*
	this.x += this.direction[0] * this.speed;
	this.y += this.direction[1] * this.speed;
	//this.lifeTime--;
	if(this.lifeTime <= 0) {
		//TODO destroy bullet
	}*/
};

module.exports = Bullet;
},{}],"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\entities\\Hackable.js":[function(require,module,exports){
/*
Defines a hackable object.
*/

var Hackable = function (gameState, x, y, sprite, hackDistance) {
   Phaser.Sprite.call(this, gameState.game, x, y, sprite);
   gameState.game.add.existing(this);
	//store gameState
	this.gameState = gameState;
	//set isHacked to false
	this.isHacked = false;
	//add hackBar
	this.hackBar = gameState.uiBuilder.buildProgressBar('growing', 1500, 1200, 100, 10,  200);
	this.hackBar.setStyle(0, 0xFFFFFF, 0x363636, 0, 0, 0, 0xFFFFFF, 0x2020CC);
	this.hackBar.hackable = this;
	this.hackBar.onEvent = function() {
		this.hackable.frame = 1;
		this.hackable.isHacked = true;
		this.destroy();
	};
	this.tag = 'neutralObj';	//Tag is used to identify object type during collision checking
	this.hackDistance = hackDistance;
	var scale = 0.5;
   this.scale.x = scale;
   this.scale.y = scale;
   this.anchor.setTo(0.5, 0.5);
   
   //Set up physics body for 'hackable' sprite
   gameState.game.physics.p2.enable(this);
   this.body.setCollisionGroup(gameState.collisionGroup);
	this.body.collides(gameState.collisionGroup);
   this.body.onBeginContact.add(this.cubeCollide, this);
   this.body.damping = 0.9;
   this.body.angularDamping = 0.9;
};

Hackable.prototype = Object.create(Phaser.Sprite.prototype);
Hackable.prototype.constructor = Hackable;

/**
 * Automatically called by World.update
 */
Hackable.prototype.update = function() {
	this.hackBar.setLocation(this.x, this.y - 70);
	//check if getting hacked
	if(!this.isHacked) {
		if(this.gameState.player.activeHackerModules.length > 0) {
			var dist;
			var hacker;
			//Loop through all hacker modules on the player's cubsat
			for(var i = 0; i < this.gameState.player.activeHackerModules.length; i++) {
				hacker = this.gameState.player.activeHackerModules[i];
				dist = Math.sqrt( Math.pow(this.x - hacker.cube.x, 2) + Math.pow(this.y - hacker.cube.y, 2) );
				if(dist < this.hackDistance) {
					//If hacker is in range, increase hack value and try to emit binary particle
					this.hackBar.addValue(0.05);
					hacker.count++;
					hacker.cube.animations.play('hacker');
					if(hacker.count >= hacker.cycle) {
						hacker.count = 0;
						this.gameState.BinaryEmitter.emitBinary(this, hacker.cube.x, hacker.cube.y, 60);
					}
				}
				else {
					hacker.cube.animations.stop();
				}
			}
		}
	}
};


Hackable.prototype.cubeCollide = function(other) {
/*   if (this.group === undefined) {
      return;
   }
   this.group.handleCollision(this, other.sprite);*/
};

module.exports = Hackable;
},{}],"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\entities\\Module.js":[function(require,module,exports){
//Don't use this function to create modules, instead use moduleBuilder()
var Module = function(setType, setCube, setGameState) {
	this.isActive = false;
	this.type = setType;
	this.cube = setCube;
	setCube.module = this;
	this.gameState = setGameState;
};

Module.prototype.constructor = Module;

module.exports = Module;
},{}],"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\entities\\ModuleBuilder.js":[function(require,module,exports){
var Cube = require('./cube');
var Module = require('./Module');
var Bullet = require('./Bullet');

var thrustAmt = 5000;

//Use this to create a moduleBuilder- only need to create one instance of it
var ModuleBuilder = function(setGameState, setColGroup) {
	//Ensure that cannot create multiple instances of this class
	if(ModuleBuilder.prototype.exists) {
		return ModuleBuilder.prototype.existingReference;
	}
		
	this.gameState = setGameState;
   this.colGroup = setColGroup;
	// this.coreExists = false;	//records if core has been created
	this.core = null;			//stores core when it is created
	//var space = this.gameState.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR);
	ModuleBuilder.prototype.exists = true;
	ModuleBuilder.prototype.existingReference = this;
};

ModuleBuilder.prototype.constructor = ModuleBuilder;

//These var's help create the singleton functionality
ModuleBuilder.prototype.exists = false;
ModuleBuilder.prototype.existingReference = null;

/** Module functions **/
function solarPanelGiveTarget(target) {
if (this === target || !this.cube.group || !target.cube.group || this.cube.group !== target.cube.group) {
      return;
   }
   var ourGroup = this.cube.group;
   var newConnection = {start: this.cube, end: target.cube};
   this.cube.myConnection = newConnection;
   target.cube.myConnection = newConnection;
   ourGroup.displayConnection(this.cube.myConnection);
   
	if(!target.isActive) {
		//Activate the module
		target.isActive = true;
		if(target.type === 'gun') {
			ourGroup.activeGuns.push(target);
		}
		else if(target.type === 'hacker') {
			ourGroup.activeHackerModules.push(target);
		}
	}
}

function solarPanelMouseOver() {
   if (!this.cube.myConnection || !this.cube.group) {
      return;
   }
   this.cube.group.displayConnection(this.cube.myConnection);
}

function solarPanelOnRemove() {
   if (!this.cube.myConnection || !this.cube.myConnection.end) {
      console.log('solarPanelOnRemove() had an error');
      return;
   }
   this.cube.myConnection.end.myConnection = undefined;
   this.cube.myConnection = undefined;
}


function beginAct() {
   this.timer = 0;
   this.act = true;
}

function endAct() {
   this.act = false;
   this.cube.frame = 0;
}

function thrusterUpdate() {
   if (this.haltTime && this.haltTime > 0) {
      this.haltTime -= this.cube.game.time.elapsed;
      this.cube.frame = 0;
   } else if (this.act && this.cube.myConnection) {
      this.cube.body.force.x = thrustAmt * Math.cos(this.cube.rotation - Math.PI / 2);
      this.cube.body.force.y = thrustAmt * Math.sin(this.cube.rotation - Math.PI / 2);
	  if(this.cube.frame === 1) {
		this.cube.frame = 2;
	  }
	  else {
		this.cube.frame = 1;
	  }
   }
}

function thrusterHalt() {
   this.haltTime = 1500;
}

/*
function gunFire(){
	var angle = this.cube.body.rotation % (2*Math.PI);
	var direction = [Math.sin(angle), -Math.cos(angle)];
	//var delta = [this.cube.x-this.cube.body.prev.x, this.cube.y - this.cube.body.prev.y];
	var deltaDist = Math.sqrt(Math.pow(this.cube.deltaX, 2) + Math.pow(this.cube.deltaY, 2));
	var speed = deltaDist * 50;
	new Bullet(this.gameState, this.cube.x + 30*direction[0], this.cube.y + 30*direction[1], 
			   direction, speed, 'playerBullet');
}
*/

function gunUpdate() {
   if (!this.cube.myConnection || !this.act) {
      return;
   }
   if (this.timer <= 0) {
      var angle = this.cube.body.rotation % (2*Math.PI);
      var direction = [Math.sin(angle), -Math.cos(angle)];
      //var delta = [this.cube.x-this.cube.body.prev.x, this.cube.y - this.cube.body.prev.y];
      var deltaDist = Math.sqrt(Math.pow(this.cube.deltaX, 2) + Math.pow(this.cube.deltaY, 2));
      var speed = deltaDist * 50;
      new Bullet(this.gameState, this.cube.x + 30*direction[0], this.cube.y + 30*direction[1], 
               direction, speed, 'playerBullet');
      this.timer = 600;
   } else {
      this.timer -= this.gameState.game.time.elapsed;
   }
}
/** End module functions **/

//call this function from ModuleBuilder to construct modules
//TYPES: 'core' 'shield' 'thruster' 'solarPannel' 'hacker'
ModuleBuilder.prototype.build = function(type, x, y, forPlayer) {	
	//Create cube object to be stored within module
	//Sprite names for modules are directly mapped to module names, so just pass 'type' as sprite name
	var newCube = new Cube(this.gameState, x, y, type);
    var scale = 0.5;
    newCube.name = this.gameState.debugNum++;
    newCube.scale.setTo(scale, scale);
    newCube.anchor.setTo(0.5, 0.5);
	
	//Create physics for new cube
    this.gameState.game.physics.p2.enable(newCube);
	newCube.body.setCollisionGroup(this.gameState.collisionGroup);
	newCube.body.collides(this.gameState.collisionGroup);
	newCube.body.onBeginContact.add(newCube.cubeCollide, newCube);
    newCube.body.damping = 0.9;
    newCube.body.angularDamping = 0.9;
 
   var cIndicator = this.gameState.add.sprite(0, 0, 'connections', 'connection_line.png');
   cIndicator.anchor.setTo(0.5, 0.5);
   cIndicator.animations.add('end', ['connection_end.png'], 60, true);
   cIndicator.animations.add('line', ['connection_line.png'], 60, true);
   cIndicator.animations.add('right', ['connection_right.png'], 60, true);
   newCube.addChild(cIndicator);
   newCube.cIndicator = cIndicator;
   cIndicator.alpha = 0;
	
	//Create module to wrap around cube class
	var newModule = new Module(type, newCube, this.gameState);
		
	//TODO: edit special module atributes based on 'type'
	if(type === 'hacker') {
		newModule.cycle = 6;
		newModule.count = 0;
		newModule.cube.animations.add('hacker', [0,1,2,3,4], 10, true);
	}
	
	//Store module if it is core
	if(type === 'core')
	{
		newModule.cube.animations.add('core', [0,1,2], 20, true);
		newModule.cube.animations.play('core');
		this.core = newModule;
		this.coreExists = true;
	}
   // solar panel testing
   if (type === 'solarPanel') {
      newModule.giveTarget = solarPanelGiveTarget;
      newModule.mouseOver = solarPanelMouseOver;
      newModule.onRemove = solarPanelOnRemove;
   }
   
   //Thruster module events
	if(type === 'thruster') {
      if (forPlayer) {
         var thrusterKey = this.gameState.input.keyboard.addKey(Phaser.Keyboard.W); 
         this.gameState.input.keyboard.addKeyCapture([thrusterKey]);
         thrusterKey.onDown.add(beginAct, newModule);
         thrusterKey.onUp.add(endAct, newModule);
      } else {
         // newModule.thrust = false;
         newModule.beginAct = beginAct;
         newModule.endAct = endAct;
      }
      newModule.update = thrusterUpdate;
      newModule.thrusterHalt = thrusterHalt;
	}

	//Gun module events
	if(type === 'gun') {
		// newModule.fire = gunFire;
      newModule.update = gunUpdate;
      if (forPlayer) {
         var actKey = this.gameState.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR);
         this.gameState.input.keyboard.addKeyCapture([actKey]);
         actKey.onDown.add(beginAct, newModule);
         actKey.onUp.add(endAct, newModule);
      } else {
         newModule.beginAct = beginAct;
         newModule.endAct = endAct;
      }
	}
	
	//Return the module object
	return newModule;
};

module.exports = ModuleBuilder;
















},{"./Bullet":"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\entities\\Bullet.js","./Module":"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\entities\\Module.js","./cube":"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\entities\\cube.js"}],"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\entities\\cube.js":[function(require,module,exports){
/*
Defines a cube.
*/

var Cube = function (gameState, x, y, sprite) {
    Phaser.Sprite.call(this, gameState.game, x, y, sprite);
	 this.tag = 'module';	//tag is used to detect object type during collision checking
    this.game = gameState.game;
	this.gameState = gameState;
    this.game.add.existing(this);
    this.group = undefined;
    this.module = undefined;
    this.indicatorFade = 0.02;
    this.healthBar = gameState.uiBuilder.buildProgressBar('shrinking', 0, 0, 20, 4, 3);
	this.healthBar.setStyle(0, 0xFFFFFF, 0x363636, 0, 0, 0, 0xFFFFFF, 0x20CC20);
	this.healthBar.cube = this;
   this.healthBarFade = 0.02;
	//set update function of health bar
	this.healthBar.update = function() {
		this.setLocation(this.cube.x, this.cube.y+10);
	};
	//onEvent called when cube runs out of health
	this.healthBar.onEvent = function() {
		this.cube.dying = true;
		this.cube.life = 50;
		// this.group.countCubes();
		// this.destroy();
	};
	this.constraints = [];
};

Cube.prototype = Object.create(Phaser.Sprite.prototype);
Cube.prototype.constructor = Cube;

/**
 * Automatically called by World.update
 */
Cube.prototype.update = function() {
   if (this.cIndicator && this.cIndicator.alpha > 0) {
      this.cIndicator.alpha -= this.indicatorFade;
   }
   if (this.module.update) {
      this.module.update();
   }
   if (this.healthBar.graphics.alpha > 0) {
      this.healthBar.graphics.alpha -= this.healthBarFade * this.game.time.elapsed;
   }
   if (this.dying) {
      this.life -= this.game.time.elapsed;
      if (this.life < 0) {
         this.dying = false;
         this.healthBar.destroy();
         if (this.group) {
			if(this.tag === 'enemy_module') {
				if(this.key === 'thruster') {
					this.gameState.money += 35;
				}
				else if(this.key === 'shield') {
					this.gameState.money += 10;
				}
				else if(this.key === 'gun') {
					this.gameState.money += 50;
				}
				else if(this.key === 'solarPanel') {
					this.gameState.money += 25;
				}
				this.gameState.moneyText.text = this.gameState.money;
			}
            this.group.destroyCube(this);
         } else {
            this.destroy();
         }
      }
   }
};

Cube.prototype.cubeCollide = function(other) {
<<<<<<< HEAD
   if (!this.group || !this.group.isPlayer || !other || !other.sprite || other.sprite.tag !== 'module' ||
       (other.group && other.group === this.group) || (other.group && other.group.isPlayer) ||
         other.prototype !== this.prototype) {
=======
   /*if (this.group && this.group.isPlayer) {
      console.log('PLAYER');
   } else {
      console.log('OTHER');
   }*/
   if (!this.group || !other || !other.sprite || other.sprite.tag !== 'module') {
      // console.log('bad collision cube: ', this.group, other, other.sprite, other.sprite.tag);
>>>>>>> origin/gh-pages
      return;
   }
	this.group.handleCollision(this, other.sprite);
	this.group.countCubes();
};

Cube.prototype.toString = function() {
   var string = '';
   string += this.concat('name', this.name);
   return string;
};

Cube.prototype.concat = function(string, val) {
   return string + ': ' + val + '\n';
};
Cube.prototype.displayIndicator = function() {
  this.cIndicator.alpha = 1; 
};

Cube.prototype.takeDamage = function(amt) {
   this.healthBar.addValue(-amt);
};

Cube.prototype.remove = function() {
   if (!this.group) {
      return;
   }
   this.group.remove(this);
};

module.exports = Cube;















},{}],"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\entities\\cube_group.js":[function(require,module,exports){
var Astar = require('../libs/javascript-astar/astar');
var EnemyAI = require('./enemy_ai');

/*
Defines a cube group.
*/

var CubeGroup = function (game, root) {
   this.game = game;
   this.root = root;
   this.cubes = [];
   var col = [];
   col.push(this.root);
   this.cubes.push(col);
   if (this.root) {
      this.root.group = this;
   }
   this.DIR = {NORTH: 0, EAST: 1, SOUTH: 2, WEST: 3};
   this.offset = 2;
	this.activeHackerModules = [];	//list of hacker modules in this group
	this.activeGuns = [];

   this.numCubes = 1;
   this.bounceBackForce = 30;
   this.minRamVel = 300;
   this.debug = false;
};

CubeGroup.prototype.constructor = CubeGroup;

/**
 * Automatically called by World.update
 */
CubeGroup.prototype.update = function() {
   if (this.AI) {
      this.AI.update();
   }
};

CubeGroup.prototype.call = function(fun) {
   for (var row = 0; row < this.cubesWidth(); row++) {
      for (var col = 0; col < this.cubesHeight(); col++) {
         var cube = this.cubes[row][col];
         if (cube && cube.hasOwnProperty(fun)) {
            // if cubes need functions called
         } else if (cube && cube.module && cube.module.hasOwnProperty(fun)) {
            var fn = cube.module[fun];
            if (typeof fn === 'function') {
               fn.call(cube.module);
            }
         }
      }
   }
};

CubeGroup.prototype.callOnType = function(fun, type) {
   for (var row = 0; row < this.cubesWidth(); row++) {
      for (var col = 0; col < this.cubesHeight(); col++) {
         var cube = this.cubes[row][col];
         if (cube && cube.hasOwnProperty(fun)) {
            // if cubes need functions called
         } else if (cube && cube.module && cube.module.type === type && cube.module.hasOwnProperty(fun)) {
            var fn = cube.module[fun];
            if (typeof fn === 'function') {
               fn.call(cube.module);
            }
         }
      }
   }
};

CubeGroup.prototype.getModules = function(type) {
   var modules = [];
   for (var row = 0; row < this.cubesWidth(); row++) {
      for (var col = 0; col < this.cubesHeight(); col++) {
         var cube = this.cubes[row][col];
         if (cube && cube.module.type === type) {
            modules.push(cube.module);
         }
      }
   }
   return modules;
};

CubeGroup.prototype.giveAI = function(type, player) {
   this.AI = new EnemyAI(this.game, this, type, player);
};

CubeGroup.prototype.add = function(cube, point) {
  if (!this.root && cube.module.type === 'core') {
     this.root = cube;
  }
  cube.group = this;
  this.set(cube, point);
  this.createConstraints(cube, point);
};

CubeGroup.prototype.handleCollision = function(origin, other) {
<<<<<<< HEAD
   if (this.debug) console.log('handleCollision() start:', origin.module.type, other.module.type); // jshint ignore:line
   if (this.debug) { this.displayCubes(); }
=======
   //console.log('collision event group');
   //this.displayCubes();
   // stop if other does not exist, either is not a cube, both are in same group
   if (other === null || origin.prototype !== other.prototype) {
      return;
   }
   // if (other.group && other.group !== this && origin.ramDelay <= 0) {
>>>>>>> origin/gh-pages
   var sumVel = Math.abs(origin.body.velocity.x) + Math.abs(origin.body.velocity.y);
   if (other.group && other.group !== this && sumVel >= this.minRamVel) {
      //console.log('collision');
      if (this.game.juicy) {
         this.game.juicy.shake();
      }
      other.takeDamage(3);
      this.call('thrusterHalt');
   } else if (!other.group && this.isPlayer) {
<<<<<<< HEAD
=======
      //console.log('continuing collision event group');
>>>>>>> origin/gh-pages
      var relSide = this.relativeSide(origin.body, other.body);
      var originLoc = this.find(origin);
      // var adjustDir = this.relativeSide(this.root.body, other.body);
      // var otherLoc = this.adjust(originLoc, adjustDir);
      var otherLoc = this.calcPos(origin, relSide);
      if (this.debug) console.log('handleCollision() pre-find:', 'relSide:', relSide, 'originLoc:', Math.floor(originLoc.x), Math.floor(originLoc.y), 'otherLoc:', Math.floor(otherLoc.x), Math.floor(otherLoc.y)); // jshint ignore:line
      this.set(other, otherLoc);
      otherLoc = this.find(other); // update position since set can shift grid
      if (!otherLoc) {
<<<<<<< HEAD
         if (this.debug) {
            console.log('handleCollision(): otherLoc DNE', '---------------------');
            this.displayCubes();
         }
         return;
      }
      if (this.debug) console.log('handleCollision() post-find:', 'otherLoc:', Math.floor(otherLoc.x), Math.floor(otherLoc.y)); // jshint ignore:line
      this.createConstraints(other, otherLoc);
      if (this.debug) this.displayCubes(); // jshint ignore:line
   }
   if (this.debug) { console.log('handleCollision() end:', '------------------------------'); }
};

CubeGroup.prototype.calcPos = function(origin, relSide) {
   var diffAngle = origin.body.rotation - this.root.body.rotation;
   var relative = this.angleToDir(diffAngle);
   var output = this.find(origin);
   if (relative === 0) { // north relative to the root
      if (relSide === 0) {
         output.y++;
      } else if (relSide === 1) {
         output.x++;
      } else if (relSide === 2) {
         output.y--;
      } else if (relSide === 3) {
         output.x--;
      }
   } else if (relative === 1) { // east relative to root
      if (relSide === 0) {
         output.x++;
      } else if (relSide === 1) {
         output.y--;
      } else if (relSide === 2) {
         output.x--;
      } else if (relSide === 3) {
         output.y++;
      }
   } else if (relative === 2) { // south relative to root
      if (relSide === 0) {
         output.y--;
      } else if (relSide === 1) {
         output.x--;
      } else if (relSide === 2) {
         output.y++;
      } else if (relSide === 3) {
         output.x++;
      }
   } else if (relative === 3) { // west relative to root
      if (relSide === 0) {
         output.x--;
      } else if (relSide === 1) {
         output.y++;
      } else if (relSide === 2) {
         output.x++;
      } else if (relSide === 3) {
         output.y--;
      }
=======
         console.log('handleCollision(): otherLoc DOE');
         //this.displayCubes();
         return;
      }
      //console.log(relSide, originLoc.x, originLoc.y, otherLoc.x, otherLoc.y);
      var otherRelSide = this.relativeSide(other.body, origin.body);
      var constraintAngle = this.decideConstraintAngle(relSide, otherRelSide);
      this.createConstraints(other, otherLoc, constraintAngle);
      //this.displayCubes();
   }
};

CubeGroup.prototype.decideConstraintAngle = function(sideA, sideB) {
  if (sideA === 0) {
     if (sideB === 0) {
        return Math.PI;
     } else if (sideB === 1) {
         return Math.PI / 2;
     } else if (sideB === 2) {
         return 0;
     } else if (sideB === 3) {
         return 3 / 2 * Math.PI;
     }
  } else if (sideA === 1) {
     if (sideB === 0) {
        return 3 / 2 * Math.PI;
     } else if (sideB === 1) {
         return Math.PI;
     } else if (sideB === 2) {
         return 1 / 2 * Math.PI;
     } else if (sideB === 3) {
         return 0;
     }
  } else if (sideA === 2) {
      if (sideB === 0) {
        return 0;
     } else if (sideB === 1) {
         return 3 / 2 * Math.PI;
     } else if (sideB === 2) {
         return Math.PI;
     } else if (sideB === 3) {
         return 1 / 2 * Math.PI;
     }
  } else if (sideA === 3) {
     if (sideB === 0) {
        return 1 / 2 * Math.PI;
     } else if (sideB === 1) {
         return 0;
     } else if (sideB === 2) {
         return 3 / 2 * Math.PI;
     } else if (sideB === 3) {
         return Math.PI;
     }
  }
};

CubeGroup.prototype.createConstraints = function(me, point, angle) {
   var myNorth = this.get(this.adjust(point, this.DIR.NORTH));
   var myEast = this.get(this.adjust(point, this.DIR.EAST));
   var mySouth = this.get(this.adjust(point, this.DIR.SOUTH));
   var myWest = this.get(this.adjust(point, this.DIR.WEST));
   var constraint;
   if (myNorth) {
      constraint = this.game.physics.p2.createLockConstraint(myNorth.body, me.body, [0, -(me.width + this.offset)], angle); // north - me
      me.constraints.push(constraint);
      myNorth.constraints.push(constraint);
   }
   if (myEast) {
      constraint = this.game.physics.p2.createLockConstraint(myEast.body, me.body, [me.width + this.offset, 0], angle); // east - me
      me.constraints.push(constraint);
      myEast.constraints.push(constraint);
   }
   if (mySouth) {
      constraint = this.game.physics.p2.createLockConstraint(mySouth.body, me.body, [0, me.width + this.offset], angle); // south - me
      me.constraints.push(constraint);
      mySouth.constraints.push(constraint);
   }
   if (myWest) {
      constraint = this.game.physics.p2.createLockConstraint(myWest.body, me.body, [-me.width - this.offset, 0], angle); // west - me
      me.constraints.push(constraint);
      myWest.constraints.push(constraint);
>>>>>>> origin/gh-pages
   }
   return output;
};

CubeGroup.prototype.angleToDir = function(angle) {
   if (angle >= 0) {
     angle %= 2 * Math.PI;
  } else {
     angle *= -1;
     angle %= 2 * Math.PI;
     angle *= -1;
  }
<<<<<<< HEAD
  if ((angle >= -1 / 4 * Math.PI && angle < 1 / 4 * Math.PI) || angle > 7 / 4 * Math.PI) {
=======
  //console.log(thisPoint, otherPoint, angleToOther, thisBody.rotation, diffAngle);
   if ((diffAngle >= -1 / 4 * Math.PI && diffAngle < 1 / 4 * Math.PI) || diffAngle > 7 / 4 * Math.PI) { // north
>>>>>>> origin/gh-pages
     return this.DIR.NORTH;
  } else if (angle >= 1 / 4 * Math.PI && angle < 3 / 4 * Math.PI) {
     return this.DIR.EAST;
  } else if (angle >= 3 / 4 * Math.PI && angle < 5 / 4 * Math.PI) {
     return this.DIR.SOUTH;
  } else if (angle >= 5 / 4 * Math.PI && angle < 7 / 4 * Math.PI) {
     return this.DIR.WEST;
  } else if (angle >= -3 / 4 * Math.PI && angle < -1 / 4 * Math.PI) {
     return this.DIR.WEST;
  } else if (angle >= -5 / 4 * Math.PI && angle < -3 / 4 * Math.PI) {
     return this.DIR.SOUTH;
  } else if (angle >= -7 / 4 * Math.PI && angle < -5 / 4 * Math.PI) {
     return this.DIR.EAST;
  } else if (angle < -7 / 4 * Math.PI) {
     return this.DIR.NORTH;
  }
};

CubeGroup.prototype.createConstraints = function(me, point) {
   var neighbors = this.getNeighbors(me);
   for (var i = 0; i < neighbors.length; i++) {
      var neighbor = neighbors[i];
      var mySide = this.relativeSide(me.body, neighbor.body);
      var neighborSide = this.relativeSide(neighbor.body, me.body);
      var constraint;
      var offset = me.width + this.offset;
      if (mySide === 0) {
        if (neighborSide === 0) {
           constraint = this.game.physics.p2.createLockConstraint(me.body, neighbor.body, [0, offset], Math.PI);
        } else if (neighborSide === 1) {
            constraint = this.game.physics.p2.createLockConstraint(me.body, neighbor.body, [0, offset], 1 / 2 * Math.PI);
        } else if (neighborSide === 2) {
            constraint = this.game.physics.p2.createLockConstraint(me.body, neighbor.body, [0, offset], 0);
        } else if (neighborSide === 3) {
            constraint = this.game.physics.p2.createLockConstraint(me.body, neighbor.body, [0, offset], 3 / 2 * Math.PI);
        }
     } else if (mySide === 1) {
        if (neighborSide === 0) {
           constraint = this.game.physics.p2.createLockConstraint(me.body, neighbor.body, [-offset, 0], -1 / 2 * Math.PI);
        } else if (neighborSide === 1) {
            constraint = this.game.physics.p2.createLockConstraint(me.body, neighbor.body, [-offset, 0], Math.PI);
        } else if (neighborSide === 2) {
            constraint = this.game.physics.p2.createLockConstraint(me.body, neighbor.body, [-offset, 0], 1 / 2 * Math.PI);
        } else if (neighborSide === 3) {
            constraint = this.game.physics.p2.createLockConstraint(me.body, neighbor.body, [-offset, 0], 0);
        }
     } else if (mySide === 2) {
         if (neighborSide === 0) {
           constraint = this.game.physics.p2.createLockConstraint(me.body, neighbor.body, [0, -offset], 0);
        } else if (neighborSide === 1) {
            constraint = this.game.physics.p2.createLockConstraint(me.body, neighbor.body, [0, -offset], 3 / 2 * Math.PI);
        } else if (neighborSide === 2) {
            constraint = this.game.physics.p2.createLockConstraint(me.body, neighbor.body, [0, -offset], Math.PI);
        } else if (neighborSide === 3) {
            constraint = this.game.physics.p2.createLockConstraint(me.body, neighbor.body, [0, -offset], 1 / 2 * Math.PI);
        }
     } else if (mySide === 3) {
        if (neighborSide === 0) {
           constraint = this.game.physics.p2.createLockConstraint(me.body, neighbor.body, [offset, 0], 1 / 2 * Math.PI);
        } else if (neighborSide === 1) {
            constraint = this.game.physics.p2.createLockConstraint(me.body, neighbor.body, [offset, 0], 0);
        } else if (neighborSide === 2) {
            constraint = this.game.physics.p2.createLockConstraint(me.body, neighbor.body, [offset, 0], -1 / 2 * Math.PI);
        } else if (neighborSide === 3) {
            constraint = this.game.physics.p2.createLockConstraint(me.body, neighbor.body, [offset, 0], Math.PI);
        }
     }
     me.constraints.push(constraint);
     neighbor.constraints.push(constraint);
   }
};

CubeGroup.prototype.relativeSide = function(thisBody, otherBody) {
  var thisPoint = new Phaser.Point(thisBody.x, thisBody.y);
  var otherPoint = new Phaser.Point(otherBody.x, otherBody.y);
  var angleToOther = this.angleBetweenPoints(thisPoint, otherPoint);
  var diffAngle = angleToOther - thisBody.rotation;
  return this.angleToDir(diffAngle);
};

CubeGroup.prototype.angleBetweenPoints = function(thisPoint, otherPoint) {
  var angleToOther = Phaser.Point.angle(thisPoint, otherPoint);
  if (angleToOther < 0) { // fix dumb part of Phaser.Point.angle()
     angleToOther = 2 * Math.PI + angleToOther;
  }
  angleToOther = (angleToOther + 3/2 * Math.PI) % (2 * Math.PI); // rotate 90 d clockwise
   return angleToOther;
};

CubeGroup.prototype.find = function(cube) {
   for (var row = 0; row < this.cubesWidth(); row++) {
      for (var col = 0; col < this.cubesHeight(); col++) {
         if (this.cubes[row][col] === cube) {
            return new Phaser.Point(row, col);
         }
      }
   }
   return undefined;
};

CubeGroup.prototype.get = function(point) {
  if (!point || this.outOfBounds(point)) {
      return;
  }
  return this.cubes[point.x][point.y];
};

CubeGroup.prototype.cubesWidth = function() {
   return this.cubes.length;
};

CubeGroup.prototype.cubesHeight = function() {
   return this.cubes[0].length;
};

CubeGroup.prototype.addTopRow = function() {
   for (var row = 0; row < this.cubesWidth(); row++) {
      this.cubes[row].push(undefined);
   }
};

CubeGroup.prototype.addRightCol = function() {
   var newCol = [];
   for (var i = 0; i < this.cubesHeight(); i++) {
      newCol.push(undefined);
   }
   this.cubes.push(newCol);
};

CubeGroup.prototype.addBotRow = function() {
   for (var row = 0; row < this.cubesWidth(); row++) {
      this.cubes[row].unshift(undefined);
   }
};

CubeGroup.prototype.addLeftCol = function() {
   var newCol = new Array(this.cubesHeight());
   this.cubes.unshift(newCol);
};

CubeGroup.prototype.getCube = function(point) {
   if (!point || this.outOfBounds(point)) {
      return undefined;
   }
   return this.cubes[point.x][point.y];
};

CubeGroup.prototype.adjust = function(point, dir) {
  if (!point) {
     return;
  }
  var newPoint = new Phaser.Point(point.x, point.y);
  switch (dir) {
      case this.DIR.NORTH:
      newPoint.y++;
      break;
      case this.DIR.EAST:
      newPoint.x++;
      break;
      case this.DIR.SOUTH:
      newPoint.y--;
      break;
      case this.DIR.WEST:
      newPoint.x--;
      break;
   }
   return newPoint;
};

CubeGroup.prototype.set = function(cube, point) {
   if (!point) {
      console.log('set given undefined point');
      return;
   }
   if (point.x < 0) {
<<<<<<< HEAD
      if (this.debug) { console.log('add left col'); }
      this.addLeftCol();
      point.x = 0;
   } else if (point.x >= this.cubesWidth()) {
      if (this.debug) { console.log('add right col'); }
      this.addRightCol();
      point.x = this.cubesWidth() - 1;
   } else if (point.y < 0) {
      if (this.debug) { console.log('add bot row'); }
      this.addBotRow();
      point.y = 0;
   } else if (point.y >= this.cubesHeight()) {
      if (this.debug) { console.log('add top row'); }
=======
      //console.log('add left col');
      this.addLeftCol();
      point.x = 0;
   } else if (point.x >= this.cubesWidth()) {
      //console.log('add right col');
      this.addRightCol();
      point.x = this.cubesWidth() - 1;
   } else if (point.y < 0) {
      //console.log('add bot row');
      this.addBotRow();
      point.y = 0;
   } else if (point.y >= this.cubesHeight()) {
      //console.log('add top row');
>>>>>>> origin/gh-pages
      this.addTopRow();
      point.y = this.cubesHeight() - 1;
   }
   if (this.get(point)) {
      // console.log('tried to set to filled position');
      return;
   }
   this.cubes[point.x][point.y] = cube;
   cube.group = this;
};

CubeGroup.prototype.outOfBounds = function(point) {
   if (!point) {
      console.log('out of bounds given undefined point');
      return;
   }
   if (point.x < 0 || point.x >= this.cubesWidth() || point.y < 0 || point.y >= this.cubesHeight()) {
      return true;
   }
   return false;
};

CubeGroup.prototype.displayCubes = function() {
   var output = 'displayCubes():\n';
   var row = 0;
   var col = this.cubesHeight() - 1;
   while (col >= 0) {
      while (row < this.cubesWidth()) {
         var cube = this.cubes[row][col];
         if (cube) {
            switch (cube.module.type) {
               case 'shield':
               output += 'S ';
               break;
               case 'core':
               output += 'C ';
               break;
               case 'thruster':
               output += 'T ';
               break;
               case 'solarPanel':
               output += 'P ';
               break;
               case 'hacker':
               output += 'H ';
               break;
               case 'gun':
               output += 'G ';
               break;
            }
         } else {
            output += '_ ';
         }
         row++;
      }
      row = 0;
      col--;
      output += '\n';
   }
   console.log(output);
};

CubeGroup.prototype.displayConnection = function(connection) {
   var graph = new Astar.Graph(this.cubesToGraph());
   var startPoint = this.find(connection.start);
   var endPoint = this.find(connection.end);
   if (!startPoint || !endPoint) {
      console.log('displayConnection failed to get points');
      return;
   }
   var start = graph.grid[startPoint.x][startPoint.y];
   var end = graph.grid[endPoint.x][endPoint.y];
   var result = Astar.astar.search(graph, start, end);
   result.unshift(start);
   var previous;
   for(var i = 0; i < result.length; i++) {
      var curPoint = new Phaser.Point(result[i].x, result[i].y);
      var cur = this.get(curPoint);
      var indicator = cur.cIndicator;
      var dir;
      var prevPoint;
      var nextPoint;
      if (!previous) {
         indicator.animations.play('end');
         nextPoint = new Phaser.Point(result[i+1].x, result[i+1].y);
         dir = this.dirBetween(curPoint, nextPoint);
         indicator.rotation = this.dirToAngle(dir);
      } else if (i === result.length - 1) {
         indicator.animations.play('end');
         prevPoint = new Phaser.Point(previous.x, previous.y);
         dir = this.dirBetween(curPoint, prevPoint);
         indicator.rotation = this.dirToAngle(dir);
      } else {
         indicator.animations.play('line');
         prevPoint = new Phaser.Point(previous.x, previous.y);
         var prevDir = this.dirBetween(curPoint, prevPoint);
         nextPoint = new Phaser.Point(result[i+1].x, result[i+1].y);
         var nextDir = this.dirBetween(curPoint, nextPoint);
         this.manageIndicator(indicator, prevDir, nextDir);
      }
      previous = result[i];
      cur.displayIndicator();
    }
};

CubeGroup.prototype.manageIndicator = function(indicator, prevDir, nextDir) {
  indicator.scale.setTo(Math.abs(indicator.scale.x), indicator.scale.y);
  if (prevDir === this.DIR.NORTH && nextDir === this.DIR.SOUTH) { // 2
      indicator.rotation = Math.PI;
   } else if (prevDir === this.DIR.SOUTH && nextDir === this.DIR.NORTH) { // 1
      indicator.rotation = 0;
   } else if (prevDir === this.DIR.EAST && nextDir === this.DIR.WEST) { // 4
      indicator.rotation = 1 / 2 * Math.PI;
   } else if (prevDir === this.DIR.WEST && nextDir === this.DIR.EAST) { // 3
      indicator.rotation = 3 / 2  * Math.PI;
   } else {
      indicator.animations.play('right');
      if (prevDir === this.DIR.SOUTH && nextDir === this.DIR.EAST) { // 5
         indicator.rotation = 0;
      } else if (prevDir === this.DIR.WEST && nextDir === this.DIR.SOUTH) { // 6
         indicator.rotation = 1 / 2 * Math.PI;
      } else if (prevDir === this.DIR.NORTH && nextDir === this.DIR.WEST) { // 7
         indicator.rotation = Math.PI;
      } else if (prevDir === this.DIR.EAST && nextDir === this.DIR.NORTH) { // 8
         indicator.rotation = 3 / 2 * Math.PI;
      } else {
         indicator.scale.setTo(-Math.abs(indicator.scale.x), indicator.scale.y);
         if (prevDir === this.DIR.SOUTH && nextDir === this.DIR.WEST) { // 9
            indicator.rotation = 0;
         } else if (prevDir === this.DIR.WEST && nextDir === this.DIR.NORTH) { // 10
            indicator.rotation = 1 / 2 * Math.PI;
         } else if (prevDir === this.DIR.NORTH && nextDir === this.DIR.EAST) { // 11
            indicator.rotation = Math.PI;
         } else if (prevDir === this.DIR.EAST && nextDir === this.DIR.SOUTH) { // 12
            indicator.rotation = 3 / 2 * Math.PI;
         }
      }
   } 
};

CubeGroup.prototype.cubesToGraph = function() {
  var graph = [];
  for (var row = 0; row < this.cubesWidth(); row++) {
     var newCol = [];
      for (var col = 0; col < this.cubesHeight(); col++) {
         if (this.cubes[row][col]) {
            newCol.push(1);
         } else {
            newCol.push(0);
         }
      }
      graph.push(newCol);
   }
   return graph;
};

CubeGroup.prototype.dirBetween = function(a, b) {
   var deltaX = a.x - b.x;
   var deltaY = a.y - b.y;
   if (deltaX > 0) {
      return this.DIR.WEST;
   }
   if (deltaX < 0) {
      return this.DIR.EAST;
   }
   if (deltaY > 0) {
      return this.DIR.SOUTH;
   }
   if (deltaY < 0) {
      return this.DIR.NORTH;
   }
   return this.DIR.NORTH;
};

CubeGroup.prototype.dirToAngle = function(dir) {
  switch (dir) {
   case this.DIR.NORTH:
   return Math.PI;
   case this.DIR.EAST:
   return 3 / 2 * Math.PI;
   case this.DIR.SOUTH:
   return 0;
   case this.DIR.WEST:
   return 1 / 2 * Math.PI;
  }  
};

CubeGroup.prototype.destroyCube = function(cube) {
  var loc = this.find(cube);
  if (!loc) {
     console.log('attempt to destroy cube not in group');
     return;
  }
  // remove cube from group
  this.remove(cube);
  // destroy cube
  cube.kill(true);
};

CubeGroup.prototype.remove = function(cube) {
   console.log('remove()');
   if (this.root === cube) {
      return;
   }
   // remove cube from array
   var row, col;
   for (row = 0; row < this.cubesWidth(); row++) {
      for (col = 0; col < this.cubesHeight(); col++) {
         if (this.cubes[row][col] === cube) {
            // this.cubes[row][col].group = undefined;
            this.cubes[row][col] = undefined;
            break;
         }
      }
   }
   // remove constraints from cube
   this.removeConstraints(cube);
   cube.group = undefined;
   if (cube.module && cube.module.hasOwnProperty('onRemove')) {
      cube.module.onRemove();
   }
   // test for exiles
   for (row = 0; row < this.cubesWidth(); row++) {
      for (col = 0; col < this.cubesHeight(); col++) {
         var exile = this.cubes[row][col];
         if (exile && this.isExile(exile)) {
            this.remove(exile);
         }
      }
   }
   if (this.debug) { this.displayCubes(); }
};

CubeGroup.prototype.removeNeighborsConstraint = function(constraint, cube) {
   // console.log('removeNeighborsConstraint');
   var neighbors = this.getNeighbors(cube);
   for (var i = 0; i < neighbors.length; i++) {
      var neighbor = neighbors[i];
      for (var j = 0; j < neighbor.constraints.length; j++) {
         if (neighbor.constraints[j] === constraint) {
            neighbor.constraints.splice(j, 1);
         }
      }
   }
};

CubeGroup.prototype.getNeighbors = function(cube) {
   var loc = this.find(cube);
   var north = this.get(this.adjust(loc, this.DIR.NORTH));
   var east = this.get(this.adjust(loc, this.DIR.EAST));
   var south = this.get(this.adjust(loc, this.DIR.SOUTH));
   var west = this.get(this.adjust(loc, this.DIR.WEST));
   var neighbors = [];
   if (north) {
      neighbors.push(north);
   }
   if (east) {
      neighbors.push(east);
   }
   if (south) {
      neighbors.push(south);
   }
   if (west) {
      neighbors.push(west);
   }
   return neighbors;
};

CubeGroup.prototype.removeConstraints = function(cube) {
   // console.log('removeConstraints');
   while (cube.constraints.length > 0) {
      this.removeNeighborsConstraint(cube.constraints[0], cube);
      this.game.physics.p2.removeConstraint(cube.constraints[0]);
      cube.constraints.splice(0, 1);
   }
};

// only used to test Astar
CubeGroup.prototype.testPath = function() {
  var graph = new Astar.Graph([
        [1,1,1,1],
        [0,1,1,0],
        [0,0,0,1]
    ]);
   var start = graph.grid[0][0];
   var end = graph.grid[2][3];
   var result = Astar.astar.search(graph, start, end);
   result.unshift(start);
   for(var i = 0; i < result.length; i++) {
      console.log(result[i].x, result[i].y);
    } 
};

CubeGroup.prototype.isExile = function(cube) {
   if (cube === this.root) {
      return;
   }
   var graph = new Astar.Graph(this.cubesToGraph());
   var startPoint = this.find(this.root);
   var endPoint = this.find(cube);
   var start = graph.grid[startPoint.x][startPoint.y];
   var end = graph.grid[endPoint.x][endPoint.y];
   var result = Astar.astar.search(graph, start, end);
   // if no path is found, the cube is an exile
   if (result.length === 0) {
      return true;
   }
   return false;
};

CubeGroup.prototype.countCubes = function() {
	var row, col;
	var num  = 0;
	for (row = 0; row < this.cubesWidth(); row++) {
		for (col = 0; col < this.cubesHeight(); col++) {
			if (this.cubes[row][col] !== undefined) {
				num++;
			}
		}
	}
	//console.log(num);
	this.numCubes = num;
};

module.exports = CubeGroup;

















},{"../libs/javascript-astar/astar":"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\libs\\javascript-astar\\astar.js","./enemy_ai":"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\entities\\enemy_ai.js"}],"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\entities\\enemy_ai.js":[function(require,module,exports){
var Utils = require('../utils.js');

var EnemyAI = function(game, group, type, playerGroup) {
   this.game = game;
   this.group = group;
   this.type = type;
   this.playerGroup = playerGroup;
   this.player = this.playerGroup.root;
   this.ramDist = 500;
   this.shootDist = 500;
   this.rotationForce = 50;
   this.facingAllowance = Math.PI / 15;
   this.acting = false;
   switch (this.type) {
      case 'ram':
      this.allocateTo('thruster');
      break;
      case 'shoot':
      this.allocateTo('gun');
   }
};

EnemyAI.prototype.constructor = EnemyAI;

EnemyAI.prototype.update = function() {
   switch (this.type) {
      case 'ram':
      this.customUpdate('thruster', this.ramDist);
      break;
      case 'shoot':
      this.customUpdate('gun', this.shootDist);
   }
};

EnemyAI.prototype.customUpdate = function(type, threshold) {
   if (!this.group.root) {
      return;
   }
   var root = this.group.root;
   var myPos = new Phaser.Point(root.x, root.y);
   var playerPos = new Phaser.Point(this.player.x, this.player.y);
   var dist = Utils.distance(myPos.x, myPos.y, playerPos.x, playerPos.y);
   if (dist <= threshold) {
      var angleTo = this.angleTo(myPos, playerPos);
      var diffAngle = angleTo - root.body.rotation;
      if (diffAngle > 0) {
         root.body.angularForce = this.rotationForce;
      } else {
         root.body.angularForce = -this.rotationForce;
      }
      if (Math.abs(diffAngle) <= this.facingAllowance && !this.acting) {
         // this.group.call('beginAct');
         this.group.callOnType('beginAct', type);
         this.acting = true;
         // this.allocateTo(type);
      } else if (Math.abs(diffAngle) > this.facingAllowance && this.acting){
         // this.group.call('endAct');
         this.group.callOnType('endAct', type);
         this.acting = false;
      }
   }
};

EnemyAI.prototype.allocateTo = function(type) {
   var panels = [];
   var types = [];
   for (var row = 0; row < this.group.cubesWidth(); row++) {
      for (var col = 0; col < this.group.cubesHeight(); col++) {
         var cube = this.group.cubes[row][col];
         if (cube && cube.module) {
            if (cube.module.type === 'solarPanel' && !cube.myConnection) {
               panels.push(cube.module);
            } else if (cube.module.type === type && !cube.myConnection) {
               types.push(cube.module);
            }
         }
      }
   }
   var i = 0;
   while (i < types.length && i < panels.length) {
      var tarPanel = panels[i];
      var tarType = types[i];
      var newConnection = {start: tarPanel.cube, end: tarType.cube};
      tarPanel.cube.myConnection = newConnection;
      tarType.cube.myConnection = newConnection;
      this.group.displayConnection(tarPanel.cube.myConnection);
      i++;
   }
};

EnemyAI.prototype.angleTo = function(from, to) {
  var angleToOther = Phaser.Point.angle(from, to);
  if (angleToOther < 0) { // fix dumb part of Phaser.Point.angle()
     angleToOther = 2 * Math.PI + angleToOther;
  }
  angleToOther = (angleToOther + 3/2 * Math.PI) % (2 * Math.PI); // rotate 90 d clockwise
  return angleToOther;
};

module.exports = EnemyAI;











},{"../utils.js":"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\utils.js"}],"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\entities\\mouse.js":[function(require,module,exports){
var Utils = require('../utils.js');

var Mouse = function(game, input, playerGroup) {
   this.game = game;
   this.input = input;
	this.body = new p2.Body(); // jshint ignore:line
   this.game.physics.p2.world.addBody(this.body);
   // this.game.physics.p2.enable(this);
   
   this.input.onDown.add(this.click, this);
   this.input.onUp.add(this.release, this);
   this.input.addMoveCallback(this.move, this);
   this.x = 0;
   this.y = 0;
   
   this.grabbed = undefined;
   this.lastClicked = undefined;
   this.line = new Phaser.Line(0, 0, 0, 0);
   
   this.removeThreshold = 400; // time in milliseconds
   this.removeTime = 0; // time till threshold
   
   this.playerGroup = playerGroup;
};

Mouse.prototype.constructor = Mouse;

Mouse.prototype.update = function() {
   if (this.grabbed) {
      var angle = Math.atan2(this.grabbed.sprite.y - (this.input.position.y + this.game.camera.y), this.grabbed.sprite.x - (this.input.position.x+ this.game.camera.x)) + Math.PI;
      var dist = Utils.distance(this.grabbed.sprite.x, this.grabbed.sprite.y, (this.input.position.x+ this.game.camera.x), (this.input.position.y + this.game.camera.y));
      var weight;
	  if(this.grabbed.sprite.key === 'asteroid') {
		weight = 1;
	  }
	  else {
		weight = 10;
	  }
	  if (!this.grabbed.sprite.group) {
         this.grabbed.force.x = Math.cos(angle) * dist * weight;
         this.grabbed.force.y = Math.sin(angle) * dist * weight;
      }
      this.line.setTo(this.grabbed.sprite.x, this.grabbed.sprite.y, (this.input.position.x+ this.game.camera.x), (this.input.position.y + this.game.camera.y));
      this.removeTime += this.game.time.elapsed;
      if(this.grabbed.sprite.tag === 'module') {
		  if (this.removeTime >= this.removeThreshold && this.grabbed.sprite.key !== 'asteroid') {
			 this.grabbed.sprite.remove();
			 this.removeTime = 0;
		  }
	  }
    } else {
       this.line.setTo(0, 0, 0, 0);
    }
    var point = new Phaser.Point(this.x, this.y);
    var bodies = this.game.physics.p2.hitTest(point);
    if (bodies.length)
    {
        var hover = bodies[0].parent;
        if (hover.sprite.module && hover.sprite.module.mouseOver) {
           hover.sprite.module.mouseOver();
        }
    }
};

Mouse.prototype.click = function(pointer) {
   var point = new Phaser.Point(pointer.x + this.game.camera.x, pointer.y + this.game.camera.y);
   var bodies = this.game.physics.p2.hitTest(point);
   if (bodies.length)
   {
     var temp = bodies[0].parent;
     // console.log('rotation:', temp.rotation);
     this.grabbed = temp;
     if (this.grabbed.sprite.module && this.grabbed.sprite.module.hasOwnProperty('mouseDown')) {
       this.grabbed.sprite.module.mouseDown();
     }
     if (this.lastClicked && this.lastClicked.sprite && this.lastClicked.sprite.module &&
     this.lastClicked.sprite.module.giveTarget) {
        this.lastClicked.sprite.module.giveTarget(this.grabbed.sprite.module);
     }
     if (temp.sprite && temp.sprite.module && temp.sprite.module.type === 'core') {
        this.grabbed = undefined;
     }
     if (temp.sprite && temp.sprite.group && temp.sprite.group !== this.playerGroup) {
        this.grabbed = undefined;
     }
     this.removeTime = 0;
     this.lastClicked = temp;
   }
};
  
 Mouse.prototype.release = function() {
   if (this.grabbed) {
     this.grabbed = undefined;
   }
};

Mouse.prototype.move = function(pointer) {
   // p2 uses different coordinate system, so convert the pointer position to p2's coordinate system
   this.body.position[0] = this.game.physics.p2.pxmi(pointer.position.x);
   this.body.position[1] = this.game.physics.p2.pxmi(pointer.position.y);
   this.x = pointer.position.x + this.game.camera.x;
   this.y = pointer.position.y + this.game.camera.y;
};

Mouse.prototype.render = function() {
   this.game.debug.geom(this.line);
};

module.exports = Mouse;















},{"../utils.js":"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\utils.js"}],"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\functionAccess\\Renderables.js":[function(require,module,exports){
var Renderables = function() {
	if(Renderables.prototype.exists) {
		return Renderables.prototype.existingReference;
	}
	
	this.list = [];
	Renderables.prototype.exists = true;
	Renderables.prototype.existingReference = this;
};

Renderables.prototype.constructor = Renderables;
//These var's help create the singleton functionality
Renderables.prototype.exists = false;
Renderables.prototype.existingReference = null;

Renderables.prototype.subscribe = function(subscriber) {
	this.list.push(subscriber);
};

Renderables.prototype.unsubscribe = function(unsubscriber) {
	for(var i = 0; i < this.list.length; i++) {
		if(this.list[i] === unsubscriber) {
			this.list[i] = false;
		}
	}
};

Renderables.prototype.renderAll = function() {
	for(var i = 0; i < this.list.length; i++) {
		if(this.list[i] === false) {
			continue;
		}
		this.list[i].render();
	}
};

module.exports = Renderables;
},{}],"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\libs\\javascript-astar\\astar.js":[function(require,module,exports){
// javascript-astar 0.4.0
// http://github.com/bgrins/javascript-astar
// Freely distributable under the MIT License.
// Implements the astar search algorithm in javascript using a Binary Heap.
// Includes Binary Heap (with modifications) from Marijn Haverbeke.
// http://eloquentjavascript.net/appendix2.html

(function(definition) {
    /* global module, define */
    if(typeof module === 'object' && typeof module.exports === 'object') {
        module.exports = definition();
    } else if(typeof define === 'function' && define.amd) {
        define([], definition);
    } else {
        var exports = definition();
        window.astar = exports.astar;
        window.Graph = exports.Graph;
    }
})(function() {

function pathTo(node){
    var curr = node,
        path = [];
    while(curr.parent) {
        path.push(curr);
        curr = curr.parent;
    }
    return path.reverse();
}

function getHeap() {
    return new BinaryHeap(function(node) {
        return node.f;
    });
}

var astar = {
    /**
    * Perform an A* Search on a graph given a start and end node.
    * @param {Graph} graph
    * @param {GridNode} start
    * @param {GridNode} end
    * @param {Object} [options]
    * @param {bool} [options.closest] Specifies whether to return the
               path to the closest node if the target is unreachable.
    * @param {Function} [options.heuristic] Heuristic function (see
    *          astar.heuristics).
    */
    search: function(graph, start, end, options) {
        graph.cleanDirty();
        options = options || {};
        var heuristic = options.heuristic || astar.heuristics.manhattan,
            closest = options.closest || false;

        var openHeap = getHeap(),
            closestNode = start; // set the start node to be the closest if required

        start.h = heuristic(start, end);

        openHeap.push(start);

        while(openHeap.size() > 0) {

            // Grab the lowest f(x) to process next.  Heap keeps this sorted for us.
            var currentNode = openHeap.pop();

            // End case -- result has been found, return the traced path.
            if(currentNode === end) {
                return pathTo(currentNode);
            }

            // Normal case -- move currentNode from open to closed, process each of its neighbors.
            currentNode.closed = true;

            // Find all neighbors for the current node.
            var neighbors = graph.neighbors(currentNode);

            for (var i = 0, il = neighbors.length; i < il; ++i) {
                var neighbor = neighbors[i];

                if (neighbor.closed || neighbor.isWall()) {
                    // Not a valid node to process, skip to next neighbor.
                    continue;
                }

                // The g score is the shortest distance from start to current node.
                // We need to check if the path we have arrived at this neighbor is the shortest one we have seen yet.
                var gScore = currentNode.g + neighbor.getCost(currentNode),
                    beenVisited = neighbor.visited;

                if (!beenVisited || gScore < neighbor.g) {

                    // Found an optimal (so far) path to this node.  Take score for node to see how good it is.
                    neighbor.visited = true;
                    neighbor.parent = currentNode;
                    neighbor.h = neighbor.h || heuristic(neighbor, end);
                    neighbor.g = gScore;
                    neighbor.f = neighbor.g + neighbor.h;
                    graph.markDirty(neighbor);
                    if (closest) {
                        // If the neighbour is closer than the current closestNode or if it's equally close but has
                        // a cheaper path than the current closest node then it becomes the closest node
                        if (neighbor.h < closestNode.h || (neighbor.h === closestNode.h && neighbor.g < closestNode.g)) {
                            closestNode = neighbor;
                        }
                    }

                    if (!beenVisited) {
                        // Pushing to heap will put it in proper place based on the 'f' value.
                        openHeap.push(neighbor);
                    }
                    else {
                        // Already seen the node, but since it has been rescored we need to reorder it in the heap
                        openHeap.rescoreElement(neighbor);
                    }
                }
            }
        }

        if (closest) {
            return pathTo(closestNode);
        }

        // No result was found - empty array signifies failure to find path.
        return [];
    },
    // See list of heuristics: http://theory.stanford.edu/~amitp/GameProgramming/Heuristics.html
    heuristics: {
        manhattan: function(pos0, pos1) {
            var d1 = Math.abs(pos1.x - pos0.x);
            var d2 = Math.abs(pos1.y - pos0.y);
            return d1 + d2;
        },
        diagonal: function(pos0, pos1) {
            var D = 1;
            var D2 = Math.sqrt(2);
            var d1 = Math.abs(pos1.x - pos0.x);
            var d2 = Math.abs(pos1.y - pos0.y);
            return (D * (d1 + d2)) + ((D2 - (2 * D)) * Math.min(d1, d2));
        }
    },
    cleanNode:function(node){
        node.f = 0;
        node.g = 0;
        node.h = 0;
        node.visited = false;
        node.closed = false;
        node.parent = null;
    }
};

/**
* A graph memory structure
* @param {Array} gridIn 2D array of input weights
* @param {Object} [options]
* @param {bool} [options.diagonal] Specifies whether diagonal moves are allowed
*/
function Graph(gridIn, options) {
    options = options || {};
    this.nodes = [];
    this.diagonal = !!options.diagonal;
    this.grid = [];
    for (var x = 0; x < gridIn.length; x++) {
        this.grid[x] = [];

        for (var y = 0, row = gridIn[x]; y < row.length; y++) {
            var node = new GridNode(x, y, row[y]);
            this.grid[x][y] = node;
            this.nodes.push(node);
        }
    }
    this.init();
}

Graph.prototype.init = function() {
    this.dirtyNodes = [];
    for (var i = 0; i < this.nodes.length; i++) {
        astar.cleanNode(this.nodes[i]);
    }
};

Graph.prototype.cleanDirty = function() {
    for (var i = 0; i < this.dirtyNodes.length; i++) {
        astar.cleanNode(this.dirtyNodes[i]);
    }
    this.dirtyNodes = [];
};

Graph.prototype.markDirty = function(node) {
    this.dirtyNodes.push(node);
};

Graph.prototype.neighbors = function(node) {
    var ret = [],
        x = node.x,
        y = node.y,
        grid = this.grid;

    // West
    if(grid[x-1] && grid[x-1][y]) {
        ret.push(grid[x-1][y]);
    }

    // East
    if(grid[x+1] && grid[x+1][y]) {
        ret.push(grid[x+1][y]);
    }

    // South
    if(grid[x] && grid[x][y-1]) {
        ret.push(grid[x][y-1]);
    }

    // North
    if(grid[x] && grid[x][y+1]) {
        ret.push(grid[x][y+1]);
    }

    if (this.diagonal) {
        // Southwest
        if(grid[x-1] && grid[x-1][y-1]) {
            ret.push(grid[x-1][y-1]);
        }

        // Southeast
        if(grid[x+1] && grid[x+1][y-1]) {
            ret.push(grid[x+1][y-1]);
        }

        // Northwest
        if(grid[x-1] && grid[x-1][y+1]) {
            ret.push(grid[x-1][y+1]);
        }

        // Northeast
        if(grid[x+1] && grid[x+1][y+1]) {
            ret.push(grid[x+1][y+1]);
        }
    }

    return ret;
};

Graph.prototype.toString = function() {
    var graphString = [],
        nodes = this.grid, // when using grid
        rowDebug, row, y, l;
    for (var x = 0, len = nodes.length; x < len; x++) {
        rowDebug = [];
        row = nodes[x];
        for (y = 0, l = row.length; y < l; y++) {
            rowDebug.push(row[y].weight);
        }
        graphString.push(rowDebug.join(' '));
    }
    return graphString.join('\n');
};

function GridNode(x, y, weight) {
    this.x = x;
    this.y = y;
    this.weight = weight;
}

GridNode.prototype.toString = function() {
    return '[' + this.x + ' ' + this.y + ']';
};

GridNode.prototype.getCost = function(fromNeighbor) {
    // Take diagonal weight into consideration.
    if (fromNeighbor && fromNeighbor.x !== this.x && fromNeighbor.y !== this.y) {
        return this.weight * 1.41421;
    }
    return this.weight;
};

GridNode.prototype.isWall = function() {
    return this.weight === 0;
};

function BinaryHeap(scoreFunction){
    this.content = [];
    this.scoreFunction = scoreFunction;
}

BinaryHeap.prototype = {
    push: function(element) {
        // Add the new element to the end of the array.
        this.content.push(element);

        // Allow it to sink down.
        this.sinkDown(this.content.length - 1);
    },
    pop: function() {
        // Store the first element so we can return it later.
        var result = this.content[0];
        // Get the element at the end of the array.
        var end = this.content.pop();
        // If there are any elements left, put the end element at the
        // start, and let it bubble up.
        if (this.content.length > 0) {
            this.content[0] = end;
            this.bubbleUp(0);
        }
        return result;
    },
    remove: function(node) {
        var i = this.content.indexOf(node);

        // When it is found, the process seen in 'pop' is repeated
        // to fill up the hole.
        var end = this.content.pop();

        if (i !== this.content.length - 1) {
            this.content[i] = end;

            if (this.scoreFunction(end) < this.scoreFunction(node)) {
                this.sinkDown(i);
            }
            else {
                this.bubbleUp(i);
            }
        }
    },
    size: function() {
        return this.content.length;
    },
    rescoreElement: function(node) {
        this.sinkDown(this.content.indexOf(node));
    },
    sinkDown: function(n) {
        // Fetch the element that has to be sunk.
        var element = this.content[n];

        // When at 0, an element can not sink any further.
        while (n > 0) {

            // Compute the parent element's index, and fetch it.
            var parentN = ((n + 1) >> 1) - 1, parent = this.content[parentN]; // jshint ignore:line
            // Swap the elements if the parent is greater.
            if (this.scoreFunction(element) < this.scoreFunction(parent)) {
                this.content[parentN] = element;
                this.content[n] = parent;
                // Update 'n' to continue at the new position.
                n = parentN;
            }
            // Found a parent that is less, no need to sink any further.
            else {
                break;
            }
        }
    },
    bubbleUp: function(n) {
        // Look up the target element and its score.
        var length = this.content.length,
            element = this.content[n],
            elemScore = this.scoreFunction(element);

        while(true) {
            // Compute the indices of the child elements.
            var child2N = (n + 1) << 1, child1N = child2N - 1; // jshint ignore:line
            // This is used to store the new position of the element, if any.
            var swap = null,
                child1Score;
            // If the first child exists (is inside the array)...
            if (child1N < length) {
                // Look it up and compute its score.
                var child1 = this.content[child1N];
                child1Score = this.scoreFunction(child1);

                // If the score is less than our element's, we need to swap.
                if (child1Score < elemScore){
                    swap = child1N;
                }
            }

            // Do the same checks for the other child.
            if (child2N < length) {
                var child2 = this.content[child2N],
                    child2Score = this.scoreFunction(child2);
                if (child2Score < (swap === null ? elemScore : child1Score)) {
                    swap = child2N;
                }
            }

            // If the element needs to be moved, swap it, and continue.
            if (swap !== null) {
                this.content[n] = this.content[swap];
                this.content[swap] = element;
                n = swap;
            }
            // Otherwise, we are done.
            else {
                break;
            }
        }
    }
};

return {
    astar: astar,
    Graph: Graph
};

});

},{}],"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\states\\boot.js":[function(require,module,exports){
var Boot = function () {};

module.exports = Boot;

Boot.prototype = {

  preload: function () {
    this.load.image('preloader', 'assets/images/preloader.gif');
  },

  create: function () {
    this.game.input.maxPointers = 1;

    if (this.game.device.desktop) {
      //this.game.stage.scale.pageAlignHorizontally = true;
      this.game.scale.scaleMode = Phaser.ScaleManager.RESIZE;
    } else {
      this.game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;
      this.game.scale.minWidth =  480;
      this.game.scale.minHeight = 260;
      this.game.scale.maxWidth = 640;
      this.game.scale.maxHeight = 480;
      this.game.scale.forceLandscape = true;
      this.game.scale.pageAlignHorizontally = true;
      this.game.scale.setScreenSize(true);
    }

    this.game.state.start('Preloader');
  }
};

},{}],"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\states\\game.js":[function(require,module,exports){
/*
Main testing environment.
*/

var Renderables = require('../functionAccess/Renderables');
var UIBuilder = require('../ui/UIBuilder');
// var Cube = require('../entities/cube');
var ModuleBuilder = require('../entities/ModuleBuilder');
// var Utils = require('../utils');
var CubeGroup = require('../entities/cube_group');
var Hackable = require('../entities/Hackable');
var Emitter = require('../effects/Emitter');
// var mouseBody; // physics body for mouse
var Mouse = require('../entities/mouse');
var Bullet = require('../entities/Bullet');

var bg, bg2;
var numRoids;
var maxRoids = 100;
var newModuleSpeed = 1000;
var asteroids, asteroidList;
var leftKey, rightKey, cwKey, ccwKey;
var warning;
var timer;
var shopPanel, shopMenuOpening = false, shopMenuClosing = false;
var diff;
var shieldButton, solarPanelButton, thrusterButton, gunButton, hackButton;

var Game = function () {
  this.testentity = null;
};

module.exports = Game;

Game.prototype = {
	
  create: function () {
	this.game.world.setBounds(0, 0, 8000, 4000);
	
	numRoids = 0;
	diff = 0;
	this.money = 500;
	
	//Create the two background images
    bg = this.game.add.sprite(0, 0, 'earthNight');
	bg2 = this.game.add.sprite(-8000, 0, 'earthNight');
	
	//Load in sound effects
	this.hoverClick = this.game.add.audio('hoverClick');
	this.downClick = this.game.add.audio('downClick');
	this.cashRegister = this.game.add.audio('cashRegister');
	this.cashRegister.allowMultiple = true;
	this.error = this.game.add.audio('error');
	
	//Set up physics
	this.game.physics.startSystem(Phaser.Physics.P2JS);
	this.game.physics.p2.setImpactEvents(true);
	//add collision group
	this.collisionGroup = this.game.physics.p2.createCollisionGroup();
	
	
	this.mouse = new Mouse(this.game, this.input);
   
	this.updateDependents = [];

	//create Renderables class
	this.renderables = new Renderables();
	//create the UIBuilder
	this.uiBuilder = new UIBuilder(this, this.renderables);   
	//create ModuleBuilder and store it in this game state object
	this.moduleBuilder = new ModuleBuilder(this);
	//create and store the core module
	this.coreModule = this.moduleBuilder.build('core', 1200, 1200, true);
	this.cubeWidth = this.coreModule.cube.width;
	this.cubeBuffer = 2;
	this.testVar = 7;
	var playerGroup = new CubeGroup(this, this.coreModule.cube);
	this.updateDependents.push(playerGroup);
	this.player = playerGroup;
	this.player.isPlayer = true;
   
	this.mouse = new Mouse(this.game, this.input, playerGroup);
	this.player.isPlayer = true;
	
	//Create the emitter for the binary particle effects
	this.BinaryEmitter = new Emitter(this);
	
	//test hackable object
	this.testHack = new Hackable(this, 1600, 1200, 'hackable1', 400);
	
	asteroids = this.game.add.group();
	asteroids.enableBody = true;
	asteroids.physicsBodyType = Phaser.Physics.P2JS;
	asteroidList = new Phaser.ArraySet();
	this.generateAsteroids();
	
	timer = this.game.time.create(false);
	warning = this.game.add.image(this.game.camera.x, this.game.camera.y, 'warning');
	warning.kill();
	
	leftKey = this.game.input.keyboard.addKey(Phaser.Keyboard.A);
	rightKey = this.game.input.keyboard.addKey(Phaser.Keyboard.D);
	ccwKey = this.game.input.keyboard.addKey(Phaser.Keyboard.Q);
	cwKey = this.game.input.keyboard.addKey(Phaser.Keyboard.E);
	
	this.shopKey = this.game.input.keyboard.addKey(Phaser.Keyboard.R);
	this.shopKey.onDown.add(this.useShopButton, this);
	
	//DEBUGGING LISTENERS- allow you to create modules by pressing keys
	/* Module debug buttons are broken and obsolete with the purchasing menu
	//core
	this.placeCoreKey = this.game.input.keyboard.addKey(Phaser.Keyboard.P);
	this.placeCoreKey.onDown.add(this.debugAddCore, this);
	//shield
	this.placeShieldKey = this.game.input.keyboard.addKey(Phaser.Keyboard.O);
    this.placeShieldKey.onDown.add(this.debugAddShield, this);
	//thruster
	this.placeThrusterKey = this.game.input.keyboard.addKey(Phaser.Keyboard.I);
    this.placeThrusterKey.onDown.add(this.debugAddThruster, this);
	//solarPanel
	this.placeSPKey = this.game.input.keyboard.addKey(Phaser.Keyboard.U);
    this.placeSPKey.onDown.add(this.debugAddSP, this);
	//hacker
	this.placeHackKey = this.game.input.keyboard.addKey(Phaser.Keyboard.Y);
	this.placeHackKey.onDown.add(this.debugAddHack, this);
	//gun
	this.placeGunKey = this.game.input.keyboard.addKey(Phaser.Keyboard.T);
<<<<<<< HEAD
    this.placeGunKey.onDown.add(this.debugAddGun, this);
=======
    this.placeGunKey.onDown.add(this.addGun, this);
	*/
>>>>>>> origin/gh-pages
	//reset game
	this.resetKey = this.game.input.keyboard.addKey(Phaser.Keyboard.M);
    this.resetKey.onDown.add(this.restartLevel, this);
	//add money
	this.addMoneyKey = this.game.input.keyboard.addKey(Phaser.Keyboard.K);
	this.addMoneyKey.onDown.add(this.addMoney, this);
	//END
    
    // Debug controller
    this.debugKey = this.game.input.keyboard.addKey(Phaser.Keyboard.H);
    this.debugKey.onDown.add(this.debug, this);

    this.levelData = JSON.parse(this.game.cache.getText('level_one'));
    this.loadData();
    
	//Buttons & Button Events
	shopPanel = this.game.add.image(this.game.camera.x + this.game.camera.width + 256 + 16, this.game.camera.y + 16, 'shopPanel');
	shopPanel.kill();
	shieldButton = this.game.add.button(this.game.camera.x + this.game.camera.width - diff, this.game.camera.y + 52 + (88 * 1), 'shieldButton', this.purchaseModule, {state: this, key: 'shield'}, 1, 0, 2);
	shieldButton.kill();
	shieldButton.onInputOver.add(this.playHoverClick, this);
	shieldButton.onInputDown.add(this.playDownClick, this);
	solarPanelButton = this.game.add.button(this.game.camera.x + this.game.camera.width - diff, this.game.camera.y + 52 + (88 * 2), 'solarPanelButton', this.purchaseModule, {state: this, key: 'solarPanel'}, 1, 0, 2);
	solarPanelButton.kill();
	solarPanelButton.onInputOver.add(this.playHoverClick, this);
	solarPanelButton.onInputDown.add(this.playDownClick, this);
	thrusterButton = this.game.add.button(this.game.camera.x + this.game.camera.width - diff, this.game.camera.y + 52 + (88 * 3), 'thrusterButton', this.purchaseModule, {state: this, key: 'thruster'}, 1, 0, 2);
	thrusterButton.kill();
	thrusterButton.onInputOver.add(this.playHoverClick, this);
	thrusterButton.onInputDown.add(this.playDownClick, this);
	gunButton = this.game.add.button(this.game.camera.x + this.game.camera.width - diff, this.game.camera.y + 52 + (88 * 4), 'gunButton', this.purchaseModule, {state: this, key: 'gun'}, 1, 0, 2);
	gunButton.kill();
	gunButton.onInputOver.add(this.playHoverClick, this);
	gunButton.onInputDown.add(this.playDownClick, this);
	hackButton = this.game.add.button(this.game.camera.x + this.game.camera.width - diff, this.game.camera.y + 52 + (88 * 5), 'hackButton', this.purchaseModule, {state: this, key: 'hack'}, 1, 0, 2);
	hackButton.kill();
	hackButton.onInputOver.add(this.playHoverClick, this);
	hackButton.onInputDown.add(this.playDownClick, this);
	this.game.camera.follow(this.coreModule.cube);
	this.shopButton = this.game.add.button(this.game.camera.x + this.game.camera.width - 48, 16, 'shopButton', this.useShopButton, this, 1, 0, 2);
	this.shopButton.onInputOver.add(this.playHoverClick, this);
	this.shopButton.onInputDown.add(this.playDownClick, this);
   
   this.juicy = this.game.plugins.add(new Phaser.Plugin.Juicy(this));
   this.game.camera.follow(this.coreModule.cube);
    
	this.helpBanner = this.uiBuilder.buildBanner(0.5, 0.5, 'tutorial_text');
	this.helpButton = this.game.add.button(0, 0, 'helpButton', this.helpBanner.toggle, this.helpBanner, 1, 0, 2);
	this.helpButton.onInputOver.add(this.playHoverClick, this);
	this.helpButton.onInputDown.add(this.playDownClick, this);
	
	this.moneyText = this.game.add.text(this.shopButton.x - 8, this.shopButton.y + 48, this.money);
    this.moneyText.font = 'VT323';
    this.moneyText.fontSize = 24;
    this.moneyText.fill = '#ffffff';
	this.be = this.game.add.image(this.moneyText.x + this.moneyText.width + 8, this.moneyText.y, 'be');
	
	this.mainSong = this.game.add.audio('mainSong', 1, true);
	this.mainSong.play('',0,1,true,true);
  },
  
  restartLevel: function() {
	this.mainSong.stop();
	this.game.state.start(playerState.currentLevel);
  },
  
  loadData: function() {
      var myLevel = this.levelData['level_one'];
      for (var key in myLevel) {
         if (myLevel.hasOwnProperty(key)) {
            var element = myLevel[key];
            if (element.hasOwnProperty('blueprint')) { // enemy type
               var enemyX = element['x_pos'];
               var enemyY = element['y_pos'];
               var enemyGroup = new CubeGroup(this, undefined);
               this.updateDependents.push(enemyGroup);
               var blueprint = element['blueprint'];
               for (var row = 0; row < blueprint.length; row++) {
                  for (var col = 0; col < blueprint[row].length; col++) {
                     var type = blueprint[row][col];
                     var newModule = this.moduleBuilder.build(type, enemyX + row * (this.cubeWidth + this.cubeBuffer),
                     enemyY - col * (this.cubeWidth + this.cubeBuffer), false);
                     newModule.cube.tag = 'enemy_module';
                     var point = new Phaser.Point(row, col);
                     enemyGroup.add(newModule.cube, point);
                  }
               }
               var aiType = element['type'];
               enemyGroup.giveAI(aiType, this.player);
            }
         }
      }
  },
  
	playHoverClick: function() {
		this.hoverClick.play();
	},
	
	playDownClick: function() {
		this.downClick.play();
	},
  
	useShopButton: function() {
		this.downClick.play();
		if(!shopPanel.alive && !shopMenuOpening && !shopMenuClosing) {
			shopPanel.revive();
			diff = 0;
			shopMenuOpening = true;
		}
		else if(shopPanel.alive&& !shopMenuClosing && !shopMenuOpening) {
			shopMenuClosing = true;
		}
	},
	
	addShopButtons: function() {
		shieldButton.revive();
		solarPanelButton.revive();
		thrusterButton.revive();
		gunButton.revive();
		hackButton.revive();
	},
	
	purchaseModule: function() {
		var randY = this.state.game.rnd.integerInRange(100, this.state.game.camera.height - 100);
		if(this.key === 'shield' && this.state.mouse.x > shieldButton.x && this.state.mouse.x < shieldButton.x + 256 && this.state.mouse.y > shieldButton.y && this.state.mouse.y < shieldButton.y + 82) {
			if(this.state.money >= 45) {
				this.state.addShield(this.state.game.camera.x + this.state.game.camera.width + 80, this.state.game.camera.y + randY);
				this.state.money -= 45;
				this.state.cashRegister.play();
			}
			else {
				this.state.error.play();
			}
		}
		else if(this.key === 'solarPanel' && this.state.mouse.x > solarPanelButton.x && this.state.mouse.x < solarPanelButton.x + 256 && this.state.mouse.y > solarPanelButton.y && this.state.mouse.y < solarPanelButton.y + 82) {
			if(this.state.money >= 105) {
				this.state.addSP(this.state.game.camera.x + this.state.game.camera.width + 80, this.state.game.camera.y + randY);
				this.state.money -= 105;
				this.state.cashRegister.play();
			}
			else {
				this.state.error.play();
			}
		}
		else if(this.key === 'thruster' && this.state.mouse.x > thrusterButton.x && this.state.mouse.x < thrusterButton.x + 256 && this.state.mouse.y > thrusterButton.y && this.state.mouse.y < thrusterButton.y + 82) {
			if(this.state.money >= 90) {
				this.state.addThruster(this.state.game.camera.x + this.state.game.camera.width + 80, this.state.game.camera.y + randY);
				this.state.money -= 90;
				this.state.cashRegister.play();
			}
			else {
				this.state.error.play();
			}
		}
		else if(this.key === 'gun' && this.state.mouse.x > gunButton.x && this.state.mouse.x < gunButton.x + 256 && this.state.mouse.y > gunButton.y && this.state.mouse.y < gunButton.y + 82) {
			if(this.state.money >= 120) {
				this.state.addGun(this.state.game.camera.x + this.state.game.camera.width + 80, this.state.game.camera.y + randY);
				this.state.money -= 120;
				this.state.cashRegister.play();
			}
			else {
				this.state.error.play();
			}
		}
		else if(this.key === 'hack' && this.state.mouse.x > hackButton.x && this.state.mouse.x < hackButton.x + 256 && this.state.mouse.y > hackButton.y && this.state.mouse.y < hackButton.y + 82) {
			if(this.state.money >= 200) {
				this.state.addHack(this.state.game.camera.x + this.state.game.camera.width + 80, this.state.game.camera.y + randY);
				this.state.money -= 200;
				this.state.cashRegister.play();
			}
			else {
				this.state.error.play();
			}
		}
		this.state.moneyText.text = this.state.money;
	},

  update: function () {
	if(leftKey.isDown) {
		if(this.coreModule.cube.body.angularVelocity > -9) { 
			this.coreModule.cube.body.angularForce += -7.5 * Math.pow(this.player.numCubes, 1.65);
		}
	}
	
	if(rightKey.isDown) {
		if(this.coreModule.cube.body.angularVelocity < 9) {
			this.coreModule.cube.body.angularForce += 7.5 * Math.pow(this.player.numCubes, 1.65);
		}
	}
	
	if(ccwKey.isDown) {
		if(this.mouse.grabbed !== undefined && this.mouse.grabbed.sprite.group === undefined) {
			this.mouse.grabbed.angularForce += -5;
		}
	}
	
	if(cwKey.isDown) {
		if(this.mouse.grabbed !== undefined && this.mouse.grabbed.sprite.group === undefined) {
			this.mouse.grabbed.angularForce += 5;
		}
	}
	
	this.mouse.update();
	this.scrollBG();
   
	for (var i = 0; i < this.updateDependents.length; i++) {
		if (this.updateDependents[i].update) {
			this.updateDependents[i].update();
		}
	}
	
	//Warning Code
	if(this.coreModule.cube.x + (Math.max(this.player.cubesWidth(), this.player.cubesHeight()) / 2 * 64) > 8000 ||
	this.coreModule.cube.x - (Math.max(this.player.cubesWidth(), this.player.cubesHeight()) / 2 * 64) < 0 ||
	this.coreModule.cube.y + (Math.max(this.player.cubesWidth(), this.player.cubesHeight()) / 2 * 64) > 4000 ||
	this.coreModule.cube.y - (Math.max(this.player.cubesWidth(), this.player.cubesHeight()) / 2 * 64) < 0) {
		if(timer.length === 0) {
			warning.revive();
			timer.loop(Phaser.Timer.SECOND * 5, this.resetPlayer, this);
			timer.start();
		}
	}
	else {
		if(warning.alive === true) {
			warning.kill();
		}
		if(timer.length > 0) {
			timer.stop(true);
		}
	}
	warning.x = this.game.camera.x;
	warning.y = this.game.camera.y;
	
	//Shop Movement Code
	if(shopMenuOpening === true) {	
		diff += 4;
		if(diff >= 276) {
			shopMenuOpening = false;
			this.addShopButtons();
		}
	}
	else if(shopMenuClosing === true) {
		diff -= 4;
		if(diff <= 0) {
			shopPanel.kill();
			shopMenuClosing = false;
		}
	}
	//Position Updates
	this.shopButton.x = this.game.camera.x + this.game.camera.width - 48 - diff;
	this.shopButton.y = this.game.camera.y + 16;
	this.helpButton.x = this.game.camera.x + 16;
	this.helpButton.y = this.game.camera.y + 16;
	shopPanel.x = this.game.camera.x + this.game.camera.width + 16 - diff;
	shopPanel.y = this.game.camera.y + 16;
	shieldButton.x = this.game.camera.x + this.game.camera.width + 16 - diff;
	shieldButton.y = this.game.camera.y + 70 + (86 * 0);
	solarPanelButton.x = this.game.camera.x + this.game.camera.width + 16 - diff;
	solarPanelButton.y = this.game.camera.y + 70 + (86 * 1);
	thrusterButton.x = this.game.camera.x + this.game.camera.width + 16 - diff;
	thrusterButton.y = this.game.camera.y + 70 + (86 * 2);
	gunButton.x = this.game.camera.x + this.game.camera.width + 16 - diff;
	gunButton.y = this.game.camera.y + 70 + (86 * 3);
	hackButton.x = this.game.camera.x + this.game.camera.width + 16 - diff;
	hackButton.y = this.game.camera.y + 70 + (86 * 4);
<<<<<<< HEAD
=======
	this.moneyText.x = this.shopButton.x - 16;
	this.moneyText.y = this.shopButton.y + 48;
	this.be.x = this.moneyText.x + this.moneyText.width + 8;
	this.be.y = this.moneyText.y;
   
   ////
   if (this.player.root) {
      for (var i = 0; i < this.lineTargets.length; i++) {
         if (!this.lineTargets[i]) {
            continue;
         }
         var pointA = new Phaser.Point(this.player.root.x, this.player.root.y);
         var pointB = new Phaser.Point(this.lineTargets[i].x, this.lineTargets[i].y);
         this.lines[i].setTo(pointA.x, pointA.y, pointB.x, pointB.y);
      }
   }
   ////
>>>>>>> origin/gh-pages
  },
  
  render: function () {
	this.mouse.render();
	this.renderables.renderAll();
  },
  
	scrollBG: function() {
		bg.x += 0.125;
		if(bg.x >= 8000) {
			bg.x = 0;
		}
		bg2.x += 0.125;
		if(bg2.x >= 8000) {
			bg2.x = 0;
		}
	},
	
	generateAsteroids: function() {
		for(;numRoids < maxRoids; numRoids++) {
			var randX = this.game.rnd.integerInRange(0, this.game.world.width);
			var randY = this.game.rnd.integerInRange(0, this.game.world.height);
			
			while(randX < this.coreModule.cube.x - (this.player.cubesWidth() / 2 + 100) && randX > this.coreModule.cube.x + (this.player.cubesWidth() / 2 + 100) &&
			randY < this.coreModule.cube.y - (this.player.cubesHeight() / 2 + 100) && randY > this.coreModule.cube.y + (this.player.cubesHeight() / 2 + 100)) {
				randX = this.game.rnd.integerInRange(0, this.game.world.width);
				randY = this.game.rnd.integerInRange(0, this.game.world.height);
			}
			
			var asteroid = asteroids.create(randX, randY, 'asteroid');
			
			asteroid.body.clearShapes(); 
			asteroid.body.loadPolygon('asteroidPolygon', 'asteroid'); //Change the collision detection from an AABB to a polygon
			asteroid.body.damping = this.game.rnd.realInRange(0, 0.3) * this.game.rnd.integerInRange(0, 1) * this.game.rnd.integerInRange(0, 1);
			asteroid.body.rotation = this.game.rnd.realInRange(0, 2 * Math.PI);
			asteroid.body.force.x = this.game.rnd.integerInRange(-10, 10) * 750;
			asteroid.body.force.y = this.game.rnd.integerInRange(-10, 10) * 750;
			asteroid.body.setCollisionGroup(this.collisionGroup);
			asteroid.body.collides(this.collisionGroup);
			asteroid.body.collideWorldBounds = false;
			asteroid.autoCull = true;
			asteroid.checkWorldBounds = true;
			asteroid.events.onOutOfBounds.add(this.resetAsteroid, {roid: asteroid, coreModule: this.coreModule, player: this.player, game: this.game});
			asteroidList.add(asteroid);
		}
	},
	
	resetAsteroid: function() {
		var randX = this.game.rnd.integerInRange(0, this.game.world.width);
		var randY = this.game.rnd.integerInRange(0, this.game.world.height);
			
		while(randX < this.coreModule.cube.x - (this.player.cubesWidth() / 2 + 100) && randX > this.coreModule.cube.x + (this.player.cubesWidth() / 2 + 100) &&
			randY < this.coreModule.cube.y - (this.player.cubesHeight() / 2 + 100) && randY > this.coreModule.cube.y + (this.player.cubesHeight() / 2 + 100)) {
				randX = this.game.rnd.integerInRange(0, this.game.world.width);
				randY = this.game.rnd.integerInRange(0, this.game.world.height);
		}
		this.roid.x = randX;
		this.roid.y = randY;
		this.roid.body.rotation = this.game.rnd.realInRange(0, 2 * Math.PI);
		this.roid.body.force.x = this.game.rnd.integerInRange(-10, 10) * 750;
		this.roid.body.force.y = this.game.rnd.integerInRange(-10, 10) * 750;
	},
	
	resetPlayer: function() {
		if(this.coreModule.cube.x + (Math.max(this.player.cubesWidth(), this.player.cubesHeight()) / 2 * 64) > 8000) {
			this.coreModule.cube.body.moveLeft(this.player.numCubes * 750);
		}
		if(this.coreModule.cube.x - (Math.max(this.player.cubesWidth(), this.player.cubesHeight()) / 2 * 64) < 0) {
			this.coreModule.cube.body.moveRight(this.player.numCubes * 750);
		}
		if(this.coreModule.cube.y + (Math.max(this.player.cubesWidth(), this.player.cubesHeight()) / 2 * 64) > 4000) {
			this.coreModule.cube.body.moveUp(this.player.numCubes * 750);
		}
		else if(this.coreModule.cube.y - (Math.max(this.player.cubesWidth(), this.player.cubesHeight()) / 2 * 64) < 0) {
			this.coreModule.cube.body.moveDown(this.player.numCubes * 750);
		}
	},
	
  //DEBUG FUNCTIONS- event functions called from listeners that allow you to create modules with key presses
  addCore: function (x, y) { 
	var newModule = this.moduleBuilder.build('core', x, y, true);
  },
  addShield: function (x, y) {
	var newModule = this.moduleBuilder.build('shield', x, y, true);
	newModule.cube.body.moveLeft(newModuleSpeed);
  },
  addThruster: function (x, y) {
	var newModule = this.moduleBuilder.build('thruster', x, y, true);
	//newModule.cube.body.setCollisionGroup(this.collisionGroup);
	//newModule.cube.body.collides(this.collisionGroup);
	newModule.cube.body.moveLeft(newModuleSpeed);
  },
  addSP: function (x, y) {
	var newModule = this.moduleBuilder.build('solarPanel', x, y, true);
	//newModule.cube.body.setCollisionGroup(this.collisionGroup);
	//newModule.cube.body.collides(this.collisionGroup);
	newModule.cube.body.moveLeft(newModuleSpeed);
  },
  addHack: function (x, y) {
	var newModule = this.moduleBuilder.build('hacker', x, y, true);
	//newModule.cube.body.setCollisionGroup(this.collisionGroup);
	//newModule.cube.body.collides(this.collisionGroup);
	newModule.cube.body.moveLeft(newModuleSpeed);
  },
  addGun: function (x, y) {
	var newModule = this.moduleBuilder.build('gun', x, y, true);
	//newModule.cube.body.setCollisionGroup(this.collisionGroup);
	//newModule.cube.body.collides(this.collisionGroup);
	newModule.cube.body.moveLeft(newModuleSpeed);
  },
  
	addMoney: function() {
		this.money += 100;
		this.moneyText.text = this.money;
		this.cashRegister.play();
	},
  
  debug: function () {
     
  },
  
  debugAddCore: function () { 
	this.moduleBuilder.build('core', this.mouse.x, this.mouse.y, true);
  },
  debugAddShield: function () {
	var grab = this.moduleBuilder.build('shield', this.mouse.x, this.mouse.y, true);
   grab.cube.body.rotation = Math.random() * 4 * Math.PI - 2 * Math.PI;
  },
  debugAddThruster: function () {
	this.moduleBuilder.build('thruster', this.mouse.x, this.mouse.y, true);
  },
  debugAddSP: function () {
	this.moduleBuilder.build('solarPanel', this.mouse.x, this.mouse.y, true);
  },
  debugAddHack: function () {
	this.moduleBuilder.build('hacker', this.mouse.x, this.mouse.y, true);
  },
  debugAddGun: function () {
	this.moduleBuilder.build('gun', this.mouse.x, this.mouse.y, true);
  },
};




























},{"../effects/Emitter":"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\effects\\Emitter.js","../entities/Bullet":"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\entities\\Bullet.js","../entities/Hackable":"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\entities\\Hackable.js","../entities/ModuleBuilder":"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\entities\\ModuleBuilder.js","../entities/cube_group":"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\entities\\cube_group.js","../entities/mouse":"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\entities\\mouse.js","../functionAccess/Renderables":"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\functionAccess\\Renderables.js","../ui/UIBuilder":"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\ui\\UIBuilder.js"}],"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\states\\menu.js":[function(require,module,exports){
var Menu = function () {
  this.text = null;
};

module.exports = Menu;

Menu.prototype = {
	
  pos: [-25, 25, 75],
  create: function () {
    var x = this.game.width / 2;
    var y = this.game.height / 2;
    
    this.title = this.add.image(this.world.centerX, this.world.centerY - 95, 'menu_title');
    this.title.anchor.setTo(0.5, 0.5);
    
    this.select = this.addButton(1, 'menu_select', this.changeToGame);
  	this.select.anchor.setTo(0.5, 0.5);
  	
  	this.manual = this.addButton(2, 'menu_manual', this.changeToMenu);
  	this.manual.anchor.setTo(0.5, 0.5);
  	
  	this.credits = this.addButton(3, 'menu_credits', this.changeToMenu);
  	this.credits.anchor.setTo(0.5, 0.5);
  },

  addButton: function(button, img, func){
    return this.add.button(this.world.centerX, this.world.centerY + this.pos[button - 1], img, func);
  },
  
  draw: function(){
  },
  
  changeToGame: function(){
  	this.game.state.start('Game');
  },  
  
  changeToMenu: function(){
  	this.game.state.start('Menu');
  },  
  /*
  changeState: function(state){
  	switch(state){
  		case 'game':
  			this.game.state.start('Game');
  			break;
  		case 'menu':
  			this.game.state.start('Menu');
  			break;
  		default:
  			break;
  	}
  },
  */
  update: function () {
  },

};

},{}],"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\states\\preloader.js":[function(require,module,exports){
var Preloader = function (game) {
  game = null;
  this.asset = null;
  this.ready = false;
};

module.exports = Preloader;

Preloader.prototype = {

  preload: function () {
    this.asset = this.add.sprite(640, 360, 'preloader');
    this.asset.anchor.setTo(0.5, 0.5);

    this.load.onLoadComplete.addOnce(this.onLoadComplete, this);
    this.load.setPreloadSprite(this.asset);
	
	//Load Spritesheets
	this.load.spritesheet('core', 'assets/images/coreSheet.png', 64, 64); 
	this.load.spritesheet('thruster', 'assets/images/thrusterSheet.png', 64, 64);
	this.load.spritesheet('gun', 'assets/images/gunSheet.png', 64, 64);
	this.load.spritesheet('hacker', 'assets/images/hackSheet.png', 64, 64);
	this.load.spritesheet('shieldButton', 'assets/images/shieldButtonSheet.png', 256, 82);
	this.load.spritesheet('solarPanelButton', 'assets/images/solarPanelButtonSheet.png', 256, 82);
	this.load.spritesheet('thrusterButton', 'assets/images/thrusterButtonSheet.png', 256, 82);
	this.load.spritesheet('gunButton', 'assets/images/gunButtonSheet.png', 256, 82);
	this.load.spritesheet('hackButton', 'assets/images/hackButtonSheet.png', 256, 82);
	this.load.spritesheet('hackable1', 'assets/images/hackable1.png', 256, 256);
	this.load.spritesheet('shopButton', 'assets/images/shopButtonSheet.png', 32, 32);
	
	//Load Images
	this.load.image('earthNight', 'assets/images/bg_earthNightSmall.jpg');
	this.load.image('bullet', 'assets/images/bullet.png');
	this.load.image('shield', 'assets/images/shield.png');
	this.load.image('solarPanel', 'assets/images/solarPanel.png');
	this.load.image('asteroid', 'assets/images/asteroid.png');
	this.load.image('shopPanel', 'assets/images/shopBackPanel.png');
	this.load.image('warning', 'assets/images/warning.png');
	this.load.image('be', 'assets/images/be.png');
    
	//Load Fonts
	this.load.script('webfont', '//ajax.googleapis.com/ajax/libs/webfont/1.4.7/webfont.js');
	
	//Load JSON Files
	this.load.atlasJSONHash('connections', 'assets/images/connections.png', 'assets/json/connections.json');
	this.load.atlasJSONHash('connections', 'assets/images/connections.png', 'assets/json/connections.json');
	this.load.atlasJSONHash('helpButton', 'assets/images/helpButtonSheet.png', 'assets/json/help_button.json');
	this.load.atlasJSONHash('arrowButton', 'assets/images/arrowButtonSheet.png', 'assets/json/arrow_button.json');
	this.load.physics('module_physics', 'assets/json/module_physics.json');
	this.load.physics('asteroidPolygon', 'assets/json/asteroidPolygon.json');
	this.load.text('level_one', 'assets/json/level_one.json');
	this.load.text('tutorial_text', 'assets/json/tutorial_text.json');
	
	//Load Sound Effects
	this.load.audio('downClick', 'assets/sound/downClick.ogg');
	this.load.audio('hoverClick', 'assets/sound/hoverClick.ogg');
	this.load.audio('error', 'assets/sound/error.ogg');
	
	this.load.text('tutorial_text', 'assets/json/tutorial_text.json');
	this.load.script('webfont', '//ajax.googleapis.com/ajax/libs/webfont/1.4.7/webfont.js');
	this.load.atlasJSONHash('helpButton', 'assets/images/helpButtonSheet.png', 'assets/json/help_button.json');
	this.load.atlasJSONHash('arrowButton', 'assets/images/arrowButtonSheet.png', 'assets/json/arrow_button.json');
	//menu buttons
	this.load.image('menu_title', 'assets/images/atic_menu_titleT.png');
	this.load.image('menu_select', 'assets/images/atic_menu_selectT.png');
	this.load.image('menu_manual', 'assets/images/atic_menu_manualT.png');
	this.load.image('menu_credits', 'assets/images/atic_menu_creditsT.png');

	this.load.audio('cashRegister', 'assets/sound/cashRegister.ogg');
	
	//Load Music
	//this.load.audio('menuSong', 'assets/sound/Yet Another.ogg');
	this.load.audio('mainSong', 'assets/sound/Top (down) Night.ogg');

  },

  create: function () {
    this.asset.cropEnabled = false;
  },

  update: function () {
    if (!!this.ready) {
      // this.game.state.start('Menu');
      this.game.state.start(playerState.currentLevel); // jshint ignore:line
    }
  },

  onLoadComplete: function () {
    this.ready = true;
  }
};

},{}],"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\states\\splash.js":[function(require,module,exports){
var Splash = function () {
};

module.exports = Splash;

Splash.prototype = {
  create: function () {
  }
};
},{}],"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\ui\\ProgressBar.js":[function(require,module,exports){
//NOTE: DON'T USE this code to create a ProgressBar. Instead, use the UIBuilder object and call buildProgressBar

var ProgressBar = function(setType, setMaxValue, setGraphics, setRenderables) {
	this.type = setType; //Two types, "growing" (starts at 0, triggers event when full) 
						 //and "shrinking" (starts full, triggers at 0)
	this.bgBorderSize = 2;			//default size of background border
	this.bgBorderColor = 0xAAAAAA;	//default color of background border
	this.bgColor = 0x888888;		//default color of background
	this.paddingHoriz = 5;			//default sum of padding on left and right side inner value bar
	this.paddingVert = 5;			//default sum (i.e. half on each side) of vertical padding of inner value bar
	this.valueBorderSize = 1;		//default size of value border
	this.valueBorderColor = 0x8888FF; //default color of value border
	this.valueColor = 0x000099;		//default color of inner value bar
	this.x = null;
	this.y = null;
	this.width = null;
	this.height = null;
	this.maxValue = setMaxValue;
	this.graphics = setGraphics; //store graphics class (used to draw bar)
	this.renderables = setRenderables;
	
	this.onEvent = function() {}; //overwrite this function to make whatever you want happen when progressBar reaches limit
	
	//switch(this.type) {
	//case 'growing' : 
	if(setType === 'growing') {
		this.value = 0;
		//tryTrigger is called automatically when you add/subtract value, and will trigger the onEvent() function
		this.tryTrigger = function() {
			if(this.value >= this.maxValue) {
				this.onEvent();
			}
		};
		//break;
	}
	else if(setType === 'shrinking') {
	//case 'shrinking' :
		this.value = this.maxValue;
		this.tryTrigger = function() {
			if(this.value <= 0) {
				this.onEvent();
			}
		};
	//}
	}
};

ProgressBar.prototype.constructor = ProgressBar;

ProgressBar.prototype.destroy = function() {
	this.graphics.clear();
	this.renderables.unsubscribe(this);
};

//To subtract value, just use negative numbers as argument i.e. foo.addValue(-5);
ProgressBar.prototype.addValue = function (addThis) {
	this.value += addThis;
	if(this.value > this.maxValue) {
		this.value = this.maxValue;
	}
	if(this.value < 0) {
		this.value = 0;
	}
	this.tryTrigger();
};

//Sets the location where progress bar is rendered
ProgressBar.prototype.setLocation = function(setX, setY) {
	this.x = setX;
	this.y = setY;
};

//Sets the size of the progress bar
ProgressBar.prototype.setSize = function(setWidth, setHeight) {
	this.width = setWidth;
	this.height = setHeight;
};

ProgressBar.prototype.setStyle = function(bgBorderSize, bgBorderColor, bgColor, paddingHoriz, paddingVert, valueBorderSize, valueBorderColor, valueColor) {
	this.bgBorderSize = bgBorderSize;
	this.bgBorderColor = bgBorderColor;
	this.bgColor = bgColor;
	this.paddingHoriz = paddingHoriz;
	this.paddingVert = paddingVert;
	this.valueBorderSize = valueBorderSize;
	this.valueBorderColor = valueBorderColor;
	this.valueColor = valueColor;
};

//update for progress bar, called just before drawing progress bar
//Overwrite this function if desired
ProgressBar.prototype.update = function() {};

//Renders progressBar
ProgressBar.prototype.render = function() {
	this.update();
	this.graphics.clear();
	//Draw background of bar
	this.graphics.lineStyle(this.bgBorderSize, this.bgBorderColor, 1); //sets border color and size
	this.graphics.beginFill(this.bgColor); //sets color of background fill
	this.graphics.drawRect(this.x-this.width/2, this.y-this.height/2, this.width, this.height);
	this.graphics.endFill();
	//Draw value of bar
	var percentage = this.value / this.maxValue;
	var barWidth = this.width - this.paddingHoriz;
	var barHeight = this.height - this.paddingVert;
	this.graphics.lineStyle(this.valueBorderSize, this.valueBorderColor, 1);
	this.graphics.beginFill(this.valueColor);
	this.graphics.drawRect(this.x-(barWidth/2), this.y-(barHeight/2), barWidth*percentage, barHeight);
	this.graphics.endFill();
};

module.exports = ProgressBar;
},{}],"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\ui\\UIBuilder.js":[function(require,module,exports){
var ProgressBar = require('./ProgressBar');
var Banner = require('./banner');

var UIBuilder = function(setGameState, setRenderables) {
	//Ensure that cannot create multiple instances of this class
	if(UIBuilder.prototype.exists) {
		return UIBuilder.prototype.existingReference;
	}
	
	this.gameState = setGameState;
	this.renderables = setRenderables;
	//Create and store a graphics object (used for stuff like drawing rectangles)
	UIBuilder.prototype.exists = true;
	UIBuilder.prototype.existingReference = this;
};

UIBuilder.prototype.constructor = UIBuilder;
//These var's help create the singleton functionality
UIBuilder.prototype.exists = false;
UIBuilder.prototype.existingReference = null;

//Use this function to create a progress bar
//Usage: type: can be "growing" or "shrinking", this will effect if bar starts at 0 and goes up or vis versa
//		 maxValue: sets the max value of the progress bar, i.e. using 100 creates a bar from 0 to 100
//		 x,y: sets location
//		 DON'T FORGET to overwrite the onEvent() function for the progress bar after creating it
//			-onEvent() is automatically called when bar fills/shrinks past limit (depending on bar type)
UIBuilder.prototype.buildProgressBar = function(type, x, y, width, height, maxValue) {
	//create and format new prog bar
	var graphics = this.gameState.game.add.graphics(0,0);
	var newProgBar = new ProgressBar(type, maxValue, graphics, this.renderables);
	newProgBar.setLocation(x,y);
	newProgBar.setSize(width, height);
	//subscribe to 'renderables' so that render() is called automatically
	this.renderables.subscribe(newProgBar);
	return newProgBar;
};

UIBuilder.prototype.buildBanner = function(xRatio, yRatio, texts) {
   var graphics = this.gameState.game.add.graphics(0, 0);
   var newBanner = new Banner(this.gameState, xRatio, yRatio, texts, graphics, this.renderables);
   this.renderables.subscribe(newBanner);
   return newBanner;
};

module.exports = UIBuilder;
},{"./ProgressBar":"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\ui\\ProgressBar.js","./banner":"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\ui\\banner.js"}],"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\ui\\banner.js":[function(require,module,exports){
var Utils = require('../utils');

//NOTE: DON'T USE this code to create a Banner. Instead, use the UIBuilder object and call buildBanner
var Banner = function(gameState, xRatio, yRatio, textJSON, graphics, renderables) {
   this.bgBorderSize = 6;			//default size of background border
	this.bgBorderColor = 0xffffff;	//default color of background border
	this.bgColor = 0x4a4a4a;		//default color of background
   this.shadowOffsetX = 3;
   this.shadowOffsetY = 3;
   this.shadowColor = 'rgba(0,0,0,0.9)';
   this.shadowBlur = 5;
   this.normalText = '#ffffff';
   this.highlightText = '#00ff00';
   this.textWrapPadding = 10;
   this.offScreenPadding = -200;
   this.textJSON = textJSON;
   this.gameState = gameState;
   this.game = gameState.game;
   this.cam = this.game.camera;
   this.xRatio = xRatio;
   this.yRatio = yRatio;
   this.graphics = graphics;
   this.renderables = renderables;
   this.width = 400;
   this.height = 200;
   this.index = 0;
   this.x = 0;
   this.hideBuffer = -50;
   this.hideHeight = -this.height - this.hideBuffer;
   this.y = this.cam.y - this.cam.height / 2 - this.hideHeight;
   this.slideY = 0;
   this.goalY = this.y;
   this.slideRate = 0.2;
   this.visible = false;
   // add buttons
   this.rightButton = this.game.add.button(0, 0, 'arrowButton', this.nextIndex, this, 1, 0, 2);
	this.rightButton.onInputOver.add(this.gameState.playHoverClick, this.gameState);
	this.rightButton.onInputDown.add(this.gameState.playDownClick, this.gameState);
   this.leftButton = this.game.add.button(0, 0, 'arrowButton', this.prevIndex, this, 1, 0, 2);
	this.leftButton.onInputOver.add(this.gameState.playHoverClick, this.gameState);
	this.leftButton.onInputDown.add(this.gameState.playDownClick, this.gameState);
   this.leftButton.scale.x = -1;
   this.group = new Phaser.Group(this.game);
   this.group.add(this.graphics);
   this.group.add(this.rightButton);
   this.group.add(this.leftButton);
   this.addTexts();
   this.game.world.bringToTop(this.group);
};

Banner.prototype.constructor = Banner;

Banner.prototype.destroy = function() {
	this.graphics.clear();
	this.renderables.unsubscribe(this);
};

Banner.prototype.update = function() {
   // TODO: add layer groups to other things
   this.game.world.bringToTop(this.group);
   // my pos
   this.x = this.cam.x + this.cam.width * this.xRatio;
   if (this.visible) {
      this.goalY = this.cam.height / 2;
   } else {
      this.goalY = this.hideHeight;
   }
   this.slideY = Utils.lerp(this.slideY, this.goalY, this.slideRate);
   this.y = this.cam.y + this.slideY;
   // text pos
   var curText = this.textObjs[this.index];
   curText.x = this.x;
   curText.y = this.y;
   // button pos
   this.rightButton.x = this.x + this.width / 2 + this.rightButton.width / 2;
   this.rightButton.y = this.y - this.rightButton.height / 2;
   this.leftButton.x = this.x - this.width / 2 + this.leftButton.width / 2;
   this.leftButton.y = this.y - this.leftButton.height / 2;
};

Banner.prototype.addTexts = function() {
   if (!this.textObs) {
      this.textObjs = [];
   }
   var textDefs = JSON.parse(this.game.cache.getText(this.textJSON));
   var textArray = textDefs['text'];
   var textColors = textDefs['colors'];
   for (var i = 0; i < textArray.length; i++) {
      var text = textArray[i];
      var newText = this.game.add.text(this.offScreenPadding, this.offScreenPadding, text);
      newText.font = 'Roboto';
      newText.fontSize = 24;
      newText.align = 'center';
      newText.fill = this.normalText;
      newText.wordWrap = true;
      newText.wordWrapWidth = this.width - this.textWrapPadding;
      newText.anchor.set(0.5);
      newText.setShadow(this.shadowOffsetX, this.shadowOffsetY, this.shadowColor, this.shadowBlur);
      var newColors = textColors[i];
      for (var j = 0; j < newColors.length; j++) {
         newText.addColor(this.highlightText, newColors[j]);
         j++;
         newText.addColor(this.normalText, newColors[j]);
      }
      this.textObjs.push(newText);
      this.group.add(newText);
   }
};

Banner.prototype.render = function() {
	this.update();
	this.graphics.clear();
	//Draw background
	this.graphics.lineStyle(this.bgBorderSize, this.bgBorderColor, 1); //sets border color and size
	this.graphics.beginFill(this.bgColor); //sets color of background fill
	this.graphics.drawRect(this.x-this.width/2, this.y-this.height/2, this.width, this.height);
	this.graphics.endFill();
};

Banner.prototype.show = function() {
   // this.goalY = this.cam.y + this.cam.height * this.yRatio;
   this.visible = true;
};

Banner.prototype.hide = function() {
   // this.goalY = this.hideHeight;
   this.visible = false;
};

Banner.prototype.toggle = function() {
  if (this.visible) {
     this.hide();
  } else {
     this.show();
  }  
};

Banner.prototype.hideCurText = function() {
  this.textObjs[this.index].x = this.textObjs[this.index].y = 0; 
};

Banner.prototype.nextIndex = function() {
   this.hideCurText();
   this.index++;
   if (this.index >= this.textObjs.length) {
      this.index = 0;
   }
};

Banner.prototype.prevIndex = function() {
   this.hideCurText();
   this.index--;
   if (this.index < 0) {
      this.index = this.textObjs.length - 1;
   }
};

module.exports = Banner;









},{"../utils":"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\utils.js"}],"c:\\Users\\CannpinCarl\\Documents\\CMPM20\\Above the Iron Curtain\\AboveTheIronCurtain\\src\\js\\utils.js":[function(require,module,exports){
/*
Collection of utility functions.
*/

var Utils = {
    containsObject: function(obj, list) {
        var i;
        for (i = 0; i < list.length; i++) {
            if (list[i] === obj) {
                return true;
            }
        }

        return false;
    },
    distance: function(x1, y1, x2, y2) {
       return Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2));
    },
    lerp: function(a, b, t) {
       if (t < 0 || t > 1) {
          console.log('bad range for Utils.lerp(), must be between 0 and 1');
          return 0;
       }
       return a + t * (b - a);
    }
};

module.exports = Utils;
},{}]},{},["./src/js/main.js"])
<<<<<<< HEAD
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlc1xcYnJvd3NlcmlmeVxcbm9kZV9tb2R1bGVzXFxicm93c2VyLXBhY2tcXF9wcmVsdWRlLmpzIiwic3JjL2pzL21haW4uanMiLCJzcmMvanMvZWZmZWN0cy9CaW5hcnlQYXJ0aWNsZS5qcyIsInNyYy9qcy9lZmZlY3RzL0VtaXR0ZXIuanMiLCJzcmMvanMvZW50aXRpZXMvQnVsbGV0LmpzIiwic3JjL2pzL2VudGl0aWVzL0hhY2thYmxlLmpzIiwic3JjL2pzL2VudGl0aWVzL01vZHVsZS5qcyIsInNyYy9qcy9lbnRpdGllcy9Nb2R1bGVCdWlsZGVyLmpzIiwic3JjL2pzL2VudGl0aWVzL2N1YmUuanMiLCJzcmMvanMvZW50aXRpZXMvY3ViZV9ncm91cC5qcyIsInNyYy9qcy9lbnRpdGllcy9lbmVteV9haS5qcyIsInNyYy9qcy9lbnRpdGllcy9tb3VzZS5qcyIsInNyYy9qcy9mdW5jdGlvbkFjY2Vzcy9SZW5kZXJhYmxlcy5qcyIsInNyYy9qcy9saWJzL2phdmFzY3JpcHQtYXN0YXIvYXN0YXIuanMiLCJzcmMvanMvc3RhdGVzL2Jvb3QuanMiLCJzcmMvanMvc3RhdGVzL2dhbWUuanMiLCJzcmMvanMvc3RhdGVzL21lbnUuanMiLCJzcmMvanMvc3RhdGVzL3ByZWxvYWRlci5qcyIsInNyYy9qcy9zdGF0ZXMvc3BsYXNoLmpzIiwic3JjL2pzL3VpL1Byb2dyZXNzQmFyLmpzIiwic3JjL2pzL3VpL1VJQnVpbGRlci5qcyIsInNyYy9qcy91aS9iYW5uZXIuanMiLCJzcmMvanMvdXRpbHMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDZEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0VBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNYQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDek9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0dBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdzQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyWkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNmQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDUkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsInZhciBnYW1lID0gbmV3IFBoYXNlci5HYW1lKHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaCwgUGhhc2VyLkFVVE8sICdhdGljLWdhbWUnKTtcclxuXHJcbndpbmRvdy5wbGF5ZXJTdGF0ZSA9IHtcclxuICAgIGN1cnJlbnRMZXZlbDogJ0dhbWUnXHJcbn07XHJcblxyXG4vLyAgVGhlIEdvb2dsZSBXZWJGb250IExvYWRlciB3aWxsIGxvb2sgZm9yIHRoaXMgb2JqZWN0LCBzbyBjcmVhdGUgaXQgYmVmb3JlIGxvYWRpbmcgdGhlIHNjcmlwdC5cclxuV2ViRm9udENvbmZpZyA9IHsgLy8ganNoaW50IGlnbm9yZTpsaW5lXHJcbiAgICAvLyAgVGhlIEdvb2dsZSBGb250cyB3ZSB3YW50IHRvIGxvYWQgKHNwZWNpZnkgYXMgbWFueSBhcyB5b3UgbGlrZSBpbiB0aGUgYXJyYXkpXHJcbiAgICBnb29nbGU6IHtcclxuICAgICAgZmFtaWxpZXM6IFsnUm9ib3RvOjpsYXRpbiddXHJcbiAgICB9XHJcbn07XHJcblxyXG5nYW1lLnN0YXRlLmFkZCgnQm9vdCcsIHJlcXVpcmUoJy4vc3RhdGVzL2Jvb3QnKSk7XHJcbmdhbWUuc3RhdGUuYWRkKCdTcGxhc2gnLCByZXF1aXJlKCcuL3N0YXRlcy9zcGxhc2gnKSk7XHJcbmdhbWUuc3RhdGUuYWRkKCdQcmVsb2FkZXInLCByZXF1aXJlKCcuL3N0YXRlcy9wcmVsb2FkZXInKSk7XHJcbmdhbWUuc3RhdGUuYWRkKCdNZW51JywgcmVxdWlyZSgnLi9zdGF0ZXMvbWVudScpKTtcclxuZ2FtZS5zdGF0ZS5hZGQoJ0dhbWUnLCByZXF1aXJlKCcuL3N0YXRlcy9nYW1lJykpO1xyXG5cclxuZ2FtZS5zdGF0ZS5zdGFydCgnQm9vdCcpOyIsInZhciBCaW5hcnlQYXJ0aWNsZSA9IGZ1bmN0aW9uKGdhbWUsIHRhcmdldE9iaiwgeCwgeSwgdGFyT2Zmc2V0WCwgdGFyT2Zmc2V0WSkge1xyXG5cdHZhciBzdHlsZSA9IHtmb250OiAnMjBweCBBdmFudCBHYXJkZScsIGZpbGw6ICcjRUVFRTMzJywgYWxpZ246ICdjZW50ZXInfTtcclxuXHR2YXIgYnl0ZVN5bWJvbCA9IE1hdGgucmFuZG9tKCkgPj0gMC41ID8gJzEnIDogJzAnO1xyXG5cdFBoYXNlci5UZXh0LmNhbGwodGhpcywgZ2FtZSwgeCwgeSwgYnl0ZVN5bWJvbCwgc3R5bGUpO1xyXG5cdGdhbWUuYWRkLmV4aXN0aW5nKHRoaXMpO1xyXG5cdHRoaXMudGFyZ2V0T2JqID0gdGFyZ2V0T2JqO1xyXG5cdHRoaXMuc3BlZWQgPSAzLjY7XHJcblx0dGhpcy50YXJPZmZzZXRYID0gdGFyT2Zmc2V0WDtcclxuXHR0aGlzLnRhck9mZnNldFkgPSB0YXJPZmZzZXRZO1xyXG59O1xyXG5cclxuQmluYXJ5UGFydGljbGUucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShQaGFzZXIuVGV4dC5wcm90b3R5cGUpO1xyXG5CaW5hcnlQYXJ0aWNsZS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBCaW5hcnlQYXJ0aWNsZTtcclxuXHJcbkJpbmFyeVBhcnRpY2xlLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHtcclxuXHQvL0dldCBkZWx0YSB2ZWN0b3IgdG8gdGFyZ2V0IG9iamVjdFxyXG5cdHZhciBkZWx0YSA9IFt0aGlzLnRhcmdldE9iai54ICsgdGhpcy50YXJPZmZzZXRYIC0gdGhpcy54LCB0aGlzLnRhcmdldE9iai55ICsgdGhpcy50YXJPZmZzZXRZIC0gdGhpcy55XTtcclxuXHQvL0dldCBkaXN0YW5jZSBhbmQgY2hlY2sgaWYgd2UndmUgcmVhY2hlZCB0YXJnZXQgZGlzdGFuY2VcclxuXHR2YXIgZGlzdCA9IE1hdGguc3FydChNYXRoLnBvdyhkZWx0YVswXSwgMikgKyBNYXRoLnBvdyhkZWx0YVsxXSwgMikpO1xyXG5cdGlmKGRpc3QgPD0gdGhpcy5zcGVlZCkge1xyXG5cdFx0dGhpcy5kZXN0cm95KCk7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cdC8vTm9ybWFsaXplIGRlbHRhIHZlY3RvclxyXG5cdGRlbHRhID0gW2RlbHRhWzBdL2Rpc3QsIGRlbHRhWzFdL2Rpc3RdO1xyXG5cdC8vVXBkYXRlIHBvc2l0aW9uXHJcblx0dGhpcy54ID0gdGhpcy54ICsgdGhpcy5zcGVlZCpkZWx0YVswXTtcclxuXHR0aGlzLnkgPSB0aGlzLnkgKyB0aGlzLnNwZWVkKmRlbHRhWzFdO1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBCaW5hcnlQYXJ0aWNsZTsiLCJ2YXIgQmluYXJ5UGFydGljbGUgPSByZXF1aXJlKCcuL0JpbmFyeVBhcnRpY2xlJyk7XHJcblxyXG52YXIgRW1pdHRlciA9IGZ1bmN0aW9uKGdhbWVTdGF0ZSkge1xyXG5cdHRoaXMuZ2FtZVN0YXRlID0gZ2FtZVN0YXRlO1xyXG59O1xyXG5cclxuRW1pdHRlci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBFbWl0dGVyO1xyXG5cclxuRW1pdHRlci5wcm90b3R5cGUuZW1pdEJpbmFyeSA9IGZ1bmN0aW9uICh0YXJnZXRPYmosIHgsIHksIHNwYWNpbmcpIHtcclxuXHR2YXIgb2Zmc2V0WCA9IChNYXRoLnJhbmRvbSgpLTAuNSkqc3BhY2luZztcclxuXHR2YXIgb2Zmc2V0WSA9IChNYXRoLnJhbmRvbSgpLTAuNSkqc3BhY2luZztcclxuXHR2YXIgbmV3UGFydGljbGUgPSBuZXcgQmluYXJ5UGFydGljbGUodGhpcy5nYW1lU3RhdGUuZ2FtZSwgdGFyZ2V0T2JqLCB4LCB5LCBvZmZzZXRYLCBvZmZzZXRZKTtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gRW1pdHRlcjsiLCIvL0J1bGxldHMgYXJlIHRhZ2dlZCBhcyAncGxheWVyQnVsbGV0JyBvciAnZW5lbXlCdWxsZXQnXHJcbnZhciBCdWxsZXQgPSBmdW5jdGlvbihnYW1lU3RhdGUsIHgsIHksIGRpcmVjdGlvbiwgaW5oZXJ0aXRTcGVlZCwgdGFnKSB7XHJcbiAgICBQaGFzZXIuU3ByaXRlLmNhbGwodGhpcywgZ2FtZVN0YXRlLmdhbWUsIHgsIHksICdidWxsZXQnKTtcclxuXHR0aGlzLmRpcmVjdGlvbiA9IGRpcmVjdGlvbjsgLy9Vbml0IHZlY3RvciByZXByZXNlbnRpbmcgZGlyZWN0aW9uIGJ1bGxldCBpcyB0cmF2ZWxsaW5nO1xyXG5cdHRoaXMuc3BlZWQgPSAzMDAgKyBpbmhlcnRpdFNwZWVkO1x0XHRcdFx0Ly9TcGVlZCBidWxsZXQgaXMgdHJhdmVsbGluZztcclxuXHR0aGlzLnRhZyA9IHRhZztcclxuXHR0aGlzLmdhbWUgPSBnYW1lU3RhdGUuZ2FtZTtcclxuXHR0aGlzLmdhbWUuYWRkLmV4aXN0aW5nKHRoaXMpO1xyXG5cdHRoaXMubGlmZVRpbWUgPSAzMDA7XHJcblx0dmFyIHNjYWxlID0gMC41O1xyXG5cdHRoaXMuc2NhbGUueCA9IHNjYWxlO1xyXG5cdHRoaXMuc2NhbGUueSA9IHNjYWxlO1xyXG5cdHRoaXMuYW5jaG9yLnNldFRvKDAuNSwgMC41KTtcclxuXHRcclxuXHQvL3NldCBwaHlzaWNzXHJcblx0Z2FtZVN0YXRlLmdhbWUucGh5c2ljcy5wMi5lbmFibGUodGhpcyk7XHJcblx0dGhpcy5ib2R5LnNldENvbGxpc2lvbkdyb3VwKGdhbWVTdGF0ZS5jb2xsaXNpb25Hcm91cCk7XHJcblx0dGhpcy5ib2R5LmNvbGxpZGVzKGdhbWVTdGF0ZS5jb2xsaXNpb25Hcm91cCk7XHJcblx0Ly9TZXQgcHJvcGVyIGNvbGxpc2lvbiBmdW5jdGlvbiBieSBkZXRlcm1pbmluZyB0eXBlIGZyb20gJ3RhZydcclxuXHRpZih0aGlzLnRhZyA9PT0gJ2VuZW15QnVsbGV0Jykge1xyXG5cdFx0dGhpcy5jb2xsaXNpb24gPSBmdW5jdGlvbihvdGhlcikge1xyXG5cdFx0XHRpZihvdGhlci5zcHJpdGUudGFnID09PSAnbW9kdWxlJykge1xyXG5cdFx0XHRcdG90aGVyLnNwcml0ZS50YWtlRGFtYWdlKDAuNSk7XHJcblx0XHRcdH1cclxuXHRcdFx0dGhpcy5kZXN0cm95KCk7XHJcblx0XHR9O1xyXG5cdH1cclxuXHRlbHNlIGlmKHRoaXMudGFnID09PSAncGxheWVyQnVsbGV0Jykge1xyXG5cdFx0dGhpcy5jb2xsaXNpb24gPSBmdW5jdGlvbihvdGhlcikge1xyXG5cdFx0XHRpZihvdGhlcikge1xyXG5cdFx0XHRcdGlmKG90aGVyLnNwcml0ZSl7XHJcblx0XHRcdFx0XHRpZihvdGhlci5zcHJpdGUudGFnKSB7XHJcblx0XHRcdFx0XHRcdGlmKG90aGVyLnNwcml0ZS50YWcgPT09ICdlbmVteV9tb2R1bGUnKSB7XHJcblx0XHRcdFx0XHRcdFx0b3RoZXIuc3ByaXRlLnRha2VEYW1hZ2UoMC41KTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHR0aGlzLmRlc3Ryb3koKTtcclxuXHRcdH07XHJcblx0fVxyXG5cdHRoaXMuYm9keS5vbkJlZ2luQ29udGFjdC5hZGQodGhpcy5jb2xsaXNpb24sIHRoaXMpO1xyXG5cdHRoaXMuYm9keS5zZXRaZXJvRGFtcGluZygpO1xyXG5cdHRoaXMuYm9keS5tYXNzID0gMC4xO1xyXG5cdHRoaXMuYm9keS52ZWxvY2l0eS54ID0gZGlyZWN0aW9uWzBdKnRoaXMuc3BlZWQ7XHJcblx0dGhpcy5ib2R5LnZlbG9jaXR5LnkgPSBkaXJlY3Rpb25bMV0qdGhpcy5zcGVlZDtcclxufTtcclxuXHJcbkJ1bGxldC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBoYXNlci5TcHJpdGUucHJvdG90eXBlKTtcclxuQnVsbGV0LnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IEJ1bGxldDtcclxuXHJcbkJ1bGxldC5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7LypcclxuXHR0aGlzLnggKz0gdGhpcy5kaXJlY3Rpb25bMF0gKiB0aGlzLnNwZWVkO1xyXG5cdHRoaXMueSArPSB0aGlzLmRpcmVjdGlvblsxXSAqIHRoaXMuc3BlZWQ7XHJcblx0Ly90aGlzLmxpZmVUaW1lLS07XHJcblx0aWYodGhpcy5saWZlVGltZSA8PSAwKSB7XHJcblx0XHQvL1RPRE8gZGVzdHJveSBidWxsZXRcclxuXHR9Ki9cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gQnVsbGV0OyIsIi8qXHJcbkRlZmluZXMgYSBoYWNrYWJsZSBvYmplY3QuXHJcbiovXHJcblxyXG52YXIgSGFja2FibGUgPSBmdW5jdGlvbiAoZ2FtZVN0YXRlLCB4LCB5LCBzcHJpdGUsIGhhY2tEaXN0YW5jZSkge1xyXG4gICBQaGFzZXIuU3ByaXRlLmNhbGwodGhpcywgZ2FtZVN0YXRlLmdhbWUsIHgsIHksIHNwcml0ZSk7XHJcbiAgIGdhbWVTdGF0ZS5nYW1lLmFkZC5leGlzdGluZyh0aGlzKTtcclxuXHQvL3N0b3JlIGdhbWVTdGF0ZVxyXG5cdHRoaXMuZ2FtZVN0YXRlID0gZ2FtZVN0YXRlO1xyXG5cdC8vc2V0IGlzSGFja2VkIHRvIGZhbHNlXHJcblx0dGhpcy5pc0hhY2tlZCA9IGZhbHNlO1xyXG5cdC8vYWRkIGhhY2tCYXJcclxuXHR0aGlzLmhhY2tCYXIgPSBnYW1lU3RhdGUudWlCdWlsZGVyLmJ1aWxkUHJvZ3Jlc3NCYXIoJ2dyb3dpbmcnLCAxNTAwLCAxMjAwLCAxMDAsIDEwLCAgMjAwKTtcclxuXHR0aGlzLmhhY2tCYXIuc2V0U3R5bGUoMCwgMHhGRkZGRkYsIDB4MzYzNjM2LCAwLCAwLCAwLCAweEZGRkZGRiwgMHgyMDIwQ0MpO1xyXG5cdHRoaXMuaGFja0Jhci5oYWNrYWJsZSA9IHRoaXM7XHJcblx0dGhpcy5oYWNrQmFyLm9uRXZlbnQgPSBmdW5jdGlvbigpIHtcclxuXHRcdHRoaXMuaGFja2FibGUuZnJhbWUgPSAxO1xyXG5cdFx0dGhpcy5oYWNrYWJsZS5pc0hhY2tlZCA9IHRydWU7XHJcblx0XHR0aGlzLmRlc3Ryb3koKTtcclxuXHR9O1xyXG5cdHRoaXMudGFnID0gJ25ldXRyYWxPYmonO1x0Ly9UYWcgaXMgdXNlZCB0byBpZGVudGlmeSBvYmplY3QgdHlwZSBkdXJpbmcgY29sbGlzaW9uIGNoZWNraW5nXHJcblx0dGhpcy5oYWNrRGlzdGFuY2UgPSBoYWNrRGlzdGFuY2U7XHJcblx0dmFyIHNjYWxlID0gMC41O1xyXG4gICB0aGlzLnNjYWxlLnggPSBzY2FsZTtcclxuICAgdGhpcy5zY2FsZS55ID0gc2NhbGU7XHJcbiAgIHRoaXMuYW5jaG9yLnNldFRvKDAuNSwgMC41KTtcclxuICAgXHJcbiAgIC8vU2V0IHVwIHBoeXNpY3MgYm9keSBmb3IgJ2hhY2thYmxlJyBzcHJpdGVcclxuICAgZ2FtZVN0YXRlLmdhbWUucGh5c2ljcy5wMi5lbmFibGUodGhpcyk7XHJcbiAgIHRoaXMuYm9keS5zZXRDb2xsaXNpb25Hcm91cChnYW1lU3RhdGUuY29sbGlzaW9uR3JvdXApO1xyXG5cdHRoaXMuYm9keS5jb2xsaWRlcyhnYW1lU3RhdGUuY29sbGlzaW9uR3JvdXApO1xyXG4gICB0aGlzLmJvZHkub25CZWdpbkNvbnRhY3QuYWRkKHRoaXMuY3ViZUNvbGxpZGUsIHRoaXMpO1xyXG4gICB0aGlzLmJvZHkuZGFtcGluZyA9IDAuOTtcclxuICAgdGhpcy5ib2R5LmFuZ3VsYXJEYW1waW5nID0gMC45O1xyXG59O1xyXG5cclxuSGFja2FibGUucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShQaGFzZXIuU3ByaXRlLnByb3RvdHlwZSk7XHJcbkhhY2thYmxlLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IEhhY2thYmxlO1xyXG5cclxuLyoqXHJcbiAqIEF1dG9tYXRpY2FsbHkgY2FsbGVkIGJ5IFdvcmxkLnVwZGF0ZVxyXG4gKi9cclxuSGFja2FibGUucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkge1xyXG5cdHRoaXMuaGFja0Jhci5zZXRMb2NhdGlvbih0aGlzLngsIHRoaXMueSAtIDcwKTtcclxuXHQvL2NoZWNrIGlmIGdldHRpbmcgaGFja2VkXHJcblx0aWYoIXRoaXMuaXNIYWNrZWQpIHtcclxuXHRcdGlmKHRoaXMuZ2FtZVN0YXRlLnBsYXllci5hY3RpdmVIYWNrZXJNb2R1bGVzLmxlbmd0aCA+IDApIHtcclxuXHRcdFx0dmFyIGRpc3Q7XHJcblx0XHRcdHZhciBoYWNrZXI7XHJcblx0XHRcdC8vTG9vcCB0aHJvdWdoIGFsbCBoYWNrZXIgbW9kdWxlcyBvbiB0aGUgcGxheWVyJ3MgY3Vic2F0XHJcblx0XHRcdGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIuYWN0aXZlSGFja2VyTW9kdWxlcy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdGhhY2tlciA9IHRoaXMuZ2FtZVN0YXRlLnBsYXllci5hY3RpdmVIYWNrZXJNb2R1bGVzW2ldO1xyXG5cdFx0XHRcdGRpc3QgPSBNYXRoLnNxcnQoIE1hdGgucG93KHRoaXMueCAtIGhhY2tlci5jdWJlLngsIDIpICsgTWF0aC5wb3codGhpcy55IC0gaGFja2VyLmN1YmUueSwgMikgKTtcclxuXHRcdFx0XHRpZihkaXN0IDwgdGhpcy5oYWNrRGlzdGFuY2UpIHtcclxuXHRcdFx0XHRcdC8vSWYgaGFja2VyIGlzIGluIHJhbmdlLCBpbmNyZWFzZSBoYWNrIHZhbHVlIGFuZCB0cnkgdG8gZW1pdCBiaW5hcnkgcGFydGljbGVcclxuXHRcdFx0XHRcdHRoaXMuaGFja0Jhci5hZGRWYWx1ZSgwLjA1KTtcclxuXHRcdFx0XHRcdGhhY2tlci5jb3VudCsrO1xyXG5cdFx0XHRcdFx0aGFja2VyLmN1YmUuYW5pbWF0aW9ucy5wbGF5KCdoYWNrZXInKTtcclxuXHRcdFx0XHRcdGlmKGhhY2tlci5jb3VudCA+PSBoYWNrZXIuY3ljbGUpIHtcclxuXHRcdFx0XHRcdFx0aGFja2VyLmNvdW50ID0gMDtcclxuXHRcdFx0XHRcdFx0dGhpcy5nYW1lU3RhdGUuQmluYXJ5RW1pdHRlci5lbWl0QmluYXJ5KHRoaXMsIGhhY2tlci5jdWJlLngsIGhhY2tlci5jdWJlLnksIDYwKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0XHRoYWNrZXIuY3ViZS5hbmltYXRpb25zLnN0b3AoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcbn07XHJcblxyXG5cclxuSGFja2FibGUucHJvdG90eXBlLmN1YmVDb2xsaWRlID0gZnVuY3Rpb24ob3RoZXIpIHtcclxuLyogICBpZiAodGhpcy5ncm91cCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgfVxyXG4gICB0aGlzLmdyb3VwLmhhbmRsZUNvbGxpc2lvbih0aGlzLCBvdGhlci5zcHJpdGUpOyovXHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEhhY2thYmxlOyIsIi8vRG9uJ3QgdXNlIHRoaXMgZnVuY3Rpb24gdG8gY3JlYXRlIG1vZHVsZXMsIGluc3RlYWQgdXNlIG1vZHVsZUJ1aWxkZXIoKVxyXG52YXIgTW9kdWxlID0gZnVuY3Rpb24oc2V0VHlwZSwgc2V0Q3ViZSwgc2V0R2FtZVN0YXRlKSB7XHJcblx0dGhpcy5pc0FjdGl2ZSA9IGZhbHNlO1xyXG5cdHRoaXMudHlwZSA9IHNldFR5cGU7XHJcblx0dGhpcy5jdWJlID0gc2V0Q3ViZTtcclxuXHRzZXRDdWJlLm1vZHVsZSA9IHRoaXM7XHJcblx0dGhpcy5nYW1lU3RhdGUgPSBzZXRHYW1lU3RhdGU7XHJcbn07XHJcblxyXG5Nb2R1bGUucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gTW9kdWxlO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBNb2R1bGU7IiwidmFyIEN1YmUgPSByZXF1aXJlKCcuL2N1YmUnKTtcclxudmFyIE1vZHVsZSA9IHJlcXVpcmUoJy4vTW9kdWxlJyk7XHJcbnZhciBCdWxsZXQgPSByZXF1aXJlKCcuL0J1bGxldCcpO1xyXG5cclxudmFyIHRocnVzdEFtdCA9IDUwMDA7XHJcblxyXG4vL1VzZSB0aGlzIHRvIGNyZWF0ZSBhIG1vZHVsZUJ1aWxkZXItIG9ubHkgbmVlZCB0byBjcmVhdGUgb25lIGluc3RhbmNlIG9mIGl0XHJcbnZhciBNb2R1bGVCdWlsZGVyID0gZnVuY3Rpb24oc2V0R2FtZVN0YXRlLCBzZXRDb2xHcm91cCkge1xyXG5cdC8vRW5zdXJlIHRoYXQgY2Fubm90IGNyZWF0ZSBtdWx0aXBsZSBpbnN0YW5jZXMgb2YgdGhpcyBjbGFzc1xyXG5cdGlmKE1vZHVsZUJ1aWxkZXIucHJvdG90eXBlLmV4aXN0cykge1xyXG5cdFx0cmV0dXJuIE1vZHVsZUJ1aWxkZXIucHJvdG90eXBlLmV4aXN0aW5nUmVmZXJlbmNlO1xyXG5cdH1cclxuXHRcdFxyXG5cdHRoaXMuZ2FtZVN0YXRlID0gc2V0R2FtZVN0YXRlO1xyXG4gICB0aGlzLmNvbEdyb3VwID0gc2V0Q29sR3JvdXA7XHJcblx0Ly8gdGhpcy5jb3JlRXhpc3RzID0gZmFsc2U7XHQvL3JlY29yZHMgaWYgY29yZSBoYXMgYmVlbiBjcmVhdGVkXHJcblx0dGhpcy5jb3JlID0gbnVsbDtcdFx0XHQvL3N0b3JlcyBjb3JlIHdoZW4gaXQgaXMgY3JlYXRlZFxyXG5cdC8vdmFyIHNwYWNlID0gdGhpcy5nYW1lU3RhdGUuaW5wdXQua2V5Ym9hcmQuYWRkS2V5KFBoYXNlci5LZXlib2FyZC5TUEFDRUJBUik7XHJcblx0TW9kdWxlQnVpbGRlci5wcm90b3R5cGUuZXhpc3RzID0gdHJ1ZTtcclxuXHRNb2R1bGVCdWlsZGVyLnByb3RvdHlwZS5leGlzdGluZ1JlZmVyZW5jZSA9IHRoaXM7XHJcbn07XHJcblxyXG5Nb2R1bGVCdWlsZGVyLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IE1vZHVsZUJ1aWxkZXI7XHJcblxyXG4vL1RoZXNlIHZhcidzIGhlbHAgY3JlYXRlIHRoZSBzaW5nbGV0b24gZnVuY3Rpb25hbGl0eVxyXG5Nb2R1bGVCdWlsZGVyLnByb3RvdHlwZS5leGlzdHMgPSBmYWxzZTtcclxuTW9kdWxlQnVpbGRlci5wcm90b3R5cGUuZXhpc3RpbmdSZWZlcmVuY2UgPSBudWxsO1xyXG5cclxuLyoqIE1vZHVsZSBmdW5jdGlvbnMgKiovXHJcbmZ1bmN0aW9uIHNvbGFyUGFuZWxHaXZlVGFyZ2V0KHRhcmdldCkge1xyXG5pZiAodGhpcyA9PT0gdGFyZ2V0IHx8ICF0aGlzLmN1YmUuZ3JvdXAgfHwgIXRhcmdldC5jdWJlLmdyb3VwIHx8IHRoaXMuY3ViZS5ncm91cCAhPT0gdGFyZ2V0LmN1YmUuZ3JvdXApIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICB9XHJcbiAgIHZhciBvdXJHcm91cCA9IHRoaXMuY3ViZS5ncm91cDtcclxuICAgdmFyIG5ld0Nvbm5lY3Rpb24gPSB7c3RhcnQ6IHRoaXMuY3ViZSwgZW5kOiB0YXJnZXQuY3ViZX07XHJcbiAgIHRoaXMuY3ViZS5teUNvbm5lY3Rpb24gPSBuZXdDb25uZWN0aW9uO1xyXG4gICB0YXJnZXQuY3ViZS5teUNvbm5lY3Rpb24gPSBuZXdDb25uZWN0aW9uO1xyXG4gICBvdXJHcm91cC5kaXNwbGF5Q29ubmVjdGlvbih0aGlzLmN1YmUubXlDb25uZWN0aW9uKTtcclxuICAgXHJcblx0aWYoIXRhcmdldC5pc0FjdGl2ZSkge1xyXG5cdFx0Ly9BY3RpdmF0ZSB0aGUgbW9kdWxlXHJcblx0XHR0YXJnZXQuaXNBY3RpdmUgPSB0cnVlO1xyXG5cdFx0aWYodGFyZ2V0LnR5cGUgPT09ICdndW4nKSB7XHJcblx0XHRcdG91ckdyb3VwLmFjdGl2ZUd1bnMucHVzaCh0YXJnZXQpO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSBpZih0YXJnZXQudHlwZSA9PT0gJ2hhY2tlcicpIHtcclxuXHRcdFx0b3VyR3JvdXAuYWN0aXZlSGFja2VyTW9kdWxlcy5wdXNoKHRhcmdldCk7XHJcblx0XHR9XHJcblx0fVxyXG59XHJcblxyXG5mdW5jdGlvbiBzb2xhclBhbmVsTW91c2VPdmVyKCkge1xyXG4gICBpZiAoIXRoaXMuY3ViZS5teUNvbm5lY3Rpb24gfHwgIXRoaXMuY3ViZS5ncm91cCkge1xyXG4gICAgICByZXR1cm47XHJcbiAgIH1cclxuICAgdGhpcy5jdWJlLmdyb3VwLmRpc3BsYXlDb25uZWN0aW9uKHRoaXMuY3ViZS5teUNvbm5lY3Rpb24pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzb2xhclBhbmVsT25SZW1vdmUoKSB7XHJcbiAgIGlmICghdGhpcy5jdWJlLm15Q29ubmVjdGlvbiB8fCAhdGhpcy5jdWJlLm15Q29ubmVjdGlvbi5lbmQpIHtcclxuICAgICAgY29uc29sZS5sb2coJ3NvbGFyUGFuZWxPblJlbW92ZSgpIGhhZCBhbiBlcnJvcicpO1xyXG4gICAgICByZXR1cm47XHJcbiAgIH1cclxuICAgdGhpcy5jdWJlLm15Q29ubmVjdGlvbi5lbmQubXlDb25uZWN0aW9uID0gdW5kZWZpbmVkO1xyXG4gICB0aGlzLmN1YmUubXlDb25uZWN0aW9uID0gdW5kZWZpbmVkO1xyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gYmVnaW5BY3QoKSB7XHJcbiAgIHRoaXMudGltZXIgPSAwO1xyXG4gICB0aGlzLmFjdCA9IHRydWU7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGVuZEFjdCgpIHtcclxuICAgdGhpcy5hY3QgPSBmYWxzZTtcclxuICAgdGhpcy5jdWJlLmZyYW1lID0gMDtcclxufVxyXG5cclxuZnVuY3Rpb24gdGhydXN0ZXJVcGRhdGUoKSB7XHJcbiAgIGlmICh0aGlzLmhhbHRUaW1lICYmIHRoaXMuaGFsdFRpbWUgPiAwKSB7XHJcbiAgICAgIHRoaXMuaGFsdFRpbWUgLT0gdGhpcy5jdWJlLmdhbWUudGltZS5lbGFwc2VkO1xyXG4gICAgICB0aGlzLmN1YmUuZnJhbWUgPSAwO1xyXG4gICB9IGVsc2UgaWYgKHRoaXMuYWN0ICYmIHRoaXMuY3ViZS5teUNvbm5lY3Rpb24pIHtcclxuICAgICAgdGhpcy5jdWJlLmJvZHkuZm9yY2UueCA9IHRocnVzdEFtdCAqIE1hdGguY29zKHRoaXMuY3ViZS5yb3RhdGlvbiAtIE1hdGguUEkgLyAyKTtcclxuICAgICAgdGhpcy5jdWJlLmJvZHkuZm9yY2UueSA9IHRocnVzdEFtdCAqIE1hdGguc2luKHRoaXMuY3ViZS5yb3RhdGlvbiAtIE1hdGguUEkgLyAyKTtcclxuXHQgIGlmKHRoaXMuY3ViZS5mcmFtZSA9PT0gMSkge1xyXG5cdFx0dGhpcy5jdWJlLmZyYW1lID0gMjtcclxuXHQgIH1cclxuXHQgIGVsc2Uge1xyXG5cdFx0dGhpcy5jdWJlLmZyYW1lID0gMTtcclxuXHQgIH1cclxuICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiB0aHJ1c3RlckhhbHQoKSB7XHJcbiAgIHRoaXMuaGFsdFRpbWUgPSAxNTAwO1xyXG59XHJcblxyXG4vKlxyXG5mdW5jdGlvbiBndW5GaXJlKCl7XHJcblx0dmFyIGFuZ2xlID0gdGhpcy5jdWJlLmJvZHkucm90YXRpb24gJSAoMipNYXRoLlBJKTtcclxuXHR2YXIgZGlyZWN0aW9uID0gW01hdGguc2luKGFuZ2xlKSwgLU1hdGguY29zKGFuZ2xlKV07XHJcblx0Ly92YXIgZGVsdGEgPSBbdGhpcy5jdWJlLngtdGhpcy5jdWJlLmJvZHkucHJldi54LCB0aGlzLmN1YmUueSAtIHRoaXMuY3ViZS5ib2R5LnByZXYueV07XHJcblx0dmFyIGRlbHRhRGlzdCA9IE1hdGguc3FydChNYXRoLnBvdyh0aGlzLmN1YmUuZGVsdGFYLCAyKSArIE1hdGgucG93KHRoaXMuY3ViZS5kZWx0YVksIDIpKTtcclxuXHR2YXIgc3BlZWQgPSBkZWx0YURpc3QgKiA1MDtcclxuXHRuZXcgQnVsbGV0KHRoaXMuZ2FtZVN0YXRlLCB0aGlzLmN1YmUueCArIDMwKmRpcmVjdGlvblswXSwgdGhpcy5jdWJlLnkgKyAzMCpkaXJlY3Rpb25bMV0sIFxyXG5cdFx0XHQgICBkaXJlY3Rpb24sIHNwZWVkLCAncGxheWVyQnVsbGV0Jyk7XHJcbn1cclxuKi9cclxuXHJcbmZ1bmN0aW9uIGd1blVwZGF0ZSgpIHtcclxuICAgaWYgKCF0aGlzLmN1YmUubXlDb25uZWN0aW9uIHx8ICF0aGlzLmFjdCkge1xyXG4gICAgICByZXR1cm47XHJcbiAgIH1cclxuICAgaWYgKHRoaXMudGltZXIgPD0gMCkge1xyXG4gICAgICB2YXIgYW5nbGUgPSB0aGlzLmN1YmUuYm9keS5yb3RhdGlvbiAlICgyKk1hdGguUEkpO1xyXG4gICAgICB2YXIgZGlyZWN0aW9uID0gW01hdGguc2luKGFuZ2xlKSwgLU1hdGguY29zKGFuZ2xlKV07XHJcbiAgICAgIC8vdmFyIGRlbHRhID0gW3RoaXMuY3ViZS54LXRoaXMuY3ViZS5ib2R5LnByZXYueCwgdGhpcy5jdWJlLnkgLSB0aGlzLmN1YmUuYm9keS5wcmV2LnldO1xyXG4gICAgICB2YXIgZGVsdGFEaXN0ID0gTWF0aC5zcXJ0KE1hdGgucG93KHRoaXMuY3ViZS5kZWx0YVgsIDIpICsgTWF0aC5wb3codGhpcy5jdWJlLmRlbHRhWSwgMikpO1xyXG4gICAgICB2YXIgc3BlZWQgPSBkZWx0YURpc3QgKiA1MDtcclxuICAgICAgbmV3IEJ1bGxldCh0aGlzLmdhbWVTdGF0ZSwgdGhpcy5jdWJlLnggKyAzMCpkaXJlY3Rpb25bMF0sIHRoaXMuY3ViZS55ICsgMzAqZGlyZWN0aW9uWzFdLCBcclxuICAgICAgICAgICAgICAgZGlyZWN0aW9uLCBzcGVlZCwgJ3BsYXllckJ1bGxldCcpO1xyXG4gICAgICB0aGlzLnRpbWVyID0gNjAwO1xyXG4gICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLnRpbWVyIC09IHRoaXMuZ2FtZVN0YXRlLmdhbWUudGltZS5lbGFwc2VkO1xyXG4gICB9XHJcbn1cclxuLyoqIEVuZCBtb2R1bGUgZnVuY3Rpb25zICoqL1xyXG5cclxuLy9jYWxsIHRoaXMgZnVuY3Rpb24gZnJvbSBNb2R1bGVCdWlsZGVyIHRvIGNvbnN0cnVjdCBtb2R1bGVzXHJcbi8vVFlQRVM6ICdjb3JlJyAnc2hpZWxkJyAndGhydXN0ZXInICdzb2xhclBhbm5lbCcgJ2hhY2tlcidcclxuTW9kdWxlQnVpbGRlci5wcm90b3R5cGUuYnVpbGQgPSBmdW5jdGlvbih0eXBlLCB4LCB5LCBmb3JQbGF5ZXIpIHtcdFxyXG5cdC8vQ3JlYXRlIGN1YmUgb2JqZWN0IHRvIGJlIHN0b3JlZCB3aXRoaW4gbW9kdWxlXHJcblx0Ly9TcHJpdGUgbmFtZXMgZm9yIG1vZHVsZXMgYXJlIGRpcmVjdGx5IG1hcHBlZCB0byBtb2R1bGUgbmFtZXMsIHNvIGp1c3QgcGFzcyAndHlwZScgYXMgc3ByaXRlIG5hbWVcclxuXHR2YXIgbmV3Q3ViZSA9IG5ldyBDdWJlKHRoaXMuZ2FtZVN0YXRlLCB4LCB5LCB0eXBlKTtcclxuICAgIHZhciBzY2FsZSA9IDAuNTtcclxuICAgIG5ld0N1YmUubmFtZSA9IHRoaXMuZ2FtZVN0YXRlLmRlYnVnTnVtKys7XHJcbiAgICBuZXdDdWJlLnNjYWxlLnNldFRvKHNjYWxlLCBzY2FsZSk7XHJcbiAgICBuZXdDdWJlLmFuY2hvci5zZXRUbygwLjUsIDAuNSk7XHJcblx0XHJcblx0Ly9DcmVhdGUgcGh5c2ljcyBmb3IgbmV3IGN1YmVcclxuICAgIHRoaXMuZ2FtZVN0YXRlLmdhbWUucGh5c2ljcy5wMi5lbmFibGUobmV3Q3ViZSk7XHJcblx0bmV3Q3ViZS5ib2R5LnNldENvbGxpc2lvbkdyb3VwKHRoaXMuZ2FtZVN0YXRlLmNvbGxpc2lvbkdyb3VwKTtcclxuXHRuZXdDdWJlLmJvZHkuY29sbGlkZXModGhpcy5nYW1lU3RhdGUuY29sbGlzaW9uR3JvdXApO1xyXG5cdG5ld0N1YmUuYm9keS5vbkJlZ2luQ29udGFjdC5hZGQobmV3Q3ViZS5jdWJlQ29sbGlkZSwgbmV3Q3ViZSk7XHJcbiAgICBuZXdDdWJlLmJvZHkuZGFtcGluZyA9IDAuOTtcclxuICAgIG5ld0N1YmUuYm9keS5hbmd1bGFyRGFtcGluZyA9IDAuOTtcclxuIFxyXG4gICB2YXIgY0luZGljYXRvciA9IHRoaXMuZ2FtZVN0YXRlLmFkZC5zcHJpdGUoMCwgMCwgJ2Nvbm5lY3Rpb25zJywgJ2Nvbm5lY3Rpb25fbGluZS5wbmcnKTtcclxuICAgY0luZGljYXRvci5hbmNob3Iuc2V0VG8oMC41LCAwLjUpO1xyXG4gICBjSW5kaWNhdG9yLmFuaW1hdGlvbnMuYWRkKCdlbmQnLCBbJ2Nvbm5lY3Rpb25fZW5kLnBuZyddLCA2MCwgdHJ1ZSk7XHJcbiAgIGNJbmRpY2F0b3IuYW5pbWF0aW9ucy5hZGQoJ2xpbmUnLCBbJ2Nvbm5lY3Rpb25fbGluZS5wbmcnXSwgNjAsIHRydWUpO1xyXG4gICBjSW5kaWNhdG9yLmFuaW1hdGlvbnMuYWRkKCdyaWdodCcsIFsnY29ubmVjdGlvbl9yaWdodC5wbmcnXSwgNjAsIHRydWUpO1xyXG4gICBuZXdDdWJlLmFkZENoaWxkKGNJbmRpY2F0b3IpO1xyXG4gICBuZXdDdWJlLmNJbmRpY2F0b3IgPSBjSW5kaWNhdG9yO1xyXG4gICBjSW5kaWNhdG9yLmFscGhhID0gMDtcclxuXHRcclxuXHQvL0NyZWF0ZSBtb2R1bGUgdG8gd3JhcCBhcm91bmQgY3ViZSBjbGFzc1xyXG5cdHZhciBuZXdNb2R1bGUgPSBuZXcgTW9kdWxlKHR5cGUsIG5ld0N1YmUsIHRoaXMuZ2FtZVN0YXRlKTtcclxuXHRcdFxyXG5cdC8vVE9ETzogZWRpdCBzcGVjaWFsIG1vZHVsZSBhdHJpYnV0ZXMgYmFzZWQgb24gJ3R5cGUnXHJcblx0aWYodHlwZSA9PT0gJ2hhY2tlcicpIHtcclxuXHRcdG5ld01vZHVsZS5jeWNsZSA9IDY7XHJcblx0XHRuZXdNb2R1bGUuY291bnQgPSAwO1xyXG5cdFx0bmV3TW9kdWxlLmN1YmUuYW5pbWF0aW9ucy5hZGQoJ2hhY2tlcicsIFswLDEsMiwzLDRdLCAxMCwgdHJ1ZSk7XHJcblx0fVxyXG5cdFxyXG5cdC8vU3RvcmUgbW9kdWxlIGlmIGl0IGlzIGNvcmVcclxuXHRpZih0eXBlID09PSAnY29yZScpXHJcblx0e1xyXG5cdFx0bmV3TW9kdWxlLmN1YmUuYW5pbWF0aW9ucy5hZGQoJ2NvcmUnLCBbMCwxLDJdLCAyMCwgdHJ1ZSk7XHJcblx0XHRuZXdNb2R1bGUuY3ViZS5hbmltYXRpb25zLnBsYXkoJ2NvcmUnKTtcclxuXHRcdHRoaXMuY29yZSA9IG5ld01vZHVsZTtcclxuXHRcdHRoaXMuY29yZUV4aXN0cyA9IHRydWU7XHJcblx0fVxyXG4gICAvLyBzb2xhciBwYW5lbCB0ZXN0aW5nXHJcbiAgIGlmICh0eXBlID09PSAnc29sYXJQYW5lbCcpIHtcclxuICAgICAgbmV3TW9kdWxlLmdpdmVUYXJnZXQgPSBzb2xhclBhbmVsR2l2ZVRhcmdldDtcclxuICAgICAgbmV3TW9kdWxlLm1vdXNlT3ZlciA9IHNvbGFyUGFuZWxNb3VzZU92ZXI7XHJcbiAgICAgIG5ld01vZHVsZS5vblJlbW92ZSA9IHNvbGFyUGFuZWxPblJlbW92ZTtcclxuICAgfVxyXG4gICBcclxuICAgLy9UaHJ1c3RlciBtb2R1bGUgZXZlbnRzXHJcblx0aWYodHlwZSA9PT0gJ3RocnVzdGVyJykge1xyXG4gICAgICBpZiAoZm9yUGxheWVyKSB7XHJcbiAgICAgICAgIHZhciB0aHJ1c3RlcktleSA9IHRoaXMuZ2FtZVN0YXRlLmlucHV0LmtleWJvYXJkLmFkZEtleShQaGFzZXIuS2V5Ym9hcmQuVyk7IFxyXG4gICAgICAgICB0aGlzLmdhbWVTdGF0ZS5pbnB1dC5rZXlib2FyZC5hZGRLZXlDYXB0dXJlKFt0aHJ1c3RlcktleV0pO1xyXG4gICAgICAgICB0aHJ1c3RlcktleS5vbkRvd24uYWRkKGJlZ2luQWN0LCBuZXdNb2R1bGUpO1xyXG4gICAgICAgICB0aHJ1c3RlcktleS5vblVwLmFkZChlbmRBY3QsIG5ld01vZHVsZSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgIC8vIG5ld01vZHVsZS50aHJ1c3QgPSBmYWxzZTtcclxuICAgICAgICAgbmV3TW9kdWxlLmJlZ2luQWN0ID0gYmVnaW5BY3Q7XHJcbiAgICAgICAgIG5ld01vZHVsZS5lbmRBY3QgPSBlbmRBY3Q7XHJcbiAgICAgIH1cclxuICAgICAgbmV3TW9kdWxlLnVwZGF0ZSA9IHRocnVzdGVyVXBkYXRlO1xyXG4gICAgICBuZXdNb2R1bGUudGhydXN0ZXJIYWx0ID0gdGhydXN0ZXJIYWx0O1xyXG5cdH1cclxuXHJcblx0Ly9HdW4gbW9kdWxlIGV2ZW50c1xyXG5cdGlmKHR5cGUgPT09ICdndW4nKSB7XHJcblx0XHQvLyBuZXdNb2R1bGUuZmlyZSA9IGd1bkZpcmU7XHJcbiAgICAgIG5ld01vZHVsZS51cGRhdGUgPSBndW5VcGRhdGU7XHJcbiAgICAgIGlmIChmb3JQbGF5ZXIpIHtcclxuICAgICAgICAgdmFyIGFjdEtleSA9IHRoaXMuZ2FtZVN0YXRlLmlucHV0LmtleWJvYXJkLmFkZEtleShQaGFzZXIuS2V5Ym9hcmQuU1BBQ0VCQVIpO1xyXG4gICAgICAgICB0aGlzLmdhbWVTdGF0ZS5pbnB1dC5rZXlib2FyZC5hZGRLZXlDYXB0dXJlKFthY3RLZXldKTtcclxuICAgICAgICAgYWN0S2V5Lm9uRG93bi5hZGQoYmVnaW5BY3QsIG5ld01vZHVsZSk7XHJcbiAgICAgICAgIGFjdEtleS5vblVwLmFkZChlbmRBY3QsIG5ld01vZHVsZSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgIG5ld01vZHVsZS5iZWdpbkFjdCA9IGJlZ2luQWN0O1xyXG4gICAgICAgICBuZXdNb2R1bGUuZW5kQWN0ID0gZW5kQWN0O1xyXG4gICAgICB9XHJcblx0fVxyXG5cdFxyXG5cdC8vUmV0dXJuIHRoZSBtb2R1bGUgb2JqZWN0XHJcblx0cmV0dXJuIG5ld01vZHVsZTtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gTW9kdWxlQnVpbGRlcjtcclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuIiwiLypcclxuRGVmaW5lcyBhIGN1YmUuXHJcbiovXHJcblxyXG52YXIgQ3ViZSA9IGZ1bmN0aW9uIChnYW1lU3RhdGUsIHgsIHksIHNwcml0ZSkge1xyXG4gICAgUGhhc2VyLlNwcml0ZS5jYWxsKHRoaXMsIGdhbWVTdGF0ZS5nYW1lLCB4LCB5LCBzcHJpdGUpO1xyXG5cdCB0aGlzLnRhZyA9ICdtb2R1bGUnO1x0Ly90YWcgaXMgdXNlZCB0byBkZXRlY3Qgb2JqZWN0IHR5cGUgZHVyaW5nIGNvbGxpc2lvbiBjaGVja2luZ1xyXG4gICAgdGhpcy5nYW1lID0gZ2FtZVN0YXRlLmdhbWU7XHJcbiAgICB0aGlzLmdhbWUuYWRkLmV4aXN0aW5nKHRoaXMpO1xyXG4gICAgdGhpcy5ncm91cCA9IHVuZGVmaW5lZDtcclxuICAgIHRoaXMubW9kdWxlID0gdW5kZWZpbmVkO1xyXG4gICAgdGhpcy5pbmRpY2F0b3JGYWRlID0gMC4wMjtcclxuICAgIHRoaXMuaGVhbHRoQmFyID0gZ2FtZVN0YXRlLnVpQnVpbGRlci5idWlsZFByb2dyZXNzQmFyKCdzaHJpbmtpbmcnLCAwLCAwLCAyMCwgNCwgMyk7XHJcblx0dGhpcy5oZWFsdGhCYXIuc2V0U3R5bGUoMCwgMHhGRkZGRkYsIDB4MzYzNjM2LCAwLCAwLCAwLCAweEZGRkZGRiwgMHgyMENDMjApO1xyXG5cdHRoaXMuaGVhbHRoQmFyLmN1YmUgPSB0aGlzO1xyXG4gICB0aGlzLmhlYWx0aEJhckZhZGUgPSAwLjAyO1xyXG5cdC8vc2V0IHVwZGF0ZSBmdW5jdGlvbiBvZiBoZWFsdGggYmFyXHJcblx0dGhpcy5oZWFsdGhCYXIudXBkYXRlID0gZnVuY3Rpb24oKSB7XHJcblx0XHR0aGlzLnNldExvY2F0aW9uKHRoaXMuY3ViZS54LCB0aGlzLmN1YmUueSsxMCk7XHJcblx0fTtcclxuXHQvL29uRXZlbnQgY2FsbGVkIHdoZW4gY3ViZSBydW5zIG91dCBvZiBoZWFsdGhcclxuXHR0aGlzLmhlYWx0aEJhci5vbkV2ZW50ID0gZnVuY3Rpb24oKSB7XHJcblx0XHR0aGlzLmN1YmUuZHlpbmcgPSB0cnVlO1xyXG5cdFx0dGhpcy5jdWJlLmxpZmUgPSA1MDtcclxuXHRcdC8vIHRoaXMuZ3JvdXAuY291bnRDdWJlcygpO1xyXG5cdFx0Ly8gdGhpcy5kZXN0cm95KCk7XHJcblx0fTtcclxuXHR0aGlzLmNvbnN0cmFpbnRzID0gW107XHJcbn07XHJcblxyXG5DdWJlLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUGhhc2VyLlNwcml0ZS5wcm90b3R5cGUpO1xyXG5DdWJlLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IEN1YmU7XHJcblxyXG4vKipcclxuICogQXV0b21hdGljYWxseSBjYWxsZWQgYnkgV29ybGQudXBkYXRlXHJcbiAqL1xyXG5DdWJlLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHtcclxuICAgaWYgKHRoaXMuY0luZGljYXRvciAmJiB0aGlzLmNJbmRpY2F0b3IuYWxwaGEgPiAwKSB7XHJcbiAgICAgIHRoaXMuY0luZGljYXRvci5hbHBoYSAtPSB0aGlzLmluZGljYXRvckZhZGU7XHJcbiAgIH1cclxuICAgaWYgKHRoaXMubW9kdWxlLnVwZGF0ZSkge1xyXG4gICAgICB0aGlzLm1vZHVsZS51cGRhdGUoKTtcclxuICAgfVxyXG4gICBpZiAodGhpcy5oZWFsdGhCYXIuZ3JhcGhpY3MuYWxwaGEgPiAwKSB7XHJcbiAgICAgIHRoaXMuaGVhbHRoQmFyLmdyYXBoaWNzLmFscGhhIC09IHRoaXMuaGVhbHRoQmFyRmFkZSAqIHRoaXMuZ2FtZS50aW1lLmVsYXBzZWQ7XHJcbiAgIH1cclxuICAgaWYgKHRoaXMuZHlpbmcpIHtcclxuICAgICAgdGhpcy5saWZlIC09IHRoaXMuZ2FtZS50aW1lLmVsYXBzZWQ7XHJcbiAgICAgIGlmICh0aGlzLmxpZmUgPCAwKSB7XHJcbiAgICAgICAgIHRoaXMuZHlpbmcgPSBmYWxzZTtcclxuICAgICAgICAgdGhpcy5oZWFsdGhCYXIuZGVzdHJveSgpO1xyXG4gICAgICAgICBpZiAodGhpcy5ncm91cCkge1xyXG4gICAgICAgICAgICB0aGlzLmdyb3VwLmRlc3Ryb3lDdWJlKHRoaXMpO1xyXG4gICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmRlc3Ryb3koKTtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgIH1cclxufTtcclxuXHJcbkN1YmUucHJvdG90eXBlLmN1YmVDb2xsaWRlID0gZnVuY3Rpb24ob3RoZXIpIHtcclxuICAgaWYgKCF0aGlzLmdyb3VwIHx8ICF0aGlzLmdyb3VwLmlzUGxheWVyIHx8ICFvdGhlciB8fCAhb3RoZXIuc3ByaXRlIHx8IG90aGVyLnNwcml0ZS50YWcgIT09ICdtb2R1bGUnIHx8XHJcbiAgICAgICAob3RoZXIuZ3JvdXAgJiYgb3RoZXIuZ3JvdXAgPT09IHRoaXMuZ3JvdXApIHx8IChvdGhlci5ncm91cCAmJiBvdGhlci5ncm91cC5pc1BsYXllcikgfHxcclxuICAgICAgICAgb3RoZXIucHJvdG90eXBlICE9PSB0aGlzLnByb3RvdHlwZSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgIH1cclxuXHR0aGlzLmdyb3VwLmhhbmRsZUNvbGxpc2lvbih0aGlzLCBvdGhlci5zcHJpdGUpO1xyXG5cdHRoaXMuZ3JvdXAuY291bnRDdWJlcygpO1xyXG59O1xyXG5cclxuQ3ViZS5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbigpIHtcclxuICAgdmFyIHN0cmluZyA9ICcnO1xyXG4gICBzdHJpbmcgKz0gdGhpcy5jb25jYXQoJ25hbWUnLCB0aGlzLm5hbWUpO1xyXG4gICByZXR1cm4gc3RyaW5nO1xyXG59O1xyXG5cclxuQ3ViZS5wcm90b3R5cGUuY29uY2F0ID0gZnVuY3Rpb24oc3RyaW5nLCB2YWwpIHtcclxuICAgcmV0dXJuIHN0cmluZyArICc6ICcgKyB2YWwgKyAnXFxuJztcclxufTtcclxuQ3ViZS5wcm90b3R5cGUuZGlzcGxheUluZGljYXRvciA9IGZ1bmN0aW9uKCkge1xyXG4gIHRoaXMuY0luZGljYXRvci5hbHBoYSA9IDE7IFxyXG59O1xyXG5cclxuQ3ViZS5wcm90b3R5cGUudGFrZURhbWFnZSA9IGZ1bmN0aW9uKGFtdCkge1xyXG4gICB0aGlzLmhlYWx0aEJhci5hZGRWYWx1ZSgtYW10KTtcclxufTtcclxuXHJcbkN1YmUucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICBpZiAoIXRoaXMuZ3JvdXApIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICB9XHJcbiAgIHRoaXMuZ3JvdXAucmVtb3ZlKHRoaXMpO1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBDdWJlO1xyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbiIsInZhciBBc3RhciA9IHJlcXVpcmUoJy4uL2xpYnMvamF2YXNjcmlwdC1hc3Rhci9hc3RhcicpO1xyXG52YXIgRW5lbXlBSSA9IHJlcXVpcmUoJy4vZW5lbXlfYWknKTtcclxuXHJcbi8qXHJcbkRlZmluZXMgYSBjdWJlIGdyb3VwLlxyXG4qL1xyXG5cclxudmFyIEN1YmVHcm91cCA9IGZ1bmN0aW9uIChnYW1lLCByb290KSB7XHJcbiAgIHRoaXMuZ2FtZSA9IGdhbWU7XHJcbiAgIHRoaXMucm9vdCA9IHJvb3Q7XHJcbiAgIHRoaXMuY3ViZXMgPSBbXTtcclxuICAgdmFyIGNvbCA9IFtdO1xyXG4gICBjb2wucHVzaCh0aGlzLnJvb3QpO1xyXG4gICB0aGlzLmN1YmVzLnB1c2goY29sKTtcclxuICAgaWYgKHRoaXMucm9vdCkge1xyXG4gICAgICB0aGlzLnJvb3QuZ3JvdXAgPSB0aGlzO1xyXG4gICB9XHJcbiAgIHRoaXMuRElSID0ge05PUlRIOiAwLCBFQVNUOiAxLCBTT1VUSDogMiwgV0VTVDogM307XHJcbiAgIHRoaXMub2Zmc2V0ID0gMjtcclxuXHR0aGlzLmFjdGl2ZUhhY2tlck1vZHVsZXMgPSBbXTtcdC8vbGlzdCBvZiBoYWNrZXIgbW9kdWxlcyBpbiB0aGlzIGdyb3VwXHJcblx0dGhpcy5hY3RpdmVHdW5zID0gW107XHJcblxyXG4gICB0aGlzLm51bUN1YmVzID0gMTtcclxuICAgdGhpcy5ib3VuY2VCYWNrRm9yY2UgPSAzMDtcclxuICAgdGhpcy5taW5SYW1WZWwgPSAzMDA7XHJcbiAgIHRoaXMuZGVidWcgPSBmYWxzZTtcclxufTtcclxuXHJcbkN1YmVHcm91cC5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBDdWJlR3JvdXA7XHJcblxyXG4vKipcclxuICogQXV0b21hdGljYWxseSBjYWxsZWQgYnkgV29ybGQudXBkYXRlXHJcbiAqL1xyXG5DdWJlR3JvdXAucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICBpZiAodGhpcy5BSSkge1xyXG4gICAgICB0aGlzLkFJLnVwZGF0ZSgpO1xyXG4gICB9XHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLmNhbGwgPSBmdW5jdGlvbihmdW4pIHtcclxuICAgZm9yICh2YXIgcm93ID0gMDsgcm93IDwgdGhpcy5jdWJlc1dpZHRoKCk7IHJvdysrKSB7XHJcbiAgICAgIGZvciAodmFyIGNvbCA9IDA7IGNvbCA8IHRoaXMuY3ViZXNIZWlnaHQoKTsgY29sKyspIHtcclxuICAgICAgICAgdmFyIGN1YmUgPSB0aGlzLmN1YmVzW3Jvd11bY29sXTtcclxuICAgICAgICAgaWYgKGN1YmUgJiYgY3ViZS5oYXNPd25Qcm9wZXJ0eShmdW4pKSB7XHJcbiAgICAgICAgICAgIC8vIGlmIGN1YmVzIG5lZWQgZnVuY3Rpb25zIGNhbGxlZFxyXG4gICAgICAgICB9IGVsc2UgaWYgKGN1YmUgJiYgY3ViZS5tb2R1bGUgJiYgY3ViZS5tb2R1bGUuaGFzT3duUHJvcGVydHkoZnVuKSkge1xyXG4gICAgICAgICAgICB2YXIgZm4gPSBjdWJlLm1vZHVsZVtmdW5dO1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGZuID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgIGZuLmNhbGwoY3ViZS5tb2R1bGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICB9XHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLmNhbGxPblR5cGUgPSBmdW5jdGlvbihmdW4sIHR5cGUpIHtcclxuICAgZm9yICh2YXIgcm93ID0gMDsgcm93IDwgdGhpcy5jdWJlc1dpZHRoKCk7IHJvdysrKSB7XHJcbiAgICAgIGZvciAodmFyIGNvbCA9IDA7IGNvbCA8IHRoaXMuY3ViZXNIZWlnaHQoKTsgY29sKyspIHtcclxuICAgICAgICAgdmFyIGN1YmUgPSB0aGlzLmN1YmVzW3Jvd11bY29sXTtcclxuICAgICAgICAgaWYgKGN1YmUgJiYgY3ViZS5oYXNPd25Qcm9wZXJ0eShmdW4pKSB7XHJcbiAgICAgICAgICAgIC8vIGlmIGN1YmVzIG5lZWQgZnVuY3Rpb25zIGNhbGxlZFxyXG4gICAgICAgICB9IGVsc2UgaWYgKGN1YmUgJiYgY3ViZS5tb2R1bGUgJiYgY3ViZS5tb2R1bGUudHlwZSA9PT0gdHlwZSAmJiBjdWJlLm1vZHVsZS5oYXNPd25Qcm9wZXJ0eShmdW4pKSB7XHJcbiAgICAgICAgICAgIHZhciBmbiA9IGN1YmUubW9kdWxlW2Z1bl07XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZm4gPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgICAgZm4uY2FsbChjdWJlLm1vZHVsZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgIH1cclxufTtcclxuXHJcbkN1YmVHcm91cC5wcm90b3R5cGUuZ2V0TW9kdWxlcyA9IGZ1bmN0aW9uKHR5cGUpIHtcclxuICAgdmFyIG1vZHVsZXMgPSBbXTtcclxuICAgZm9yICh2YXIgcm93ID0gMDsgcm93IDwgdGhpcy5jdWJlc1dpZHRoKCk7IHJvdysrKSB7XHJcbiAgICAgIGZvciAodmFyIGNvbCA9IDA7IGNvbCA8IHRoaXMuY3ViZXNIZWlnaHQoKTsgY29sKyspIHtcclxuICAgICAgICAgdmFyIGN1YmUgPSB0aGlzLmN1YmVzW3Jvd11bY29sXTtcclxuICAgICAgICAgaWYgKGN1YmUgJiYgY3ViZS5tb2R1bGUudHlwZSA9PT0gdHlwZSkge1xyXG4gICAgICAgICAgICBtb2R1bGVzLnB1c2goY3ViZS5tb2R1bGUpO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICByZXR1cm4gbW9kdWxlcztcclxufTtcclxuXHJcbkN1YmVHcm91cC5wcm90b3R5cGUuZ2l2ZUFJID0gZnVuY3Rpb24odHlwZSwgcGxheWVyKSB7XHJcbiAgIHRoaXMuQUkgPSBuZXcgRW5lbXlBSSh0aGlzLmdhbWUsIHRoaXMsIHR5cGUsIHBsYXllcik7XHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uKGN1YmUsIHBvaW50KSB7XHJcbiAgaWYgKCF0aGlzLnJvb3QgJiYgY3ViZS5tb2R1bGUudHlwZSA9PT0gJ2NvcmUnKSB7XHJcbiAgICAgdGhpcy5yb290ID0gY3ViZTtcclxuICB9XHJcbiAgY3ViZS5ncm91cCA9IHRoaXM7XHJcbiAgdGhpcy5zZXQoY3ViZSwgcG9pbnQpO1xyXG4gIHRoaXMuY3JlYXRlQ29uc3RyYWludHMoY3ViZSwgcG9pbnQpO1xyXG59O1xyXG5cclxuQ3ViZUdyb3VwLnByb3RvdHlwZS5oYW5kbGVDb2xsaXNpb24gPSBmdW5jdGlvbihvcmlnaW4sIG90aGVyKSB7XHJcbiAgIGlmICh0aGlzLmRlYnVnKSBjb25zb2xlLmxvZygnaGFuZGxlQ29sbGlzaW9uKCkgc3RhcnQ6Jywgb3JpZ2luLm1vZHVsZS50eXBlLCBvdGhlci5tb2R1bGUudHlwZSk7IC8vIGpzaGludCBpZ25vcmU6bGluZVxyXG4gICBpZiAodGhpcy5kZWJ1ZykgeyB0aGlzLmRpc3BsYXlDdWJlcygpOyB9XHJcbiAgIHZhciBzdW1WZWwgPSBNYXRoLmFicyhvcmlnaW4uYm9keS52ZWxvY2l0eS54KSArIE1hdGguYWJzKG9yaWdpbi5ib2R5LnZlbG9jaXR5LnkpO1xyXG4gICBpZiAob3RoZXIuZ3JvdXAgJiYgb3RoZXIuZ3JvdXAgIT09IHRoaXMgJiYgc3VtVmVsID49IHRoaXMubWluUmFtVmVsKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdjb2xsaXNpb24nKTtcclxuICAgICAgaWYgKHRoaXMuZ2FtZS5qdWljeSkge1xyXG4gICAgICAgICB0aGlzLmdhbWUuanVpY3kuc2hha2UoKTtcclxuICAgICAgfVxyXG4gICAgICBvdGhlci50YWtlRGFtYWdlKDMpO1xyXG4gICAgICB0aGlzLmNhbGwoJ3RocnVzdGVySGFsdCcpO1xyXG4gICB9IGVsc2UgaWYgKCFvdGhlci5ncm91cCAmJiB0aGlzLmlzUGxheWVyKSB7XHJcbiAgICAgIHZhciByZWxTaWRlID0gdGhpcy5yZWxhdGl2ZVNpZGUob3JpZ2luLmJvZHksIG90aGVyLmJvZHkpO1xyXG4gICAgICB2YXIgb3JpZ2luTG9jID0gdGhpcy5maW5kKG9yaWdpbik7XHJcbiAgICAgIC8vIHZhciBhZGp1c3REaXIgPSB0aGlzLnJlbGF0aXZlU2lkZSh0aGlzLnJvb3QuYm9keSwgb3RoZXIuYm9keSk7XHJcbiAgICAgIC8vIHZhciBvdGhlckxvYyA9IHRoaXMuYWRqdXN0KG9yaWdpbkxvYywgYWRqdXN0RGlyKTtcclxuICAgICAgdmFyIG90aGVyTG9jID0gdGhpcy5jYWxjUG9zKG9yaWdpbiwgcmVsU2lkZSk7XHJcbiAgICAgIGlmICh0aGlzLmRlYnVnKSBjb25zb2xlLmxvZygnaGFuZGxlQ29sbGlzaW9uKCkgcHJlLWZpbmQ6JywgJ3JlbFNpZGU6JywgcmVsU2lkZSwgJ29yaWdpbkxvYzonLCBNYXRoLmZsb29yKG9yaWdpbkxvYy54KSwgTWF0aC5mbG9vcihvcmlnaW5Mb2MueSksICdvdGhlckxvYzonLCBNYXRoLmZsb29yKG90aGVyTG9jLngpLCBNYXRoLmZsb29yKG90aGVyTG9jLnkpKTsgLy8ganNoaW50IGlnbm9yZTpsaW5lXHJcbiAgICAgIHRoaXMuc2V0KG90aGVyLCBvdGhlckxvYyk7XHJcbiAgICAgIG90aGVyTG9jID0gdGhpcy5maW5kKG90aGVyKTsgLy8gdXBkYXRlIHBvc2l0aW9uIHNpbmNlIHNldCBjYW4gc2hpZnQgZ3JpZFxyXG4gICAgICBpZiAoIW90aGVyTG9jKSB7XHJcbiAgICAgICAgIGlmICh0aGlzLmRlYnVnKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdoYW5kbGVDb2xsaXNpb24oKTogb3RoZXJMb2MgRE5FJywgJy0tLS0tLS0tLS0tLS0tLS0tLS0tLScpO1xyXG4gICAgICAgICAgICB0aGlzLmRpc3BsYXlDdWJlcygpO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5kZWJ1ZykgY29uc29sZS5sb2coJ2hhbmRsZUNvbGxpc2lvbigpIHBvc3QtZmluZDonLCAnb3RoZXJMb2M6JywgTWF0aC5mbG9vcihvdGhlckxvYy54KSwgTWF0aC5mbG9vcihvdGhlckxvYy55KSk7IC8vIGpzaGludCBpZ25vcmU6bGluZVxyXG4gICAgICB0aGlzLmNyZWF0ZUNvbnN0cmFpbnRzKG90aGVyLCBvdGhlckxvYyk7XHJcbiAgICAgIGlmICh0aGlzLmRlYnVnKSB0aGlzLmRpc3BsYXlDdWJlcygpOyAvLyBqc2hpbnQgaWdub3JlOmxpbmVcclxuICAgfVxyXG4gICBpZiAodGhpcy5kZWJ1ZykgeyBjb25zb2xlLmxvZygnaGFuZGxlQ29sbGlzaW9uKCkgZW5kOicsICctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0nKTsgfVxyXG59O1xyXG5cclxuQ3ViZUdyb3VwLnByb3RvdHlwZS5jYWxjUG9zID0gZnVuY3Rpb24ob3JpZ2luLCByZWxTaWRlKSB7XHJcbiAgIHZhciBkaWZmQW5nbGUgPSBvcmlnaW4uYm9keS5yb3RhdGlvbiAtIHRoaXMucm9vdC5ib2R5LnJvdGF0aW9uO1xyXG4gICB2YXIgcmVsYXRpdmUgPSB0aGlzLmFuZ2xlVG9EaXIoZGlmZkFuZ2xlKTtcclxuICAgdmFyIG91dHB1dCA9IHRoaXMuZmluZChvcmlnaW4pO1xyXG4gICBpZiAocmVsYXRpdmUgPT09IDApIHsgLy8gbm9ydGggcmVsYXRpdmUgdG8gdGhlIHJvb3RcclxuICAgICAgaWYgKHJlbFNpZGUgPT09IDApIHtcclxuICAgICAgICAgb3V0cHV0LnkrKztcclxuICAgICAgfSBlbHNlIGlmIChyZWxTaWRlID09PSAxKSB7XHJcbiAgICAgICAgIG91dHB1dC54Kys7XHJcbiAgICAgIH0gZWxzZSBpZiAocmVsU2lkZSA9PT0gMikge1xyXG4gICAgICAgICBvdXRwdXQueS0tO1xyXG4gICAgICB9IGVsc2UgaWYgKHJlbFNpZGUgPT09IDMpIHtcclxuICAgICAgICAgb3V0cHV0LngtLTtcclxuICAgICAgfVxyXG4gICB9IGVsc2UgaWYgKHJlbGF0aXZlID09PSAxKSB7IC8vIGVhc3QgcmVsYXRpdmUgdG8gcm9vdFxyXG4gICAgICBpZiAocmVsU2lkZSA9PT0gMCkge1xyXG4gICAgICAgICBvdXRwdXQueCsrO1xyXG4gICAgICB9IGVsc2UgaWYgKHJlbFNpZGUgPT09IDEpIHtcclxuICAgICAgICAgb3V0cHV0LnktLTtcclxuICAgICAgfSBlbHNlIGlmIChyZWxTaWRlID09PSAyKSB7XHJcbiAgICAgICAgIG91dHB1dC54LS07XHJcbiAgICAgIH0gZWxzZSBpZiAocmVsU2lkZSA9PT0gMykge1xyXG4gICAgICAgICBvdXRwdXQueSsrO1xyXG4gICAgICB9XHJcbiAgIH0gZWxzZSBpZiAocmVsYXRpdmUgPT09IDIpIHsgLy8gc291dGggcmVsYXRpdmUgdG8gcm9vdFxyXG4gICAgICBpZiAocmVsU2lkZSA9PT0gMCkge1xyXG4gICAgICAgICBvdXRwdXQueS0tO1xyXG4gICAgICB9IGVsc2UgaWYgKHJlbFNpZGUgPT09IDEpIHtcclxuICAgICAgICAgb3V0cHV0LngtLTtcclxuICAgICAgfSBlbHNlIGlmIChyZWxTaWRlID09PSAyKSB7XHJcbiAgICAgICAgIG91dHB1dC55Kys7XHJcbiAgICAgIH0gZWxzZSBpZiAocmVsU2lkZSA9PT0gMykge1xyXG4gICAgICAgICBvdXRwdXQueCsrO1xyXG4gICAgICB9XHJcbiAgIH0gZWxzZSBpZiAocmVsYXRpdmUgPT09IDMpIHsgLy8gd2VzdCByZWxhdGl2ZSB0byByb290XHJcbiAgICAgIGlmIChyZWxTaWRlID09PSAwKSB7XHJcbiAgICAgICAgIG91dHB1dC54LS07XHJcbiAgICAgIH0gZWxzZSBpZiAocmVsU2lkZSA9PT0gMSkge1xyXG4gICAgICAgICBvdXRwdXQueSsrO1xyXG4gICAgICB9IGVsc2UgaWYgKHJlbFNpZGUgPT09IDIpIHtcclxuICAgICAgICAgb3V0cHV0LngrKztcclxuICAgICAgfSBlbHNlIGlmIChyZWxTaWRlID09PSAzKSB7XHJcbiAgICAgICAgIG91dHB1dC55LS07XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICByZXR1cm4gb3V0cHV0O1xyXG59O1xyXG5cclxuQ3ViZUdyb3VwLnByb3RvdHlwZS5hbmdsZVRvRGlyID0gZnVuY3Rpb24oYW5nbGUpIHtcclxuICAgaWYgKGFuZ2xlID49IDApIHtcclxuICAgICBhbmdsZSAlPSAyICogTWF0aC5QSTtcclxuICB9IGVsc2Uge1xyXG4gICAgIGFuZ2xlICo9IC0xO1xyXG4gICAgIGFuZ2xlICU9IDIgKiBNYXRoLlBJO1xyXG4gICAgIGFuZ2xlICo9IC0xO1xyXG4gIH1cclxuICBpZiAoKGFuZ2xlID49IC0xIC8gNCAqIE1hdGguUEkgJiYgYW5nbGUgPCAxIC8gNCAqIE1hdGguUEkpIHx8IGFuZ2xlID4gNyAvIDQgKiBNYXRoLlBJKSB7XHJcbiAgICAgcmV0dXJuIHRoaXMuRElSLk5PUlRIO1xyXG4gIH0gZWxzZSBpZiAoYW5nbGUgPj0gMSAvIDQgKiBNYXRoLlBJICYmIGFuZ2xlIDwgMyAvIDQgKiBNYXRoLlBJKSB7XHJcbiAgICAgcmV0dXJuIHRoaXMuRElSLkVBU1Q7XHJcbiAgfSBlbHNlIGlmIChhbmdsZSA+PSAzIC8gNCAqIE1hdGguUEkgJiYgYW5nbGUgPCA1IC8gNCAqIE1hdGguUEkpIHtcclxuICAgICByZXR1cm4gdGhpcy5ESVIuU09VVEg7XHJcbiAgfSBlbHNlIGlmIChhbmdsZSA+PSA1IC8gNCAqIE1hdGguUEkgJiYgYW5nbGUgPCA3IC8gNCAqIE1hdGguUEkpIHtcclxuICAgICByZXR1cm4gdGhpcy5ESVIuV0VTVDtcclxuICB9IGVsc2UgaWYgKGFuZ2xlID49IC0zIC8gNCAqIE1hdGguUEkgJiYgYW5nbGUgPCAtMSAvIDQgKiBNYXRoLlBJKSB7XHJcbiAgICAgcmV0dXJuIHRoaXMuRElSLldFU1Q7XHJcbiAgfSBlbHNlIGlmIChhbmdsZSA+PSAtNSAvIDQgKiBNYXRoLlBJICYmIGFuZ2xlIDwgLTMgLyA0ICogTWF0aC5QSSkge1xyXG4gICAgIHJldHVybiB0aGlzLkRJUi5TT1VUSDtcclxuICB9IGVsc2UgaWYgKGFuZ2xlID49IC03IC8gNCAqIE1hdGguUEkgJiYgYW5nbGUgPCAtNSAvIDQgKiBNYXRoLlBJKSB7XHJcbiAgICAgcmV0dXJuIHRoaXMuRElSLkVBU1Q7XHJcbiAgfSBlbHNlIGlmIChhbmdsZSA8IC03IC8gNCAqIE1hdGguUEkpIHtcclxuICAgICByZXR1cm4gdGhpcy5ESVIuTk9SVEg7XHJcbiAgfVxyXG59O1xyXG5cclxuQ3ViZUdyb3VwLnByb3RvdHlwZS5jcmVhdGVDb25zdHJhaW50cyA9IGZ1bmN0aW9uKG1lLCBwb2ludCkge1xyXG4gICB2YXIgbmVpZ2hib3JzID0gdGhpcy5nZXROZWlnaGJvcnMobWUpO1xyXG4gICBmb3IgKHZhciBpID0gMDsgaSA8IG5laWdoYm9ycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICB2YXIgbmVpZ2hib3IgPSBuZWlnaGJvcnNbaV07XHJcbiAgICAgIHZhciBteVNpZGUgPSB0aGlzLnJlbGF0aXZlU2lkZShtZS5ib2R5LCBuZWlnaGJvci5ib2R5KTtcclxuICAgICAgdmFyIG5laWdoYm9yU2lkZSA9IHRoaXMucmVsYXRpdmVTaWRlKG5laWdoYm9yLmJvZHksIG1lLmJvZHkpO1xyXG4gICAgICB2YXIgY29uc3RyYWludDtcclxuICAgICAgdmFyIG9mZnNldCA9IG1lLndpZHRoICsgdGhpcy5vZmZzZXQ7XHJcbiAgICAgIGlmIChteVNpZGUgPT09IDApIHtcclxuICAgICAgICBpZiAobmVpZ2hib3JTaWRlID09PSAwKSB7XHJcbiAgICAgICAgICAgY29uc3RyYWludCA9IHRoaXMuZ2FtZS5waHlzaWNzLnAyLmNyZWF0ZUxvY2tDb25zdHJhaW50KG1lLmJvZHksIG5laWdoYm9yLmJvZHksIFswLCBvZmZzZXRdLCBNYXRoLlBJKTtcclxuICAgICAgICB9IGVsc2UgaWYgKG5laWdoYm9yU2lkZSA9PT0gMSkge1xyXG4gICAgICAgICAgICBjb25zdHJhaW50ID0gdGhpcy5nYW1lLnBoeXNpY3MucDIuY3JlYXRlTG9ja0NvbnN0cmFpbnQobWUuYm9keSwgbmVpZ2hib3IuYm9keSwgWzAsIG9mZnNldF0sIDEgLyAyICogTWF0aC5QSSk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChuZWlnaGJvclNpZGUgPT09IDIpIHtcclxuICAgICAgICAgICAgY29uc3RyYWludCA9IHRoaXMuZ2FtZS5waHlzaWNzLnAyLmNyZWF0ZUxvY2tDb25zdHJhaW50KG1lLmJvZHksIG5laWdoYm9yLmJvZHksIFswLCBvZmZzZXRdLCAwKTtcclxuICAgICAgICB9IGVsc2UgaWYgKG5laWdoYm9yU2lkZSA9PT0gMykge1xyXG4gICAgICAgICAgICBjb25zdHJhaW50ID0gdGhpcy5nYW1lLnBoeXNpY3MucDIuY3JlYXRlTG9ja0NvbnN0cmFpbnQobWUuYm9keSwgbmVpZ2hib3IuYm9keSwgWzAsIG9mZnNldF0sIDMgLyAyICogTWF0aC5QSSk7XHJcbiAgICAgICAgfVxyXG4gICAgIH0gZWxzZSBpZiAobXlTaWRlID09PSAxKSB7XHJcbiAgICAgICAgaWYgKG5laWdoYm9yU2lkZSA9PT0gMCkge1xyXG4gICAgICAgICAgIGNvbnN0cmFpbnQgPSB0aGlzLmdhbWUucGh5c2ljcy5wMi5jcmVhdGVMb2NrQ29uc3RyYWludChtZS5ib2R5LCBuZWlnaGJvci5ib2R5LCBbLW9mZnNldCwgMF0sIC0xIC8gMiAqIE1hdGguUEkpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAobmVpZ2hib3JTaWRlID09PSAxKSB7XHJcbiAgICAgICAgICAgIGNvbnN0cmFpbnQgPSB0aGlzLmdhbWUucGh5c2ljcy5wMi5jcmVhdGVMb2NrQ29uc3RyYWludChtZS5ib2R5LCBuZWlnaGJvci5ib2R5LCBbLW9mZnNldCwgMF0sIE1hdGguUEkpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAobmVpZ2hib3JTaWRlID09PSAyKSB7XHJcbiAgICAgICAgICAgIGNvbnN0cmFpbnQgPSB0aGlzLmdhbWUucGh5c2ljcy5wMi5jcmVhdGVMb2NrQ29uc3RyYWludChtZS5ib2R5LCBuZWlnaGJvci5ib2R5LCBbLW9mZnNldCwgMF0sIDEgLyAyICogTWF0aC5QSSk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChuZWlnaGJvclNpZGUgPT09IDMpIHtcclxuICAgICAgICAgICAgY29uc3RyYWludCA9IHRoaXMuZ2FtZS5waHlzaWNzLnAyLmNyZWF0ZUxvY2tDb25zdHJhaW50KG1lLmJvZHksIG5laWdoYm9yLmJvZHksIFstb2Zmc2V0LCAwXSwgMCk7XHJcbiAgICAgICAgfVxyXG4gICAgIH0gZWxzZSBpZiAobXlTaWRlID09PSAyKSB7XHJcbiAgICAgICAgIGlmIChuZWlnaGJvclNpZGUgPT09IDApIHtcclxuICAgICAgICAgICBjb25zdHJhaW50ID0gdGhpcy5nYW1lLnBoeXNpY3MucDIuY3JlYXRlTG9ja0NvbnN0cmFpbnQobWUuYm9keSwgbmVpZ2hib3IuYm9keSwgWzAsIC1vZmZzZXRdLCAwKTtcclxuICAgICAgICB9IGVsc2UgaWYgKG5laWdoYm9yU2lkZSA9PT0gMSkge1xyXG4gICAgICAgICAgICBjb25zdHJhaW50ID0gdGhpcy5nYW1lLnBoeXNpY3MucDIuY3JlYXRlTG9ja0NvbnN0cmFpbnQobWUuYm9keSwgbmVpZ2hib3IuYm9keSwgWzAsIC1vZmZzZXRdLCAzIC8gMiAqIE1hdGguUEkpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAobmVpZ2hib3JTaWRlID09PSAyKSB7XHJcbiAgICAgICAgICAgIGNvbnN0cmFpbnQgPSB0aGlzLmdhbWUucGh5c2ljcy5wMi5jcmVhdGVMb2NrQ29uc3RyYWludChtZS5ib2R5LCBuZWlnaGJvci5ib2R5LCBbMCwgLW9mZnNldF0sIE1hdGguUEkpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAobmVpZ2hib3JTaWRlID09PSAzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0cmFpbnQgPSB0aGlzLmdhbWUucGh5c2ljcy5wMi5jcmVhdGVMb2NrQ29uc3RyYWludChtZS5ib2R5LCBuZWlnaGJvci5ib2R5LCBbMCwgLW9mZnNldF0sIDEgLyAyICogTWF0aC5QSSk7XHJcbiAgICAgICAgfVxyXG4gICAgIH0gZWxzZSBpZiAobXlTaWRlID09PSAzKSB7XHJcbiAgICAgICAgaWYgKG5laWdoYm9yU2lkZSA9PT0gMCkge1xyXG4gICAgICAgICAgIGNvbnN0cmFpbnQgPSB0aGlzLmdhbWUucGh5c2ljcy5wMi5jcmVhdGVMb2NrQ29uc3RyYWludChtZS5ib2R5LCBuZWlnaGJvci5ib2R5LCBbb2Zmc2V0LCAwXSwgMSAvIDIgKiBNYXRoLlBJKTtcclxuICAgICAgICB9IGVsc2UgaWYgKG5laWdoYm9yU2lkZSA9PT0gMSkge1xyXG4gICAgICAgICAgICBjb25zdHJhaW50ID0gdGhpcy5nYW1lLnBoeXNpY3MucDIuY3JlYXRlTG9ja0NvbnN0cmFpbnQobWUuYm9keSwgbmVpZ2hib3IuYm9keSwgW29mZnNldCwgMF0sIDApO1xyXG4gICAgICAgIH0gZWxzZSBpZiAobmVpZ2hib3JTaWRlID09PSAyKSB7XHJcbiAgICAgICAgICAgIGNvbnN0cmFpbnQgPSB0aGlzLmdhbWUucGh5c2ljcy5wMi5jcmVhdGVMb2NrQ29uc3RyYWludChtZS5ib2R5LCBuZWlnaGJvci5ib2R5LCBbb2Zmc2V0LCAwXSwgLTEgLyAyICogTWF0aC5QSSk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChuZWlnaGJvclNpZGUgPT09IDMpIHtcclxuICAgICAgICAgICAgY29uc3RyYWludCA9IHRoaXMuZ2FtZS5waHlzaWNzLnAyLmNyZWF0ZUxvY2tDb25zdHJhaW50KG1lLmJvZHksIG5laWdoYm9yLmJvZHksIFtvZmZzZXQsIDBdLCBNYXRoLlBJKTtcclxuICAgICAgICB9XHJcbiAgICAgfVxyXG4gICAgIG1lLmNvbnN0cmFpbnRzLnB1c2goY29uc3RyYWludCk7XHJcbiAgICAgbmVpZ2hib3IuY29uc3RyYWludHMucHVzaChjb25zdHJhaW50KTtcclxuICAgfVxyXG59O1xyXG5cclxuQ3ViZUdyb3VwLnByb3RvdHlwZS5yZWxhdGl2ZVNpZGUgPSBmdW5jdGlvbih0aGlzQm9keSwgb3RoZXJCb2R5KSB7XHJcbiAgdmFyIHRoaXNQb2ludCA9IG5ldyBQaGFzZXIuUG9pbnQodGhpc0JvZHkueCwgdGhpc0JvZHkueSk7XHJcbiAgdmFyIG90aGVyUG9pbnQgPSBuZXcgUGhhc2VyLlBvaW50KG90aGVyQm9keS54LCBvdGhlckJvZHkueSk7XHJcbiAgdmFyIGFuZ2xlVG9PdGhlciA9IHRoaXMuYW5nbGVCZXR3ZWVuUG9pbnRzKHRoaXNQb2ludCwgb3RoZXJQb2ludCk7XHJcbiAgdmFyIGRpZmZBbmdsZSA9IGFuZ2xlVG9PdGhlciAtIHRoaXNCb2R5LnJvdGF0aW9uO1xyXG4gIHJldHVybiB0aGlzLmFuZ2xlVG9EaXIoZGlmZkFuZ2xlKTtcclxufTtcclxuXHJcbkN1YmVHcm91cC5wcm90b3R5cGUuYW5nbGVCZXR3ZWVuUG9pbnRzID0gZnVuY3Rpb24odGhpc1BvaW50LCBvdGhlclBvaW50KSB7XHJcbiAgdmFyIGFuZ2xlVG9PdGhlciA9IFBoYXNlci5Qb2ludC5hbmdsZSh0aGlzUG9pbnQsIG90aGVyUG9pbnQpO1xyXG4gIGlmIChhbmdsZVRvT3RoZXIgPCAwKSB7IC8vIGZpeCBkdW1iIHBhcnQgb2YgUGhhc2VyLlBvaW50LmFuZ2xlKClcclxuICAgICBhbmdsZVRvT3RoZXIgPSAyICogTWF0aC5QSSArIGFuZ2xlVG9PdGhlcjtcclxuICB9XHJcbiAgYW5nbGVUb090aGVyID0gKGFuZ2xlVG9PdGhlciArIDMvMiAqIE1hdGguUEkpICUgKDIgKiBNYXRoLlBJKTsgLy8gcm90YXRlIDkwIGQgY2xvY2t3aXNlXHJcbiAgIHJldHVybiBhbmdsZVRvT3RoZXI7XHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLmZpbmQgPSBmdW5jdGlvbihjdWJlKSB7XHJcbiAgIGZvciAodmFyIHJvdyA9IDA7IHJvdyA8IHRoaXMuY3ViZXNXaWR0aCgpOyByb3crKykge1xyXG4gICAgICBmb3IgKHZhciBjb2wgPSAwOyBjb2wgPCB0aGlzLmN1YmVzSGVpZ2h0KCk7IGNvbCsrKSB7XHJcbiAgICAgICAgIGlmICh0aGlzLmN1YmVzW3Jvd11bY29sXSA9PT0gY3ViZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFBoYXNlci5Qb2ludChyb3csIGNvbCk7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICB9XHJcbiAgIHJldHVybiB1bmRlZmluZWQ7XHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uKHBvaW50KSB7XHJcbiAgaWYgKCFwb2ludCB8fCB0aGlzLm91dE9mQm91bmRzKHBvaW50KSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgfVxyXG4gIHJldHVybiB0aGlzLmN1YmVzW3BvaW50LnhdW3BvaW50LnldO1xyXG59O1xyXG5cclxuQ3ViZUdyb3VwLnByb3RvdHlwZS5jdWJlc1dpZHRoID0gZnVuY3Rpb24oKSB7XHJcbiAgIHJldHVybiB0aGlzLmN1YmVzLmxlbmd0aDtcclxufTtcclxuXHJcbkN1YmVHcm91cC5wcm90b3R5cGUuY3ViZXNIZWlnaHQgPSBmdW5jdGlvbigpIHtcclxuICAgcmV0dXJuIHRoaXMuY3ViZXNbMF0ubGVuZ3RoO1xyXG59O1xyXG5cclxuQ3ViZUdyb3VwLnByb3RvdHlwZS5hZGRUb3BSb3cgPSBmdW5jdGlvbigpIHtcclxuICAgZm9yICh2YXIgcm93ID0gMDsgcm93IDwgdGhpcy5jdWJlc1dpZHRoKCk7IHJvdysrKSB7XHJcbiAgICAgIHRoaXMuY3ViZXNbcm93XS5wdXNoKHVuZGVmaW5lZCk7XHJcbiAgIH1cclxufTtcclxuXHJcbkN1YmVHcm91cC5wcm90b3R5cGUuYWRkUmlnaHRDb2wgPSBmdW5jdGlvbigpIHtcclxuICAgdmFyIG5ld0NvbCA9IFtdO1xyXG4gICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuY3ViZXNIZWlnaHQoKTsgaSsrKSB7XHJcbiAgICAgIG5ld0NvbC5wdXNoKHVuZGVmaW5lZCk7XHJcbiAgIH1cclxuICAgdGhpcy5jdWJlcy5wdXNoKG5ld0NvbCk7XHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLmFkZEJvdFJvdyA9IGZ1bmN0aW9uKCkge1xyXG4gICBmb3IgKHZhciByb3cgPSAwOyByb3cgPCB0aGlzLmN1YmVzV2lkdGgoKTsgcm93KyspIHtcclxuICAgICAgdGhpcy5jdWJlc1tyb3ddLnVuc2hpZnQodW5kZWZpbmVkKTtcclxuICAgfVxyXG59O1xyXG5cclxuQ3ViZUdyb3VwLnByb3RvdHlwZS5hZGRMZWZ0Q29sID0gZnVuY3Rpb24oKSB7XHJcbiAgIHZhciBuZXdDb2wgPSBuZXcgQXJyYXkodGhpcy5jdWJlc0hlaWdodCgpKTtcclxuICAgdGhpcy5jdWJlcy51bnNoaWZ0KG5ld0NvbCk7XHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLmdldEN1YmUgPSBmdW5jdGlvbihwb2ludCkge1xyXG4gICBpZiAoIXBvaW50IHx8IHRoaXMub3V0T2ZCb3VuZHMocG9pbnQpKSB7XHJcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgIH1cclxuICAgcmV0dXJuIHRoaXMuY3ViZXNbcG9pbnQueF1bcG9pbnQueV07XHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLmFkanVzdCA9IGZ1bmN0aW9uKHBvaW50LCBkaXIpIHtcclxuICBpZiAoIXBvaW50KSB7XHJcbiAgICAgcmV0dXJuO1xyXG4gIH1cclxuICB2YXIgbmV3UG9pbnQgPSBuZXcgUGhhc2VyLlBvaW50KHBvaW50LngsIHBvaW50LnkpO1xyXG4gIHN3aXRjaCAoZGlyKSB7XHJcbiAgICAgIGNhc2UgdGhpcy5ESVIuTk9SVEg6XHJcbiAgICAgIG5ld1BvaW50LnkrKztcclxuICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgdGhpcy5ESVIuRUFTVDpcclxuICAgICAgbmV3UG9pbnQueCsrO1xyXG4gICAgICBicmVhaztcclxuICAgICAgY2FzZSB0aGlzLkRJUi5TT1VUSDpcclxuICAgICAgbmV3UG9pbnQueS0tO1xyXG4gICAgICBicmVhaztcclxuICAgICAgY2FzZSB0aGlzLkRJUi5XRVNUOlxyXG4gICAgICBuZXdQb2ludC54LS07XHJcbiAgICAgIGJyZWFrO1xyXG4gICB9XHJcbiAgIHJldHVybiBuZXdQb2ludDtcclxufTtcclxuXHJcbkN1YmVHcm91cC5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24oY3ViZSwgcG9pbnQpIHtcclxuICAgaWYgKCFwb2ludCkge1xyXG4gICAgICBjb25zb2xlLmxvZygnc2V0IGdpdmVuIHVuZGVmaW5lZCBwb2ludCcpO1xyXG4gICAgICByZXR1cm47XHJcbiAgIH1cclxuICAgaWYgKHBvaW50LnggPCAwKSB7XHJcbiAgICAgIGlmICh0aGlzLmRlYnVnKSB7IGNvbnNvbGUubG9nKCdhZGQgbGVmdCBjb2wnKTsgfVxyXG4gICAgICB0aGlzLmFkZExlZnRDb2woKTtcclxuICAgICAgcG9pbnQueCA9IDA7XHJcbiAgIH0gZWxzZSBpZiAocG9pbnQueCA+PSB0aGlzLmN1YmVzV2lkdGgoKSkge1xyXG4gICAgICBpZiAodGhpcy5kZWJ1ZykgeyBjb25zb2xlLmxvZygnYWRkIHJpZ2h0IGNvbCcpOyB9XHJcbiAgICAgIHRoaXMuYWRkUmlnaHRDb2woKTtcclxuICAgICAgcG9pbnQueCA9IHRoaXMuY3ViZXNXaWR0aCgpIC0gMTtcclxuICAgfSBlbHNlIGlmIChwb2ludC55IDwgMCkge1xyXG4gICAgICBpZiAodGhpcy5kZWJ1ZykgeyBjb25zb2xlLmxvZygnYWRkIGJvdCByb3cnKTsgfVxyXG4gICAgICB0aGlzLmFkZEJvdFJvdygpO1xyXG4gICAgICBwb2ludC55ID0gMDtcclxuICAgfSBlbHNlIGlmIChwb2ludC55ID49IHRoaXMuY3ViZXNIZWlnaHQoKSkge1xyXG4gICAgICBpZiAodGhpcy5kZWJ1ZykgeyBjb25zb2xlLmxvZygnYWRkIHRvcCByb3cnKTsgfVxyXG4gICAgICB0aGlzLmFkZFRvcFJvdygpO1xyXG4gICAgICBwb2ludC55ID0gdGhpcy5jdWJlc0hlaWdodCgpIC0gMTtcclxuICAgfVxyXG4gICBpZiAodGhpcy5nZXQocG9pbnQpKSB7XHJcbiAgICAgIC8vIGNvbnNvbGUubG9nKCd0cmllZCB0byBzZXQgdG8gZmlsbGVkIHBvc2l0aW9uJyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgfVxyXG4gICB0aGlzLmN1YmVzW3BvaW50LnhdW3BvaW50LnldID0gY3ViZTtcclxuICAgY3ViZS5ncm91cCA9IHRoaXM7XHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLm91dE9mQm91bmRzID0gZnVuY3Rpb24ocG9pbnQpIHtcclxuICAgaWYgKCFwb2ludCkge1xyXG4gICAgICBjb25zb2xlLmxvZygnb3V0IG9mIGJvdW5kcyBnaXZlbiB1bmRlZmluZWQgcG9pbnQnKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICB9XHJcbiAgIGlmIChwb2ludC54IDwgMCB8fCBwb2ludC54ID49IHRoaXMuY3ViZXNXaWR0aCgpIHx8IHBvaW50LnkgPCAwIHx8IHBvaW50LnkgPj0gdGhpcy5jdWJlc0hlaWdodCgpKSB7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICB9XHJcbiAgIHJldHVybiBmYWxzZTtcclxufTtcclxuXHJcbkN1YmVHcm91cC5wcm90b3R5cGUuZGlzcGxheUN1YmVzID0gZnVuY3Rpb24oKSB7XHJcbiAgIHZhciBvdXRwdXQgPSAnZGlzcGxheUN1YmVzKCk6XFxuJztcclxuICAgdmFyIHJvdyA9IDA7XHJcbiAgIHZhciBjb2wgPSB0aGlzLmN1YmVzSGVpZ2h0KCkgLSAxO1xyXG4gICB3aGlsZSAoY29sID49IDApIHtcclxuICAgICAgd2hpbGUgKHJvdyA8IHRoaXMuY3ViZXNXaWR0aCgpKSB7XHJcbiAgICAgICAgIHZhciBjdWJlID0gdGhpcy5jdWJlc1tyb3ddW2NvbF07XHJcbiAgICAgICAgIGlmIChjdWJlKSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAoY3ViZS5tb2R1bGUudHlwZSkge1xyXG4gICAgICAgICAgICAgICBjYXNlICdzaGllbGQnOlxyXG4gICAgICAgICAgICAgICBvdXRwdXQgKz0gJ1MgJztcclxuICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgIGNhc2UgJ2NvcmUnOlxyXG4gICAgICAgICAgICAgICBvdXRwdXQgKz0gJ0MgJztcclxuICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgIGNhc2UgJ3RocnVzdGVyJzpcclxuICAgICAgICAgICAgICAgb3V0cHV0ICs9ICdUICc7XHJcbiAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICBjYXNlICdzb2xhclBhbmVsJzpcclxuICAgICAgICAgICAgICAgb3V0cHV0ICs9ICdQICc7XHJcbiAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICBjYXNlICdoYWNrZXInOlxyXG4gICAgICAgICAgICAgICBvdXRwdXQgKz0gJ0ggJztcclxuICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgIGNhc2UgJ2d1bic6XHJcbiAgICAgICAgICAgICAgIG91dHB1dCArPSAnRyAnO1xyXG4gICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBvdXRwdXQgKz0gJ18gJztcclxuICAgICAgICAgfVxyXG4gICAgICAgICByb3crKztcclxuICAgICAgfVxyXG4gICAgICByb3cgPSAwO1xyXG4gICAgICBjb2wtLTtcclxuICAgICAgb3V0cHV0ICs9ICdcXG4nO1xyXG4gICB9XHJcbiAgIGNvbnNvbGUubG9nKG91dHB1dCk7XHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLmRpc3BsYXlDb25uZWN0aW9uID0gZnVuY3Rpb24oY29ubmVjdGlvbikge1xyXG4gICB2YXIgZ3JhcGggPSBuZXcgQXN0YXIuR3JhcGgodGhpcy5jdWJlc1RvR3JhcGgoKSk7XHJcbiAgIHZhciBzdGFydFBvaW50ID0gdGhpcy5maW5kKGNvbm5lY3Rpb24uc3RhcnQpO1xyXG4gICB2YXIgZW5kUG9pbnQgPSB0aGlzLmZpbmQoY29ubmVjdGlvbi5lbmQpO1xyXG4gICBpZiAoIXN0YXJ0UG9pbnQgfHwgIWVuZFBvaW50KSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdkaXNwbGF5Q29ubmVjdGlvbiBmYWlsZWQgdG8gZ2V0IHBvaW50cycpO1xyXG4gICAgICByZXR1cm47XHJcbiAgIH1cclxuICAgdmFyIHN0YXJ0ID0gZ3JhcGguZ3JpZFtzdGFydFBvaW50LnhdW3N0YXJ0UG9pbnQueV07XHJcbiAgIHZhciBlbmQgPSBncmFwaC5ncmlkW2VuZFBvaW50LnhdW2VuZFBvaW50LnldO1xyXG4gICB2YXIgcmVzdWx0ID0gQXN0YXIuYXN0YXIuc2VhcmNoKGdyYXBoLCBzdGFydCwgZW5kKTtcclxuICAgcmVzdWx0LnVuc2hpZnQoc3RhcnQpO1xyXG4gICB2YXIgcHJldmlvdXM7XHJcbiAgIGZvcih2YXIgaSA9IDA7IGkgPCByZXN1bHQubGVuZ3RoOyBpKyspIHtcclxuICAgICAgdmFyIGN1clBvaW50ID0gbmV3IFBoYXNlci5Qb2ludChyZXN1bHRbaV0ueCwgcmVzdWx0W2ldLnkpO1xyXG4gICAgICB2YXIgY3VyID0gdGhpcy5nZXQoY3VyUG9pbnQpO1xyXG4gICAgICB2YXIgaW5kaWNhdG9yID0gY3VyLmNJbmRpY2F0b3I7XHJcbiAgICAgIHZhciBkaXI7XHJcbiAgICAgIHZhciBwcmV2UG9pbnQ7XHJcbiAgICAgIHZhciBuZXh0UG9pbnQ7XHJcbiAgICAgIGlmICghcHJldmlvdXMpIHtcclxuICAgICAgICAgaW5kaWNhdG9yLmFuaW1hdGlvbnMucGxheSgnZW5kJyk7XHJcbiAgICAgICAgIG5leHRQb2ludCA9IG5ldyBQaGFzZXIuUG9pbnQocmVzdWx0W2krMV0ueCwgcmVzdWx0W2krMV0ueSk7XHJcbiAgICAgICAgIGRpciA9IHRoaXMuZGlyQmV0d2VlbihjdXJQb2ludCwgbmV4dFBvaW50KTtcclxuICAgICAgICAgaW5kaWNhdG9yLnJvdGF0aW9uID0gdGhpcy5kaXJUb0FuZ2xlKGRpcik7XHJcbiAgICAgIH0gZWxzZSBpZiAoaSA9PT0gcmVzdWx0Lmxlbmd0aCAtIDEpIHtcclxuICAgICAgICAgaW5kaWNhdG9yLmFuaW1hdGlvbnMucGxheSgnZW5kJyk7XHJcbiAgICAgICAgIHByZXZQb2ludCA9IG5ldyBQaGFzZXIuUG9pbnQocHJldmlvdXMueCwgcHJldmlvdXMueSk7XHJcbiAgICAgICAgIGRpciA9IHRoaXMuZGlyQmV0d2VlbihjdXJQb2ludCwgcHJldlBvaW50KTtcclxuICAgICAgICAgaW5kaWNhdG9yLnJvdGF0aW9uID0gdGhpcy5kaXJUb0FuZ2xlKGRpcik7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgIGluZGljYXRvci5hbmltYXRpb25zLnBsYXkoJ2xpbmUnKTtcclxuICAgICAgICAgcHJldlBvaW50ID0gbmV3IFBoYXNlci5Qb2ludChwcmV2aW91cy54LCBwcmV2aW91cy55KTtcclxuICAgICAgICAgdmFyIHByZXZEaXIgPSB0aGlzLmRpckJldHdlZW4oY3VyUG9pbnQsIHByZXZQb2ludCk7XHJcbiAgICAgICAgIG5leHRQb2ludCA9IG5ldyBQaGFzZXIuUG9pbnQocmVzdWx0W2krMV0ueCwgcmVzdWx0W2krMV0ueSk7XHJcbiAgICAgICAgIHZhciBuZXh0RGlyID0gdGhpcy5kaXJCZXR3ZWVuKGN1clBvaW50LCBuZXh0UG9pbnQpO1xyXG4gICAgICAgICB0aGlzLm1hbmFnZUluZGljYXRvcihpbmRpY2F0b3IsIHByZXZEaXIsIG5leHREaXIpO1xyXG4gICAgICB9XHJcbiAgICAgIHByZXZpb3VzID0gcmVzdWx0W2ldO1xyXG4gICAgICBjdXIuZGlzcGxheUluZGljYXRvcigpO1xyXG4gICAgfVxyXG59O1xyXG5cclxuQ3ViZUdyb3VwLnByb3RvdHlwZS5tYW5hZ2VJbmRpY2F0b3IgPSBmdW5jdGlvbihpbmRpY2F0b3IsIHByZXZEaXIsIG5leHREaXIpIHtcclxuICBpbmRpY2F0b3Iuc2NhbGUuc2V0VG8oTWF0aC5hYnMoaW5kaWNhdG9yLnNjYWxlLngpLCBpbmRpY2F0b3Iuc2NhbGUueSk7XHJcbiAgaWYgKHByZXZEaXIgPT09IHRoaXMuRElSLk5PUlRIICYmIG5leHREaXIgPT09IHRoaXMuRElSLlNPVVRIKSB7IC8vIDJcclxuICAgICAgaW5kaWNhdG9yLnJvdGF0aW9uID0gTWF0aC5QSTtcclxuICAgfSBlbHNlIGlmIChwcmV2RGlyID09PSB0aGlzLkRJUi5TT1VUSCAmJiBuZXh0RGlyID09PSB0aGlzLkRJUi5OT1JUSCkgeyAvLyAxXHJcbiAgICAgIGluZGljYXRvci5yb3RhdGlvbiA9IDA7XHJcbiAgIH0gZWxzZSBpZiAocHJldkRpciA9PT0gdGhpcy5ESVIuRUFTVCAmJiBuZXh0RGlyID09PSB0aGlzLkRJUi5XRVNUKSB7IC8vIDRcclxuICAgICAgaW5kaWNhdG9yLnJvdGF0aW9uID0gMSAvIDIgKiBNYXRoLlBJO1xyXG4gICB9IGVsc2UgaWYgKHByZXZEaXIgPT09IHRoaXMuRElSLldFU1QgJiYgbmV4dERpciA9PT0gdGhpcy5ESVIuRUFTVCkgeyAvLyAzXHJcbiAgICAgIGluZGljYXRvci5yb3RhdGlvbiA9IDMgLyAyICAqIE1hdGguUEk7XHJcbiAgIH0gZWxzZSB7XHJcbiAgICAgIGluZGljYXRvci5hbmltYXRpb25zLnBsYXkoJ3JpZ2h0Jyk7XHJcbiAgICAgIGlmIChwcmV2RGlyID09PSB0aGlzLkRJUi5TT1VUSCAmJiBuZXh0RGlyID09PSB0aGlzLkRJUi5FQVNUKSB7IC8vIDVcclxuICAgICAgICAgaW5kaWNhdG9yLnJvdGF0aW9uID0gMDtcclxuICAgICAgfSBlbHNlIGlmIChwcmV2RGlyID09PSB0aGlzLkRJUi5XRVNUICYmIG5leHREaXIgPT09IHRoaXMuRElSLlNPVVRIKSB7IC8vIDZcclxuICAgICAgICAgaW5kaWNhdG9yLnJvdGF0aW9uID0gMSAvIDIgKiBNYXRoLlBJO1xyXG4gICAgICB9IGVsc2UgaWYgKHByZXZEaXIgPT09IHRoaXMuRElSLk5PUlRIICYmIG5leHREaXIgPT09IHRoaXMuRElSLldFU1QpIHsgLy8gN1xyXG4gICAgICAgICBpbmRpY2F0b3Iucm90YXRpb24gPSBNYXRoLlBJO1xyXG4gICAgICB9IGVsc2UgaWYgKHByZXZEaXIgPT09IHRoaXMuRElSLkVBU1QgJiYgbmV4dERpciA9PT0gdGhpcy5ESVIuTk9SVEgpIHsgLy8gOFxyXG4gICAgICAgICBpbmRpY2F0b3Iucm90YXRpb24gPSAzIC8gMiAqIE1hdGguUEk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgIGluZGljYXRvci5zY2FsZS5zZXRUbygtTWF0aC5hYnMoaW5kaWNhdG9yLnNjYWxlLngpLCBpbmRpY2F0b3Iuc2NhbGUueSk7XHJcbiAgICAgICAgIGlmIChwcmV2RGlyID09PSB0aGlzLkRJUi5TT1VUSCAmJiBuZXh0RGlyID09PSB0aGlzLkRJUi5XRVNUKSB7IC8vIDlcclxuICAgICAgICAgICAgaW5kaWNhdG9yLnJvdGF0aW9uID0gMDtcclxuICAgICAgICAgfSBlbHNlIGlmIChwcmV2RGlyID09PSB0aGlzLkRJUi5XRVNUICYmIG5leHREaXIgPT09IHRoaXMuRElSLk5PUlRIKSB7IC8vIDEwXHJcbiAgICAgICAgICAgIGluZGljYXRvci5yb3RhdGlvbiA9IDEgLyAyICogTWF0aC5QSTtcclxuICAgICAgICAgfSBlbHNlIGlmIChwcmV2RGlyID09PSB0aGlzLkRJUi5OT1JUSCAmJiBuZXh0RGlyID09PSB0aGlzLkRJUi5FQVNUKSB7IC8vIDExXHJcbiAgICAgICAgICAgIGluZGljYXRvci5yb3RhdGlvbiA9IE1hdGguUEk7XHJcbiAgICAgICAgIH0gZWxzZSBpZiAocHJldkRpciA9PT0gdGhpcy5ESVIuRUFTVCAmJiBuZXh0RGlyID09PSB0aGlzLkRJUi5TT1VUSCkgeyAvLyAxMlxyXG4gICAgICAgICAgICBpbmRpY2F0b3Iucm90YXRpb24gPSAzIC8gMiAqIE1hdGguUEk7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICB9IFxyXG59O1xyXG5cclxuQ3ViZUdyb3VwLnByb3RvdHlwZS5jdWJlc1RvR3JhcGggPSBmdW5jdGlvbigpIHtcclxuICB2YXIgZ3JhcGggPSBbXTtcclxuICBmb3IgKHZhciByb3cgPSAwOyByb3cgPCB0aGlzLmN1YmVzV2lkdGgoKTsgcm93KyspIHtcclxuICAgICB2YXIgbmV3Q29sID0gW107XHJcbiAgICAgIGZvciAodmFyIGNvbCA9IDA7IGNvbCA8IHRoaXMuY3ViZXNIZWlnaHQoKTsgY29sKyspIHtcclxuICAgICAgICAgaWYgKHRoaXMuY3ViZXNbcm93XVtjb2xdKSB7XHJcbiAgICAgICAgICAgIG5ld0NvbC5wdXNoKDEpO1xyXG4gICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBuZXdDb2wucHVzaCgwKTtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGdyYXBoLnB1c2gobmV3Q29sKTtcclxuICAgfVxyXG4gICByZXR1cm4gZ3JhcGg7XHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLmRpckJldHdlZW4gPSBmdW5jdGlvbihhLCBiKSB7XHJcbiAgIHZhciBkZWx0YVggPSBhLnggLSBiLng7XHJcbiAgIHZhciBkZWx0YVkgPSBhLnkgLSBiLnk7XHJcbiAgIGlmIChkZWx0YVggPiAwKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLkRJUi5XRVNUO1xyXG4gICB9XHJcbiAgIGlmIChkZWx0YVggPCAwKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLkRJUi5FQVNUO1xyXG4gICB9XHJcbiAgIGlmIChkZWx0YVkgPiAwKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLkRJUi5TT1VUSDtcclxuICAgfVxyXG4gICBpZiAoZGVsdGFZIDwgMCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5ESVIuTk9SVEg7XHJcbiAgIH1cclxuICAgcmV0dXJuIHRoaXMuRElSLk5PUlRIO1xyXG59O1xyXG5cclxuQ3ViZUdyb3VwLnByb3RvdHlwZS5kaXJUb0FuZ2xlID0gZnVuY3Rpb24oZGlyKSB7XHJcbiAgc3dpdGNoIChkaXIpIHtcclxuICAgY2FzZSB0aGlzLkRJUi5OT1JUSDpcclxuICAgcmV0dXJuIE1hdGguUEk7XHJcbiAgIGNhc2UgdGhpcy5ESVIuRUFTVDpcclxuICAgcmV0dXJuIDMgLyAyICogTWF0aC5QSTtcclxuICAgY2FzZSB0aGlzLkRJUi5TT1VUSDpcclxuICAgcmV0dXJuIDA7XHJcbiAgIGNhc2UgdGhpcy5ESVIuV0VTVDpcclxuICAgcmV0dXJuIDEgLyAyICogTWF0aC5QSTtcclxuICB9ICBcclxufTtcclxuXHJcbkN1YmVHcm91cC5wcm90b3R5cGUuZGVzdHJveUN1YmUgPSBmdW5jdGlvbihjdWJlKSB7XHJcbiAgdmFyIGxvYyA9IHRoaXMuZmluZChjdWJlKTtcclxuICBpZiAoIWxvYykge1xyXG4gICAgIGNvbnNvbGUubG9nKCdhdHRlbXB0IHRvIGRlc3Ryb3kgY3ViZSBub3QgaW4gZ3JvdXAnKTtcclxuICAgICByZXR1cm47XHJcbiAgfVxyXG4gIC8vIHJlbW92ZSBjdWJlIGZyb20gZ3JvdXBcclxuICB0aGlzLnJlbW92ZShjdWJlKTtcclxuICAvLyBkZXN0cm95IGN1YmVcclxuICBjdWJlLmtpbGwodHJ1ZSk7XHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uKGN1YmUpIHtcclxuICAgY29uc29sZS5sb2coJ3JlbW92ZSgpJyk7XHJcbiAgIGlmICh0aGlzLnJvb3QgPT09IGN1YmUpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICB9XHJcbiAgIC8vIHJlbW92ZSBjdWJlIGZyb20gYXJyYXlcclxuICAgdmFyIHJvdywgY29sO1xyXG4gICBmb3IgKHJvdyA9IDA7IHJvdyA8IHRoaXMuY3ViZXNXaWR0aCgpOyByb3crKykge1xyXG4gICAgICBmb3IgKGNvbCA9IDA7IGNvbCA8IHRoaXMuY3ViZXNIZWlnaHQoKTsgY29sKyspIHtcclxuICAgICAgICAgaWYgKHRoaXMuY3ViZXNbcm93XVtjb2xdID09PSBjdWJlKSB7XHJcbiAgICAgICAgICAgIC8vIHRoaXMuY3ViZXNbcm93XVtjb2xdLmdyb3VwID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICB0aGlzLmN1YmVzW3Jvd11bY29sXSA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICB9XHJcbiAgIC8vIHJlbW92ZSBjb25zdHJhaW50cyBmcm9tIGN1YmVcclxuICAgdGhpcy5yZW1vdmVDb25zdHJhaW50cyhjdWJlKTtcclxuICAgY3ViZS5ncm91cCA9IHVuZGVmaW5lZDtcclxuICAgaWYgKGN1YmUubW9kdWxlICYmIGN1YmUubW9kdWxlLmhhc093blByb3BlcnR5KCdvblJlbW92ZScpKSB7XHJcbiAgICAgIGN1YmUubW9kdWxlLm9uUmVtb3ZlKCk7XHJcbiAgIH1cclxuICAgLy8gdGVzdCBmb3IgZXhpbGVzXHJcbiAgIGZvciAocm93ID0gMDsgcm93IDwgdGhpcy5jdWJlc1dpZHRoKCk7IHJvdysrKSB7XHJcbiAgICAgIGZvciAoY29sID0gMDsgY29sIDwgdGhpcy5jdWJlc0hlaWdodCgpOyBjb2wrKykge1xyXG4gICAgICAgICB2YXIgZXhpbGUgPSB0aGlzLmN1YmVzW3Jvd11bY29sXTtcclxuICAgICAgICAgaWYgKGV4aWxlICYmIHRoaXMuaXNFeGlsZShleGlsZSkpIHtcclxuICAgICAgICAgICAgdGhpcy5yZW1vdmUoZXhpbGUpO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICBpZiAodGhpcy5kZWJ1ZykgeyB0aGlzLmRpc3BsYXlDdWJlcygpOyB9XHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLnJlbW92ZU5laWdoYm9yc0NvbnN0cmFpbnQgPSBmdW5jdGlvbihjb25zdHJhaW50LCBjdWJlKSB7XHJcbiAgIC8vIGNvbnNvbGUubG9nKCdyZW1vdmVOZWlnaGJvcnNDb25zdHJhaW50Jyk7XHJcbiAgIHZhciBuZWlnaGJvcnMgPSB0aGlzLmdldE5laWdoYm9ycyhjdWJlKTtcclxuICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuZWlnaGJvcnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgdmFyIG5laWdoYm9yID0gbmVpZ2hib3JzW2ldO1xyXG4gICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG5laWdoYm9yLmNvbnN0cmFpbnRzLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgIGlmIChuZWlnaGJvci5jb25zdHJhaW50c1tqXSA9PT0gY29uc3RyYWludCkge1xyXG4gICAgICAgICAgICBuZWlnaGJvci5jb25zdHJhaW50cy5zcGxpY2UoaiwgMSk7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICB9XHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLmdldE5laWdoYm9ycyA9IGZ1bmN0aW9uKGN1YmUpIHtcclxuICAgdmFyIGxvYyA9IHRoaXMuZmluZChjdWJlKTtcclxuICAgdmFyIG5vcnRoID0gdGhpcy5nZXQodGhpcy5hZGp1c3QobG9jLCB0aGlzLkRJUi5OT1JUSCkpO1xyXG4gICB2YXIgZWFzdCA9IHRoaXMuZ2V0KHRoaXMuYWRqdXN0KGxvYywgdGhpcy5ESVIuRUFTVCkpO1xyXG4gICB2YXIgc291dGggPSB0aGlzLmdldCh0aGlzLmFkanVzdChsb2MsIHRoaXMuRElSLlNPVVRIKSk7XHJcbiAgIHZhciB3ZXN0ID0gdGhpcy5nZXQodGhpcy5hZGp1c3QobG9jLCB0aGlzLkRJUi5XRVNUKSk7XHJcbiAgIHZhciBuZWlnaGJvcnMgPSBbXTtcclxuICAgaWYgKG5vcnRoKSB7XHJcbiAgICAgIG5laWdoYm9ycy5wdXNoKG5vcnRoKTtcclxuICAgfVxyXG4gICBpZiAoZWFzdCkge1xyXG4gICAgICBuZWlnaGJvcnMucHVzaChlYXN0KTtcclxuICAgfVxyXG4gICBpZiAoc291dGgpIHtcclxuICAgICAgbmVpZ2hib3JzLnB1c2goc291dGgpO1xyXG4gICB9XHJcbiAgIGlmICh3ZXN0KSB7XHJcbiAgICAgIG5laWdoYm9ycy5wdXNoKHdlc3QpO1xyXG4gICB9XHJcbiAgIHJldHVybiBuZWlnaGJvcnM7XHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLnJlbW92ZUNvbnN0cmFpbnRzID0gZnVuY3Rpb24oY3ViZSkge1xyXG4gICAvLyBjb25zb2xlLmxvZygncmVtb3ZlQ29uc3RyYWludHMnKTtcclxuICAgd2hpbGUgKGN1YmUuY29uc3RyYWludHMubGVuZ3RoID4gMCkge1xyXG4gICAgICB0aGlzLnJlbW92ZU5laWdoYm9yc0NvbnN0cmFpbnQoY3ViZS5jb25zdHJhaW50c1swXSwgY3ViZSk7XHJcbiAgICAgIHRoaXMuZ2FtZS5waHlzaWNzLnAyLnJlbW92ZUNvbnN0cmFpbnQoY3ViZS5jb25zdHJhaW50c1swXSk7XHJcbiAgICAgIGN1YmUuY29uc3RyYWludHMuc3BsaWNlKDAsIDEpO1xyXG4gICB9XHJcbn07XHJcblxyXG4vLyBvbmx5IHVzZWQgdG8gdGVzdCBBc3RhclxyXG5DdWJlR3JvdXAucHJvdG90eXBlLnRlc3RQYXRoID0gZnVuY3Rpb24oKSB7XHJcbiAgdmFyIGdyYXBoID0gbmV3IEFzdGFyLkdyYXBoKFtcclxuICAgICAgICBbMSwxLDEsMV0sXHJcbiAgICAgICAgWzAsMSwxLDBdLFxyXG4gICAgICAgIFswLDAsMCwxXVxyXG4gICAgXSk7XHJcbiAgIHZhciBzdGFydCA9IGdyYXBoLmdyaWRbMF1bMF07XHJcbiAgIHZhciBlbmQgPSBncmFwaC5ncmlkWzJdWzNdO1xyXG4gICB2YXIgcmVzdWx0ID0gQXN0YXIuYXN0YXIuc2VhcmNoKGdyYXBoLCBzdGFydCwgZW5kKTtcclxuICAgcmVzdWx0LnVuc2hpZnQoc3RhcnQpO1xyXG4gICBmb3IodmFyIGkgPSAwOyBpIDwgcmVzdWx0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKHJlc3VsdFtpXS54LCByZXN1bHRbaV0ueSk7XHJcbiAgICB9IFxyXG59O1xyXG5cclxuQ3ViZUdyb3VwLnByb3RvdHlwZS5pc0V4aWxlID0gZnVuY3Rpb24oY3ViZSkge1xyXG4gICBpZiAoY3ViZSA9PT0gdGhpcy5yb290KSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgfVxyXG4gICB2YXIgZ3JhcGggPSBuZXcgQXN0YXIuR3JhcGgodGhpcy5jdWJlc1RvR3JhcGgoKSk7XHJcbiAgIHZhciBzdGFydFBvaW50ID0gdGhpcy5maW5kKHRoaXMucm9vdCk7XHJcbiAgIHZhciBlbmRQb2ludCA9IHRoaXMuZmluZChjdWJlKTtcclxuICAgdmFyIHN0YXJ0ID0gZ3JhcGguZ3JpZFtzdGFydFBvaW50LnhdW3N0YXJ0UG9pbnQueV07XHJcbiAgIHZhciBlbmQgPSBncmFwaC5ncmlkW2VuZFBvaW50LnhdW2VuZFBvaW50LnldO1xyXG4gICB2YXIgcmVzdWx0ID0gQXN0YXIuYXN0YXIuc2VhcmNoKGdyYXBoLCBzdGFydCwgZW5kKTtcclxuICAgLy8gaWYgbm8gcGF0aCBpcyBmb3VuZCwgdGhlIGN1YmUgaXMgYW4gZXhpbGVcclxuICAgaWYgKHJlc3VsdC5sZW5ndGggPT09IDApIHtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgIH1cclxuICAgcmV0dXJuIGZhbHNlO1xyXG59O1xyXG5cclxuQ3ViZUdyb3VwLnByb3RvdHlwZS5jb3VudEN1YmVzID0gZnVuY3Rpb24oKSB7XHJcblx0dmFyIHJvdywgY29sO1xyXG5cdHZhciBudW0gID0gMDtcclxuXHRmb3IgKHJvdyA9IDA7IHJvdyA8IHRoaXMuY3ViZXNXaWR0aCgpOyByb3crKykge1xyXG5cdFx0Zm9yIChjb2wgPSAwOyBjb2wgPCB0aGlzLmN1YmVzSGVpZ2h0KCk7IGNvbCsrKSB7XHJcblx0XHRcdGlmICh0aGlzLmN1YmVzW3Jvd11bY29sXSAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFx0bnVtKys7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblx0Ly9jb25zb2xlLmxvZyhudW0pO1xyXG5cdHRoaXMubnVtQ3ViZXMgPSBudW07XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEN1YmVHcm91cDtcclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbiIsInZhciBVdGlscyA9IHJlcXVpcmUoJy4uL3V0aWxzLmpzJyk7XHJcblxyXG52YXIgRW5lbXlBSSA9IGZ1bmN0aW9uKGdhbWUsIGdyb3VwLCB0eXBlLCBwbGF5ZXJHcm91cCkge1xyXG4gICB0aGlzLmdhbWUgPSBnYW1lO1xyXG4gICB0aGlzLmdyb3VwID0gZ3JvdXA7XHJcbiAgIHRoaXMudHlwZSA9IHR5cGU7XHJcbiAgIHRoaXMucGxheWVyR3JvdXAgPSBwbGF5ZXJHcm91cDtcclxuICAgdGhpcy5wbGF5ZXIgPSB0aGlzLnBsYXllckdyb3VwLnJvb3Q7XHJcbiAgIHRoaXMucmFtRGlzdCA9IDUwMDtcclxuICAgdGhpcy5zaG9vdERpc3QgPSA1MDA7XHJcbiAgIHRoaXMucm90YXRpb25Gb3JjZSA9IDUwO1xyXG4gICB0aGlzLmZhY2luZ0FsbG93YW5jZSA9IE1hdGguUEkgLyAxNTtcclxuICAgdGhpcy5hY3RpbmcgPSBmYWxzZTtcclxuICAgc3dpdGNoICh0aGlzLnR5cGUpIHtcclxuICAgICAgY2FzZSAncmFtJzpcclxuICAgICAgdGhpcy5hbGxvY2F0ZVRvKCd0aHJ1c3RlcicpO1xyXG4gICAgICBicmVhaztcclxuICAgICAgY2FzZSAnc2hvb3QnOlxyXG4gICAgICB0aGlzLmFsbG9jYXRlVG8oJ2d1bicpO1xyXG4gICB9XHJcbn07XHJcblxyXG5FbmVteUFJLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IEVuZW15QUk7XHJcblxyXG5FbmVteUFJLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHtcclxuICAgc3dpdGNoICh0aGlzLnR5cGUpIHtcclxuICAgICAgY2FzZSAncmFtJzpcclxuICAgICAgdGhpcy5jdXN0b21VcGRhdGUoJ3RocnVzdGVyJywgdGhpcy5yYW1EaXN0KTtcclxuICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ3Nob290JzpcclxuICAgICAgdGhpcy5jdXN0b21VcGRhdGUoJ2d1bicsIHRoaXMuc2hvb3REaXN0KTtcclxuICAgfVxyXG59O1xyXG5cclxuRW5lbXlBSS5wcm90b3R5cGUuY3VzdG9tVXBkYXRlID0gZnVuY3Rpb24odHlwZSwgdGhyZXNob2xkKSB7XHJcbiAgIGlmICghdGhpcy5ncm91cC5yb290KSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgfVxyXG4gICB2YXIgcm9vdCA9IHRoaXMuZ3JvdXAucm9vdDtcclxuICAgdmFyIG15UG9zID0gbmV3IFBoYXNlci5Qb2ludChyb290LngsIHJvb3QueSk7XHJcbiAgIHZhciBwbGF5ZXJQb3MgPSBuZXcgUGhhc2VyLlBvaW50KHRoaXMucGxheWVyLngsIHRoaXMucGxheWVyLnkpO1xyXG4gICB2YXIgZGlzdCA9IFV0aWxzLmRpc3RhbmNlKG15UG9zLngsIG15UG9zLnksIHBsYXllclBvcy54LCBwbGF5ZXJQb3MueSk7XHJcbiAgIGlmIChkaXN0IDw9IHRocmVzaG9sZCkge1xyXG4gICAgICB2YXIgYW5nbGVUbyA9IHRoaXMuYW5nbGVUbyhteVBvcywgcGxheWVyUG9zKTtcclxuICAgICAgdmFyIGRpZmZBbmdsZSA9IGFuZ2xlVG8gLSByb290LmJvZHkucm90YXRpb247XHJcbiAgICAgIGlmIChkaWZmQW5nbGUgPiAwKSB7XHJcbiAgICAgICAgIHJvb3QuYm9keS5hbmd1bGFyRm9yY2UgPSB0aGlzLnJvdGF0aW9uRm9yY2U7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgIHJvb3QuYm9keS5hbmd1bGFyRm9yY2UgPSAtdGhpcy5yb3RhdGlvbkZvcmNlO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChNYXRoLmFicyhkaWZmQW5nbGUpIDw9IHRoaXMuZmFjaW5nQWxsb3dhbmNlICYmICF0aGlzLmFjdGluZykge1xyXG4gICAgICAgICAvLyB0aGlzLmdyb3VwLmNhbGwoJ2JlZ2luQWN0Jyk7XHJcbiAgICAgICAgIHRoaXMuZ3JvdXAuY2FsbE9uVHlwZSgnYmVnaW5BY3QnLCB0eXBlKTtcclxuICAgICAgICAgdGhpcy5hY3RpbmcgPSB0cnVlO1xyXG4gICAgICAgICAvLyB0aGlzLmFsbG9jYXRlVG8odHlwZSk7XHJcbiAgICAgIH0gZWxzZSBpZiAoTWF0aC5hYnMoZGlmZkFuZ2xlKSA+IHRoaXMuZmFjaW5nQWxsb3dhbmNlICYmIHRoaXMuYWN0aW5nKXtcclxuICAgICAgICAgLy8gdGhpcy5ncm91cC5jYWxsKCdlbmRBY3QnKTtcclxuICAgICAgICAgdGhpcy5ncm91cC5jYWxsT25UeXBlKCdlbmRBY3QnLCB0eXBlKTtcclxuICAgICAgICAgdGhpcy5hY3RpbmcgPSBmYWxzZTtcclxuICAgICAgfVxyXG4gICB9XHJcbn07XHJcblxyXG5FbmVteUFJLnByb3RvdHlwZS5hbGxvY2F0ZVRvID0gZnVuY3Rpb24odHlwZSkge1xyXG4gICB2YXIgcGFuZWxzID0gW107XHJcbiAgIHZhciB0eXBlcyA9IFtdO1xyXG4gICBmb3IgKHZhciByb3cgPSAwOyByb3cgPCB0aGlzLmdyb3VwLmN1YmVzV2lkdGgoKTsgcm93KyspIHtcclxuICAgICAgZm9yICh2YXIgY29sID0gMDsgY29sIDwgdGhpcy5ncm91cC5jdWJlc0hlaWdodCgpOyBjb2wrKykge1xyXG4gICAgICAgICB2YXIgY3ViZSA9IHRoaXMuZ3JvdXAuY3ViZXNbcm93XVtjb2xdO1xyXG4gICAgICAgICBpZiAoY3ViZSAmJiBjdWJlLm1vZHVsZSkge1xyXG4gICAgICAgICAgICBpZiAoY3ViZS5tb2R1bGUudHlwZSA9PT0gJ3NvbGFyUGFuZWwnICYmICFjdWJlLm15Q29ubmVjdGlvbikge1xyXG4gICAgICAgICAgICAgICBwYW5lbHMucHVzaChjdWJlLm1vZHVsZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY3ViZS5tb2R1bGUudHlwZSA9PT0gdHlwZSAmJiAhY3ViZS5teUNvbm5lY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgdHlwZXMucHVzaChjdWJlLm1vZHVsZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgIH1cclxuICAgdmFyIGkgPSAwO1xyXG4gICB3aGlsZSAoaSA8IHR5cGVzLmxlbmd0aCAmJiBpIDwgcGFuZWxzLmxlbmd0aCkge1xyXG4gICAgICB2YXIgdGFyUGFuZWwgPSBwYW5lbHNbaV07XHJcbiAgICAgIHZhciB0YXJUeXBlID0gdHlwZXNbaV07XHJcbiAgICAgIHZhciBuZXdDb25uZWN0aW9uID0ge3N0YXJ0OiB0YXJQYW5lbC5jdWJlLCBlbmQ6IHRhclR5cGUuY3ViZX07XHJcbiAgICAgIHRhclBhbmVsLmN1YmUubXlDb25uZWN0aW9uID0gbmV3Q29ubmVjdGlvbjtcclxuICAgICAgdGFyVHlwZS5jdWJlLm15Q29ubmVjdGlvbiA9IG5ld0Nvbm5lY3Rpb247XHJcbiAgICAgIHRoaXMuZ3JvdXAuZGlzcGxheUNvbm5lY3Rpb24odGFyUGFuZWwuY3ViZS5teUNvbm5lY3Rpb24pO1xyXG4gICAgICBpKys7XHJcbiAgIH1cclxufTtcclxuXHJcbkVuZW15QUkucHJvdG90eXBlLmFuZ2xlVG8gPSBmdW5jdGlvbihmcm9tLCB0bykge1xyXG4gIHZhciBhbmdsZVRvT3RoZXIgPSBQaGFzZXIuUG9pbnQuYW5nbGUoZnJvbSwgdG8pO1xyXG4gIGlmIChhbmdsZVRvT3RoZXIgPCAwKSB7IC8vIGZpeCBkdW1iIHBhcnQgb2YgUGhhc2VyLlBvaW50LmFuZ2xlKClcclxuICAgICBhbmdsZVRvT3RoZXIgPSAyICogTWF0aC5QSSArIGFuZ2xlVG9PdGhlcjtcclxuICB9XHJcbiAgYW5nbGVUb090aGVyID0gKGFuZ2xlVG9PdGhlciArIDMvMiAqIE1hdGguUEkpICUgKDIgKiBNYXRoLlBJKTsgLy8gcm90YXRlIDkwIGQgY2xvY2t3aXNlXHJcbiAgcmV0dXJuIGFuZ2xlVG9PdGhlcjtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gRW5lbXlBSTtcclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbiIsInZhciBVdGlscyA9IHJlcXVpcmUoJy4uL3V0aWxzLmpzJyk7XHJcblxyXG52YXIgTW91c2UgPSBmdW5jdGlvbihnYW1lLCBpbnB1dCwgcGxheWVyR3JvdXApIHtcclxuICAgdGhpcy5nYW1lID0gZ2FtZTtcclxuICAgdGhpcy5pbnB1dCA9IGlucHV0O1xyXG5cdHRoaXMuYm9keSA9IG5ldyBwMi5Cb2R5KCk7IC8vIGpzaGludCBpZ25vcmU6bGluZVxyXG4gICB0aGlzLmdhbWUucGh5c2ljcy5wMi53b3JsZC5hZGRCb2R5KHRoaXMuYm9keSk7XHJcbiAgIC8vIHRoaXMuZ2FtZS5waHlzaWNzLnAyLmVuYWJsZSh0aGlzKTtcclxuICAgXHJcbiAgIHRoaXMuaW5wdXQub25Eb3duLmFkZCh0aGlzLmNsaWNrLCB0aGlzKTtcclxuICAgdGhpcy5pbnB1dC5vblVwLmFkZCh0aGlzLnJlbGVhc2UsIHRoaXMpO1xyXG4gICB0aGlzLmlucHV0LmFkZE1vdmVDYWxsYmFjayh0aGlzLm1vdmUsIHRoaXMpO1xyXG4gICB0aGlzLnggPSAwO1xyXG4gICB0aGlzLnkgPSAwO1xyXG4gICBcclxuICAgdGhpcy5ncmFiYmVkID0gdW5kZWZpbmVkO1xyXG4gICB0aGlzLmxhc3RDbGlja2VkID0gdW5kZWZpbmVkO1xyXG4gICB0aGlzLmxpbmUgPSBuZXcgUGhhc2VyLkxpbmUoMCwgMCwgMCwgMCk7XHJcbiAgIFxyXG4gICB0aGlzLnJlbW92ZVRocmVzaG9sZCA9IDQwMDsgLy8gdGltZSBpbiBtaWxsaXNlY29uZHNcclxuICAgdGhpcy5yZW1vdmVUaW1lID0gMDsgLy8gdGltZSB0aWxsIHRocmVzaG9sZFxyXG4gICBcclxuICAgdGhpcy5wbGF5ZXJHcm91cCA9IHBsYXllckdyb3VwO1xyXG59O1xyXG5cclxuTW91c2UucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gTW91c2U7XHJcblxyXG5Nb3VzZS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgIGlmICh0aGlzLmdyYWJiZWQpIHtcclxuICAgICAgdmFyIGFuZ2xlID0gTWF0aC5hdGFuMih0aGlzLmdyYWJiZWQuc3ByaXRlLnkgLSAodGhpcy5pbnB1dC5wb3NpdGlvbi55ICsgdGhpcy5nYW1lLmNhbWVyYS55KSwgdGhpcy5ncmFiYmVkLnNwcml0ZS54IC0gKHRoaXMuaW5wdXQucG9zaXRpb24ueCsgdGhpcy5nYW1lLmNhbWVyYS54KSkgKyBNYXRoLlBJO1xyXG4gICAgICB2YXIgZGlzdCA9IFV0aWxzLmRpc3RhbmNlKHRoaXMuZ3JhYmJlZC5zcHJpdGUueCwgdGhpcy5ncmFiYmVkLnNwcml0ZS55LCAodGhpcy5pbnB1dC5wb3NpdGlvbi54KyB0aGlzLmdhbWUuY2FtZXJhLngpLCAodGhpcy5pbnB1dC5wb3NpdGlvbi55ICsgdGhpcy5nYW1lLmNhbWVyYS55KSk7XHJcbiAgICAgIGlmKHRoaXMuZ3JhYmJlZC5zcHJpdGUua2V5ID09PSAnYXN0ZXJvaWQnKSB7XHJcblx0ICB2YXIgd2VpZ2h0ID0gMTtcclxuXHQgIH1cclxuXHQgIGVsc2Uge1xyXG5cdCAgdmFyIHdlaWdodCA9IDEwO1xyXG5cdCAgfVxyXG5cdCAgaWYgKCF0aGlzLmdyYWJiZWQuc3ByaXRlLmdyb3VwKSB7XHJcbiAgICAgICAgIHRoaXMuZ3JhYmJlZC5mb3JjZS54ID0gTWF0aC5jb3MoYW5nbGUpICogZGlzdCAqIHdlaWdodDtcclxuICAgICAgICAgdGhpcy5ncmFiYmVkLmZvcmNlLnkgPSBNYXRoLnNpbihhbmdsZSkgKiBkaXN0ICogd2VpZ2h0O1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMubGluZS5zZXRUbyh0aGlzLmdyYWJiZWQuc3ByaXRlLngsIHRoaXMuZ3JhYmJlZC5zcHJpdGUueSwgKHRoaXMuaW5wdXQucG9zaXRpb24ueCsgdGhpcy5nYW1lLmNhbWVyYS54KSwgKHRoaXMuaW5wdXQucG9zaXRpb24ueSArIHRoaXMuZ2FtZS5jYW1lcmEueSkpO1xyXG4gICAgICB0aGlzLnJlbW92ZVRpbWUgKz0gdGhpcy5nYW1lLnRpbWUuZWxhcHNlZDtcclxuICAgICAgaWYodGhpcy5ncmFiYmVkLnNwcml0ZS50YWcgPT09ICdtb2R1bGUnKSB7XHJcblx0XHQgIGlmICh0aGlzLnJlbW92ZVRpbWUgPj0gdGhpcy5yZW1vdmVUaHJlc2hvbGQgJiYgdGhpcy5ncmFiYmVkLnNwcml0ZS5rZXkgIT09ICdhc3Rlcm9pZCcpIHtcclxuXHRcdFx0IHRoaXMuZ3JhYmJlZC5zcHJpdGUucmVtb3ZlKCk7XHJcblx0XHRcdCB0aGlzLnJlbW92ZVRpbWUgPSAwO1xyXG5cdFx0ICB9XHJcblx0ICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgdGhpcy5saW5lLnNldFRvKDAsIDAsIDAsIDApO1xyXG4gICAgfVxyXG4gICAgdmFyIHBvaW50ID0gbmV3IFBoYXNlci5Qb2ludCh0aGlzLngsIHRoaXMueSk7XHJcbiAgICB2YXIgYm9kaWVzID0gdGhpcy5nYW1lLnBoeXNpY3MucDIuaGl0VGVzdChwb2ludCk7XHJcbiAgICBpZiAoYm9kaWVzLmxlbmd0aClcclxuICAgIHtcclxuICAgICAgICB2YXIgaG92ZXIgPSBib2RpZXNbMF0ucGFyZW50O1xyXG4gICAgICAgIGlmIChob3Zlci5zcHJpdGUubW9kdWxlICYmIGhvdmVyLnNwcml0ZS5tb2R1bGUubW91c2VPdmVyKSB7XHJcbiAgICAgICAgICAgaG92ZXIuc3ByaXRlLm1vZHVsZS5tb3VzZU92ZXIoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn07XHJcblxyXG5Nb3VzZS5wcm90b3R5cGUuY2xpY2sgPSBmdW5jdGlvbihwb2ludGVyKSB7XHJcbiAgIHZhciBwb2ludCA9IG5ldyBQaGFzZXIuUG9pbnQocG9pbnRlci54ICsgdGhpcy5nYW1lLmNhbWVyYS54LCBwb2ludGVyLnkgKyB0aGlzLmdhbWUuY2FtZXJhLnkpO1xyXG4gICB2YXIgYm9kaWVzID0gdGhpcy5nYW1lLnBoeXNpY3MucDIuaGl0VGVzdChwb2ludCk7XHJcbiAgIGlmIChib2RpZXMubGVuZ3RoKVxyXG4gICB7XHJcbiAgICAgdmFyIHRlbXAgPSBib2RpZXNbMF0ucGFyZW50O1xyXG4gICAgIC8vIGNvbnNvbGUubG9nKCdyb3RhdGlvbjonLCB0ZW1wLnJvdGF0aW9uKTtcclxuICAgICB0aGlzLmdyYWJiZWQgPSB0ZW1wO1xyXG4gICAgIGlmICh0aGlzLmdyYWJiZWQuc3ByaXRlLm1vZHVsZSAmJiB0aGlzLmdyYWJiZWQuc3ByaXRlLm1vZHVsZS5oYXNPd25Qcm9wZXJ0eSgnbW91c2VEb3duJykpIHtcclxuICAgICAgIHRoaXMuZ3JhYmJlZC5zcHJpdGUubW9kdWxlLm1vdXNlRG93bigpO1xyXG4gICAgIH1cclxuICAgICBpZiAodGhpcy5sYXN0Q2xpY2tlZCAmJiB0aGlzLmxhc3RDbGlja2VkLnNwcml0ZSAmJiB0aGlzLmxhc3RDbGlja2VkLnNwcml0ZS5tb2R1bGUgJiZcclxuICAgICB0aGlzLmxhc3RDbGlja2VkLnNwcml0ZS5tb2R1bGUuZ2l2ZVRhcmdldCkge1xyXG4gICAgICAgIHRoaXMubGFzdENsaWNrZWQuc3ByaXRlLm1vZHVsZS5naXZlVGFyZ2V0KHRoaXMuZ3JhYmJlZC5zcHJpdGUubW9kdWxlKTtcclxuICAgICB9XHJcbiAgICAgaWYgKHRlbXAuc3ByaXRlICYmIHRlbXAuc3ByaXRlLm1vZHVsZSAmJiB0ZW1wLnNwcml0ZS5tb2R1bGUudHlwZSA9PT0gJ2NvcmUnKSB7XHJcbiAgICAgICAgdGhpcy5ncmFiYmVkID0gdW5kZWZpbmVkO1xyXG4gICAgIH1cclxuICAgICBpZiAodGVtcC5zcHJpdGUgJiYgdGVtcC5zcHJpdGUuZ3JvdXAgJiYgdGVtcC5zcHJpdGUuZ3JvdXAgIT09IHRoaXMucGxheWVyR3JvdXApIHtcclxuICAgICAgICB0aGlzLmdyYWJiZWQgPSB1bmRlZmluZWQ7XHJcbiAgICAgfVxyXG4gICAgIHRoaXMucmVtb3ZlVGltZSA9IDA7XHJcbiAgICAgdGhpcy5sYXN0Q2xpY2tlZCA9IHRlbXA7XHJcbiAgIH1cclxufTtcclxuICBcclxuIE1vdXNlLnByb3RvdHlwZS5yZWxlYXNlID0gZnVuY3Rpb24oKSB7XHJcbiAgIGlmICh0aGlzLmdyYWJiZWQpIHtcclxuICAgICB0aGlzLmdyYWJiZWQgPSB1bmRlZmluZWQ7XHJcbiAgIH1cclxufTtcclxuXHJcbk1vdXNlLnByb3RvdHlwZS5tb3ZlID0gZnVuY3Rpb24ocG9pbnRlcikge1xyXG4gICAvLyBwMiB1c2VzIGRpZmZlcmVudCBjb29yZGluYXRlIHN5c3RlbSwgc28gY29udmVydCB0aGUgcG9pbnRlciBwb3NpdGlvbiB0byBwMidzIGNvb3JkaW5hdGUgc3lzdGVtXHJcbiAgIHRoaXMuYm9keS5wb3NpdGlvblswXSA9IHRoaXMuZ2FtZS5waHlzaWNzLnAyLnB4bWkocG9pbnRlci5wb3NpdGlvbi54KTtcclxuICAgdGhpcy5ib2R5LnBvc2l0aW9uWzFdID0gdGhpcy5nYW1lLnBoeXNpY3MucDIucHhtaShwb2ludGVyLnBvc2l0aW9uLnkpO1xyXG4gICB0aGlzLnggPSBwb2ludGVyLnBvc2l0aW9uLnggKyB0aGlzLmdhbWUuY2FtZXJhLng7XHJcbiAgIHRoaXMueSA9IHBvaW50ZXIucG9zaXRpb24ueSArIHRoaXMuZ2FtZS5jYW1lcmEueTtcclxufTtcclxuXHJcbk1vdXNlLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbigpIHtcclxuICAgdGhpcy5nYW1lLmRlYnVnLmdlb20odGhpcy5saW5lKTtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gTW91c2U7XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuIiwidmFyIFJlbmRlcmFibGVzID0gZnVuY3Rpb24oKSB7XHJcblx0aWYoUmVuZGVyYWJsZXMucHJvdG90eXBlLmV4aXN0cykge1xyXG5cdFx0cmV0dXJuIFJlbmRlcmFibGVzLnByb3RvdHlwZS5leGlzdGluZ1JlZmVyZW5jZTtcclxuXHR9XHJcblx0XHJcblx0dGhpcy5saXN0ID0gW107XHJcblx0UmVuZGVyYWJsZXMucHJvdG90eXBlLmV4aXN0cyA9IHRydWU7XHJcblx0UmVuZGVyYWJsZXMucHJvdG90eXBlLmV4aXN0aW5nUmVmZXJlbmNlID0gdGhpcztcclxufTtcclxuXHJcblJlbmRlcmFibGVzLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFJlbmRlcmFibGVzO1xyXG4vL1RoZXNlIHZhcidzIGhlbHAgY3JlYXRlIHRoZSBzaW5nbGV0b24gZnVuY3Rpb25hbGl0eVxyXG5SZW5kZXJhYmxlcy5wcm90b3R5cGUuZXhpc3RzID0gZmFsc2U7XHJcblJlbmRlcmFibGVzLnByb3RvdHlwZS5leGlzdGluZ1JlZmVyZW5jZSA9IG51bGw7XHJcblxyXG5SZW5kZXJhYmxlcy5wcm90b3R5cGUuc3Vic2NyaWJlID0gZnVuY3Rpb24oc3Vic2NyaWJlcikge1xyXG5cdHRoaXMubGlzdC5wdXNoKHN1YnNjcmliZXIpO1xyXG59O1xyXG5cclxuUmVuZGVyYWJsZXMucHJvdG90eXBlLnVuc3Vic2NyaWJlID0gZnVuY3Rpb24odW5zdWJzY3JpYmVyKSB7XHJcblx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMubGlzdC5sZW5ndGg7IGkrKykge1xyXG5cdFx0aWYodGhpcy5saXN0W2ldID09PSB1bnN1YnNjcmliZXIpIHtcclxuXHRcdFx0dGhpcy5saXN0W2ldID0gZmFsc2U7XHJcblx0XHR9XHJcblx0fVxyXG59O1xyXG5cclxuUmVuZGVyYWJsZXMucHJvdG90eXBlLnJlbmRlckFsbCA9IGZ1bmN0aW9uKCkge1xyXG5cdGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLmxpc3QubGVuZ3RoOyBpKyspIHtcclxuXHRcdGlmKHRoaXMubGlzdFtpXSA9PT0gZmFsc2UpIHtcclxuXHRcdFx0Y29udGludWU7XHJcblx0XHR9XHJcblx0XHR0aGlzLmxpc3RbaV0ucmVuZGVyKCk7XHJcblx0fVxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBSZW5kZXJhYmxlczsiLCIvLyBqYXZhc2NyaXB0LWFzdGFyIDAuNC4wXHJcbi8vIGh0dHA6Ly9naXRodWIuY29tL2Jncmlucy9qYXZhc2NyaXB0LWFzdGFyXHJcbi8vIEZyZWVseSBkaXN0cmlidXRhYmxlIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuLy8gSW1wbGVtZW50cyB0aGUgYXN0YXIgc2VhcmNoIGFsZ29yaXRobSBpbiBqYXZhc2NyaXB0IHVzaW5nIGEgQmluYXJ5IEhlYXAuXHJcbi8vIEluY2x1ZGVzIEJpbmFyeSBIZWFwICh3aXRoIG1vZGlmaWNhdGlvbnMpIGZyb20gTWFyaWpuIEhhdmVyYmVrZS5cclxuLy8gaHR0cDovL2Vsb3F1ZW50amF2YXNjcmlwdC5uZXQvYXBwZW5kaXgyLmh0bWxcclxuXHJcbihmdW5jdGlvbihkZWZpbml0aW9uKSB7XHJcbiAgICAvKiBnbG9iYWwgbW9kdWxlLCBkZWZpbmUgKi9cclxuICAgIGlmKHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUuZXhwb3J0cyA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGRlZmluaXRpb24oKTtcclxuICAgIH0gZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcclxuICAgICAgICBkZWZpbmUoW10sIGRlZmluaXRpb24pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICB2YXIgZXhwb3J0cyA9IGRlZmluaXRpb24oKTtcclxuICAgICAgICB3aW5kb3cuYXN0YXIgPSBleHBvcnRzLmFzdGFyO1xyXG4gICAgICAgIHdpbmRvdy5HcmFwaCA9IGV4cG9ydHMuR3JhcGg7XHJcbiAgICB9XHJcbn0pKGZ1bmN0aW9uKCkge1xyXG5cclxuZnVuY3Rpb24gcGF0aFRvKG5vZGUpe1xyXG4gICAgdmFyIGN1cnIgPSBub2RlLFxyXG4gICAgICAgIHBhdGggPSBbXTtcclxuICAgIHdoaWxlKGN1cnIucGFyZW50KSB7XHJcbiAgICAgICAgcGF0aC5wdXNoKGN1cnIpO1xyXG4gICAgICAgIGN1cnIgPSBjdXJyLnBhcmVudDtcclxuICAgIH1cclxuICAgIHJldHVybiBwYXRoLnJldmVyc2UoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0SGVhcCgpIHtcclxuICAgIHJldHVybiBuZXcgQmluYXJ5SGVhcChmdW5jdGlvbihub2RlKSB7XHJcbiAgICAgICAgcmV0dXJuIG5vZGUuZjtcclxuICAgIH0pO1xyXG59XHJcblxyXG52YXIgYXN0YXIgPSB7XHJcbiAgICAvKipcclxuICAgICogUGVyZm9ybSBhbiBBKiBTZWFyY2ggb24gYSBncmFwaCBnaXZlbiBhIHN0YXJ0IGFuZCBlbmQgbm9kZS5cclxuICAgICogQHBhcmFtIHtHcmFwaH0gZ3JhcGhcclxuICAgICogQHBhcmFtIHtHcmlkTm9kZX0gc3RhcnRcclxuICAgICogQHBhcmFtIHtHcmlkTm9kZX0gZW5kXHJcbiAgICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uc11cclxuICAgICogQHBhcmFtIHtib29sfSBbb3B0aW9ucy5jbG9zZXN0XSBTcGVjaWZpZXMgd2hldGhlciB0byByZXR1cm4gdGhlXHJcbiAgICAgICAgICAgICAgIHBhdGggdG8gdGhlIGNsb3Nlc3Qgbm9kZSBpZiB0aGUgdGFyZ2V0IGlzIHVucmVhY2hhYmxlLlxyXG4gICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbb3B0aW9ucy5oZXVyaXN0aWNdIEhldXJpc3RpYyBmdW5jdGlvbiAoc2VlXHJcbiAgICAqICAgICAgICAgIGFzdGFyLmhldXJpc3RpY3MpLlxyXG4gICAgKi9cclxuICAgIHNlYXJjaDogZnVuY3Rpb24oZ3JhcGgsIHN0YXJ0LCBlbmQsIG9wdGlvbnMpIHtcclxuICAgICAgICBncmFwaC5jbGVhbkRpcnR5KCk7XHJcbiAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XHJcbiAgICAgICAgdmFyIGhldXJpc3RpYyA9IG9wdGlvbnMuaGV1cmlzdGljIHx8IGFzdGFyLmhldXJpc3RpY3MubWFuaGF0dGFuLFxyXG4gICAgICAgICAgICBjbG9zZXN0ID0gb3B0aW9ucy5jbG9zZXN0IHx8IGZhbHNlO1xyXG5cclxuICAgICAgICB2YXIgb3BlbkhlYXAgPSBnZXRIZWFwKCksXHJcbiAgICAgICAgICAgIGNsb3Nlc3ROb2RlID0gc3RhcnQ7IC8vIHNldCB0aGUgc3RhcnQgbm9kZSB0byBiZSB0aGUgY2xvc2VzdCBpZiByZXF1aXJlZFxyXG5cclxuICAgICAgICBzdGFydC5oID0gaGV1cmlzdGljKHN0YXJ0LCBlbmQpO1xyXG5cclxuICAgICAgICBvcGVuSGVhcC5wdXNoKHN0YXJ0KTtcclxuXHJcbiAgICAgICAgd2hpbGUob3BlbkhlYXAuc2l6ZSgpID4gMCkge1xyXG5cclxuICAgICAgICAgICAgLy8gR3JhYiB0aGUgbG93ZXN0IGYoeCkgdG8gcHJvY2VzcyBuZXh0LiAgSGVhcCBrZWVwcyB0aGlzIHNvcnRlZCBmb3IgdXMuXHJcbiAgICAgICAgICAgIHZhciBjdXJyZW50Tm9kZSA9IG9wZW5IZWFwLnBvcCgpO1xyXG5cclxuICAgICAgICAgICAgLy8gRW5kIGNhc2UgLS0gcmVzdWx0IGhhcyBiZWVuIGZvdW5kLCByZXR1cm4gdGhlIHRyYWNlZCBwYXRoLlxyXG4gICAgICAgICAgICBpZihjdXJyZW50Tm9kZSA9PT0gZW5kKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcGF0aFRvKGN1cnJlbnROb2RlKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gTm9ybWFsIGNhc2UgLS0gbW92ZSBjdXJyZW50Tm9kZSBmcm9tIG9wZW4gdG8gY2xvc2VkLCBwcm9jZXNzIGVhY2ggb2YgaXRzIG5laWdoYm9ycy5cclxuICAgICAgICAgICAgY3VycmVudE5vZGUuY2xvc2VkID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgIC8vIEZpbmQgYWxsIG5laWdoYm9ycyBmb3IgdGhlIGN1cnJlbnQgbm9kZS5cclxuICAgICAgICAgICAgdmFyIG5laWdoYm9ycyA9IGdyYXBoLm5laWdoYm9ycyhjdXJyZW50Tm9kZSk7XHJcblxyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgaWwgPSBuZWlnaGJvcnMubGVuZ3RoOyBpIDwgaWw7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG5laWdoYm9yID0gbmVpZ2hib3JzW2ldO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChuZWlnaGJvci5jbG9zZWQgfHwgbmVpZ2hib3IuaXNXYWxsKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBOb3QgYSB2YWxpZCBub2RlIHRvIHByb2Nlc3MsIHNraXAgdG8gbmV4dCBuZWlnaGJvci5cclxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvLyBUaGUgZyBzY29yZSBpcyB0aGUgc2hvcnRlc3QgZGlzdGFuY2UgZnJvbSBzdGFydCB0byBjdXJyZW50IG5vZGUuXHJcbiAgICAgICAgICAgICAgICAvLyBXZSBuZWVkIHRvIGNoZWNrIGlmIHRoZSBwYXRoIHdlIGhhdmUgYXJyaXZlZCBhdCB0aGlzIG5laWdoYm9yIGlzIHRoZSBzaG9ydGVzdCBvbmUgd2UgaGF2ZSBzZWVuIHlldC5cclxuICAgICAgICAgICAgICAgIHZhciBnU2NvcmUgPSBjdXJyZW50Tm9kZS5nICsgbmVpZ2hib3IuZ2V0Q29zdChjdXJyZW50Tm9kZSksXHJcbiAgICAgICAgICAgICAgICAgICAgYmVlblZpc2l0ZWQgPSBuZWlnaGJvci52aXNpdGVkO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICghYmVlblZpc2l0ZWQgfHwgZ1Njb3JlIDwgbmVpZ2hib3IuZykge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBGb3VuZCBhbiBvcHRpbWFsIChzbyBmYXIpIHBhdGggdG8gdGhpcyBub2RlLiAgVGFrZSBzY29yZSBmb3Igbm9kZSB0byBzZWUgaG93IGdvb2QgaXQgaXMuXHJcbiAgICAgICAgICAgICAgICAgICAgbmVpZ2hib3IudmlzaXRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgbmVpZ2hib3IucGFyZW50ID0gY3VycmVudE5vZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgbmVpZ2hib3IuaCA9IG5laWdoYm9yLmggfHwgaGV1cmlzdGljKG5laWdoYm9yLCBlbmQpO1xyXG4gICAgICAgICAgICAgICAgICAgIG5laWdoYm9yLmcgPSBnU2NvcmU7XHJcbiAgICAgICAgICAgICAgICAgICAgbmVpZ2hib3IuZiA9IG5laWdoYm9yLmcgKyBuZWlnaGJvci5oO1xyXG4gICAgICAgICAgICAgICAgICAgIGdyYXBoLm1hcmtEaXJ0eShuZWlnaGJvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNsb3Nlc3QpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhlIG5laWdoYm91ciBpcyBjbG9zZXIgdGhhbiB0aGUgY3VycmVudCBjbG9zZXN0Tm9kZSBvciBpZiBpdCdzIGVxdWFsbHkgY2xvc2UgYnV0IGhhc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhIGNoZWFwZXIgcGF0aCB0aGFuIHRoZSBjdXJyZW50IGNsb3Nlc3Qgbm9kZSB0aGVuIGl0IGJlY29tZXMgdGhlIGNsb3Nlc3Qgbm9kZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobmVpZ2hib3IuaCA8IGNsb3Nlc3ROb2RlLmggfHwgKG5laWdoYm9yLmggPT09IGNsb3Nlc3ROb2RlLmggJiYgbmVpZ2hib3IuZyA8IGNsb3Nlc3ROb2RlLmcpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbG9zZXN0Tm9kZSA9IG5laWdoYm9yO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWJlZW5WaXNpdGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFB1c2hpbmcgdG8gaGVhcCB3aWxsIHB1dCBpdCBpbiBwcm9wZXIgcGxhY2UgYmFzZWQgb24gdGhlICdmJyB2YWx1ZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgb3BlbkhlYXAucHVzaChuZWlnaGJvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBbHJlYWR5IHNlZW4gdGhlIG5vZGUsIGJ1dCBzaW5jZSBpdCBoYXMgYmVlbiByZXNjb3JlZCB3ZSBuZWVkIHRvIHJlb3JkZXIgaXQgaW4gdGhlIGhlYXBcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3BlbkhlYXAucmVzY29yZUVsZW1lbnQobmVpZ2hib3IpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGNsb3Nlc3QpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHBhdGhUbyhjbG9zZXN0Tm9kZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBObyByZXN1bHQgd2FzIGZvdW5kIC0gZW1wdHkgYXJyYXkgc2lnbmlmaWVzIGZhaWx1cmUgdG8gZmluZCBwYXRoLlxyXG4gICAgICAgIHJldHVybiBbXTtcclxuICAgIH0sXHJcbiAgICAvLyBTZWUgbGlzdCBvZiBoZXVyaXN0aWNzOiBodHRwOi8vdGhlb3J5LnN0YW5mb3JkLmVkdS9+YW1pdHAvR2FtZVByb2dyYW1taW5nL0hldXJpc3RpY3MuaHRtbFxyXG4gICAgaGV1cmlzdGljczoge1xyXG4gICAgICAgIG1hbmhhdHRhbjogZnVuY3Rpb24ocG9zMCwgcG9zMSkge1xyXG4gICAgICAgICAgICB2YXIgZDEgPSBNYXRoLmFicyhwb3MxLnggLSBwb3MwLngpO1xyXG4gICAgICAgICAgICB2YXIgZDIgPSBNYXRoLmFicyhwb3MxLnkgLSBwb3MwLnkpO1xyXG4gICAgICAgICAgICByZXR1cm4gZDEgKyBkMjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGRpYWdvbmFsOiBmdW5jdGlvbihwb3MwLCBwb3MxKSB7XHJcbiAgICAgICAgICAgIHZhciBEID0gMTtcclxuICAgICAgICAgICAgdmFyIEQyID0gTWF0aC5zcXJ0KDIpO1xyXG4gICAgICAgICAgICB2YXIgZDEgPSBNYXRoLmFicyhwb3MxLnggLSBwb3MwLngpO1xyXG4gICAgICAgICAgICB2YXIgZDIgPSBNYXRoLmFicyhwb3MxLnkgLSBwb3MwLnkpO1xyXG4gICAgICAgICAgICByZXR1cm4gKEQgKiAoZDEgKyBkMikpICsgKChEMiAtICgyICogRCkpICogTWF0aC5taW4oZDEsIGQyKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGNsZWFuTm9kZTpmdW5jdGlvbihub2RlKXtcclxuICAgICAgICBub2RlLmYgPSAwO1xyXG4gICAgICAgIG5vZGUuZyA9IDA7XHJcbiAgICAgICAgbm9kZS5oID0gMDtcclxuICAgICAgICBub2RlLnZpc2l0ZWQgPSBmYWxzZTtcclxuICAgICAgICBub2RlLmNsb3NlZCA9IGZhbHNlO1xyXG4gICAgICAgIG5vZGUucGFyZW50ID0gbnVsbDtcclxuICAgIH1cclxufTtcclxuXHJcbi8qKlxyXG4qIEEgZ3JhcGggbWVtb3J5IHN0cnVjdHVyZVxyXG4qIEBwYXJhbSB7QXJyYXl9IGdyaWRJbiAyRCBhcnJheSBvZiBpbnB1dCB3ZWlnaHRzXHJcbiogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXVxyXG4qIEBwYXJhbSB7Ym9vbH0gW29wdGlvbnMuZGlhZ29uYWxdIFNwZWNpZmllcyB3aGV0aGVyIGRpYWdvbmFsIG1vdmVzIGFyZSBhbGxvd2VkXHJcbiovXHJcbmZ1bmN0aW9uIEdyYXBoKGdyaWRJbiwgb3B0aW9ucykge1xyXG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XHJcbiAgICB0aGlzLm5vZGVzID0gW107XHJcbiAgICB0aGlzLmRpYWdvbmFsID0gISFvcHRpb25zLmRpYWdvbmFsO1xyXG4gICAgdGhpcy5ncmlkID0gW107XHJcbiAgICBmb3IgKHZhciB4ID0gMDsgeCA8IGdyaWRJbi5sZW5ndGg7IHgrKykge1xyXG4gICAgICAgIHRoaXMuZ3JpZFt4XSA9IFtdO1xyXG5cclxuICAgICAgICBmb3IgKHZhciB5ID0gMCwgcm93ID0gZ3JpZEluW3hdOyB5IDwgcm93Lmxlbmd0aDsgeSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBub2RlID0gbmV3IEdyaWROb2RlKHgsIHksIHJvd1t5XSk7XHJcbiAgICAgICAgICAgIHRoaXMuZ3JpZFt4XVt5XSA9IG5vZGU7XHJcbiAgICAgICAgICAgIHRoaXMubm9kZXMucHVzaChub2RlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICB0aGlzLmluaXQoKTtcclxufVxyXG5cclxuR3JhcGgucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpIHtcclxuICAgIHRoaXMuZGlydHlOb2RlcyA9IFtdO1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm5vZGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgYXN0YXIuY2xlYW5Ob2RlKHRoaXMubm9kZXNbaV0pO1xyXG4gICAgfVxyXG59O1xyXG5cclxuR3JhcGgucHJvdG90eXBlLmNsZWFuRGlydHkgPSBmdW5jdGlvbigpIHtcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5kaXJ0eU5vZGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgYXN0YXIuY2xlYW5Ob2RlKHRoaXMuZGlydHlOb2Rlc1tpXSk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmRpcnR5Tm9kZXMgPSBbXTtcclxufTtcclxuXHJcbkdyYXBoLnByb3RvdHlwZS5tYXJrRGlydHkgPSBmdW5jdGlvbihub2RlKSB7XHJcbiAgICB0aGlzLmRpcnR5Tm9kZXMucHVzaChub2RlKTtcclxufTtcclxuXHJcbkdyYXBoLnByb3RvdHlwZS5uZWlnaGJvcnMgPSBmdW5jdGlvbihub2RlKSB7XHJcbiAgICB2YXIgcmV0ID0gW10sXHJcbiAgICAgICAgeCA9IG5vZGUueCxcclxuICAgICAgICB5ID0gbm9kZS55LFxyXG4gICAgICAgIGdyaWQgPSB0aGlzLmdyaWQ7XHJcblxyXG4gICAgLy8gV2VzdFxyXG4gICAgaWYoZ3JpZFt4LTFdICYmIGdyaWRbeC0xXVt5XSkge1xyXG4gICAgICAgIHJldC5wdXNoKGdyaWRbeC0xXVt5XSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRWFzdFxyXG4gICAgaWYoZ3JpZFt4KzFdICYmIGdyaWRbeCsxXVt5XSkge1xyXG4gICAgICAgIHJldC5wdXNoKGdyaWRbeCsxXVt5XSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gU291dGhcclxuICAgIGlmKGdyaWRbeF0gJiYgZ3JpZFt4XVt5LTFdKSB7XHJcbiAgICAgICAgcmV0LnB1c2goZ3JpZFt4XVt5LTFdKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBOb3J0aFxyXG4gICAgaWYoZ3JpZFt4XSAmJiBncmlkW3hdW3krMV0pIHtcclxuICAgICAgICByZXQucHVzaChncmlkW3hdW3krMV0pO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh0aGlzLmRpYWdvbmFsKSB7XHJcbiAgICAgICAgLy8gU291dGh3ZXN0XHJcbiAgICAgICAgaWYoZ3JpZFt4LTFdICYmIGdyaWRbeC0xXVt5LTFdKSB7XHJcbiAgICAgICAgICAgIHJldC5wdXNoKGdyaWRbeC0xXVt5LTFdKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFNvdXRoZWFzdFxyXG4gICAgICAgIGlmKGdyaWRbeCsxXSAmJiBncmlkW3grMV1beS0xXSkge1xyXG4gICAgICAgICAgICByZXQucHVzaChncmlkW3grMV1beS0xXSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBOb3J0aHdlc3RcclxuICAgICAgICBpZihncmlkW3gtMV0gJiYgZ3JpZFt4LTFdW3krMV0pIHtcclxuICAgICAgICAgICAgcmV0LnB1c2goZ3JpZFt4LTFdW3krMV0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gTm9ydGhlYXN0XHJcbiAgICAgICAgaWYoZ3JpZFt4KzFdICYmIGdyaWRbeCsxXVt5KzFdKSB7XHJcbiAgICAgICAgICAgIHJldC5wdXNoKGdyaWRbeCsxXVt5KzFdKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHJldDtcclxufTtcclxuXHJcbkdyYXBoLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIGdyYXBoU3RyaW5nID0gW10sXHJcbiAgICAgICAgbm9kZXMgPSB0aGlzLmdyaWQsIC8vIHdoZW4gdXNpbmcgZ3JpZFxyXG4gICAgICAgIHJvd0RlYnVnLCByb3csIHksIGw7XHJcbiAgICBmb3IgKHZhciB4ID0gMCwgbGVuID0gbm9kZXMubGVuZ3RoOyB4IDwgbGVuOyB4KyspIHtcclxuICAgICAgICByb3dEZWJ1ZyA9IFtdO1xyXG4gICAgICAgIHJvdyA9IG5vZGVzW3hdO1xyXG4gICAgICAgIGZvciAoeSA9IDAsIGwgPSByb3cubGVuZ3RoOyB5IDwgbDsgeSsrKSB7XHJcbiAgICAgICAgICAgIHJvd0RlYnVnLnB1c2gocm93W3ldLndlaWdodCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGdyYXBoU3RyaW5nLnB1c2gocm93RGVidWcuam9pbignICcpKTtcclxuICAgIH1cclxuICAgIHJldHVybiBncmFwaFN0cmluZy5qb2luKCdcXG4nKTtcclxufTtcclxuXHJcbmZ1bmN0aW9uIEdyaWROb2RlKHgsIHksIHdlaWdodCkge1xyXG4gICAgdGhpcy54ID0geDtcclxuICAgIHRoaXMueSA9IHk7XHJcbiAgICB0aGlzLndlaWdodCA9IHdlaWdodDtcclxufVxyXG5cclxuR3JpZE5vZGUucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gJ1snICsgdGhpcy54ICsgJyAnICsgdGhpcy55ICsgJ10nO1xyXG59O1xyXG5cclxuR3JpZE5vZGUucHJvdG90eXBlLmdldENvc3QgPSBmdW5jdGlvbihmcm9tTmVpZ2hib3IpIHtcclxuICAgIC8vIFRha2UgZGlhZ29uYWwgd2VpZ2h0IGludG8gY29uc2lkZXJhdGlvbi5cclxuICAgIGlmIChmcm9tTmVpZ2hib3IgJiYgZnJvbU5laWdoYm9yLnggIT09IHRoaXMueCAmJiBmcm9tTmVpZ2hib3IueSAhPT0gdGhpcy55KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMud2VpZ2h0ICogMS40MTQyMTtcclxuICAgIH1cclxuICAgIHJldHVybiB0aGlzLndlaWdodDtcclxufTtcclxuXHJcbkdyaWROb2RlLnByb3RvdHlwZS5pc1dhbGwgPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiB0aGlzLndlaWdodCA9PT0gMDtcclxufTtcclxuXHJcbmZ1bmN0aW9uIEJpbmFyeUhlYXAoc2NvcmVGdW5jdGlvbil7XHJcbiAgICB0aGlzLmNvbnRlbnQgPSBbXTtcclxuICAgIHRoaXMuc2NvcmVGdW5jdGlvbiA9IHNjb3JlRnVuY3Rpb247XHJcbn1cclxuXHJcbkJpbmFyeUhlYXAucHJvdG90eXBlID0ge1xyXG4gICAgcHVzaDogZnVuY3Rpb24oZWxlbWVudCkge1xyXG4gICAgICAgIC8vIEFkZCB0aGUgbmV3IGVsZW1lbnQgdG8gdGhlIGVuZCBvZiB0aGUgYXJyYXkuXHJcbiAgICAgICAgdGhpcy5jb250ZW50LnB1c2goZWxlbWVudCk7XHJcblxyXG4gICAgICAgIC8vIEFsbG93IGl0IHRvIHNpbmsgZG93bi5cclxuICAgICAgICB0aGlzLnNpbmtEb3duKHRoaXMuY29udGVudC5sZW5ndGggLSAxKTtcclxuICAgIH0sXHJcbiAgICBwb3A6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIC8vIFN0b3JlIHRoZSBmaXJzdCBlbGVtZW50IHNvIHdlIGNhbiByZXR1cm4gaXQgbGF0ZXIuXHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IHRoaXMuY29udGVudFswXTtcclxuICAgICAgICAvLyBHZXQgdGhlIGVsZW1lbnQgYXQgdGhlIGVuZCBvZiB0aGUgYXJyYXkuXHJcbiAgICAgICAgdmFyIGVuZCA9IHRoaXMuY29udGVudC5wb3AoKTtcclxuICAgICAgICAvLyBJZiB0aGVyZSBhcmUgYW55IGVsZW1lbnRzIGxlZnQsIHB1dCB0aGUgZW5kIGVsZW1lbnQgYXQgdGhlXHJcbiAgICAgICAgLy8gc3RhcnQsIGFuZCBsZXQgaXQgYnViYmxlIHVwLlxyXG4gICAgICAgIGlmICh0aGlzLmNvbnRlbnQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRlbnRbMF0gPSBlbmQ7XHJcbiAgICAgICAgICAgIHRoaXMuYnViYmxlVXAoMCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9LFxyXG4gICAgcmVtb3ZlOiBmdW5jdGlvbihub2RlKSB7XHJcbiAgICAgICAgdmFyIGkgPSB0aGlzLmNvbnRlbnQuaW5kZXhPZihub2RlKTtcclxuXHJcbiAgICAgICAgLy8gV2hlbiBpdCBpcyBmb3VuZCwgdGhlIHByb2Nlc3Mgc2VlbiBpbiAncG9wJyBpcyByZXBlYXRlZFxyXG4gICAgICAgIC8vIHRvIGZpbGwgdXAgdGhlIGhvbGUuXHJcbiAgICAgICAgdmFyIGVuZCA9IHRoaXMuY29udGVudC5wb3AoKTtcclxuXHJcbiAgICAgICAgaWYgKGkgIT09IHRoaXMuY29udGVudC5sZW5ndGggLSAxKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGVudFtpXSA9IGVuZDtcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNjb3JlRnVuY3Rpb24oZW5kKSA8IHRoaXMuc2NvcmVGdW5jdGlvbihub2RlKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zaW5rRG93bihpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYnViYmxlVXAoaSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgc2l6ZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGVudC5sZW5ndGg7XHJcbiAgICB9LFxyXG4gICAgcmVzY29yZUVsZW1lbnQ6IGZ1bmN0aW9uKG5vZGUpIHtcclxuICAgICAgICB0aGlzLnNpbmtEb3duKHRoaXMuY29udGVudC5pbmRleE9mKG5vZGUpKTtcclxuICAgIH0sXHJcbiAgICBzaW5rRG93bjogZnVuY3Rpb24obikge1xyXG4gICAgICAgIC8vIEZldGNoIHRoZSBlbGVtZW50IHRoYXQgaGFzIHRvIGJlIHN1bmsuXHJcbiAgICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzLmNvbnRlbnRbbl07XHJcblxyXG4gICAgICAgIC8vIFdoZW4gYXQgMCwgYW4gZWxlbWVudCBjYW4gbm90IHNpbmsgYW55IGZ1cnRoZXIuXHJcbiAgICAgICAgd2hpbGUgKG4gPiAwKSB7XHJcblxyXG4gICAgICAgICAgICAvLyBDb21wdXRlIHRoZSBwYXJlbnQgZWxlbWVudCdzIGluZGV4LCBhbmQgZmV0Y2ggaXQuXHJcbiAgICAgICAgICAgIHZhciBwYXJlbnROID0gKChuICsgMSkgPj4gMSkgLSAxLCBwYXJlbnQgPSB0aGlzLmNvbnRlbnRbcGFyZW50Tl07IC8vIGpzaGludCBpZ25vcmU6bGluZVxyXG4gICAgICAgICAgICAvLyBTd2FwIHRoZSBlbGVtZW50cyBpZiB0aGUgcGFyZW50IGlzIGdyZWF0ZXIuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNjb3JlRnVuY3Rpb24oZWxlbWVudCkgPCB0aGlzLnNjb3JlRnVuY3Rpb24ocGFyZW50KSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb250ZW50W3BhcmVudE5dID0gZWxlbWVudDtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29udGVudFtuXSA9IHBhcmVudDtcclxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSAnbicgdG8gY29udGludWUgYXQgdGhlIG5ldyBwb3NpdGlvbi5cclxuICAgICAgICAgICAgICAgIG4gPSBwYXJlbnROO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIEZvdW5kIGEgcGFyZW50IHRoYXQgaXMgbGVzcywgbm8gbmVlZCB0byBzaW5rIGFueSBmdXJ0aGVyLlxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIGJ1YmJsZVVwOiBmdW5jdGlvbihuKSB7XHJcbiAgICAgICAgLy8gTG9vayB1cCB0aGUgdGFyZ2V0IGVsZW1lbnQgYW5kIGl0cyBzY29yZS5cclxuICAgICAgICB2YXIgbGVuZ3RoID0gdGhpcy5jb250ZW50Lmxlbmd0aCxcclxuICAgICAgICAgICAgZWxlbWVudCA9IHRoaXMuY29udGVudFtuXSxcclxuICAgICAgICAgICAgZWxlbVNjb3JlID0gdGhpcy5zY29yZUZ1bmN0aW9uKGVsZW1lbnQpO1xyXG5cclxuICAgICAgICB3aGlsZSh0cnVlKSB7XHJcbiAgICAgICAgICAgIC8vIENvbXB1dGUgdGhlIGluZGljZXMgb2YgdGhlIGNoaWxkIGVsZW1lbnRzLlxyXG4gICAgICAgICAgICB2YXIgY2hpbGQyTiA9IChuICsgMSkgPDwgMSwgY2hpbGQxTiA9IGNoaWxkMk4gLSAxOyAvLyBqc2hpbnQgaWdub3JlOmxpbmVcclxuICAgICAgICAgICAgLy8gVGhpcyBpcyB1c2VkIHRvIHN0b3JlIHRoZSBuZXcgcG9zaXRpb24gb2YgdGhlIGVsZW1lbnQsIGlmIGFueS5cclxuICAgICAgICAgICAgdmFyIHN3YXAgPSBudWxsLFxyXG4gICAgICAgICAgICAgICAgY2hpbGQxU2NvcmU7XHJcbiAgICAgICAgICAgIC8vIElmIHRoZSBmaXJzdCBjaGlsZCBleGlzdHMgKGlzIGluc2lkZSB0aGUgYXJyYXkpLi4uXHJcbiAgICAgICAgICAgIGlmIChjaGlsZDFOIDwgbGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBMb29rIGl0IHVwIGFuZCBjb21wdXRlIGl0cyBzY29yZS5cclxuICAgICAgICAgICAgICAgIHZhciBjaGlsZDEgPSB0aGlzLmNvbnRlbnRbY2hpbGQxTl07XHJcbiAgICAgICAgICAgICAgICBjaGlsZDFTY29yZSA9IHRoaXMuc2NvcmVGdW5jdGlvbihjaGlsZDEpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIElmIHRoZSBzY29yZSBpcyBsZXNzIHRoYW4gb3VyIGVsZW1lbnQncywgd2UgbmVlZCB0byBzd2FwLlxyXG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkMVNjb3JlIDwgZWxlbVNjb3JlKXtcclxuICAgICAgICAgICAgICAgICAgICBzd2FwID0gY2hpbGQxTjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gRG8gdGhlIHNhbWUgY2hlY2tzIGZvciB0aGUgb3RoZXIgY2hpbGQuXHJcbiAgICAgICAgICAgIGlmIChjaGlsZDJOIDwgbGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY2hpbGQyID0gdGhpcy5jb250ZW50W2NoaWxkMk5dLFxyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkMlNjb3JlID0gdGhpcy5zY29yZUZ1bmN0aW9uKGNoaWxkMik7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2hpbGQyU2NvcmUgPCAoc3dhcCA9PT0gbnVsbCA/IGVsZW1TY29yZSA6IGNoaWxkMVNjb3JlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN3YXAgPSBjaGlsZDJOO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBJZiB0aGUgZWxlbWVudCBuZWVkcyB0byBiZSBtb3ZlZCwgc3dhcCBpdCwgYW5kIGNvbnRpbnVlLlxyXG4gICAgICAgICAgICBpZiAoc3dhcCAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb250ZW50W25dID0gdGhpcy5jb250ZW50W3N3YXBdO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb250ZW50W3N3YXBdID0gZWxlbWVudDtcclxuICAgICAgICAgICAgICAgIG4gPSBzd2FwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIE90aGVyd2lzZSwgd2UgYXJlIGRvbmUuXHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn07XHJcblxyXG5yZXR1cm4ge1xyXG4gICAgYXN0YXI6IGFzdGFyLFxyXG4gICAgR3JhcGg6IEdyYXBoXHJcbn07XHJcblxyXG59KTtcclxuIiwidmFyIEJvb3QgPSBmdW5jdGlvbiAoKSB7fTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gQm9vdDtcclxuXHJcbkJvb3QucHJvdG90eXBlID0ge1xyXG5cclxuICBwcmVsb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ3ByZWxvYWRlcicsICdhc3NldHMvaW1hZ2VzL3ByZWxvYWRlci5naWYnKTtcclxuICB9LFxyXG5cclxuICBjcmVhdGU6IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMuZ2FtZS5pbnB1dC5tYXhQb2ludGVycyA9IDE7XHJcblxyXG4gICAgaWYgKHRoaXMuZ2FtZS5kZXZpY2UuZGVza3RvcCkge1xyXG4gICAgICAvL3RoaXMuZ2FtZS5zdGFnZS5zY2FsZS5wYWdlQWxpZ25Ib3Jpem9udGFsbHkgPSB0cnVlO1xyXG4gICAgICB0aGlzLmdhbWUuc2NhbGUuc2NhbGVNb2RlID0gUGhhc2VyLlNjYWxlTWFuYWdlci5SRVNJWkU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmdhbWUuc2NhbGUuc2NhbGVNb2RlID0gUGhhc2VyLlNjYWxlTWFuYWdlci5TSE9XX0FMTDtcclxuICAgICAgdGhpcy5nYW1lLnNjYWxlLm1pbldpZHRoID0gIDQ4MDtcclxuICAgICAgdGhpcy5nYW1lLnNjYWxlLm1pbkhlaWdodCA9IDI2MDtcclxuICAgICAgdGhpcy5nYW1lLnNjYWxlLm1heFdpZHRoID0gNjQwO1xyXG4gICAgICB0aGlzLmdhbWUuc2NhbGUubWF4SGVpZ2h0ID0gNDgwO1xyXG4gICAgICB0aGlzLmdhbWUuc2NhbGUuZm9yY2VMYW5kc2NhcGUgPSB0cnVlO1xyXG4gICAgICB0aGlzLmdhbWUuc2NhbGUucGFnZUFsaWduSG9yaXpvbnRhbGx5ID0gdHJ1ZTtcclxuICAgICAgdGhpcy5nYW1lLnNjYWxlLnNldFNjcmVlblNpemUodHJ1ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdQcmVsb2FkZXInKTtcclxuICB9XHJcbn07XHJcbiIsIi8qXHJcbk1haW4gdGVzdGluZyBlbnZpcm9ubWVudC5cclxuKi9cclxuXHJcbnZhciBSZW5kZXJhYmxlcyA9IHJlcXVpcmUoJy4uL2Z1bmN0aW9uQWNjZXNzL1JlbmRlcmFibGVzJyk7XHJcbnZhciBVSUJ1aWxkZXIgPSByZXF1aXJlKCcuLi91aS9VSUJ1aWxkZXInKTtcclxuLy8gdmFyIEN1YmUgPSByZXF1aXJlKCcuLi9lbnRpdGllcy9jdWJlJyk7XHJcbnZhciBNb2R1bGVCdWlsZGVyID0gcmVxdWlyZSgnLi4vZW50aXRpZXMvTW9kdWxlQnVpbGRlcicpO1xyXG4vLyB2YXIgVXRpbHMgPSByZXF1aXJlKCcuLi91dGlscycpO1xyXG52YXIgQ3ViZUdyb3VwID0gcmVxdWlyZSgnLi4vZW50aXRpZXMvY3ViZV9ncm91cCcpO1xyXG52YXIgSGFja2FibGUgPSByZXF1aXJlKCcuLi9lbnRpdGllcy9IYWNrYWJsZScpO1xyXG52YXIgRW1pdHRlciA9IHJlcXVpcmUoJy4uL2VmZmVjdHMvRW1pdHRlcicpO1xyXG4vLyB2YXIgbW91c2VCb2R5OyAvLyBwaHlzaWNzIGJvZHkgZm9yIG1vdXNlXHJcbnZhciBNb3VzZSA9IHJlcXVpcmUoJy4uL2VudGl0aWVzL21vdXNlJyk7XHJcbnZhciBCdWxsZXQgPSByZXF1aXJlKCcuLi9lbnRpdGllcy9CdWxsZXQnKTtcclxuXHJcbnZhciBiZywgYmcyO1xyXG52YXIgbnVtUm9pZHM7XHJcbnZhciBtYXhSb2lkcyA9IDEwMDtcclxudmFyIG5ld01vZHVsZVNwZWVkID0gMTAwMDtcclxudmFyIGFzdGVyb2lkcywgYXN0ZXJvaWRMaXN0O1xyXG52YXIgbGVmdEtleSwgcmlnaHRLZXksIGN3S2V5LCBjY3dLZXk7XHJcbnZhciB3YXJuaW5nO1xyXG52YXIgdGltZXI7XHJcbnZhciBzaG9wUGFuZWwsIHNob3BNZW51T3BlbmluZyA9IGZhbHNlLCBzaG9wTWVudUNsb3NpbmcgPSBmYWxzZTtcclxudmFyIGRpZmY7XHJcbnZhciBzaGllbGRCdXR0b24sIHNvbGFyUGFuZWxCdXR0b24sIHRocnVzdGVyQnV0dG9uLCBndW5CdXR0b24sIGhhY2tCdXR0b247XHJcblxyXG52YXIgR2FtZSA9IGZ1bmN0aW9uICgpIHtcclxuICB0aGlzLnRlc3RlbnRpdHkgPSBudWxsO1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBHYW1lO1xyXG5cclxuR2FtZS5wcm90b3R5cGUgPSB7XHJcblx0XHJcbiAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XHJcblx0dGhpcy5nYW1lLndvcmxkLnNldEJvdW5kcygwLCAwLCA4MDAwLCA0MDAwKTtcclxuXHRcclxuXHRudW1Sb2lkcyA9IDA7XHJcblx0ZGlmZiA9IDA7XHJcblx0XHJcblx0Ly9DcmVhdGUgdGhlIHR3byBiYWNrZ3JvdW5kIGltYWdlc1xyXG4gICAgYmcgPSB0aGlzLmdhbWUuYWRkLnNwcml0ZSgwLCAwLCAnZWFydGhOaWdodCcpO1xyXG5cdGJnMiA9IHRoaXMuZ2FtZS5hZGQuc3ByaXRlKC04MDAwLCAwLCAnZWFydGhOaWdodCcpO1xyXG5cdFxyXG5cdC8vTG9hZCBpbiBzb3VuZCBlZmZlY3RzXHJcblx0dGhpcy5ob3ZlckNsaWNrID0gdGhpcy5nYW1lLmFkZC5hdWRpbygnaG92ZXJDbGljaycpO1xyXG5cdHRoaXMuZG93bkNsaWNrID0gdGhpcy5nYW1lLmFkZC5hdWRpbygnZG93bkNsaWNrJyk7XHJcblx0dGhpcy5jYXNoUmVnaXN0ZXIgPSB0aGlzLmdhbWUuYWRkLmF1ZGlvKCdjYXNoUmVnaXN0ZXInKTtcclxuXHR0aGlzLmNhc2hSZWdpc3Rlci5hbGxvd011bHRpcGxlID0gdHJ1ZTtcclxuXHRcclxuXHQvL1NldCB1cCBwaHlzaWNzXHJcblx0dGhpcy5nYW1lLnBoeXNpY3Muc3RhcnRTeXN0ZW0oUGhhc2VyLlBoeXNpY3MuUDJKUyk7XHJcblx0dGhpcy5nYW1lLnBoeXNpY3MucDIuc2V0SW1wYWN0RXZlbnRzKHRydWUpO1xyXG5cdC8vYWRkIGNvbGxpc2lvbiBncm91cFxyXG5cdHRoaXMuY29sbGlzaW9uR3JvdXAgPSB0aGlzLmdhbWUucGh5c2ljcy5wMi5jcmVhdGVDb2xsaXNpb25Hcm91cCgpO1xyXG5cdFxyXG5cdFxyXG5cdHRoaXMubW91c2UgPSBuZXcgTW91c2UodGhpcy5nYW1lLCB0aGlzLmlucHV0KTtcclxuICAgXHJcblx0dGhpcy51cGRhdGVEZXBlbmRlbnRzID0gW107XHJcblxyXG5cdC8vY3JlYXRlIFJlbmRlcmFibGVzIGNsYXNzXHJcblx0dGhpcy5yZW5kZXJhYmxlcyA9IG5ldyBSZW5kZXJhYmxlcygpO1xyXG5cdC8vY3JlYXRlIHRoZSBVSUJ1aWxkZXJcclxuXHR0aGlzLnVpQnVpbGRlciA9IG5ldyBVSUJ1aWxkZXIodGhpcywgdGhpcy5yZW5kZXJhYmxlcyk7ICAgXHJcblx0Ly9jcmVhdGUgTW9kdWxlQnVpbGRlciBhbmQgc3RvcmUgaXQgaW4gdGhpcyBnYW1lIHN0YXRlIG9iamVjdFxyXG5cdHRoaXMubW9kdWxlQnVpbGRlciA9IG5ldyBNb2R1bGVCdWlsZGVyKHRoaXMpO1xyXG5cdC8vY3JlYXRlIGFuZCBzdG9yZSB0aGUgY29yZSBtb2R1bGVcclxuXHR0aGlzLmNvcmVNb2R1bGUgPSB0aGlzLm1vZHVsZUJ1aWxkZXIuYnVpbGQoJ2NvcmUnLCAxMjAwLCAxMjAwLCB0cnVlKTtcclxuXHR0aGlzLmN1YmVXaWR0aCA9IHRoaXMuY29yZU1vZHVsZS5jdWJlLndpZHRoO1xyXG5cdHRoaXMuY3ViZUJ1ZmZlciA9IDI7XHJcblx0dGhpcy50ZXN0VmFyID0gNztcclxuXHR2YXIgcGxheWVyR3JvdXAgPSBuZXcgQ3ViZUdyb3VwKHRoaXMsIHRoaXMuY29yZU1vZHVsZS5jdWJlKTtcclxuXHR0aGlzLnVwZGF0ZURlcGVuZGVudHMucHVzaChwbGF5ZXJHcm91cCk7XHJcblx0dGhpcy5wbGF5ZXIgPSBwbGF5ZXJHcm91cDtcclxuXHR0aGlzLnBsYXllci5pc1BsYXllciA9IHRydWU7XHJcbiAgIFxyXG5cdHRoaXMubW91c2UgPSBuZXcgTW91c2UodGhpcy5nYW1lLCB0aGlzLmlucHV0LCBwbGF5ZXJHcm91cCk7XHJcblx0dGhpcy5wbGF5ZXIuaXNQbGF5ZXIgPSB0cnVlO1xyXG5cdFxyXG5cdC8vQ3JlYXRlIHRoZSBlbWl0dGVyIGZvciB0aGUgYmluYXJ5IHBhcnRpY2xlIGVmZmVjdHNcclxuXHR0aGlzLkJpbmFyeUVtaXR0ZXIgPSBuZXcgRW1pdHRlcih0aGlzKTtcclxuXHRcclxuXHQvL3Rlc3QgaGFja2FibGUgb2JqZWN0XHJcblx0dGhpcy50ZXN0SGFjayA9IG5ldyBIYWNrYWJsZSh0aGlzLCAxNjAwLCAxMjAwLCAnaGFja2FibGUxJywgNDAwKTtcclxuXHRcclxuXHRhc3Rlcm9pZHMgPSB0aGlzLmdhbWUuYWRkLmdyb3VwKCk7XHJcblx0YXN0ZXJvaWRzLmVuYWJsZUJvZHkgPSB0cnVlO1xyXG5cdGFzdGVyb2lkcy5waHlzaWNzQm9keVR5cGUgPSBQaGFzZXIuUGh5c2ljcy5QMkpTO1xyXG5cdGFzdGVyb2lkTGlzdCA9IG5ldyBQaGFzZXIuQXJyYXlTZXQoKTtcclxuXHR0aGlzLmdlbmVyYXRlQXN0ZXJvaWRzKCk7XHJcblx0XHJcblx0dGltZXIgPSB0aGlzLmdhbWUudGltZS5jcmVhdGUoZmFsc2UpO1xyXG5cdHdhcm5pbmcgPSB0aGlzLmdhbWUuYWRkLmltYWdlKHRoaXMuZ2FtZS5jYW1lcmEueCwgdGhpcy5nYW1lLmNhbWVyYS55LCAnd2FybmluZycpO1xyXG5cdHdhcm5pbmcua2lsbCgpO1xyXG5cdFxyXG5cdGxlZnRLZXkgPSB0aGlzLmdhbWUuaW5wdXQua2V5Ym9hcmQuYWRkS2V5KFBoYXNlci5LZXlib2FyZC5BKTtcclxuXHRyaWdodEtleSA9IHRoaXMuZ2FtZS5pbnB1dC5rZXlib2FyZC5hZGRLZXkoUGhhc2VyLktleWJvYXJkLkQpO1xyXG5cdGNjd0tleSA9IHRoaXMuZ2FtZS5pbnB1dC5rZXlib2FyZC5hZGRLZXkoUGhhc2VyLktleWJvYXJkLlEpO1xyXG5cdGN3S2V5ID0gdGhpcy5nYW1lLmlucHV0LmtleWJvYXJkLmFkZEtleShQaGFzZXIuS2V5Ym9hcmQuRSk7XHJcblx0XHJcblx0Ly9ERUJVR0dJTkcgTElTVEVORVJTLSBhbGxvdyB5b3UgdG8gY3JlYXRlIG1vZHVsZXMgYnkgcHJlc3Npbmcga2V5c1xyXG5cdC8vY29yZVxyXG5cdHRoaXMucGxhY2VDb3JlS2V5ID0gdGhpcy5nYW1lLmlucHV0LmtleWJvYXJkLmFkZEtleShQaGFzZXIuS2V5Ym9hcmQuUCk7XHJcblx0dGhpcy5wbGFjZUNvcmVLZXkub25Eb3duLmFkZCh0aGlzLmRlYnVnQWRkQ29yZSwgdGhpcyk7XHJcblx0Ly9zaGllbGRcclxuXHR0aGlzLnBsYWNlU2hpZWxkS2V5ID0gdGhpcy5nYW1lLmlucHV0LmtleWJvYXJkLmFkZEtleShQaGFzZXIuS2V5Ym9hcmQuTyk7XHJcbiAgICB0aGlzLnBsYWNlU2hpZWxkS2V5Lm9uRG93bi5hZGQodGhpcy5kZWJ1Z0FkZFNoaWVsZCwgdGhpcyk7XHJcblx0Ly90aHJ1c3RlclxyXG5cdHRoaXMucGxhY2VUaHJ1c3RlcktleSA9IHRoaXMuZ2FtZS5pbnB1dC5rZXlib2FyZC5hZGRLZXkoUGhhc2VyLktleWJvYXJkLkkpO1xyXG4gICAgdGhpcy5wbGFjZVRocnVzdGVyS2V5Lm9uRG93bi5hZGQodGhpcy5kZWJ1Z0FkZFRocnVzdGVyLCB0aGlzKTtcclxuXHQvL3NvbGFyUGFuZWxcclxuXHR0aGlzLnBsYWNlU1BLZXkgPSB0aGlzLmdhbWUuaW5wdXQua2V5Ym9hcmQuYWRkS2V5KFBoYXNlci5LZXlib2FyZC5VKTtcclxuICAgIHRoaXMucGxhY2VTUEtleS5vbkRvd24uYWRkKHRoaXMuZGVidWdBZGRTUCwgdGhpcyk7XHJcblx0Ly9oYWNrZXJcclxuXHR0aGlzLnBsYWNlSGFja0tleSA9IHRoaXMuZ2FtZS5pbnB1dC5rZXlib2FyZC5hZGRLZXkoUGhhc2VyLktleWJvYXJkLlkpO1xyXG5cdHRoaXMucGxhY2VIYWNrS2V5Lm9uRG93bi5hZGQodGhpcy5kZWJ1Z0FkZEhhY2ssIHRoaXMpO1xyXG5cdC8vZ3VuXHJcblx0dGhpcy5wbGFjZUd1bktleSA9IHRoaXMuZ2FtZS5pbnB1dC5rZXlib2FyZC5hZGRLZXkoUGhhc2VyLktleWJvYXJkLlQpO1xyXG4gICAgdGhpcy5wbGFjZUd1bktleS5vbkRvd24uYWRkKHRoaXMuZGVidWdBZGRHdW4sIHRoaXMpO1xyXG5cdC8vcmVzZXQgZ2FtZVxyXG5cdHRoaXMucmVzZXRLZXkgPSB0aGlzLmdhbWUuaW5wdXQua2V5Ym9hcmQuYWRkS2V5KFBoYXNlci5LZXlib2FyZC5NKTtcclxuICAgIHRoaXMucmVzZXRLZXkub25Eb3duLmFkZCh0aGlzLnJlc3RhcnRMZXZlbCwgdGhpcyk7XHJcblx0Ly9FTkRcclxuICAgIFxyXG4gICAgLy8gRGVidWcgY29udHJvbGxlclxyXG4gICAgdGhpcy5kZWJ1Z0tleSA9IHRoaXMuZ2FtZS5pbnB1dC5rZXlib2FyZC5hZGRLZXkoUGhhc2VyLktleWJvYXJkLkgpO1xyXG4gICAgdGhpcy5kZWJ1Z0tleS5vbkRvd24uYWRkKHRoaXMuZGVidWcsIHRoaXMpO1xyXG5cclxuICAgIHRoaXMubGV2ZWxEYXRhID0gSlNPTi5wYXJzZSh0aGlzLmdhbWUuY2FjaGUuZ2V0VGV4dCgnbGV2ZWxfb25lJykpO1xyXG4gICAgdGhpcy5sb2FkRGF0YSgpO1xyXG4gICAgXHJcblx0c2hvcFBhbmVsID0gdGhpcy5nYW1lLmFkZC5pbWFnZSh0aGlzLmdhbWUuY2FtZXJhLnggKyB0aGlzLmdhbWUuY2FtZXJhLndpZHRoICsgMjU2ICsgMTYsIHRoaXMuZ2FtZS5jYW1lcmEueSArIDE2LCAnc2hvcFBhbmVsJyk7XHJcblx0c2hvcFBhbmVsLmtpbGwoKTtcclxuXHRzaGllbGRCdXR0b24gPSB0aGlzLmdhbWUuYWRkLmJ1dHRvbih0aGlzLmdhbWUuY2FtZXJhLnggKyB0aGlzLmdhbWUuY2FtZXJhLndpZHRoIC0gZGlmZiwgdGhpcy5nYW1lLmNhbWVyYS55ICsgNTIgKyAoODggKiAxKSwgJ3NoaWVsZEJ1dHRvbicsIHRoaXMucHVyY2hhc2VNb2R1bGUsIHtzdGF0ZTogdGhpcywga2V5OiAnc2hpZWxkJ30sIDEsIDAsIDIpO1xyXG5cdHNoaWVsZEJ1dHRvbi5raWxsKCk7XHJcblx0c2hpZWxkQnV0dG9uLm9uSW5wdXRPdmVyLmFkZCh0aGlzLnBsYXlIb3ZlckNsaWNrLCB0aGlzKTtcclxuXHRzaGllbGRCdXR0b24ub25JbnB1dERvd24uYWRkKHRoaXMucGxheURvd25DbGljaywgdGhpcyk7XHJcblx0c29sYXJQYW5lbEJ1dHRvbiA9IHRoaXMuZ2FtZS5hZGQuYnV0dG9uKHRoaXMuZ2FtZS5jYW1lcmEueCArIHRoaXMuZ2FtZS5jYW1lcmEud2lkdGggLSBkaWZmLCB0aGlzLmdhbWUuY2FtZXJhLnkgKyA1MiArICg4OCAqIDIpLCAnc29sYXJQYW5lbEJ1dHRvbicsIHRoaXMucHVyY2hhc2VNb2R1bGUsIHtzdGF0ZTogdGhpcywga2V5OiAnc29sYXJQYW5lbCd9LCAxLCAwLCAyKTtcclxuXHRzb2xhclBhbmVsQnV0dG9uLmtpbGwoKTtcclxuXHRzb2xhclBhbmVsQnV0dG9uLm9uSW5wdXRPdmVyLmFkZCh0aGlzLnBsYXlIb3ZlckNsaWNrLCB0aGlzKTtcclxuXHRzb2xhclBhbmVsQnV0dG9uLm9uSW5wdXREb3duLmFkZCh0aGlzLnBsYXlEb3duQ2xpY2ssIHRoaXMpO1xyXG5cdHRocnVzdGVyQnV0dG9uID0gdGhpcy5nYW1lLmFkZC5idXR0b24odGhpcy5nYW1lLmNhbWVyYS54ICsgdGhpcy5nYW1lLmNhbWVyYS53aWR0aCAtIGRpZmYsIHRoaXMuZ2FtZS5jYW1lcmEueSArIDUyICsgKDg4ICogMyksICd0aHJ1c3RlckJ1dHRvbicsIHRoaXMucHVyY2hhc2VNb2R1bGUsIHtzdGF0ZTogdGhpcywga2V5OiAndGhydXN0ZXInfSwgMSwgMCwgMik7XHJcblx0dGhydXN0ZXJCdXR0b24ua2lsbCgpO1xyXG5cdHRocnVzdGVyQnV0dG9uLm9uSW5wdXRPdmVyLmFkZCh0aGlzLnBsYXlIb3ZlckNsaWNrLCB0aGlzKTtcclxuXHR0aHJ1c3RlckJ1dHRvbi5vbklucHV0RG93bi5hZGQodGhpcy5wbGF5RG93bkNsaWNrLCB0aGlzKTtcclxuXHRndW5CdXR0b24gPSB0aGlzLmdhbWUuYWRkLmJ1dHRvbih0aGlzLmdhbWUuY2FtZXJhLnggKyB0aGlzLmdhbWUuY2FtZXJhLndpZHRoIC0gZGlmZiwgdGhpcy5nYW1lLmNhbWVyYS55ICsgNTIgKyAoODggKiA0KSwgJ2d1bkJ1dHRvbicsIHRoaXMucHVyY2hhc2VNb2R1bGUsIHtzdGF0ZTogdGhpcywga2V5OiAnZ3VuJ30sIDEsIDAsIDIpO1xyXG5cdGd1bkJ1dHRvbi5raWxsKCk7XHJcblx0Z3VuQnV0dG9uLm9uSW5wdXRPdmVyLmFkZCh0aGlzLnBsYXlIb3ZlckNsaWNrLCB0aGlzKTtcclxuXHRndW5CdXR0b24ub25JbnB1dERvd24uYWRkKHRoaXMucGxheURvd25DbGljaywgdGhpcyk7XHJcblx0aGFja0J1dHRvbiA9IHRoaXMuZ2FtZS5hZGQuYnV0dG9uKHRoaXMuZ2FtZS5jYW1lcmEueCArIHRoaXMuZ2FtZS5jYW1lcmEud2lkdGggLSBkaWZmLCB0aGlzLmdhbWUuY2FtZXJhLnkgKyA1MiArICg4OCAqIDUpLCAnaGFja0J1dHRvbicsIHRoaXMucHVyY2hhc2VNb2R1bGUsIHtzdGF0ZTogdGhpcywga2V5OiAnaGFjayd9LCAxLCAwLCAyKTtcclxuXHRoYWNrQnV0dG9uLmtpbGwoKTtcclxuXHRoYWNrQnV0dG9uLm9uSW5wdXRPdmVyLmFkZCh0aGlzLnBsYXlIb3ZlckNsaWNrLCB0aGlzKTtcclxuXHRoYWNrQnV0dG9uLm9uSW5wdXREb3duLmFkZCh0aGlzLnBsYXlEb3duQ2xpY2ssIHRoaXMpO1xyXG5cdHRoaXMuZ2FtZS5jYW1lcmEuZm9sbG93KHRoaXMuY29yZU1vZHVsZS5jdWJlKTtcclxuXHR0aGlzLnNob3BCdXR0b24gPSB0aGlzLmdhbWUuYWRkLmJ1dHRvbih0aGlzLmdhbWUuY2FtZXJhLnggKyB0aGlzLmdhbWUuY2FtZXJhLndpZHRoIC0gNDgsIDE2LCAnc2hvcEJ1dHRvbicsIHRoaXMudXNlU2hvcEJ1dHRvbiwgdGhpcywgMSwgMCwgMik7XHJcblx0dGhpcy5zaG9wQnV0dG9uLm9uSW5wdXRPdmVyLmFkZCh0aGlzLnBsYXlIb3ZlckNsaWNrLCB0aGlzKTtcclxuXHR0aGlzLnNob3BCdXR0b24ub25JbnB1dERvd24uYWRkKHRoaXMucGxheURvd25DbGljaywgdGhpcyk7XHJcbiAgIFxyXG4gICB0aGlzLmp1aWN5ID0gdGhpcy5nYW1lLnBsdWdpbnMuYWRkKG5ldyBQaGFzZXIuUGx1Z2luLkp1aWN5KHRoaXMpKTtcclxuICAgdGhpcy5nYW1lLmNhbWVyYS5mb2xsb3codGhpcy5jb3JlTW9kdWxlLmN1YmUpO1xyXG4gICAgXHJcblx0dGhpcy5oZWxwQmFubmVyID0gdGhpcy51aUJ1aWxkZXIuYnVpbGRCYW5uZXIoMC41LCAwLjUsICd0dXRvcmlhbF90ZXh0Jyk7XHJcblx0dGhpcy5oZWxwQnV0dG9uID0gdGhpcy5nYW1lLmFkZC5idXR0b24oMCwgMCwgJ2hlbHBCdXR0b24nLCB0aGlzLmhlbHBCYW5uZXIudG9nZ2xlLCB0aGlzLmhlbHBCYW5uZXIsIDEsIDAsIDIpO1xyXG5cdHRoaXMuaGVscEJ1dHRvbi5vbklucHV0T3Zlci5hZGQodGhpcy5wbGF5SG92ZXJDbGljaywgdGhpcyk7XHJcblx0dGhpcy5oZWxwQnV0dG9uLm9uSW5wdXREb3duLmFkZCh0aGlzLnBsYXlEb3duQ2xpY2ssIHRoaXMpO1xyXG5cdFxyXG5cdHRoaXMubWFpblNvbmcgPSB0aGlzLmdhbWUuYWRkLmF1ZGlvKCdtYWluU29uZycsIDEsIHRydWUpO1xyXG5cdHRoaXMubWFpblNvbmcucGxheSgnJywwLDEsdHJ1ZSx0cnVlKTtcclxuICB9LFxyXG4gIFxyXG4gIHJlc3RhcnRMZXZlbDogZnVuY3Rpb24oKSB7XHJcblx0dGhpcy5tYWluU29uZy5zdG9wKCk7XHJcblx0dGhpcy5nYW1lLnN0YXRlLnN0YXJ0KHBsYXllclN0YXRlLmN1cnJlbnRMZXZlbCk7XHJcbiAgfSxcclxuICBcclxuICBsb2FkRGF0YTogZnVuY3Rpb24oKSB7XHJcbiAgICAgIHZhciBteUxldmVsID0gdGhpcy5sZXZlbERhdGFbJ2xldmVsX29uZSddO1xyXG4gICAgICBmb3IgKHZhciBrZXkgaW4gbXlMZXZlbCkge1xyXG4gICAgICAgICBpZiAobXlMZXZlbC5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XHJcbiAgICAgICAgICAgIHZhciBlbGVtZW50ID0gbXlMZXZlbFtrZXldO1xyXG4gICAgICAgICAgICBpZiAoZWxlbWVudC5oYXNPd25Qcm9wZXJ0eSgnYmx1ZXByaW50JykpIHsgLy8gZW5lbXkgdHlwZVxyXG4gICAgICAgICAgICAgICB2YXIgZW5lbXlYID0gZWxlbWVudFsneF9wb3MnXTtcclxuICAgICAgICAgICAgICAgdmFyIGVuZW15WSA9IGVsZW1lbnRbJ3lfcG9zJ107XHJcbiAgICAgICAgICAgICAgIHZhciBlbmVteUdyb3VwID0gbmV3IEN1YmVHcm91cCh0aGlzLCB1bmRlZmluZWQpO1xyXG4gICAgICAgICAgICAgICB0aGlzLnVwZGF0ZURlcGVuZGVudHMucHVzaChlbmVteUdyb3VwKTtcclxuICAgICAgICAgICAgICAgdmFyIGJsdWVwcmludCA9IGVsZW1lbnRbJ2JsdWVwcmludCddO1xyXG4gICAgICAgICAgICAgICBmb3IgKHZhciByb3cgPSAwOyByb3cgPCBibHVlcHJpbnQubGVuZ3RoOyByb3crKykge1xyXG4gICAgICAgICAgICAgICAgICBmb3IgKHZhciBjb2wgPSAwOyBjb2wgPCBibHVlcHJpbnRbcm93XS5sZW5ndGg7IGNvbCsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgIHZhciB0eXBlID0gYmx1ZXByaW50W3Jvd11bY29sXTtcclxuICAgICAgICAgICAgICAgICAgICAgdmFyIG5ld01vZHVsZSA9IHRoaXMubW9kdWxlQnVpbGRlci5idWlsZCh0eXBlLCBlbmVteVggKyByb3cgKiAodGhpcy5jdWJlV2lkdGggKyB0aGlzLmN1YmVCdWZmZXIpLFxyXG4gICAgICAgICAgICAgICAgICAgICBlbmVteVkgLSBjb2wgKiAodGhpcy5jdWJlV2lkdGggKyB0aGlzLmN1YmVCdWZmZXIpLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgIG5ld01vZHVsZS5jdWJlLnRhZyA9ICdlbmVteV9tb2R1bGUnO1xyXG4gICAgICAgICAgICAgICAgICAgICB2YXIgcG9pbnQgPSBuZXcgUGhhc2VyLlBvaW50KHJvdywgY29sKTtcclxuICAgICAgICAgICAgICAgICAgICAgZW5lbXlHcm91cC5hZGQobmV3TW9kdWxlLmN1YmUsIHBvaW50KTtcclxuICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgIHZhciBhaVR5cGUgPSBlbGVtZW50Wyd0eXBlJ107XHJcbiAgICAgICAgICAgICAgIGVuZW15R3JvdXAuZ2l2ZUFJKGFpVHlwZSwgdGhpcy5wbGF5ZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gIH0sXHJcbiAgXHJcblx0cGxheUhvdmVyQ2xpY2s6IGZ1bmN0aW9uKCkge1xyXG5cdFx0dGhpcy5ob3ZlckNsaWNrLnBsYXkoKTtcclxuXHR9LFxyXG5cdFxyXG5cdHBsYXlEb3duQ2xpY2s6IGZ1bmN0aW9uKCkge1xyXG5cdFx0dGhpcy5kb3duQ2xpY2sucGxheSgpO1xyXG5cdH0sXHJcbiAgXHJcblx0dXNlU2hvcEJ1dHRvbjogZnVuY3Rpb24oKSB7XHJcblx0XHR0aGlzLmRvd25DbGljay5wbGF5KCk7XHJcblx0XHRpZighc2hvcFBhbmVsLmFsaXZlICYmICFzaG9wTWVudU9wZW5pbmcgJiYgIXNob3BNZW51Q2xvc2luZykge1xyXG5cdFx0XHRzaG9wUGFuZWwucmV2aXZlKCk7XHJcblx0XHRcdGRpZmYgPSAwO1xyXG5cdFx0XHRzaG9wTWVudU9wZW5pbmcgPSB0cnVlO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSBpZihzaG9wUGFuZWwuYWxpdmUmJiAhc2hvcE1lbnVDbG9zaW5nICYmICFzaG9wTWVudU9wZW5pbmcpIHtcclxuXHRcdFx0c2hvcE1lbnVDbG9zaW5nID0gdHJ1ZTtcclxuXHRcdH1cclxuXHR9LFxyXG5cdFxyXG5cdGFkZFNob3BCdXR0b25zOiBmdW5jdGlvbigpIHtcclxuXHRcdHNoaWVsZEJ1dHRvbi5yZXZpdmUoKTtcclxuXHRcdHNvbGFyUGFuZWxCdXR0b24ucmV2aXZlKCk7XHJcblx0XHR0aHJ1c3RlckJ1dHRvbi5yZXZpdmUoKTtcclxuXHRcdGd1bkJ1dHRvbi5yZXZpdmUoKTtcclxuXHRcdGhhY2tCdXR0b24ucmV2aXZlKCk7XHJcblx0fSxcclxuXHRcclxuXHRwdXJjaGFzZU1vZHVsZTogZnVuY3Rpb24oKSB7XHJcblx0XHR2YXIgcmFuZFkgPSB0aGlzLnN0YXRlLmdhbWUucm5kLmludGVnZXJJblJhbmdlKDEwMCwgdGhpcy5zdGF0ZS5nYW1lLmNhbWVyYS5oZWlnaHQgLSAxMDApO1xyXG5cdFx0aWYodGhpcy5rZXkgPT09ICdzaGllbGQnICYmIHRoaXMuc3RhdGUubW91c2UueCA+IHNoaWVsZEJ1dHRvbi54ICYmIHRoaXMuc3RhdGUubW91c2UueCA8IHNoaWVsZEJ1dHRvbi54ICsgMjU2ICYmIHRoaXMuc3RhdGUubW91c2UueSA+IHNoaWVsZEJ1dHRvbi55ICYmIHRoaXMuc3RhdGUubW91c2UueSA8IHNoaWVsZEJ1dHRvbi55ICsgODIpIHtcclxuXHRcdFx0dGhpcy5zdGF0ZS5hZGRTaGllbGQodGhpcy5zdGF0ZS5nYW1lLmNhbWVyYS54ICsgdGhpcy5zdGF0ZS5nYW1lLmNhbWVyYS53aWR0aCArIDgwLCB0aGlzLnN0YXRlLmdhbWUuY2FtZXJhLnkgKyByYW5kWSk7XHJcblx0XHRcdHRoaXMuc3RhdGUuY2FzaFJlZ2lzdGVyLnBsYXkoKTtcclxuXHRcdH1cclxuXHRcdGVsc2UgaWYodGhpcy5rZXkgPT09ICdzb2xhclBhbmVsJyAmJiB0aGlzLnN0YXRlLm1vdXNlLnggPiBzb2xhclBhbmVsQnV0dG9uLnggJiYgdGhpcy5zdGF0ZS5tb3VzZS54IDwgc29sYXJQYW5lbEJ1dHRvbi54ICsgMjU2ICYmIHRoaXMuc3RhdGUubW91c2UueSA+IHNvbGFyUGFuZWxCdXR0b24ueSAmJiB0aGlzLnN0YXRlLm1vdXNlLnkgPCBzb2xhclBhbmVsQnV0dG9uLnkgKyA4Mikge1xyXG5cdFx0XHR0aGlzLnN0YXRlLmFkZFNQKHRoaXMuc3RhdGUuZ2FtZS5jYW1lcmEueCArIHRoaXMuc3RhdGUuZ2FtZS5jYW1lcmEud2lkdGggKyA4MCwgdGhpcy5zdGF0ZS5nYW1lLmNhbWVyYS55ICsgcmFuZFkpO1xyXG5cdFx0XHR0aGlzLnN0YXRlLmNhc2hSZWdpc3Rlci5wbGF5KCk7XHJcblx0XHR9XHJcblx0XHRlbHNlIGlmKHRoaXMua2V5ID09PSAndGhydXN0ZXInICYmIHRoaXMuc3RhdGUubW91c2UueCA+IHRocnVzdGVyQnV0dG9uLnggJiYgdGhpcy5zdGF0ZS5tb3VzZS54IDwgdGhydXN0ZXJCdXR0b24ueCArIDI1NiAmJiB0aGlzLnN0YXRlLm1vdXNlLnkgPiB0aHJ1c3RlckJ1dHRvbi55ICYmIHRoaXMuc3RhdGUubW91c2UueSA8IHRocnVzdGVyQnV0dG9uLnkgKyA4Mikge1xyXG5cdFx0XHR0aGlzLnN0YXRlLmFkZFRocnVzdGVyKHRoaXMuc3RhdGUuZ2FtZS5jYW1lcmEueCArIHRoaXMuc3RhdGUuZ2FtZS5jYW1lcmEud2lkdGggKyA4MCwgdGhpcy5zdGF0ZS5nYW1lLmNhbWVyYS55ICsgcmFuZFkpO1xyXG5cdFx0XHR0aGlzLnN0YXRlLmNhc2hSZWdpc3Rlci5wbGF5KCk7XHJcblx0XHR9XHJcblx0XHRlbHNlIGlmKHRoaXMua2V5ID09PSAnZ3VuJyAmJiB0aGlzLnN0YXRlLm1vdXNlLnggPiBndW5CdXR0b24ueCAmJiB0aGlzLnN0YXRlLm1vdXNlLnggPCBndW5CdXR0b24ueCArIDI1NiAmJiB0aGlzLnN0YXRlLm1vdXNlLnkgPiBndW5CdXR0b24ueSAmJiB0aGlzLnN0YXRlLm1vdXNlLnkgPCBndW5CdXR0b24ueSArIDgyKSB7XHJcblx0XHRcdHRoaXMuc3RhdGUuYWRkR3VuKHRoaXMuc3RhdGUuZ2FtZS5jYW1lcmEueCArIHRoaXMuc3RhdGUuZ2FtZS5jYW1lcmEud2lkdGggKyA4MCwgdGhpcy5zdGF0ZS5nYW1lLmNhbWVyYS55ICsgcmFuZFkpO1xyXG5cdFx0XHR0aGlzLnN0YXRlLmNhc2hSZWdpc3Rlci5wbGF5KCk7XHJcblx0XHR9XHJcblx0XHRlbHNlIGlmKHRoaXMua2V5ID09PSAnaGFjaycgJiYgdGhpcy5zdGF0ZS5tb3VzZS54ID4gaGFja0J1dHRvbi54ICYmIHRoaXMuc3RhdGUubW91c2UueCA8IGhhY2tCdXR0b24ueCArIDI1NiAmJiB0aGlzLnN0YXRlLm1vdXNlLnkgPiBoYWNrQnV0dG9uLnkgJiYgdGhpcy5zdGF0ZS5tb3VzZS55IDwgaGFja0J1dHRvbi55ICsgODIpIHtcclxuXHRcdFx0dGhpcy5zdGF0ZS5hZGRIYWNrKHRoaXMuc3RhdGUuZ2FtZS5jYW1lcmEueCArIHRoaXMuc3RhdGUuZ2FtZS5jYW1lcmEud2lkdGggKyA4MCwgdGhpcy5zdGF0ZS5nYW1lLmNhbWVyYS55ICsgcmFuZFkpO1xyXG5cdFx0XHR0aGlzLnN0YXRlLmNhc2hSZWdpc3Rlci5wbGF5KCk7XHJcblx0XHR9XHJcblx0fSxcclxuXHJcbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XHJcblx0aWYobGVmdEtleS5pc0Rvd24pIHtcclxuXHRcdGlmKHRoaXMuY29yZU1vZHVsZS5jdWJlLmJvZHkuYW5ndWxhclZlbG9jaXR5ID4gLTkpIHsgXHJcblx0XHRcdHRoaXMuY29yZU1vZHVsZS5jdWJlLmJvZHkuYW5ndWxhckZvcmNlICs9IC03LjUgKiBNYXRoLnBvdyh0aGlzLnBsYXllci5udW1DdWJlcywgMS42NSk7XHJcblx0XHR9XHJcblx0fVxyXG5cdFxyXG5cdGlmKHJpZ2h0S2V5LmlzRG93bikge1xyXG5cdFx0aWYodGhpcy5jb3JlTW9kdWxlLmN1YmUuYm9keS5hbmd1bGFyVmVsb2NpdHkgPCA5KSB7XHJcblx0XHRcdHRoaXMuY29yZU1vZHVsZS5jdWJlLmJvZHkuYW5ndWxhckZvcmNlICs9IDcuNSAqIE1hdGgucG93KHRoaXMucGxheWVyLm51bUN1YmVzLCAxLjY1KTtcclxuXHRcdH1cclxuXHR9XHJcblx0XHJcblx0aWYoY2N3S2V5LmlzRG93bikge1xyXG5cdFx0aWYodGhpcy5tb3VzZS5ncmFiYmVkICE9PSB1bmRlZmluZWQgJiYgdGhpcy5tb3VzZS5ncmFiYmVkLnNwcml0ZS5ncm91cCA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdHRoaXMubW91c2UuZ3JhYmJlZC5hbmd1bGFyRm9yY2UgKz0gLTU7XHJcblx0XHR9XHJcblx0fVxyXG5cdFxyXG5cdGlmKGN3S2V5LmlzRG93bikge1xyXG5cdFx0aWYodGhpcy5tb3VzZS5ncmFiYmVkICE9PSB1bmRlZmluZWQgJiYgdGhpcy5tb3VzZS5ncmFiYmVkLnNwcml0ZS5ncm91cCA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdHRoaXMubW91c2UuZ3JhYmJlZC5hbmd1bGFyRm9yY2UgKz0gNTtcclxuXHRcdH1cclxuXHR9XHJcblx0XHJcblx0dGhpcy5tb3VzZS51cGRhdGUoKTtcclxuXHR0aGlzLnNjcm9sbEJHKCk7XHJcbiAgIFxyXG5cdGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy51cGRhdGVEZXBlbmRlbnRzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRpZiAodGhpcy51cGRhdGVEZXBlbmRlbnRzW2ldLnVwZGF0ZSkge1xyXG5cdFx0XHR0aGlzLnVwZGF0ZURlcGVuZGVudHNbaV0udXBkYXRlKCk7XHJcblx0XHR9XHJcblx0fVxyXG5cdFxyXG5cdC8vV2FybmluZyBDb2RlXHJcblx0aWYodGhpcy5jb3JlTW9kdWxlLmN1YmUueCArIChNYXRoLm1heCh0aGlzLnBsYXllci5jdWJlc1dpZHRoKCksIHRoaXMucGxheWVyLmN1YmVzSGVpZ2h0KCkpIC8gMiAqIDY0KSA+IDgwMDAgfHxcclxuXHR0aGlzLmNvcmVNb2R1bGUuY3ViZS54IC0gKE1hdGgubWF4KHRoaXMucGxheWVyLmN1YmVzV2lkdGgoKSwgdGhpcy5wbGF5ZXIuY3ViZXNIZWlnaHQoKSkgLyAyICogNjQpIDwgMCB8fFxyXG5cdHRoaXMuY29yZU1vZHVsZS5jdWJlLnkgKyAoTWF0aC5tYXgodGhpcy5wbGF5ZXIuY3ViZXNXaWR0aCgpLCB0aGlzLnBsYXllci5jdWJlc0hlaWdodCgpKSAvIDIgKiA2NCkgPiA0MDAwIHx8XHJcblx0dGhpcy5jb3JlTW9kdWxlLmN1YmUueSAtIChNYXRoLm1heCh0aGlzLnBsYXllci5jdWJlc1dpZHRoKCksIHRoaXMucGxheWVyLmN1YmVzSGVpZ2h0KCkpIC8gMiAqIDY0KSA8IDApIHtcclxuXHRcdGlmKHRpbWVyLmxlbmd0aCA9PT0gMCkge1xyXG5cdFx0XHR3YXJuaW5nLnJldml2ZSgpO1xyXG5cdFx0XHR0aW1lci5sb29wKFBoYXNlci5UaW1lci5TRUNPTkQgKiA1LCB0aGlzLnJlc2V0UGxheWVyLCB0aGlzKTtcclxuXHRcdFx0dGltZXIuc3RhcnQoKTtcclxuXHRcdH1cclxuXHR9XHJcblx0ZWxzZSB7XHJcblx0XHRpZih3YXJuaW5nLmFsaXZlID09PSB0cnVlKSB7XHJcblx0XHRcdHdhcm5pbmcua2lsbCgpO1xyXG5cdFx0fVxyXG5cdFx0aWYodGltZXIubGVuZ3RoID4gMCkge1xyXG5cdFx0XHR0aW1lci5zdG9wKHRydWUpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHR3YXJuaW5nLnggPSB0aGlzLmdhbWUuY2FtZXJhLng7XHJcblx0d2FybmluZy55ID0gdGhpcy5nYW1lLmNhbWVyYS55O1xyXG5cdFxyXG5cdC8vU2hvcCBNb3ZlbWVudCBDb2RlXHJcblx0aWYoc2hvcE1lbnVPcGVuaW5nID09PSB0cnVlKSB7XHRcclxuXHRcdGRpZmYgKz0gNDtcclxuXHRcdGlmKGRpZmYgPj0gMjc2KSB7XHJcblx0XHRcdHNob3BNZW51T3BlbmluZyA9IGZhbHNlO1xyXG5cdFx0XHR0aGlzLmFkZFNob3BCdXR0b25zKCk7XHJcblx0XHR9XHJcblx0fVxyXG5cdGVsc2UgaWYoc2hvcE1lbnVDbG9zaW5nID09PSB0cnVlKSB7XHJcblx0XHRkaWZmIC09IDQ7XHJcblx0XHRpZihkaWZmIDw9IDApIHtcclxuXHRcdFx0c2hvcFBhbmVsLmtpbGwoKTtcclxuXHRcdFx0c2hvcE1lbnVDbG9zaW5nID0gZmFsc2U7XHJcblx0XHR9XHJcblx0fVxyXG5cdHRoaXMuc2hvcEJ1dHRvbi54ID0gdGhpcy5nYW1lLmNhbWVyYS54ICsgdGhpcy5nYW1lLmNhbWVyYS53aWR0aCAtIDQ4IC0gZGlmZjtcclxuXHR0aGlzLnNob3BCdXR0b24ueSA9IHRoaXMuZ2FtZS5jYW1lcmEueSArIDE2O1xyXG5cdHRoaXMuaGVscEJ1dHRvbi54ID0gdGhpcy5nYW1lLmNhbWVyYS54ICsgMTY7XHJcblx0dGhpcy5oZWxwQnV0dG9uLnkgPSB0aGlzLmdhbWUuY2FtZXJhLnkgKyAxNjtcclxuXHRzaG9wUGFuZWwueCA9IHRoaXMuZ2FtZS5jYW1lcmEueCArIHRoaXMuZ2FtZS5jYW1lcmEud2lkdGggKyAxNiAtIGRpZmY7XHJcblx0c2hvcFBhbmVsLnkgPSB0aGlzLmdhbWUuY2FtZXJhLnkgKyAxNjtcclxuXHRzaGllbGRCdXR0b24ueCA9IHRoaXMuZ2FtZS5jYW1lcmEueCArIHRoaXMuZ2FtZS5jYW1lcmEud2lkdGggKyAxNiAtIGRpZmY7XHJcblx0c2hpZWxkQnV0dG9uLnkgPSB0aGlzLmdhbWUuY2FtZXJhLnkgKyA3MCArICg4NiAqIDApO1xyXG5cdHNvbGFyUGFuZWxCdXR0b24ueCA9IHRoaXMuZ2FtZS5jYW1lcmEueCArIHRoaXMuZ2FtZS5jYW1lcmEud2lkdGggKyAxNiAtIGRpZmY7XHJcblx0c29sYXJQYW5lbEJ1dHRvbi55ID0gdGhpcy5nYW1lLmNhbWVyYS55ICsgNzAgKyAoODYgKiAxKTtcclxuXHR0aHJ1c3RlckJ1dHRvbi54ID0gdGhpcy5nYW1lLmNhbWVyYS54ICsgdGhpcy5nYW1lLmNhbWVyYS53aWR0aCArIDE2IC0gZGlmZjtcclxuXHR0aHJ1c3RlckJ1dHRvbi55ID0gdGhpcy5nYW1lLmNhbWVyYS55ICsgNzAgKyAoODYgKiAyKTtcclxuXHRndW5CdXR0b24ueCA9IHRoaXMuZ2FtZS5jYW1lcmEueCArIHRoaXMuZ2FtZS5jYW1lcmEud2lkdGggKyAxNiAtIGRpZmY7XHJcblx0Z3VuQnV0dG9uLnkgPSB0aGlzLmdhbWUuY2FtZXJhLnkgKyA3MCArICg4NiAqIDMpO1xyXG5cdGhhY2tCdXR0b24ueCA9IHRoaXMuZ2FtZS5jYW1lcmEueCArIHRoaXMuZ2FtZS5jYW1lcmEud2lkdGggKyAxNiAtIGRpZmY7XHJcblx0aGFja0J1dHRvbi55ID0gdGhpcy5nYW1lLmNhbWVyYS55ICsgNzAgKyAoODYgKiA0KTtcclxuICB9LFxyXG4gIFxyXG4gIHJlbmRlcjogZnVuY3Rpb24gKCkge1xyXG5cdHRoaXMubW91c2UucmVuZGVyKCk7XHJcblx0dGhpcy5yZW5kZXJhYmxlcy5yZW5kZXJBbGwoKTtcclxuICB9LFxyXG4gIFxyXG5cdHNjcm9sbEJHOiBmdW5jdGlvbigpIHtcclxuXHRcdGJnLnggKz0gMC4xMjU7XHJcblx0XHRpZihiZy54ID49IDgwMDApIHtcclxuXHRcdFx0YmcueCA9IDA7XHJcblx0XHR9XHJcblx0XHRiZzIueCArPSAwLjEyNTtcclxuXHRcdGlmKGJnMi54ID49IDgwMDApIHtcclxuXHRcdFx0YmcyLnggPSAwO1xyXG5cdFx0fVxyXG5cdH0sXHJcblx0XHJcblx0Z2VuZXJhdGVBc3Rlcm9pZHM6IGZ1bmN0aW9uKCkge1xyXG5cdFx0Zm9yKDtudW1Sb2lkcyA8IG1heFJvaWRzOyBudW1Sb2lkcysrKSB7XHJcblx0XHRcdHZhciByYW5kWCA9IHRoaXMuZ2FtZS5ybmQuaW50ZWdlckluUmFuZ2UoMCwgdGhpcy5nYW1lLndvcmxkLndpZHRoKTtcclxuXHRcdFx0dmFyIHJhbmRZID0gdGhpcy5nYW1lLnJuZC5pbnRlZ2VySW5SYW5nZSgwLCB0aGlzLmdhbWUud29ybGQuaGVpZ2h0KTtcclxuXHRcdFx0XHJcblx0XHRcdHdoaWxlKHJhbmRYIDwgdGhpcy5jb3JlTW9kdWxlLmN1YmUueCAtICh0aGlzLnBsYXllci5jdWJlc1dpZHRoKCkgLyAyICsgMTAwKSAmJiByYW5kWCA+IHRoaXMuY29yZU1vZHVsZS5jdWJlLnggKyAodGhpcy5wbGF5ZXIuY3ViZXNXaWR0aCgpIC8gMiArIDEwMCkgJiZcclxuXHRcdFx0cmFuZFkgPCB0aGlzLmNvcmVNb2R1bGUuY3ViZS55IC0gKHRoaXMucGxheWVyLmN1YmVzSGVpZ2h0KCkgLyAyICsgMTAwKSAmJiByYW5kWSA+IHRoaXMuY29yZU1vZHVsZS5jdWJlLnkgKyAodGhpcy5wbGF5ZXIuY3ViZXNIZWlnaHQoKSAvIDIgKyAxMDApKSB7XHJcblx0XHRcdFx0cmFuZFggPSB0aGlzLmdhbWUucm5kLmludGVnZXJJblJhbmdlKDAsIHRoaXMuZ2FtZS53b3JsZC53aWR0aCk7XHJcblx0XHRcdFx0cmFuZFkgPSB0aGlzLmdhbWUucm5kLmludGVnZXJJblJhbmdlKDAsIHRoaXMuZ2FtZS53b3JsZC5oZWlnaHQpO1xyXG5cdFx0XHR9XHJcblx0XHRcdFxyXG5cdFx0XHR2YXIgYXN0ZXJvaWQgPSBhc3Rlcm9pZHMuY3JlYXRlKHJhbmRYLCByYW5kWSwgJ2FzdGVyb2lkJyk7XHJcblx0XHRcdFxyXG5cdFx0XHRhc3Rlcm9pZC5ib2R5LmNsZWFyU2hhcGVzKCk7IFxyXG5cdFx0XHRhc3Rlcm9pZC5ib2R5LmxvYWRQb2x5Z29uKCdhc3Rlcm9pZFBvbHlnb24nLCAnYXN0ZXJvaWQnKTsgLy9DaGFuZ2UgdGhlIGNvbGxpc2lvbiBkZXRlY3Rpb24gZnJvbSBhbiBBQUJCIHRvIGEgcG9seWdvblxyXG5cdFx0XHRhc3Rlcm9pZC5ib2R5LmRhbXBpbmcgPSB0aGlzLmdhbWUucm5kLnJlYWxJblJhbmdlKDAsIDAuMykgKiB0aGlzLmdhbWUucm5kLmludGVnZXJJblJhbmdlKDAsIDEpICogdGhpcy5nYW1lLnJuZC5pbnRlZ2VySW5SYW5nZSgwLCAxKTtcclxuXHRcdFx0YXN0ZXJvaWQuYm9keS5yb3RhdGlvbiA9IHRoaXMuZ2FtZS5ybmQucmVhbEluUmFuZ2UoMCwgMiAqIE1hdGguUEkpO1xyXG5cdFx0XHRhc3Rlcm9pZC5ib2R5LmZvcmNlLnggPSB0aGlzLmdhbWUucm5kLmludGVnZXJJblJhbmdlKC0xMCwgMTApICogNzUwO1xyXG5cdFx0XHRhc3Rlcm9pZC5ib2R5LmZvcmNlLnkgPSB0aGlzLmdhbWUucm5kLmludGVnZXJJblJhbmdlKC0xMCwgMTApICogNzUwO1xyXG5cdFx0XHRhc3Rlcm9pZC5ib2R5LnNldENvbGxpc2lvbkdyb3VwKHRoaXMuY29sbGlzaW9uR3JvdXApO1xyXG5cdFx0XHRhc3Rlcm9pZC5ib2R5LmNvbGxpZGVzKHRoaXMuY29sbGlzaW9uR3JvdXApO1xyXG5cdFx0XHRhc3Rlcm9pZC5ib2R5LmNvbGxpZGVXb3JsZEJvdW5kcyA9IGZhbHNlO1xyXG5cdFx0XHRhc3Rlcm9pZC5hdXRvQ3VsbCA9IHRydWU7XHJcblx0XHRcdGFzdGVyb2lkLmNoZWNrV29ybGRCb3VuZHMgPSB0cnVlO1xyXG5cdFx0XHRhc3Rlcm9pZC5ldmVudHMub25PdXRPZkJvdW5kcy5hZGQodGhpcy5yZXNldEFzdGVyb2lkLCB7cm9pZDogYXN0ZXJvaWQsIGNvcmVNb2R1bGU6IHRoaXMuY29yZU1vZHVsZSwgcGxheWVyOiB0aGlzLnBsYXllciwgZ2FtZTogdGhpcy5nYW1lfSk7XHJcblx0XHRcdGFzdGVyb2lkTGlzdC5hZGQoYXN0ZXJvaWQpO1xyXG5cdFx0fVxyXG5cdH0sXHJcblx0XHJcblx0cmVzZXRBc3Rlcm9pZDogZnVuY3Rpb24oKSB7XHJcblx0XHR2YXIgcmFuZFggPSB0aGlzLmdhbWUucm5kLmludGVnZXJJblJhbmdlKDAsIHRoaXMuZ2FtZS53b3JsZC53aWR0aCk7XHJcblx0XHR2YXIgcmFuZFkgPSB0aGlzLmdhbWUucm5kLmludGVnZXJJblJhbmdlKDAsIHRoaXMuZ2FtZS53b3JsZC5oZWlnaHQpO1xyXG5cdFx0XHRcclxuXHRcdHdoaWxlKHJhbmRYIDwgdGhpcy5jb3JlTW9kdWxlLmN1YmUueCAtICh0aGlzLnBsYXllci5jdWJlc1dpZHRoKCkgLyAyICsgMTAwKSAmJiByYW5kWCA+IHRoaXMuY29yZU1vZHVsZS5jdWJlLnggKyAodGhpcy5wbGF5ZXIuY3ViZXNXaWR0aCgpIC8gMiArIDEwMCkgJiZcclxuXHRcdFx0cmFuZFkgPCB0aGlzLmNvcmVNb2R1bGUuY3ViZS55IC0gKHRoaXMucGxheWVyLmN1YmVzSGVpZ2h0KCkgLyAyICsgMTAwKSAmJiByYW5kWSA+IHRoaXMuY29yZU1vZHVsZS5jdWJlLnkgKyAodGhpcy5wbGF5ZXIuY3ViZXNIZWlnaHQoKSAvIDIgKyAxMDApKSB7XHJcblx0XHRcdFx0cmFuZFggPSB0aGlzLmdhbWUucm5kLmludGVnZXJJblJhbmdlKDAsIHRoaXMuZ2FtZS53b3JsZC53aWR0aCk7XHJcblx0XHRcdFx0cmFuZFkgPSB0aGlzLmdhbWUucm5kLmludGVnZXJJblJhbmdlKDAsIHRoaXMuZ2FtZS53b3JsZC5oZWlnaHQpO1xyXG5cdFx0fVxyXG5cdFx0dGhpcy5yb2lkLnggPSByYW5kWDtcclxuXHRcdHRoaXMucm9pZC55ID0gcmFuZFk7XHJcblx0XHR0aGlzLnJvaWQuYm9keS5yb3RhdGlvbiA9IHRoaXMuZ2FtZS5ybmQucmVhbEluUmFuZ2UoMCwgMiAqIE1hdGguUEkpO1xyXG5cdFx0dGhpcy5yb2lkLmJvZHkuZm9yY2UueCA9IHRoaXMuZ2FtZS5ybmQuaW50ZWdlckluUmFuZ2UoLTEwLCAxMCkgKiA3NTA7XHJcblx0XHR0aGlzLnJvaWQuYm9keS5mb3JjZS55ID0gdGhpcy5nYW1lLnJuZC5pbnRlZ2VySW5SYW5nZSgtMTAsIDEwKSAqIDc1MDtcclxuXHR9LFxyXG5cdFxyXG5cdHJlc2V0UGxheWVyOiBmdW5jdGlvbigpIHtcclxuXHRcdGlmKHRoaXMuY29yZU1vZHVsZS5jdWJlLnggKyAoTWF0aC5tYXgodGhpcy5wbGF5ZXIuY3ViZXNXaWR0aCgpLCB0aGlzLnBsYXllci5jdWJlc0hlaWdodCgpKSAvIDIgKiA2NCkgPiA4MDAwKSB7XHJcblx0XHRcdHRoaXMuY29yZU1vZHVsZS5jdWJlLmJvZHkubW92ZUxlZnQodGhpcy5wbGF5ZXIubnVtQ3ViZXMgKiA3NTApO1xyXG5cdFx0fVxyXG5cdFx0aWYodGhpcy5jb3JlTW9kdWxlLmN1YmUueCAtIChNYXRoLm1heCh0aGlzLnBsYXllci5jdWJlc1dpZHRoKCksIHRoaXMucGxheWVyLmN1YmVzSGVpZ2h0KCkpIC8gMiAqIDY0KSA8IDApIHtcclxuXHRcdFx0dGhpcy5jb3JlTW9kdWxlLmN1YmUuYm9keS5tb3ZlUmlnaHQodGhpcy5wbGF5ZXIubnVtQ3ViZXMgKiA3NTApO1xyXG5cdFx0fVxyXG5cdFx0aWYodGhpcy5jb3JlTW9kdWxlLmN1YmUueSArIChNYXRoLm1heCh0aGlzLnBsYXllci5jdWJlc1dpZHRoKCksIHRoaXMucGxheWVyLmN1YmVzSGVpZ2h0KCkpIC8gMiAqIDY0KSA+IDQwMDApIHtcclxuXHRcdFx0dGhpcy5jb3JlTW9kdWxlLmN1YmUuYm9keS5tb3ZlVXAodGhpcy5wbGF5ZXIubnVtQ3ViZXMgKiA3NTApO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSBpZih0aGlzLmNvcmVNb2R1bGUuY3ViZS55IC0gKE1hdGgubWF4KHRoaXMucGxheWVyLmN1YmVzV2lkdGgoKSwgdGhpcy5wbGF5ZXIuY3ViZXNIZWlnaHQoKSkgLyAyICogNjQpIDwgMCkge1xyXG5cdFx0XHR0aGlzLmNvcmVNb2R1bGUuY3ViZS5ib2R5Lm1vdmVEb3duKHRoaXMucGxheWVyLm51bUN1YmVzICogNzUwKTtcclxuXHRcdH1cclxuXHR9LFxyXG5cdFxyXG4gIC8vREVCVUcgRlVOQ1RJT05TLSBldmVudCBmdW5jdGlvbnMgY2FsbGVkIGZyb20gbGlzdGVuZXJzIHRoYXQgYWxsb3cgeW91IHRvIGNyZWF0ZSBtb2R1bGVzIHdpdGgga2V5IHByZXNzZXNcclxuICBhZGRDb3JlOiBmdW5jdGlvbiAoeCwgeSkgeyBcclxuXHR2YXIgbmV3TW9kdWxlID0gdGhpcy5tb2R1bGVCdWlsZGVyLmJ1aWxkKCdjb3JlJywgeCwgeSwgdHJ1ZSk7XHJcbiAgfSxcclxuICBhZGRTaGllbGQ6IGZ1bmN0aW9uICh4LCB5KSB7XHJcblx0dmFyIG5ld01vZHVsZSA9IHRoaXMubW9kdWxlQnVpbGRlci5idWlsZCgnc2hpZWxkJywgeCwgeSwgdHJ1ZSk7XHJcblx0bmV3TW9kdWxlLmN1YmUuYm9keS5tb3ZlTGVmdChuZXdNb2R1bGVTcGVlZCk7XHJcbiAgfSxcclxuICBhZGRUaHJ1c3RlcjogZnVuY3Rpb24gKHgsIHkpIHtcclxuXHR2YXIgbmV3TW9kdWxlID0gdGhpcy5tb2R1bGVCdWlsZGVyLmJ1aWxkKCd0aHJ1c3RlcicsIHgsIHksIHRydWUpO1xyXG5cdC8vbmV3TW9kdWxlLmN1YmUuYm9keS5zZXRDb2xsaXNpb25Hcm91cCh0aGlzLmNvbGxpc2lvbkdyb3VwKTtcclxuXHQvL25ld01vZHVsZS5jdWJlLmJvZHkuY29sbGlkZXModGhpcy5jb2xsaXNpb25Hcm91cCk7XHJcblx0bmV3TW9kdWxlLmN1YmUuYm9keS5tb3ZlTGVmdChuZXdNb2R1bGVTcGVlZCk7XHJcbiAgfSxcclxuICBhZGRTUDogZnVuY3Rpb24gKHgsIHkpIHtcclxuXHR2YXIgbmV3TW9kdWxlID0gdGhpcy5tb2R1bGVCdWlsZGVyLmJ1aWxkKCdzb2xhclBhbmVsJywgeCwgeSwgdHJ1ZSk7XHJcblx0Ly9uZXdNb2R1bGUuY3ViZS5ib2R5LnNldENvbGxpc2lvbkdyb3VwKHRoaXMuY29sbGlzaW9uR3JvdXApO1xyXG5cdC8vbmV3TW9kdWxlLmN1YmUuYm9keS5jb2xsaWRlcyh0aGlzLmNvbGxpc2lvbkdyb3VwKTtcclxuXHRuZXdNb2R1bGUuY3ViZS5ib2R5Lm1vdmVMZWZ0KG5ld01vZHVsZVNwZWVkKTtcclxuICB9LFxyXG4gIGFkZEhhY2s6IGZ1bmN0aW9uICh4LCB5KSB7XHJcblx0dmFyIG5ld01vZHVsZSA9IHRoaXMubW9kdWxlQnVpbGRlci5idWlsZCgnaGFja2VyJywgeCwgeSwgdHJ1ZSk7XHJcblx0Ly9uZXdNb2R1bGUuY3ViZS5ib2R5LnNldENvbGxpc2lvbkdyb3VwKHRoaXMuY29sbGlzaW9uR3JvdXApO1xyXG5cdC8vbmV3TW9kdWxlLmN1YmUuYm9keS5jb2xsaWRlcyh0aGlzLmNvbGxpc2lvbkdyb3VwKTtcclxuXHRuZXdNb2R1bGUuY3ViZS5ib2R5Lm1vdmVMZWZ0KG5ld01vZHVsZVNwZWVkKTtcclxuICB9LFxyXG4gIGFkZEd1bjogZnVuY3Rpb24gKHgsIHkpIHtcclxuXHR2YXIgbmV3TW9kdWxlID0gdGhpcy5tb2R1bGVCdWlsZGVyLmJ1aWxkKCdndW4nLCB4LCB5LCB0cnVlKTtcclxuXHQvL25ld01vZHVsZS5jdWJlLmJvZHkuc2V0Q29sbGlzaW9uR3JvdXAodGhpcy5jb2xsaXNpb25Hcm91cCk7XHJcblx0Ly9uZXdNb2R1bGUuY3ViZS5ib2R5LmNvbGxpZGVzKHRoaXMuY29sbGlzaW9uR3JvdXApO1xyXG5cdG5ld01vZHVsZS5jdWJlLmJvZHkubW92ZUxlZnQobmV3TW9kdWxlU3BlZWQpO1xyXG4gIH0sXHJcbiAgXHJcbiAgZGVidWc6IGZ1bmN0aW9uICgpIHtcclxuICAgICBcclxuICB9LFxyXG4gIFxyXG4gIGRlYnVnQWRkQ29yZTogZnVuY3Rpb24gKCkgeyBcclxuXHR0aGlzLm1vZHVsZUJ1aWxkZXIuYnVpbGQoJ2NvcmUnLCB0aGlzLm1vdXNlLngsIHRoaXMubW91c2UueSwgdHJ1ZSk7XHJcbiAgfSxcclxuICBkZWJ1Z0FkZFNoaWVsZDogZnVuY3Rpb24gKCkge1xyXG5cdHZhciBncmFiID0gdGhpcy5tb2R1bGVCdWlsZGVyLmJ1aWxkKCdzaGllbGQnLCB0aGlzLm1vdXNlLngsIHRoaXMubW91c2UueSwgdHJ1ZSk7XHJcbiAgIGdyYWIuY3ViZS5ib2R5LnJvdGF0aW9uID0gTWF0aC5yYW5kb20oKSAqIDQgKiBNYXRoLlBJIC0gMiAqIE1hdGguUEk7XHJcbiAgfSxcclxuICBkZWJ1Z0FkZFRocnVzdGVyOiBmdW5jdGlvbiAoKSB7XHJcblx0dGhpcy5tb2R1bGVCdWlsZGVyLmJ1aWxkKCd0aHJ1c3RlcicsIHRoaXMubW91c2UueCwgdGhpcy5tb3VzZS55LCB0cnVlKTtcclxuICB9LFxyXG4gIGRlYnVnQWRkU1A6IGZ1bmN0aW9uICgpIHtcclxuXHR0aGlzLm1vZHVsZUJ1aWxkZXIuYnVpbGQoJ3NvbGFyUGFuZWwnLCB0aGlzLm1vdXNlLngsIHRoaXMubW91c2UueSwgdHJ1ZSk7XHJcbiAgfSxcclxuICBkZWJ1Z0FkZEhhY2s6IGZ1bmN0aW9uICgpIHtcclxuXHR0aGlzLm1vZHVsZUJ1aWxkZXIuYnVpbGQoJ2hhY2tlcicsIHRoaXMubW91c2UueCwgdGhpcy5tb3VzZS55LCB0cnVlKTtcclxuICB9LFxyXG4gIGRlYnVnQWRkR3VuOiBmdW5jdGlvbiAoKSB7XHJcblx0dGhpcy5tb2R1bGVCdWlsZGVyLmJ1aWxkKCdndW4nLCB0aGlzLm1vdXNlLngsIHRoaXMubW91c2UueSwgdHJ1ZSk7XHJcbiAgfSxcclxufTtcclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuIiwidmFyIE1lbnUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgdGhpcy50ZXh0ID0gbnVsbDtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gTWVudTtcclxuXHJcbk1lbnUucHJvdG90eXBlID0ge1xyXG5cdFxyXG4gIHBvczogWy0yNSwgMjUsIDc1XSxcclxuICBjcmVhdGU6IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciB4ID0gdGhpcy5nYW1lLndpZHRoIC8gMjtcclxuICAgIHZhciB5ID0gdGhpcy5nYW1lLmhlaWdodCAvIDI7XHJcbiAgICBcclxuICAgIHRoaXMudGl0bGUgPSB0aGlzLmFkZC5pbWFnZSh0aGlzLndvcmxkLmNlbnRlclgsIHRoaXMud29ybGQuY2VudGVyWSAtIDk1LCAnbWVudV90aXRsZScpO1xyXG4gICAgdGhpcy50aXRsZS5hbmNob3Iuc2V0VG8oMC41LCAwLjUpO1xyXG4gICAgXHJcbiAgICB0aGlzLnNlbGVjdCA9IHRoaXMuYWRkQnV0dG9uKDEsICdtZW51X3NlbGVjdCcsIHRoaXMuY2hhbmdlVG9HYW1lKTtcclxuICBcdHRoaXMuc2VsZWN0LmFuY2hvci5zZXRUbygwLjUsIDAuNSk7XHJcbiAgXHRcclxuICBcdHRoaXMubWFudWFsID0gdGhpcy5hZGRCdXR0b24oMiwgJ21lbnVfbWFudWFsJywgdGhpcy5jaGFuZ2VUb01lbnUpO1xyXG4gIFx0dGhpcy5tYW51YWwuYW5jaG9yLnNldFRvKDAuNSwgMC41KTtcclxuICBcdFxyXG4gIFx0dGhpcy5jcmVkaXRzID0gdGhpcy5hZGRCdXR0b24oMywgJ21lbnVfY3JlZGl0cycsIHRoaXMuY2hhbmdlVG9NZW51KTtcclxuICBcdHRoaXMuY3JlZGl0cy5hbmNob3Iuc2V0VG8oMC41LCAwLjUpO1xyXG4gIH0sXHJcblxyXG4gIGFkZEJ1dHRvbjogZnVuY3Rpb24oYnV0dG9uLCBpbWcsIGZ1bmMpe1xyXG4gICAgcmV0dXJuIHRoaXMuYWRkLmJ1dHRvbih0aGlzLndvcmxkLmNlbnRlclgsIHRoaXMud29ybGQuY2VudGVyWSArIHRoaXMucG9zW2J1dHRvbiAtIDFdLCBpbWcsIGZ1bmMpO1xyXG4gIH0sXHJcbiAgXHJcbiAgZHJhdzogZnVuY3Rpb24oKXtcclxuICB9LFxyXG4gIFxyXG4gIGNoYW5nZVRvR2FtZTogZnVuY3Rpb24oKXtcclxuICBcdHRoaXMuZ2FtZS5zdGF0ZS5zdGFydCgnR2FtZScpO1xyXG4gIH0sICBcclxuICBcclxuICBjaGFuZ2VUb01lbnU6IGZ1bmN0aW9uKCl7XHJcbiAgXHR0aGlzLmdhbWUuc3RhdGUuc3RhcnQoJ01lbnUnKTtcclxuICB9LCAgXHJcbiAgLypcclxuICBjaGFuZ2VTdGF0ZTogZnVuY3Rpb24oc3RhdGUpe1xyXG4gIFx0c3dpdGNoKHN0YXRlKXtcclxuICBcdFx0Y2FzZSAnZ2FtZSc6XHJcbiAgXHRcdFx0dGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdHYW1lJyk7XHJcbiAgXHRcdFx0YnJlYWs7XHJcbiAgXHRcdGNhc2UgJ21lbnUnOlxyXG4gIFx0XHRcdHRoaXMuZ2FtZS5zdGF0ZS5zdGFydCgnTWVudScpO1xyXG4gIFx0XHRcdGJyZWFrO1xyXG4gIFx0XHRkZWZhdWx0OlxyXG4gIFx0XHRcdGJyZWFrO1xyXG4gIFx0fVxyXG4gIH0sXHJcbiAgKi9cclxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcclxuICB9LFxyXG5cclxufTtcclxuIiwidmFyIFByZWxvYWRlciA9IGZ1bmN0aW9uIChnYW1lKSB7XHJcbiAgZ2FtZSA9IG51bGw7XHJcbiAgdGhpcy5hc3NldCA9IG51bGw7XHJcbiAgdGhpcy5yZWFkeSA9IGZhbHNlO1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBQcmVsb2FkZXI7XHJcblxyXG5QcmVsb2FkZXIucHJvdG90eXBlID0ge1xyXG5cclxuICBwcmVsb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLmFzc2V0ID0gdGhpcy5hZGQuc3ByaXRlKDY0MCwgMzYwLCAncHJlbG9hZGVyJyk7XHJcbiAgICB0aGlzLmFzc2V0LmFuY2hvci5zZXRUbygwLjUsIDAuNSk7XHJcblxyXG4gICAgdGhpcy5sb2FkLm9uTG9hZENvbXBsZXRlLmFkZE9uY2UodGhpcy5vbkxvYWRDb21wbGV0ZSwgdGhpcyk7XHJcbiAgICB0aGlzLmxvYWQuc2V0UHJlbG9hZFNwcml0ZSh0aGlzLmFzc2V0KTtcclxuXHRcclxuXHQvL0xvYWQgU3ByaXRlc2hlZXRzXHJcblx0dGhpcy5sb2FkLnNwcml0ZXNoZWV0KCdjb3JlJywgJ2Fzc2V0cy9pbWFnZXMvY29yZVNoZWV0LnBuZycsIDY0LCA2NCk7IFxyXG5cdHRoaXMubG9hZC5zcHJpdGVzaGVldCgndGhydXN0ZXInLCAnYXNzZXRzL2ltYWdlcy90aHJ1c3RlclNoZWV0LnBuZycsIDY0LCA2NCk7XHJcblx0dGhpcy5sb2FkLnNwcml0ZXNoZWV0KCdndW4nLCAnYXNzZXRzL2ltYWdlcy9ndW5TaGVldC5wbmcnLCA2NCwgNjQpO1xyXG5cdHRoaXMubG9hZC5zcHJpdGVzaGVldCgnaGFja2VyJywgJ2Fzc2V0cy9pbWFnZXMvaGFja1NoZWV0LnBuZycsIDY0LCA2NCk7XHJcblx0dGhpcy5sb2FkLnNwcml0ZXNoZWV0KCdzaGllbGRCdXR0b24nLCAnYXNzZXRzL2ltYWdlcy9zaGllbGRCdXR0b25TaGVldC5wbmcnLCAyNTYsIDgyKTtcclxuXHR0aGlzLmxvYWQuc3ByaXRlc2hlZXQoJ3NvbGFyUGFuZWxCdXR0b24nLCAnYXNzZXRzL2ltYWdlcy9zb2xhclBhbmVsQnV0dG9uU2hlZXQucG5nJywgMjU2LCA4Mik7XHJcblx0dGhpcy5sb2FkLnNwcml0ZXNoZWV0KCd0aHJ1c3RlckJ1dHRvbicsICdhc3NldHMvaW1hZ2VzL3RocnVzdGVyQnV0dG9uU2hlZXQucG5nJywgMjU2LCA4Mik7XHJcblx0dGhpcy5sb2FkLnNwcml0ZXNoZWV0KCdndW5CdXR0b24nLCAnYXNzZXRzL2ltYWdlcy9ndW5CdXR0b25TaGVldC5wbmcnLCAyNTYsIDgyKTtcclxuXHR0aGlzLmxvYWQuc3ByaXRlc2hlZXQoJ2hhY2tCdXR0b24nLCAnYXNzZXRzL2ltYWdlcy9oYWNrQnV0dG9uU2hlZXQucG5nJywgMjU2LCA4Mik7XHJcblx0dGhpcy5sb2FkLnNwcml0ZXNoZWV0KCdoYWNrYWJsZTEnLCAnYXNzZXRzL2ltYWdlcy9oYWNrYWJsZTEucG5nJywgMjU2LCAyNTYpO1xyXG5cdHRoaXMubG9hZC5zcHJpdGVzaGVldCgnc2hvcEJ1dHRvbicsICdhc3NldHMvaW1hZ2VzL3Nob3BCdXR0b25TaGVldC5wbmcnLCAzMiwgMzIpO1xyXG5cdFxyXG5cdC8vTG9hZCBJbWFnZXNcclxuXHR0aGlzLmxvYWQuaW1hZ2UoJ2VhcnRoTmlnaHQnLCAnYXNzZXRzL2ltYWdlcy9iZ19lYXJ0aE5pZ2h0U21hbGwuanBnJyk7XHJcblx0dGhpcy5sb2FkLmltYWdlKCdidWxsZXQnLCAnYXNzZXRzL2ltYWdlcy9idWxsZXQucG5nJyk7XHJcblx0dGhpcy5sb2FkLmltYWdlKCdzaGllbGQnLCAnYXNzZXRzL2ltYWdlcy9zaGllbGQucG5nJyk7XHJcblx0dGhpcy5sb2FkLmltYWdlKCdzb2xhclBhbmVsJywgJ2Fzc2V0cy9pbWFnZXMvc29sYXJQYW5lbC5wbmcnKTtcclxuXHR0aGlzLmxvYWQuaW1hZ2UoJ2FzdGVyb2lkJywgJ2Fzc2V0cy9pbWFnZXMvYXN0ZXJvaWQucG5nJyk7XHJcblx0dGhpcy5sb2FkLmltYWdlKCdzaG9wUGFuZWwnLCAnYXNzZXRzL2ltYWdlcy9zaG9wQmFja1BhbmVsLnBuZycpO1xyXG5cdHRoaXMubG9hZC5pbWFnZSgnd2FybmluZycsICdhc3NldHMvaW1hZ2VzL3dhcm5pbmcucG5nJyk7XHJcbiAgICBcclxuXHQvL0xvYWQgRm9udHNcclxuXHR0aGlzLmxvYWQuc2NyaXB0KCd3ZWJmb250JywgJy8vYWpheC5nb29nbGVhcGlzLmNvbS9hamF4L2xpYnMvd2ViZm9udC8xLjQuNy93ZWJmb250LmpzJyk7XHJcblx0XHJcblx0Ly9Mb2FkIEpTT04gRmlsZXNcclxuXHR0aGlzLmxvYWQuYXRsYXNKU09OSGFzaCgnY29ubmVjdGlvbnMnLCAnYXNzZXRzL2ltYWdlcy9jb25uZWN0aW9ucy5wbmcnLCAnYXNzZXRzL2pzb24vY29ubmVjdGlvbnMuanNvbicpO1xyXG5cdHRoaXMubG9hZC5hdGxhc0pTT05IYXNoKCdjb25uZWN0aW9ucycsICdhc3NldHMvaW1hZ2VzL2Nvbm5lY3Rpb25zLnBuZycsICdhc3NldHMvanNvbi9jb25uZWN0aW9ucy5qc29uJyk7XHJcblx0dGhpcy5sb2FkLmF0bGFzSlNPTkhhc2goJ2hlbHBCdXR0b24nLCAnYXNzZXRzL2ltYWdlcy9oZWxwQnV0dG9uU2hlZXQucG5nJywgJ2Fzc2V0cy9qc29uL2hlbHBfYnV0dG9uLmpzb24nKTtcclxuXHR0aGlzLmxvYWQuYXRsYXNKU09OSGFzaCgnYXJyb3dCdXR0b24nLCAnYXNzZXRzL2ltYWdlcy9hcnJvd0J1dHRvblNoZWV0LnBuZycsICdhc3NldHMvanNvbi9hcnJvd19idXR0b24uanNvbicpO1xyXG5cdHRoaXMubG9hZC5waHlzaWNzKCdtb2R1bGVfcGh5c2ljcycsICdhc3NldHMvanNvbi9tb2R1bGVfcGh5c2ljcy5qc29uJyk7XHJcblx0dGhpcy5sb2FkLnBoeXNpY3MoJ2FzdGVyb2lkUG9seWdvbicsICdhc3NldHMvanNvbi9hc3Rlcm9pZFBvbHlnb24uanNvbicpO1xyXG5cdHRoaXMubG9hZC50ZXh0KCdsZXZlbF9vbmUnLCAnYXNzZXRzL2pzb24vbGV2ZWxfb25lLmpzb24nKTtcclxuXHR0aGlzLmxvYWQudGV4dCgndHV0b3JpYWxfdGV4dCcsICdhc3NldHMvanNvbi90dXRvcmlhbF90ZXh0Lmpzb24nKTtcclxuXHRcclxuXHQvL0xvYWQgU291bmQgRWZmZWN0c1xyXG5cdHRoaXMubG9hZC5hdWRpbygnZG93bkNsaWNrJywgJ2Fzc2V0cy9zb3VuZC9kb3duQ2xpY2sub2dnJyk7XHJcblx0dGhpcy5sb2FkLmF1ZGlvKCdob3ZlckNsaWNrJywgJ2Fzc2V0cy9zb3VuZC9ob3ZlckNsaWNrLm9nZycpO1xyXG4gICB0aGlzLmxvYWQudGV4dCgndHV0b3JpYWxfdGV4dCcsICdhc3NldHMvanNvbi90dXRvcmlhbF90ZXh0Lmpzb24nKTtcclxuICAgdGhpcy5sb2FkLnNjcmlwdCgnd2ViZm9udCcsICcvL2FqYXguZ29vZ2xlYXBpcy5jb20vYWpheC9saWJzL3dlYmZvbnQvMS40Ljcvd2ViZm9udC5qcycpO1xyXG5cdHRoaXMubG9hZC5hdGxhc0pTT05IYXNoKCdoZWxwQnV0dG9uJywgJ2Fzc2V0cy9pbWFnZXMvaGVscEJ1dHRvblNoZWV0LnBuZycsICdhc3NldHMvanNvbi9oZWxwX2J1dHRvbi5qc29uJyk7XHJcblx0dGhpcy5sb2FkLmF0bGFzSlNPTkhhc2goJ2Fycm93QnV0dG9uJywgJ2Fzc2V0cy9pbWFnZXMvYXJyb3dCdXR0b25TaGVldC5wbmcnLCAnYXNzZXRzL2pzb24vYXJyb3dfYnV0dG9uLmpzb24nKTtcclxuXHQvL21lbnUgYnV0dG9uc1xyXG5cdHRoaXMubG9hZC5pbWFnZSgnbWVudV90aXRsZScsICdhc3NldHMvaW1hZ2VzL2F0aWNfbWVudV90aXRsZVQucG5nJyk7XHJcblx0dGhpcy5sb2FkLmltYWdlKCdtZW51X3NlbGVjdCcsICdhc3NldHMvaW1hZ2VzL2F0aWNfbWVudV9zZWxlY3RULnBuZycpO1xyXG5cdHRoaXMubG9hZC5pbWFnZSgnbWVudV9tYW51YWwnLCAnYXNzZXRzL2ltYWdlcy9hdGljX21lbnVfbWFudWFsVC5wbmcnKTtcclxuXHR0aGlzLmxvYWQuaW1hZ2UoJ21lbnVfY3JlZGl0cycsICdhc3NldHMvaW1hZ2VzL2F0aWNfbWVudV9jcmVkaXRzVC5wbmcnKTtcclxuXHJcblx0dGhpcy5sb2FkLmF1ZGlvKCdjYXNoUmVnaXN0ZXInLCAnYXNzZXRzL3NvdW5kL2Nhc2hSZWdpc3Rlci5vZ2cnKTtcclxuXHRcclxuXHQvL0xvYWQgTXVzaWNcclxuXHQvL3RoaXMubG9hZC5hdWRpbygnbWVudVNvbmcnLCAnYXNzZXRzL3NvdW5kL1lldCBBbm90aGVyLm9nZycpO1xyXG5cdHRoaXMubG9hZC5hdWRpbygnbWFpblNvbmcnLCAnYXNzZXRzL3NvdW5kL1RvcCAoZG93bikgTmlnaHQub2dnJyk7XHJcblxyXG4gIH0sXHJcblxyXG4gIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5hc3NldC5jcm9wRW5hYmxlZCA9IGZhbHNlO1xyXG4gIH0sXHJcblxyXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgaWYgKCEhdGhpcy5yZWFkeSkge1xyXG4gICAgICAvLyB0aGlzLmdhbWUuc3RhdGUuc3RhcnQoJ01lbnUnKTtcclxuICAgICAgdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KHBsYXllclN0YXRlLmN1cnJlbnRMZXZlbCk7IC8vIGpzaGludCBpZ25vcmU6bGluZVxyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIG9uTG9hZENvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLnJlYWR5ID0gdHJ1ZTtcclxuICB9XHJcbn07XHJcbiIsInZhciBTcGxhc2ggPSBmdW5jdGlvbiAoKSB7XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFNwbGFzaDtcclxuXHJcblNwbGFzaC5wcm90b3R5cGUgPSB7XHJcbiAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgfVxyXG59OyIsIi8vTk9URTogRE9OJ1QgVVNFIHRoaXMgY29kZSB0byBjcmVhdGUgYSBQcm9ncmVzc0Jhci4gSW5zdGVhZCwgdXNlIHRoZSBVSUJ1aWxkZXIgb2JqZWN0IGFuZCBjYWxsIGJ1aWxkUHJvZ3Jlc3NCYXJcclxuXHJcbnZhciBQcm9ncmVzc0JhciA9IGZ1bmN0aW9uKHNldFR5cGUsIHNldE1heFZhbHVlLCBzZXRHcmFwaGljcywgc2V0UmVuZGVyYWJsZXMpIHtcclxuXHR0aGlzLnR5cGUgPSBzZXRUeXBlOyAvL1R3byB0eXBlcywgXCJncm93aW5nXCIgKHN0YXJ0cyBhdCAwLCB0cmlnZ2VycyBldmVudCB3aGVuIGZ1bGwpIFxyXG5cdFx0XHRcdFx0XHQgLy9hbmQgXCJzaHJpbmtpbmdcIiAoc3RhcnRzIGZ1bGwsIHRyaWdnZXJzIGF0IDApXHJcblx0dGhpcy5iZ0JvcmRlclNpemUgPSAyO1x0XHRcdC8vZGVmYXVsdCBzaXplIG9mIGJhY2tncm91bmQgYm9yZGVyXHJcblx0dGhpcy5iZ0JvcmRlckNvbG9yID0gMHhBQUFBQUE7XHQvL2RlZmF1bHQgY29sb3Igb2YgYmFja2dyb3VuZCBib3JkZXJcclxuXHR0aGlzLmJnQ29sb3IgPSAweDg4ODg4ODtcdFx0Ly9kZWZhdWx0IGNvbG9yIG9mIGJhY2tncm91bmRcclxuXHR0aGlzLnBhZGRpbmdIb3JpeiA9IDU7XHRcdFx0Ly9kZWZhdWx0IHN1bSBvZiBwYWRkaW5nIG9uIGxlZnQgYW5kIHJpZ2h0IHNpZGUgaW5uZXIgdmFsdWUgYmFyXHJcblx0dGhpcy5wYWRkaW5nVmVydCA9IDU7XHRcdFx0Ly9kZWZhdWx0IHN1bSAoaS5lLiBoYWxmIG9uIGVhY2ggc2lkZSkgb2YgdmVydGljYWwgcGFkZGluZyBvZiBpbm5lciB2YWx1ZSBiYXJcclxuXHR0aGlzLnZhbHVlQm9yZGVyU2l6ZSA9IDE7XHRcdC8vZGVmYXVsdCBzaXplIG9mIHZhbHVlIGJvcmRlclxyXG5cdHRoaXMudmFsdWVCb3JkZXJDb2xvciA9IDB4ODg4OEZGOyAvL2RlZmF1bHQgY29sb3Igb2YgdmFsdWUgYm9yZGVyXHJcblx0dGhpcy52YWx1ZUNvbG9yID0gMHgwMDAwOTk7XHRcdC8vZGVmYXVsdCBjb2xvciBvZiBpbm5lciB2YWx1ZSBiYXJcclxuXHR0aGlzLnggPSBudWxsO1xyXG5cdHRoaXMueSA9IG51bGw7XHJcblx0dGhpcy53aWR0aCA9IG51bGw7XHJcblx0dGhpcy5oZWlnaHQgPSBudWxsO1xyXG5cdHRoaXMubWF4VmFsdWUgPSBzZXRNYXhWYWx1ZTtcclxuXHR0aGlzLmdyYXBoaWNzID0gc2V0R3JhcGhpY3M7IC8vc3RvcmUgZ3JhcGhpY3MgY2xhc3MgKHVzZWQgdG8gZHJhdyBiYXIpXHJcblx0dGhpcy5yZW5kZXJhYmxlcyA9IHNldFJlbmRlcmFibGVzO1xyXG5cdFxyXG5cdHRoaXMub25FdmVudCA9IGZ1bmN0aW9uKCkge307IC8vb3ZlcndyaXRlIHRoaXMgZnVuY3Rpb24gdG8gbWFrZSB3aGF0ZXZlciB5b3Ugd2FudCBoYXBwZW4gd2hlbiBwcm9ncmVzc0JhciByZWFjaGVzIGxpbWl0XHJcblx0XHJcblx0Ly9zd2l0Y2godGhpcy50eXBlKSB7XHJcblx0Ly9jYXNlICdncm93aW5nJyA6IFxyXG5cdGlmKHNldFR5cGUgPT09ICdncm93aW5nJykge1xyXG5cdFx0dGhpcy52YWx1ZSA9IDA7XHJcblx0XHQvL3RyeVRyaWdnZXIgaXMgY2FsbGVkIGF1dG9tYXRpY2FsbHkgd2hlbiB5b3UgYWRkL3N1YnRyYWN0IHZhbHVlLCBhbmQgd2lsbCB0cmlnZ2VyIHRoZSBvbkV2ZW50KCkgZnVuY3Rpb25cclxuXHRcdHRoaXMudHJ5VHJpZ2dlciA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRpZih0aGlzLnZhbHVlID49IHRoaXMubWF4VmFsdWUpIHtcclxuXHRcdFx0XHR0aGlzLm9uRXZlbnQoKTtcclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHRcdC8vYnJlYWs7XHJcblx0fVxyXG5cdGVsc2UgaWYoc2V0VHlwZSA9PT0gJ3Nocmlua2luZycpIHtcclxuXHQvL2Nhc2UgJ3Nocmlua2luZycgOlxyXG5cdFx0dGhpcy52YWx1ZSA9IHRoaXMubWF4VmFsdWU7XHJcblx0XHR0aGlzLnRyeVRyaWdnZXIgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0aWYodGhpcy52YWx1ZSA8PSAwKSB7XHJcblx0XHRcdFx0dGhpcy5vbkV2ZW50KCk7XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0Ly99XHJcblx0fVxyXG59O1xyXG5cclxuUHJvZ3Jlc3NCYXIucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gUHJvZ3Jlc3NCYXI7XHJcblxyXG5Qcm9ncmVzc0Jhci5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uKCkge1xyXG5cdHRoaXMuZ3JhcGhpY3MuY2xlYXIoKTtcclxuXHR0aGlzLnJlbmRlcmFibGVzLnVuc3Vic2NyaWJlKHRoaXMpO1xyXG59O1xyXG5cclxuLy9UbyBzdWJ0cmFjdCB2YWx1ZSwganVzdCB1c2UgbmVnYXRpdmUgbnVtYmVycyBhcyBhcmd1bWVudCBpLmUuIGZvby5hZGRWYWx1ZSgtNSk7XHJcblByb2dyZXNzQmFyLnByb3RvdHlwZS5hZGRWYWx1ZSA9IGZ1bmN0aW9uIChhZGRUaGlzKSB7XHJcblx0dGhpcy52YWx1ZSArPSBhZGRUaGlzO1xyXG5cdGlmKHRoaXMudmFsdWUgPiB0aGlzLm1heFZhbHVlKSB7XHJcblx0XHR0aGlzLnZhbHVlID0gdGhpcy5tYXhWYWx1ZTtcclxuXHR9XHJcblx0aWYodGhpcy52YWx1ZSA8IDApIHtcclxuXHRcdHRoaXMudmFsdWUgPSAwO1xyXG5cdH1cclxuXHR0aGlzLnRyeVRyaWdnZXIoKTtcclxufTtcclxuXHJcbi8vU2V0cyB0aGUgbG9jYXRpb24gd2hlcmUgcHJvZ3Jlc3MgYmFyIGlzIHJlbmRlcmVkXHJcblByb2dyZXNzQmFyLnByb3RvdHlwZS5zZXRMb2NhdGlvbiA9IGZ1bmN0aW9uKHNldFgsIHNldFkpIHtcclxuXHR0aGlzLnggPSBzZXRYO1xyXG5cdHRoaXMueSA9IHNldFk7XHJcbn07XHJcblxyXG4vL1NldHMgdGhlIHNpemUgb2YgdGhlIHByb2dyZXNzIGJhclxyXG5Qcm9ncmVzc0Jhci5wcm90b3R5cGUuc2V0U2l6ZSA9IGZ1bmN0aW9uKHNldFdpZHRoLCBzZXRIZWlnaHQpIHtcclxuXHR0aGlzLndpZHRoID0gc2V0V2lkdGg7XHJcblx0dGhpcy5oZWlnaHQgPSBzZXRIZWlnaHQ7XHJcbn07XHJcblxyXG5Qcm9ncmVzc0Jhci5wcm90b3R5cGUuc2V0U3R5bGUgPSBmdW5jdGlvbihiZ0JvcmRlclNpemUsIGJnQm9yZGVyQ29sb3IsIGJnQ29sb3IsIHBhZGRpbmdIb3JpeiwgcGFkZGluZ1ZlcnQsIHZhbHVlQm9yZGVyU2l6ZSwgdmFsdWVCb3JkZXJDb2xvciwgdmFsdWVDb2xvcikge1xyXG5cdHRoaXMuYmdCb3JkZXJTaXplID0gYmdCb3JkZXJTaXplO1xyXG5cdHRoaXMuYmdCb3JkZXJDb2xvciA9IGJnQm9yZGVyQ29sb3I7XHJcblx0dGhpcy5iZ0NvbG9yID0gYmdDb2xvcjtcclxuXHR0aGlzLnBhZGRpbmdIb3JpeiA9IHBhZGRpbmdIb3JpejtcclxuXHR0aGlzLnBhZGRpbmdWZXJ0ID0gcGFkZGluZ1ZlcnQ7XHJcblx0dGhpcy52YWx1ZUJvcmRlclNpemUgPSB2YWx1ZUJvcmRlclNpemU7XHJcblx0dGhpcy52YWx1ZUJvcmRlckNvbG9yID0gdmFsdWVCb3JkZXJDb2xvcjtcclxuXHR0aGlzLnZhbHVlQ29sb3IgPSB2YWx1ZUNvbG9yO1xyXG59O1xyXG5cclxuLy91cGRhdGUgZm9yIHByb2dyZXNzIGJhciwgY2FsbGVkIGp1c3QgYmVmb3JlIGRyYXdpbmcgcHJvZ3Jlc3MgYmFyXHJcbi8vT3ZlcndyaXRlIHRoaXMgZnVuY3Rpb24gaWYgZGVzaXJlZFxyXG5Qcm9ncmVzc0Jhci5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7fTtcclxuXHJcbi8vUmVuZGVycyBwcm9ncmVzc0JhclxyXG5Qcm9ncmVzc0Jhci5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24oKSB7XHJcblx0dGhpcy51cGRhdGUoKTtcclxuXHR0aGlzLmdyYXBoaWNzLmNsZWFyKCk7XHJcblx0Ly9EcmF3IGJhY2tncm91bmQgb2YgYmFyXHJcblx0dGhpcy5ncmFwaGljcy5saW5lU3R5bGUodGhpcy5iZ0JvcmRlclNpemUsIHRoaXMuYmdCb3JkZXJDb2xvciwgMSk7IC8vc2V0cyBib3JkZXIgY29sb3IgYW5kIHNpemVcclxuXHR0aGlzLmdyYXBoaWNzLmJlZ2luRmlsbCh0aGlzLmJnQ29sb3IpOyAvL3NldHMgY29sb3Igb2YgYmFja2dyb3VuZCBmaWxsXHJcblx0dGhpcy5ncmFwaGljcy5kcmF3UmVjdCh0aGlzLngtdGhpcy53aWR0aC8yLCB0aGlzLnktdGhpcy5oZWlnaHQvMiwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xyXG5cdHRoaXMuZ3JhcGhpY3MuZW5kRmlsbCgpO1xyXG5cdC8vRHJhdyB2YWx1ZSBvZiBiYXJcclxuXHR2YXIgcGVyY2VudGFnZSA9IHRoaXMudmFsdWUgLyB0aGlzLm1heFZhbHVlO1xyXG5cdHZhciBiYXJXaWR0aCA9IHRoaXMud2lkdGggLSB0aGlzLnBhZGRpbmdIb3JpejtcclxuXHR2YXIgYmFySGVpZ2h0ID0gdGhpcy5oZWlnaHQgLSB0aGlzLnBhZGRpbmdWZXJ0O1xyXG5cdHRoaXMuZ3JhcGhpY3MubGluZVN0eWxlKHRoaXMudmFsdWVCb3JkZXJTaXplLCB0aGlzLnZhbHVlQm9yZGVyQ29sb3IsIDEpO1xyXG5cdHRoaXMuZ3JhcGhpY3MuYmVnaW5GaWxsKHRoaXMudmFsdWVDb2xvcik7XHJcblx0dGhpcy5ncmFwaGljcy5kcmF3UmVjdCh0aGlzLngtKGJhcldpZHRoLzIpLCB0aGlzLnktKGJhckhlaWdodC8yKSwgYmFyV2lkdGgqcGVyY2VudGFnZSwgYmFySGVpZ2h0KTtcclxuXHR0aGlzLmdyYXBoaWNzLmVuZEZpbGwoKTtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gUHJvZ3Jlc3NCYXI7IiwidmFyIFByb2dyZXNzQmFyID0gcmVxdWlyZSgnLi9Qcm9ncmVzc0JhcicpO1xyXG52YXIgQmFubmVyID0gcmVxdWlyZSgnLi9iYW5uZXInKTtcclxuXHJcbnZhciBVSUJ1aWxkZXIgPSBmdW5jdGlvbihzZXRHYW1lU3RhdGUsIHNldFJlbmRlcmFibGVzKSB7XHJcblx0Ly9FbnN1cmUgdGhhdCBjYW5ub3QgY3JlYXRlIG11bHRpcGxlIGluc3RhbmNlcyBvZiB0aGlzIGNsYXNzXHJcblx0aWYoVUlCdWlsZGVyLnByb3RvdHlwZS5leGlzdHMpIHtcclxuXHRcdHJldHVybiBVSUJ1aWxkZXIucHJvdG90eXBlLmV4aXN0aW5nUmVmZXJlbmNlO1xyXG5cdH1cclxuXHRcclxuXHR0aGlzLmdhbWVTdGF0ZSA9IHNldEdhbWVTdGF0ZTtcclxuXHR0aGlzLnJlbmRlcmFibGVzID0gc2V0UmVuZGVyYWJsZXM7XHJcblx0Ly9DcmVhdGUgYW5kIHN0b3JlIGEgZ3JhcGhpY3Mgb2JqZWN0ICh1c2VkIGZvciBzdHVmZiBsaWtlIGRyYXdpbmcgcmVjdGFuZ2xlcylcclxuXHRVSUJ1aWxkZXIucHJvdG90eXBlLmV4aXN0cyA9IHRydWU7XHJcblx0VUlCdWlsZGVyLnByb3RvdHlwZS5leGlzdGluZ1JlZmVyZW5jZSA9IHRoaXM7XHJcbn07XHJcblxyXG5VSUJ1aWxkZXIucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gVUlCdWlsZGVyO1xyXG4vL1RoZXNlIHZhcidzIGhlbHAgY3JlYXRlIHRoZSBzaW5nbGV0b24gZnVuY3Rpb25hbGl0eVxyXG5VSUJ1aWxkZXIucHJvdG90eXBlLmV4aXN0cyA9IGZhbHNlO1xyXG5VSUJ1aWxkZXIucHJvdG90eXBlLmV4aXN0aW5nUmVmZXJlbmNlID0gbnVsbDtcclxuXHJcbi8vVXNlIHRoaXMgZnVuY3Rpb24gdG8gY3JlYXRlIGEgcHJvZ3Jlc3MgYmFyXHJcbi8vVXNhZ2U6IHR5cGU6IGNhbiBiZSBcImdyb3dpbmdcIiBvciBcInNocmlua2luZ1wiLCB0aGlzIHdpbGwgZWZmZWN0IGlmIGJhciBzdGFydHMgYXQgMCBhbmQgZ29lcyB1cCBvciB2aXMgdmVyc2FcclxuLy9cdFx0IG1heFZhbHVlOiBzZXRzIHRoZSBtYXggdmFsdWUgb2YgdGhlIHByb2dyZXNzIGJhciwgaS5lLiB1c2luZyAxMDAgY3JlYXRlcyBhIGJhciBmcm9tIDAgdG8gMTAwXHJcbi8vXHRcdCB4LHk6IHNldHMgbG9jYXRpb25cclxuLy9cdFx0IERPTidUIEZPUkdFVCB0byBvdmVyd3JpdGUgdGhlIG9uRXZlbnQoKSBmdW5jdGlvbiBmb3IgdGhlIHByb2dyZXNzIGJhciBhZnRlciBjcmVhdGluZyBpdFxyXG4vL1x0XHRcdC1vbkV2ZW50KCkgaXMgYXV0b21hdGljYWxseSBjYWxsZWQgd2hlbiBiYXIgZmlsbHMvc2hyaW5rcyBwYXN0IGxpbWl0IChkZXBlbmRpbmcgb24gYmFyIHR5cGUpXHJcblVJQnVpbGRlci5wcm90b3R5cGUuYnVpbGRQcm9ncmVzc0JhciA9IGZ1bmN0aW9uKHR5cGUsIHgsIHksIHdpZHRoLCBoZWlnaHQsIG1heFZhbHVlKSB7XHJcblx0Ly9jcmVhdGUgYW5kIGZvcm1hdCBuZXcgcHJvZyBiYXJcclxuXHR2YXIgZ3JhcGhpY3MgPSB0aGlzLmdhbWVTdGF0ZS5nYW1lLmFkZC5ncmFwaGljcygwLDApO1xyXG5cdHZhciBuZXdQcm9nQmFyID0gbmV3IFByb2dyZXNzQmFyKHR5cGUsIG1heFZhbHVlLCBncmFwaGljcywgdGhpcy5yZW5kZXJhYmxlcyk7XHJcblx0bmV3UHJvZ0Jhci5zZXRMb2NhdGlvbih4LHkpO1xyXG5cdG5ld1Byb2dCYXIuc2V0U2l6ZSh3aWR0aCwgaGVpZ2h0KTtcclxuXHQvL3N1YnNjcmliZSB0byAncmVuZGVyYWJsZXMnIHNvIHRoYXQgcmVuZGVyKCkgaXMgY2FsbGVkIGF1dG9tYXRpY2FsbHlcclxuXHR0aGlzLnJlbmRlcmFibGVzLnN1YnNjcmliZShuZXdQcm9nQmFyKTtcclxuXHRyZXR1cm4gbmV3UHJvZ0JhcjtcclxufTtcclxuXHJcblVJQnVpbGRlci5wcm90b3R5cGUuYnVpbGRCYW5uZXIgPSBmdW5jdGlvbih4UmF0aW8sIHlSYXRpbywgdGV4dHMpIHtcclxuICAgdmFyIGdyYXBoaWNzID0gdGhpcy5nYW1lU3RhdGUuZ2FtZS5hZGQuZ3JhcGhpY3MoMCwgMCk7XHJcbiAgIHZhciBuZXdCYW5uZXIgPSBuZXcgQmFubmVyKHRoaXMuZ2FtZVN0YXRlLCB4UmF0aW8sIHlSYXRpbywgdGV4dHMsIGdyYXBoaWNzLCB0aGlzLnJlbmRlcmFibGVzKTtcclxuICAgdGhpcy5yZW5kZXJhYmxlcy5zdWJzY3JpYmUobmV3QmFubmVyKTtcclxuICAgcmV0dXJuIG5ld0Jhbm5lcjtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gVUlCdWlsZGVyOyIsInZhciBVdGlscyA9IHJlcXVpcmUoJy4uL3V0aWxzJyk7XHJcblxyXG4vL05PVEU6IERPTidUIFVTRSB0aGlzIGNvZGUgdG8gY3JlYXRlIGEgQmFubmVyLiBJbnN0ZWFkLCB1c2UgdGhlIFVJQnVpbGRlciBvYmplY3QgYW5kIGNhbGwgYnVpbGRCYW5uZXJcclxudmFyIEJhbm5lciA9IGZ1bmN0aW9uKGdhbWVTdGF0ZSwgeFJhdGlvLCB5UmF0aW8sIHRleHRKU09OLCBncmFwaGljcywgcmVuZGVyYWJsZXMpIHtcclxuICAgdGhpcy5iZ0JvcmRlclNpemUgPSA2O1x0XHRcdC8vZGVmYXVsdCBzaXplIG9mIGJhY2tncm91bmQgYm9yZGVyXHJcblx0dGhpcy5iZ0JvcmRlckNvbG9yID0gMHhmZmZmZmY7XHQvL2RlZmF1bHQgY29sb3Igb2YgYmFja2dyb3VuZCBib3JkZXJcclxuXHR0aGlzLmJnQ29sb3IgPSAweDRhNGE0YTtcdFx0Ly9kZWZhdWx0IGNvbG9yIG9mIGJhY2tncm91bmRcclxuICAgdGhpcy5zaGFkb3dPZmZzZXRYID0gMztcclxuICAgdGhpcy5zaGFkb3dPZmZzZXRZID0gMztcclxuICAgdGhpcy5zaGFkb3dDb2xvciA9ICdyZ2JhKDAsMCwwLDAuOSknO1xyXG4gICB0aGlzLnNoYWRvd0JsdXIgPSA1O1xyXG4gICB0aGlzLm5vcm1hbFRleHQgPSAnI2ZmZmZmZic7XHJcbiAgIHRoaXMuaGlnaGxpZ2h0VGV4dCA9ICcjMDBmZjAwJztcclxuICAgdGhpcy50ZXh0V3JhcFBhZGRpbmcgPSAxMDtcclxuICAgdGhpcy5vZmZTY3JlZW5QYWRkaW5nID0gLTIwMDtcclxuICAgdGhpcy50ZXh0SlNPTiA9IHRleHRKU09OO1xyXG4gICB0aGlzLmdhbWVTdGF0ZSA9IGdhbWVTdGF0ZTtcclxuICAgdGhpcy5nYW1lID0gZ2FtZVN0YXRlLmdhbWU7XHJcbiAgIHRoaXMuY2FtID0gdGhpcy5nYW1lLmNhbWVyYTtcclxuICAgdGhpcy54UmF0aW8gPSB4UmF0aW87XHJcbiAgIHRoaXMueVJhdGlvID0geVJhdGlvO1xyXG4gICB0aGlzLmdyYXBoaWNzID0gZ3JhcGhpY3M7XHJcbiAgIHRoaXMucmVuZGVyYWJsZXMgPSByZW5kZXJhYmxlcztcclxuICAgdGhpcy53aWR0aCA9IDQwMDtcclxuICAgdGhpcy5oZWlnaHQgPSAyMDA7XHJcbiAgIHRoaXMuaW5kZXggPSAwO1xyXG4gICB0aGlzLnggPSAwO1xyXG4gICB0aGlzLmhpZGVCdWZmZXIgPSAtNTA7XHJcbiAgIHRoaXMuaGlkZUhlaWdodCA9IC10aGlzLmhlaWdodCAtIHRoaXMuaGlkZUJ1ZmZlcjtcclxuICAgdGhpcy55ID0gdGhpcy5jYW0ueSAtIHRoaXMuY2FtLmhlaWdodCAvIDIgLSB0aGlzLmhpZGVIZWlnaHQ7XHJcbiAgIHRoaXMuc2xpZGVZID0gMDtcclxuICAgdGhpcy5nb2FsWSA9IHRoaXMueTtcclxuICAgdGhpcy5zbGlkZVJhdGUgPSAwLjI7XHJcbiAgIHRoaXMudmlzaWJsZSA9IGZhbHNlO1xyXG4gICAvLyBhZGQgYnV0dG9uc1xyXG4gICB0aGlzLnJpZ2h0QnV0dG9uID0gdGhpcy5nYW1lLmFkZC5idXR0b24oMCwgMCwgJ2Fycm93QnV0dG9uJywgdGhpcy5uZXh0SW5kZXgsIHRoaXMsIDEsIDAsIDIpO1xyXG5cdHRoaXMucmlnaHRCdXR0b24ub25JbnB1dE92ZXIuYWRkKHRoaXMuZ2FtZVN0YXRlLnBsYXlIb3ZlckNsaWNrLCB0aGlzLmdhbWVTdGF0ZSk7XHJcblx0dGhpcy5yaWdodEJ1dHRvbi5vbklucHV0RG93bi5hZGQodGhpcy5nYW1lU3RhdGUucGxheURvd25DbGljaywgdGhpcy5nYW1lU3RhdGUpO1xyXG4gICB0aGlzLmxlZnRCdXR0b24gPSB0aGlzLmdhbWUuYWRkLmJ1dHRvbigwLCAwLCAnYXJyb3dCdXR0b24nLCB0aGlzLnByZXZJbmRleCwgdGhpcywgMSwgMCwgMik7XHJcblx0dGhpcy5sZWZ0QnV0dG9uLm9uSW5wdXRPdmVyLmFkZCh0aGlzLmdhbWVTdGF0ZS5wbGF5SG92ZXJDbGljaywgdGhpcy5nYW1lU3RhdGUpO1xyXG5cdHRoaXMubGVmdEJ1dHRvbi5vbklucHV0RG93bi5hZGQodGhpcy5nYW1lU3RhdGUucGxheURvd25DbGljaywgdGhpcy5nYW1lU3RhdGUpO1xyXG4gICB0aGlzLmxlZnRCdXR0b24uc2NhbGUueCA9IC0xO1xyXG4gICB0aGlzLmdyb3VwID0gbmV3IFBoYXNlci5Hcm91cCh0aGlzLmdhbWUpO1xyXG4gICB0aGlzLmdyb3VwLmFkZCh0aGlzLmdyYXBoaWNzKTtcclxuICAgdGhpcy5ncm91cC5hZGQodGhpcy5yaWdodEJ1dHRvbik7XHJcbiAgIHRoaXMuZ3JvdXAuYWRkKHRoaXMubGVmdEJ1dHRvbik7XHJcbiAgIHRoaXMuYWRkVGV4dHMoKTtcclxuICAgdGhpcy5nYW1lLndvcmxkLmJyaW5nVG9Ub3AodGhpcy5ncm91cCk7XHJcbn07XHJcblxyXG5CYW5uZXIucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gQmFubmVyO1xyXG5cclxuQmFubmVyLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24oKSB7XHJcblx0dGhpcy5ncmFwaGljcy5jbGVhcigpO1xyXG5cdHRoaXMucmVuZGVyYWJsZXMudW5zdWJzY3JpYmUodGhpcyk7XHJcbn07XHJcblxyXG5CYW5uZXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAvLyBUT0RPOiBhZGQgbGF5ZXIgZ3JvdXBzIHRvIG90aGVyIHRoaW5nc1xyXG4gICB0aGlzLmdhbWUud29ybGQuYnJpbmdUb1RvcCh0aGlzLmdyb3VwKTtcclxuICAgLy8gbXkgcG9zXHJcbiAgIHRoaXMueCA9IHRoaXMuY2FtLnggKyB0aGlzLmNhbS53aWR0aCAqIHRoaXMueFJhdGlvO1xyXG4gICBpZiAodGhpcy52aXNpYmxlKSB7XHJcbiAgICAgIHRoaXMuZ29hbFkgPSB0aGlzLmNhbS5oZWlnaHQgLyAyO1xyXG4gICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmdvYWxZID0gdGhpcy5oaWRlSGVpZ2h0O1xyXG4gICB9XHJcbiAgIHRoaXMuc2xpZGVZID0gVXRpbHMubGVycCh0aGlzLnNsaWRlWSwgdGhpcy5nb2FsWSwgdGhpcy5zbGlkZVJhdGUpO1xyXG4gICB0aGlzLnkgPSB0aGlzLmNhbS55ICsgdGhpcy5zbGlkZVk7XHJcbiAgIC8vIHRleHQgcG9zXHJcbiAgIHZhciBjdXJUZXh0ID0gdGhpcy50ZXh0T2Jqc1t0aGlzLmluZGV4XTtcclxuICAgY3VyVGV4dC54ID0gdGhpcy54O1xyXG4gICBjdXJUZXh0LnkgPSB0aGlzLnk7XHJcbiAgIC8vIGJ1dHRvbiBwb3NcclxuICAgdGhpcy5yaWdodEJ1dHRvbi54ID0gdGhpcy54ICsgdGhpcy53aWR0aCAvIDIgKyB0aGlzLnJpZ2h0QnV0dG9uLndpZHRoIC8gMjtcclxuICAgdGhpcy5yaWdodEJ1dHRvbi55ID0gdGhpcy55IC0gdGhpcy5yaWdodEJ1dHRvbi5oZWlnaHQgLyAyO1xyXG4gICB0aGlzLmxlZnRCdXR0b24ueCA9IHRoaXMueCAtIHRoaXMud2lkdGggLyAyICsgdGhpcy5sZWZ0QnV0dG9uLndpZHRoIC8gMjtcclxuICAgdGhpcy5sZWZ0QnV0dG9uLnkgPSB0aGlzLnkgLSB0aGlzLmxlZnRCdXR0b24uaGVpZ2h0IC8gMjtcclxufTtcclxuXHJcbkJhbm5lci5wcm90b3R5cGUuYWRkVGV4dHMgPSBmdW5jdGlvbigpIHtcclxuICAgaWYgKCF0aGlzLnRleHRPYnMpIHtcclxuICAgICAgdGhpcy50ZXh0T2JqcyA9IFtdO1xyXG4gICB9XHJcbiAgIHZhciB0ZXh0RGVmcyA9IEpTT04ucGFyc2UodGhpcy5nYW1lLmNhY2hlLmdldFRleHQodGhpcy50ZXh0SlNPTikpO1xyXG4gICB2YXIgdGV4dEFycmF5ID0gdGV4dERlZnNbJ3RleHQnXTtcclxuICAgdmFyIHRleHRDb2xvcnMgPSB0ZXh0RGVmc1snY29sb3JzJ107XHJcbiAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGV4dEFycmF5Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIHZhciB0ZXh0ID0gdGV4dEFycmF5W2ldO1xyXG4gICAgICB2YXIgbmV3VGV4dCA9IHRoaXMuZ2FtZS5hZGQudGV4dCh0aGlzLm9mZlNjcmVlblBhZGRpbmcsIHRoaXMub2ZmU2NyZWVuUGFkZGluZywgdGV4dCk7XHJcbiAgICAgIG5ld1RleHQuZm9udCA9ICdSb2JvdG8nO1xyXG4gICAgICBuZXdUZXh0LmZvbnRTaXplID0gMjQ7XHJcbiAgICAgIG5ld1RleHQuYWxpZ24gPSAnY2VudGVyJztcclxuICAgICAgbmV3VGV4dC5maWxsID0gdGhpcy5ub3JtYWxUZXh0O1xyXG4gICAgICBuZXdUZXh0LndvcmRXcmFwID0gdHJ1ZTtcclxuICAgICAgbmV3VGV4dC53b3JkV3JhcFdpZHRoID0gdGhpcy53aWR0aCAtIHRoaXMudGV4dFdyYXBQYWRkaW5nO1xyXG4gICAgICBuZXdUZXh0LmFuY2hvci5zZXQoMC41KTtcclxuICAgICAgbmV3VGV4dC5zZXRTaGFkb3codGhpcy5zaGFkb3dPZmZzZXRYLCB0aGlzLnNoYWRvd09mZnNldFksIHRoaXMuc2hhZG93Q29sb3IsIHRoaXMuc2hhZG93Qmx1cik7XHJcbiAgICAgIHZhciBuZXdDb2xvcnMgPSB0ZXh0Q29sb3JzW2ldO1xyXG4gICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG5ld0NvbG9ycy5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICBuZXdUZXh0LmFkZENvbG9yKHRoaXMuaGlnaGxpZ2h0VGV4dCwgbmV3Q29sb3JzW2pdKTtcclxuICAgICAgICAgaisrO1xyXG4gICAgICAgICBuZXdUZXh0LmFkZENvbG9yKHRoaXMubm9ybWFsVGV4dCwgbmV3Q29sb3JzW2pdKTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLnRleHRPYmpzLnB1c2gobmV3VGV4dCk7XHJcbiAgICAgIHRoaXMuZ3JvdXAuYWRkKG5ld1RleHQpO1xyXG4gICB9XHJcbn07XHJcblxyXG5CYW5uZXIucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uKCkge1xyXG5cdHRoaXMudXBkYXRlKCk7XHJcblx0dGhpcy5ncmFwaGljcy5jbGVhcigpO1xyXG5cdC8vRHJhdyBiYWNrZ3JvdW5kXHJcblx0dGhpcy5ncmFwaGljcy5saW5lU3R5bGUodGhpcy5iZ0JvcmRlclNpemUsIHRoaXMuYmdCb3JkZXJDb2xvciwgMSk7IC8vc2V0cyBib3JkZXIgY29sb3IgYW5kIHNpemVcclxuXHR0aGlzLmdyYXBoaWNzLmJlZ2luRmlsbCh0aGlzLmJnQ29sb3IpOyAvL3NldHMgY29sb3Igb2YgYmFja2dyb3VuZCBmaWxsXHJcblx0dGhpcy5ncmFwaGljcy5kcmF3UmVjdCh0aGlzLngtdGhpcy53aWR0aC8yLCB0aGlzLnktdGhpcy5oZWlnaHQvMiwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xyXG5cdHRoaXMuZ3JhcGhpY3MuZW5kRmlsbCgpO1xyXG59O1xyXG5cclxuQmFubmVyLnByb3RvdHlwZS5zaG93ID0gZnVuY3Rpb24oKSB7XHJcbiAgIC8vIHRoaXMuZ29hbFkgPSB0aGlzLmNhbS55ICsgdGhpcy5jYW0uaGVpZ2h0ICogdGhpcy55UmF0aW87XHJcbiAgIHRoaXMudmlzaWJsZSA9IHRydWU7XHJcbn07XHJcblxyXG5CYW5uZXIucHJvdG90eXBlLmhpZGUgPSBmdW5jdGlvbigpIHtcclxuICAgLy8gdGhpcy5nb2FsWSA9IHRoaXMuaGlkZUhlaWdodDtcclxuICAgdGhpcy52aXNpYmxlID0gZmFsc2U7XHJcbn07XHJcblxyXG5CYW5uZXIucHJvdG90eXBlLnRvZ2dsZSA9IGZ1bmN0aW9uKCkge1xyXG4gIGlmICh0aGlzLnZpc2libGUpIHtcclxuICAgICB0aGlzLmhpZGUoKTtcclxuICB9IGVsc2Uge1xyXG4gICAgIHRoaXMuc2hvdygpO1xyXG4gIH0gIFxyXG59O1xyXG5cclxuQmFubmVyLnByb3RvdHlwZS5oaWRlQ3VyVGV4dCA9IGZ1bmN0aW9uKCkge1xyXG4gIHRoaXMudGV4dE9ianNbdGhpcy5pbmRleF0ueCA9IHRoaXMudGV4dE9ianNbdGhpcy5pbmRleF0ueSA9IDA7IFxyXG59O1xyXG5cclxuQmFubmVyLnByb3RvdHlwZS5uZXh0SW5kZXggPSBmdW5jdGlvbigpIHtcclxuICAgdGhpcy5oaWRlQ3VyVGV4dCgpO1xyXG4gICB0aGlzLmluZGV4Kys7XHJcbiAgIGlmICh0aGlzLmluZGV4ID49IHRoaXMudGV4dE9ianMubGVuZ3RoKSB7XHJcbiAgICAgIHRoaXMuaW5kZXggPSAwO1xyXG4gICB9XHJcbn07XHJcblxyXG5CYW5uZXIucHJvdG90eXBlLnByZXZJbmRleCA9IGZ1bmN0aW9uKCkge1xyXG4gICB0aGlzLmhpZGVDdXJUZXh0KCk7XHJcbiAgIHRoaXMuaW5kZXgtLTtcclxuICAgaWYgKHRoaXMuaW5kZXggPCAwKSB7XHJcbiAgICAgIHRoaXMuaW5kZXggPSB0aGlzLnRleHRPYmpzLmxlbmd0aCAtIDE7XHJcbiAgIH1cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gQmFubmVyO1xyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbiIsIi8qXHJcbkNvbGxlY3Rpb24gb2YgdXRpbGl0eSBmdW5jdGlvbnMuXHJcbiovXHJcblxyXG52YXIgVXRpbHMgPSB7XHJcbiAgICBjb250YWluc09iamVjdDogZnVuY3Rpb24ob2JqLCBsaXN0KSB7XHJcbiAgICAgICAgdmFyIGk7XHJcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKGxpc3RbaV0gPT09IG9iaikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0sXHJcbiAgICBkaXN0YW5jZTogZnVuY3Rpb24oeDEsIHkxLCB4MiwgeTIpIHtcclxuICAgICAgIHJldHVybiBNYXRoLnNxcnQoTWF0aC5wb3coeDEgLSB4MiwgMikgKyBNYXRoLnBvdyh5MSAtIHkyLCAyKSk7XHJcbiAgICB9LFxyXG4gICAgbGVycDogZnVuY3Rpb24oYSwgYiwgdCkge1xyXG4gICAgICAgaWYgKHQgPCAwIHx8IHQgPiAxKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZygnYmFkIHJhbmdlIGZvciBVdGlscy5sZXJwKCksIG11c3QgYmUgYmV0d2VlbiAwIGFuZCAxJyk7XHJcbiAgICAgICAgICByZXR1cm4gMDtcclxuICAgICAgIH1cclxuICAgICAgIHJldHVybiBhICsgdCAqIChiIC0gYSk7XHJcbiAgICB9XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFV0aWxzOyJdfQ==
=======
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlc1xcYnJvd3NlcmlmeVxcbm9kZV9tb2R1bGVzXFxicm93c2VyLXBhY2tcXF9wcmVsdWRlLmpzIiwic3JjL2pzL21haW4uanMiLCJzcmMvanMvZWZmZWN0cy9CaW5hcnlQYXJ0aWNsZS5qcyIsInNyYy9qcy9lZmZlY3RzL0VtaXR0ZXIuanMiLCJzcmMvanMvZW50aXRpZXMvQnVsbGV0LmpzIiwic3JjL2pzL2VudGl0aWVzL0hhY2thYmxlLmpzIiwic3JjL2pzL2VudGl0aWVzL01vZHVsZS5qcyIsInNyYy9qcy9lbnRpdGllcy9Nb2R1bGVCdWlsZGVyLmpzIiwic3JjL2pzL2VudGl0aWVzL2N1YmUuanMiLCJzcmMvanMvZW50aXRpZXMvY3ViZV9ncm91cC5qcyIsInNyYy9qcy9lbnRpdGllcy9lbmVteV9haS5qcyIsInNyYy9qcy9lbnRpdGllcy9tb3VzZS5qcyIsInNyYy9qcy9mdW5jdGlvbkFjY2Vzcy9SZW5kZXJhYmxlcy5qcyIsInNyYy9qcy9saWJzL2phdmFzY3JpcHQtYXN0YXIvYXN0YXIuanMiLCJzcmMvanMvc3RhdGVzL2Jvb3QuanMiLCJzcmMvanMvc3RhdGVzL2dhbWUuanMiLCJzcmMvanMvc3RhdGVzL21lbnUuanMiLCJzcmMvanMvc3RhdGVzL3ByZWxvYWRlci5qcyIsInNyYy9qcy9zdGF0ZXMvc3BsYXNoLmpzIiwic3JjL2pzL3VpL1Byb2dyZXNzQmFyLmpzIiwic3JjL2pzL3VpL1VJQnVpbGRlci5qcyIsInNyYy9qcy91aS9iYW5uZXIuanMiLCJzcmMvanMvdXRpbHMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDZEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0VBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNYQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDek9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3SEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5cEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDclpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2prQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaEhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJ2YXIgZ2FtZSA9IG5ldyBQaGFzZXIuR2FtZSh3aW5kb3cuaW5uZXJXaWR0aCwgd2luZG93LmlubmVySGVpZ2gsIFBoYXNlci5BVVRPLCAnYXRpYy1nYW1lJyk7XHJcblxyXG53aW5kb3cucGxheWVyU3RhdGUgPSB7XHJcbiAgICBjdXJyZW50TGV2ZWw6ICdHYW1lJ1xyXG59O1xyXG5cclxuLy8gIFRoZSBHb29nbGUgV2ViRm9udCBMb2FkZXIgd2lsbCBsb29rIGZvciB0aGlzIG9iamVjdCwgc28gY3JlYXRlIGl0IGJlZm9yZSBsb2FkaW5nIHRoZSBzY3JpcHQuXHJcbldlYkZvbnRDb25maWcgPSB7IC8vIGpzaGludCBpZ25vcmU6bGluZVxyXG4gICAgLy8gIFRoZSBHb29nbGUgRm9udHMgd2Ugd2FudCB0byBsb2FkIChzcGVjaWZ5IGFzIG1hbnkgYXMgeW91IGxpa2UgaW4gdGhlIGFycmF5KVxyXG4gICAgZ29vZ2xlOiB7XHJcbiAgICAgIGZhbWlsaWVzOiBbJ1JvYm90bzo6bGF0aW4nLCAnVlQzMjM6OmxhdGluJ11cclxuICAgIH1cclxufTtcclxuXHJcbmdhbWUuc3RhdGUuYWRkKCdCb290JywgcmVxdWlyZSgnLi9zdGF0ZXMvYm9vdCcpKTtcclxuZ2FtZS5zdGF0ZS5hZGQoJ1NwbGFzaCcsIHJlcXVpcmUoJy4vc3RhdGVzL3NwbGFzaCcpKTtcclxuZ2FtZS5zdGF0ZS5hZGQoJ1ByZWxvYWRlcicsIHJlcXVpcmUoJy4vc3RhdGVzL3ByZWxvYWRlcicpKTtcclxuZ2FtZS5zdGF0ZS5hZGQoJ01lbnUnLCByZXF1aXJlKCcuL3N0YXRlcy9tZW51JykpO1xyXG5nYW1lLnN0YXRlLmFkZCgnR2FtZScsIHJlcXVpcmUoJy4vc3RhdGVzL2dhbWUnKSk7XHJcblxyXG5nYW1lLnN0YXRlLnN0YXJ0KCdCb290Jyk7IiwidmFyIEJpbmFyeVBhcnRpY2xlID0gZnVuY3Rpb24oZ2FtZSwgdGFyZ2V0T2JqLCB4LCB5LCB0YXJPZmZzZXRYLCB0YXJPZmZzZXRZKSB7XHJcblx0dmFyIHN0eWxlID0ge2ZvbnQ6ICcyMHB4IEF2YW50IEdhcmRlJywgZmlsbDogJyNFRUVFMzMnLCBhbGlnbjogJ2NlbnRlcid9O1xyXG5cdHZhciBieXRlU3ltYm9sID0gTWF0aC5yYW5kb20oKSA+PSAwLjUgPyAnMScgOiAnMCc7XHJcblx0UGhhc2VyLlRleHQuY2FsbCh0aGlzLCBnYW1lLCB4LCB5LCBieXRlU3ltYm9sLCBzdHlsZSk7XHJcblx0Z2FtZS5hZGQuZXhpc3RpbmcodGhpcyk7XHJcblx0dGhpcy50YXJnZXRPYmogPSB0YXJnZXRPYmo7XHJcblx0dGhpcy5zcGVlZCA9IDMuNjtcclxuXHR0aGlzLnRhck9mZnNldFggPSB0YXJPZmZzZXRYO1xyXG5cdHRoaXMudGFyT2Zmc2V0WSA9IHRhck9mZnNldFk7XHJcbn07XHJcblxyXG5CaW5hcnlQYXJ0aWNsZS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBoYXNlci5UZXh0LnByb3RvdHlwZSk7XHJcbkJpbmFyeVBhcnRpY2xlLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IEJpbmFyeVBhcnRpY2xlO1xyXG5cclxuQmluYXJ5UGFydGljbGUucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkge1xyXG5cdC8vR2V0IGRlbHRhIHZlY3RvciB0byB0YXJnZXQgb2JqZWN0XHJcblx0dmFyIGRlbHRhID0gW3RoaXMudGFyZ2V0T2JqLnggKyB0aGlzLnRhck9mZnNldFggLSB0aGlzLngsIHRoaXMudGFyZ2V0T2JqLnkgKyB0aGlzLnRhck9mZnNldFkgLSB0aGlzLnldO1xyXG5cdC8vR2V0IGRpc3RhbmNlIGFuZCBjaGVjayBpZiB3ZSd2ZSByZWFjaGVkIHRhcmdldCBkaXN0YW5jZVxyXG5cdHZhciBkaXN0ID0gTWF0aC5zcXJ0KE1hdGgucG93KGRlbHRhWzBdLCAyKSArIE1hdGgucG93KGRlbHRhWzFdLCAyKSk7XHJcblx0aWYoZGlzdCA8PSB0aGlzLnNwZWVkKSB7XHJcblx0XHR0aGlzLmRlc3Ryb3koKTtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblx0Ly9Ob3JtYWxpemUgZGVsdGEgdmVjdG9yXHJcblx0ZGVsdGEgPSBbZGVsdGFbMF0vZGlzdCwgZGVsdGFbMV0vZGlzdF07XHJcblx0Ly9VcGRhdGUgcG9zaXRpb25cclxuXHR0aGlzLnggPSB0aGlzLnggKyB0aGlzLnNwZWVkKmRlbHRhWzBdO1xyXG5cdHRoaXMueSA9IHRoaXMueSArIHRoaXMuc3BlZWQqZGVsdGFbMV07XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEJpbmFyeVBhcnRpY2xlOyIsInZhciBCaW5hcnlQYXJ0aWNsZSA9IHJlcXVpcmUoJy4vQmluYXJ5UGFydGljbGUnKTtcclxuXHJcbnZhciBFbWl0dGVyID0gZnVuY3Rpb24oZ2FtZVN0YXRlKSB7XHJcblx0dGhpcy5nYW1lU3RhdGUgPSBnYW1lU3RhdGU7XHJcbn07XHJcblxyXG5FbWl0dGVyLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IEVtaXR0ZXI7XHJcblxyXG5FbWl0dGVyLnByb3RvdHlwZS5lbWl0QmluYXJ5ID0gZnVuY3Rpb24gKHRhcmdldE9iaiwgeCwgeSwgc3BhY2luZykge1xyXG5cdHZhciBvZmZzZXRYID0gKE1hdGgucmFuZG9tKCktMC41KSpzcGFjaW5nO1xyXG5cdHZhciBvZmZzZXRZID0gKE1hdGgucmFuZG9tKCktMC41KSpzcGFjaW5nO1xyXG5cdHZhciBuZXdQYXJ0aWNsZSA9IG5ldyBCaW5hcnlQYXJ0aWNsZSh0aGlzLmdhbWVTdGF0ZS5nYW1lLCB0YXJnZXRPYmosIHgsIHksIG9mZnNldFgsIG9mZnNldFkpO1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBFbWl0dGVyOyIsIi8vQnVsbGV0cyBhcmUgdGFnZ2VkIGFzICdwbGF5ZXJCdWxsZXQnIG9yICdlbmVteUJ1bGxldCdcclxudmFyIEJ1bGxldCA9IGZ1bmN0aW9uKGdhbWVTdGF0ZSwgeCwgeSwgZGlyZWN0aW9uLCBpbmhlcnRpdFNwZWVkLCB0YWcpIHtcclxuICAgIFBoYXNlci5TcHJpdGUuY2FsbCh0aGlzLCBnYW1lU3RhdGUuZ2FtZSwgeCwgeSwgJ2J1bGxldCcpO1xyXG5cdHRoaXMuZGlyZWN0aW9uID0gZGlyZWN0aW9uOyAvL1VuaXQgdmVjdG9yIHJlcHJlc2VudGluZyBkaXJlY3Rpb24gYnVsbGV0IGlzIHRyYXZlbGxpbmc7XHJcblx0dGhpcy5zcGVlZCA9IDMwMCArIGluaGVydGl0U3BlZWQ7XHRcdFx0XHQvL1NwZWVkIGJ1bGxldCBpcyB0cmF2ZWxsaW5nO1xyXG5cdHRoaXMudGFnID0gdGFnO1xyXG5cdHRoaXMuZ2FtZSA9IGdhbWVTdGF0ZS5nYW1lO1xyXG5cdHRoaXMuZ2FtZS5hZGQuZXhpc3RpbmcodGhpcyk7XHJcblx0dGhpcy5saWZlVGltZSA9IDMwMDtcclxuXHR2YXIgc2NhbGUgPSAwLjU7XHJcblx0dGhpcy5zY2FsZS54ID0gc2NhbGU7XHJcblx0dGhpcy5zY2FsZS55ID0gc2NhbGU7XHJcblx0dGhpcy5hbmNob3Iuc2V0VG8oMC41LCAwLjUpO1xyXG5cdFxyXG5cdC8vc2V0IHBoeXNpY3NcclxuXHRnYW1lU3RhdGUuZ2FtZS5waHlzaWNzLnAyLmVuYWJsZSh0aGlzKTtcclxuXHR0aGlzLmJvZHkuc2V0Q29sbGlzaW9uR3JvdXAoZ2FtZVN0YXRlLmNvbGxpc2lvbkdyb3VwKTtcclxuXHR0aGlzLmJvZHkuY29sbGlkZXMoZ2FtZVN0YXRlLmNvbGxpc2lvbkdyb3VwKTtcclxuXHQvL1NldCBwcm9wZXIgY29sbGlzaW9uIGZ1bmN0aW9uIGJ5IGRldGVybWluaW5nIHR5cGUgZnJvbSAndGFnJ1xyXG5cdGlmKHRoaXMudGFnID09PSAnZW5lbXlCdWxsZXQnKSB7XHJcblx0XHR0aGlzLmNvbGxpc2lvbiA9IGZ1bmN0aW9uKG90aGVyKSB7XHJcblx0XHRcdGlmKG90aGVyLnNwcml0ZS50YWcgPT09ICdtb2R1bGUnKSB7XHJcblx0XHRcdFx0b3RoZXIuc3ByaXRlLnRha2VEYW1hZ2UoMC41KTtcclxuXHRcdFx0fVxyXG5cdFx0XHR0aGlzLmRlc3Ryb3koKTtcclxuXHRcdH07XHJcblx0fVxyXG5cdGVsc2UgaWYodGhpcy50YWcgPT09ICdwbGF5ZXJCdWxsZXQnKSB7XHJcblx0XHR0aGlzLmNvbGxpc2lvbiA9IGZ1bmN0aW9uKG90aGVyKSB7XHJcblx0XHRcdGlmKG90aGVyKSB7XHJcblx0XHRcdFx0aWYob3RoZXIuc3ByaXRlKXtcclxuXHRcdFx0XHRcdGlmKG90aGVyLnNwcml0ZS50YWcpIHtcclxuXHRcdFx0XHRcdFx0aWYob3RoZXIuc3ByaXRlLnRhZyA9PT0gJ2VuZW15X21vZHVsZScpIHtcclxuXHRcdFx0XHRcdFx0XHRvdGhlci5zcHJpdGUudGFrZURhbWFnZSgwLjUpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdHRoaXMuZGVzdHJveSgpO1xyXG5cdFx0fTtcclxuXHR9XHJcblx0dGhpcy5ib2R5Lm9uQmVnaW5Db250YWN0LmFkZCh0aGlzLmNvbGxpc2lvbiwgdGhpcyk7XHJcblx0dGhpcy5ib2R5LnNldFplcm9EYW1waW5nKCk7XHJcblx0dGhpcy5ib2R5Lm1hc3MgPSAwLjE7XHJcblx0dGhpcy5ib2R5LnZlbG9jaXR5LnggPSBkaXJlY3Rpb25bMF0qdGhpcy5zcGVlZDtcclxuXHR0aGlzLmJvZHkudmVsb2NpdHkueSA9IGRpcmVjdGlvblsxXSp0aGlzLnNwZWVkO1xyXG59O1xyXG5cclxuQnVsbGV0LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUGhhc2VyLlNwcml0ZS5wcm90b3R5cGUpO1xyXG5CdWxsZXQucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gQnVsbGV0O1xyXG5cclxuQnVsbGV0LnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHsvKlxyXG5cdHRoaXMueCArPSB0aGlzLmRpcmVjdGlvblswXSAqIHRoaXMuc3BlZWQ7XHJcblx0dGhpcy55ICs9IHRoaXMuZGlyZWN0aW9uWzFdICogdGhpcy5zcGVlZDtcclxuXHQvL3RoaXMubGlmZVRpbWUtLTtcclxuXHRpZih0aGlzLmxpZmVUaW1lIDw9IDApIHtcclxuXHRcdC8vVE9ETyBkZXN0cm95IGJ1bGxldFxyXG5cdH0qL1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBCdWxsZXQ7IiwiLypcclxuRGVmaW5lcyBhIGhhY2thYmxlIG9iamVjdC5cclxuKi9cclxuXHJcbnZhciBIYWNrYWJsZSA9IGZ1bmN0aW9uIChnYW1lU3RhdGUsIHgsIHksIHNwcml0ZSwgaGFja0Rpc3RhbmNlKSB7XHJcbiAgIFBoYXNlci5TcHJpdGUuY2FsbCh0aGlzLCBnYW1lU3RhdGUuZ2FtZSwgeCwgeSwgc3ByaXRlKTtcclxuICAgZ2FtZVN0YXRlLmdhbWUuYWRkLmV4aXN0aW5nKHRoaXMpO1xyXG5cdC8vc3RvcmUgZ2FtZVN0YXRlXHJcblx0dGhpcy5nYW1lU3RhdGUgPSBnYW1lU3RhdGU7XHJcblx0Ly9zZXQgaXNIYWNrZWQgdG8gZmFsc2VcclxuXHR0aGlzLmlzSGFja2VkID0gZmFsc2U7XHJcblx0Ly9hZGQgaGFja0JhclxyXG5cdHRoaXMuaGFja0JhciA9IGdhbWVTdGF0ZS51aUJ1aWxkZXIuYnVpbGRQcm9ncmVzc0JhcignZ3Jvd2luZycsIDE1MDAsIDEyMDAsIDEwMCwgMTAsICAyMDApO1xyXG5cdHRoaXMuaGFja0Jhci5zZXRTdHlsZSgwLCAweEZGRkZGRiwgMHgzNjM2MzYsIDAsIDAsIDAsIDB4RkZGRkZGLCAweDIwMjBDQyk7XHJcblx0dGhpcy5oYWNrQmFyLmhhY2thYmxlID0gdGhpcztcclxuXHR0aGlzLmhhY2tCYXIub25FdmVudCA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0dGhpcy5oYWNrYWJsZS5mcmFtZSA9IDE7XHJcblx0XHR0aGlzLmhhY2thYmxlLmlzSGFja2VkID0gdHJ1ZTtcclxuXHRcdHRoaXMuZGVzdHJveSgpO1xyXG5cdH07XHJcblx0dGhpcy50YWcgPSAnbmV1dHJhbE9iaic7XHQvL1RhZyBpcyB1c2VkIHRvIGlkZW50aWZ5IG9iamVjdCB0eXBlIGR1cmluZyBjb2xsaXNpb24gY2hlY2tpbmdcclxuXHR0aGlzLmhhY2tEaXN0YW5jZSA9IGhhY2tEaXN0YW5jZTtcclxuXHR2YXIgc2NhbGUgPSAwLjU7XHJcbiAgIHRoaXMuc2NhbGUueCA9IHNjYWxlO1xyXG4gICB0aGlzLnNjYWxlLnkgPSBzY2FsZTtcclxuICAgdGhpcy5hbmNob3Iuc2V0VG8oMC41LCAwLjUpO1xyXG4gICBcclxuICAgLy9TZXQgdXAgcGh5c2ljcyBib2R5IGZvciAnaGFja2FibGUnIHNwcml0ZVxyXG4gICBnYW1lU3RhdGUuZ2FtZS5waHlzaWNzLnAyLmVuYWJsZSh0aGlzKTtcclxuICAgdGhpcy5ib2R5LnNldENvbGxpc2lvbkdyb3VwKGdhbWVTdGF0ZS5jb2xsaXNpb25Hcm91cCk7XHJcblx0dGhpcy5ib2R5LmNvbGxpZGVzKGdhbWVTdGF0ZS5jb2xsaXNpb25Hcm91cCk7XHJcbiAgIHRoaXMuYm9keS5vbkJlZ2luQ29udGFjdC5hZGQodGhpcy5jdWJlQ29sbGlkZSwgdGhpcyk7XHJcbiAgIHRoaXMuYm9keS5kYW1waW5nID0gMC45O1xyXG4gICB0aGlzLmJvZHkuYW5ndWxhckRhbXBpbmcgPSAwLjk7XHJcbn07XHJcblxyXG5IYWNrYWJsZS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBoYXNlci5TcHJpdGUucHJvdG90eXBlKTtcclxuSGFja2FibGUucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gSGFja2FibGU7XHJcblxyXG4vKipcclxuICogQXV0b21hdGljYWxseSBjYWxsZWQgYnkgV29ybGQudXBkYXRlXHJcbiAqL1xyXG5IYWNrYWJsZS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7XHJcblx0dGhpcy5oYWNrQmFyLnNldExvY2F0aW9uKHRoaXMueCwgdGhpcy55IC0gNzApO1xyXG5cdC8vY2hlY2sgaWYgZ2V0dGluZyBoYWNrZWRcclxuXHRpZighdGhpcy5pc0hhY2tlZCkge1xyXG5cdFx0aWYodGhpcy5nYW1lU3RhdGUucGxheWVyLmFjdGl2ZUhhY2tlck1vZHVsZXMubGVuZ3RoID4gMCkge1xyXG5cdFx0XHR2YXIgZGlzdDtcclxuXHRcdFx0dmFyIGhhY2tlcjtcclxuXHRcdFx0Ly9Mb29wIHRocm91Z2ggYWxsIGhhY2tlciBtb2R1bGVzIG9uIHRoZSBwbGF5ZXIncyBjdWJzYXRcclxuXHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMuZ2FtZVN0YXRlLnBsYXllci5hY3RpdmVIYWNrZXJNb2R1bGVzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0aGFja2VyID0gdGhpcy5nYW1lU3RhdGUucGxheWVyLmFjdGl2ZUhhY2tlck1vZHVsZXNbaV07XHJcblx0XHRcdFx0ZGlzdCA9IE1hdGguc3FydCggTWF0aC5wb3codGhpcy54IC0gaGFja2VyLmN1YmUueCwgMikgKyBNYXRoLnBvdyh0aGlzLnkgLSBoYWNrZXIuY3ViZS55LCAyKSApO1xyXG5cdFx0XHRcdGlmKGRpc3QgPCB0aGlzLmhhY2tEaXN0YW5jZSkge1xyXG5cdFx0XHRcdFx0Ly9JZiBoYWNrZXIgaXMgaW4gcmFuZ2UsIGluY3JlYXNlIGhhY2sgdmFsdWUgYW5kIHRyeSB0byBlbWl0IGJpbmFyeSBwYXJ0aWNsZVxyXG5cdFx0XHRcdFx0dGhpcy5oYWNrQmFyLmFkZFZhbHVlKDAuMDUpO1xyXG5cdFx0XHRcdFx0aGFja2VyLmNvdW50Kys7XHJcblx0XHRcdFx0XHRoYWNrZXIuY3ViZS5hbmltYXRpb25zLnBsYXkoJ2hhY2tlcicpO1xyXG5cdFx0XHRcdFx0aWYoaGFja2VyLmNvdW50ID49IGhhY2tlci5jeWNsZSkge1xyXG5cdFx0XHRcdFx0XHRoYWNrZXIuY291bnQgPSAwO1xyXG5cdFx0XHRcdFx0XHR0aGlzLmdhbWVTdGF0ZS5CaW5hcnlFbWl0dGVyLmVtaXRCaW5hcnkodGhpcywgaGFja2VyLmN1YmUueCwgaGFja2VyLmN1YmUueSwgNjApO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRcdGhhY2tlci5jdWJlLmFuaW1hdGlvbnMuc3RvcCgpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxufTtcclxuXHJcblxyXG5IYWNrYWJsZS5wcm90b3R5cGUuY3ViZUNvbGxpZGUgPSBmdW5jdGlvbihvdGhlcikge1xyXG4vKiAgIGlmICh0aGlzLmdyb3VwID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICB9XHJcbiAgIHRoaXMuZ3JvdXAuaGFuZGxlQ29sbGlzaW9uKHRoaXMsIG90aGVyLnNwcml0ZSk7Ki9cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gSGFja2FibGU7IiwiLy9Eb24ndCB1c2UgdGhpcyBmdW5jdGlvbiB0byBjcmVhdGUgbW9kdWxlcywgaW5zdGVhZCB1c2UgbW9kdWxlQnVpbGRlcigpXHJcbnZhciBNb2R1bGUgPSBmdW5jdGlvbihzZXRUeXBlLCBzZXRDdWJlLCBzZXRHYW1lU3RhdGUpIHtcclxuXHR0aGlzLmlzQWN0aXZlID0gZmFsc2U7XHJcblx0dGhpcy50eXBlID0gc2V0VHlwZTtcclxuXHR0aGlzLmN1YmUgPSBzZXRDdWJlO1xyXG5cdHNldEN1YmUubW9kdWxlID0gdGhpcztcclxuXHR0aGlzLmdhbWVTdGF0ZSA9IHNldEdhbWVTdGF0ZTtcclxufTtcclxuXHJcbk1vZHVsZS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBNb2R1bGU7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IE1vZHVsZTsiLCJ2YXIgQ3ViZSA9IHJlcXVpcmUoJy4vY3ViZScpO1xyXG52YXIgTW9kdWxlID0gcmVxdWlyZSgnLi9Nb2R1bGUnKTtcclxudmFyIEJ1bGxldCA9IHJlcXVpcmUoJy4vQnVsbGV0Jyk7XHJcblxyXG52YXIgdGhydXN0QW10ID0gNTAwMDtcclxuXHJcbi8vVXNlIHRoaXMgdG8gY3JlYXRlIGEgbW9kdWxlQnVpbGRlci0gb25seSBuZWVkIHRvIGNyZWF0ZSBvbmUgaW5zdGFuY2Ugb2YgaXRcclxudmFyIE1vZHVsZUJ1aWxkZXIgPSBmdW5jdGlvbihzZXRHYW1lU3RhdGUsIHNldENvbEdyb3VwKSB7XHJcblx0Ly9FbnN1cmUgdGhhdCBjYW5ub3QgY3JlYXRlIG11bHRpcGxlIGluc3RhbmNlcyBvZiB0aGlzIGNsYXNzXHJcblx0aWYoTW9kdWxlQnVpbGRlci5wcm90b3R5cGUuZXhpc3RzKSB7XHJcblx0XHRyZXR1cm4gTW9kdWxlQnVpbGRlci5wcm90b3R5cGUuZXhpc3RpbmdSZWZlcmVuY2U7XHJcblx0fVxyXG5cdFx0XHJcblx0dGhpcy5nYW1lU3RhdGUgPSBzZXRHYW1lU3RhdGU7XHJcbiAgIHRoaXMuY29sR3JvdXAgPSBzZXRDb2xHcm91cDtcclxuXHQvLyB0aGlzLmNvcmVFeGlzdHMgPSBmYWxzZTtcdC8vcmVjb3JkcyBpZiBjb3JlIGhhcyBiZWVuIGNyZWF0ZWRcclxuXHR0aGlzLmNvcmUgPSBudWxsO1x0XHRcdC8vc3RvcmVzIGNvcmUgd2hlbiBpdCBpcyBjcmVhdGVkXHJcblx0Ly92YXIgc3BhY2UgPSB0aGlzLmdhbWVTdGF0ZS5pbnB1dC5rZXlib2FyZC5hZGRLZXkoUGhhc2VyLktleWJvYXJkLlNQQUNFQkFSKTtcclxuXHRNb2R1bGVCdWlsZGVyLnByb3RvdHlwZS5leGlzdHMgPSB0cnVlO1xyXG5cdE1vZHVsZUJ1aWxkZXIucHJvdG90eXBlLmV4aXN0aW5nUmVmZXJlbmNlID0gdGhpcztcclxufTtcclxuXHJcbk1vZHVsZUJ1aWxkZXIucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gTW9kdWxlQnVpbGRlcjtcclxuXHJcbi8vVGhlc2UgdmFyJ3MgaGVscCBjcmVhdGUgdGhlIHNpbmdsZXRvbiBmdW5jdGlvbmFsaXR5XHJcbk1vZHVsZUJ1aWxkZXIucHJvdG90eXBlLmV4aXN0cyA9IGZhbHNlO1xyXG5Nb2R1bGVCdWlsZGVyLnByb3RvdHlwZS5leGlzdGluZ1JlZmVyZW5jZSA9IG51bGw7XHJcblxyXG4vKiogTW9kdWxlIGZ1bmN0aW9ucyAqKi9cclxuZnVuY3Rpb24gc29sYXJQYW5lbEdpdmVUYXJnZXQodGFyZ2V0KSB7XHJcbmlmICh0aGlzID09PSB0YXJnZXQgfHwgIXRoaXMuY3ViZS5ncm91cCB8fCAhdGFyZ2V0LmN1YmUuZ3JvdXAgfHwgdGhpcy5jdWJlLmdyb3VwICE9PSB0YXJnZXQuY3ViZS5ncm91cCkge1xyXG4gICAgICByZXR1cm47XHJcbiAgIH1cclxuICAgdmFyIG91ckdyb3VwID0gdGhpcy5jdWJlLmdyb3VwO1xyXG4gICB2YXIgbmV3Q29ubmVjdGlvbiA9IHtzdGFydDogdGhpcy5jdWJlLCBlbmQ6IHRhcmdldC5jdWJlfTtcclxuICAgdGhpcy5jdWJlLm15Q29ubmVjdGlvbiA9IG5ld0Nvbm5lY3Rpb247XHJcbiAgIHRhcmdldC5jdWJlLm15Q29ubmVjdGlvbiA9IG5ld0Nvbm5lY3Rpb247XHJcbiAgIG91ckdyb3VwLmRpc3BsYXlDb25uZWN0aW9uKHRoaXMuY3ViZS5teUNvbm5lY3Rpb24pO1xyXG4gICBcclxuXHRpZighdGFyZ2V0LmlzQWN0aXZlKSB7XHJcblx0XHQvL0FjdGl2YXRlIHRoZSBtb2R1bGVcclxuXHRcdHRhcmdldC5pc0FjdGl2ZSA9IHRydWU7XHJcblx0XHRpZih0YXJnZXQudHlwZSA9PT0gJ2d1bicpIHtcclxuXHRcdFx0b3VyR3JvdXAuYWN0aXZlR3Vucy5wdXNoKHRhcmdldCk7XHJcblx0XHR9XHJcblx0XHRlbHNlIGlmKHRhcmdldC50eXBlID09PSAnaGFja2VyJykge1xyXG5cdFx0XHRvdXJHcm91cC5hY3RpdmVIYWNrZXJNb2R1bGVzLnB1c2godGFyZ2V0KTtcclxuXHRcdH1cclxuXHR9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNvbGFyUGFuZWxNb3VzZU92ZXIoKSB7XHJcbiAgIGlmICghdGhpcy5jdWJlLm15Q29ubmVjdGlvbiB8fCAhdGhpcy5jdWJlLmdyb3VwKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgfVxyXG4gICB0aGlzLmN1YmUuZ3JvdXAuZGlzcGxheUNvbm5lY3Rpb24odGhpcy5jdWJlLm15Q29ubmVjdGlvbik7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNvbGFyUGFuZWxPblJlbW92ZSgpIHtcclxuICAgaWYgKCF0aGlzLmN1YmUubXlDb25uZWN0aW9uIHx8ICF0aGlzLmN1YmUubXlDb25uZWN0aW9uLmVuZCkge1xyXG4gICAgICBjb25zb2xlLmxvZygnc29sYXJQYW5lbE9uUmVtb3ZlKCkgaGFkIGFuIGVycm9yJyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgfVxyXG4gICB0aGlzLmN1YmUubXlDb25uZWN0aW9uLmVuZC5teUNvbm5lY3Rpb24gPSB1bmRlZmluZWQ7XHJcbiAgIHRoaXMuY3ViZS5teUNvbm5lY3Rpb24gPSB1bmRlZmluZWQ7XHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiBiZWdpbkFjdCgpIHtcclxuICAgdGhpcy50aW1lciA9IDA7XHJcbiAgIHRoaXMuYWN0ID0gdHJ1ZTtcclxufVxyXG5cclxuZnVuY3Rpb24gZW5kQWN0KCkge1xyXG4gICB0aGlzLmFjdCA9IGZhbHNlO1xyXG4gICB0aGlzLmN1YmUuZnJhbWUgPSAwO1xyXG59XHJcblxyXG5mdW5jdGlvbiB0aHJ1c3RlclVwZGF0ZSgpIHtcclxuICAgaWYgKHRoaXMuaGFsdFRpbWUgJiYgdGhpcy5oYWx0VGltZSA+IDApIHtcclxuICAgICAgdGhpcy5oYWx0VGltZSAtPSB0aGlzLmN1YmUuZ2FtZS50aW1lLmVsYXBzZWQ7XHJcbiAgICAgIHRoaXMuY3ViZS5mcmFtZSA9IDA7XHJcbiAgIH0gZWxzZSBpZiAodGhpcy5hY3QgJiYgdGhpcy5jdWJlLm15Q29ubmVjdGlvbikge1xyXG4gICAgICB0aGlzLmN1YmUuYm9keS5mb3JjZS54ID0gdGhydXN0QW10ICogTWF0aC5jb3ModGhpcy5jdWJlLnJvdGF0aW9uIC0gTWF0aC5QSSAvIDIpO1xyXG4gICAgICB0aGlzLmN1YmUuYm9keS5mb3JjZS55ID0gdGhydXN0QW10ICogTWF0aC5zaW4odGhpcy5jdWJlLnJvdGF0aW9uIC0gTWF0aC5QSSAvIDIpO1xyXG5cdCAgaWYodGhpcy5jdWJlLmZyYW1lID09PSAxKSB7XHJcblx0XHR0aGlzLmN1YmUuZnJhbWUgPSAyO1xyXG5cdCAgfVxyXG5cdCAgZWxzZSB7XHJcblx0XHR0aGlzLmN1YmUuZnJhbWUgPSAxO1xyXG5cdCAgfVxyXG4gICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHRocnVzdGVySGFsdCgpIHtcclxuICAgdGhpcy5oYWx0VGltZSA9IDE1MDA7XHJcbn1cclxuXHJcbi8qXHJcbmZ1bmN0aW9uIGd1bkZpcmUoKXtcclxuXHR2YXIgYW5nbGUgPSB0aGlzLmN1YmUuYm9keS5yb3RhdGlvbiAlICgyKk1hdGguUEkpO1xyXG5cdHZhciBkaXJlY3Rpb24gPSBbTWF0aC5zaW4oYW5nbGUpLCAtTWF0aC5jb3MoYW5nbGUpXTtcclxuXHQvL3ZhciBkZWx0YSA9IFt0aGlzLmN1YmUueC10aGlzLmN1YmUuYm9keS5wcmV2LngsIHRoaXMuY3ViZS55IC0gdGhpcy5jdWJlLmJvZHkucHJldi55XTtcclxuXHR2YXIgZGVsdGFEaXN0ID0gTWF0aC5zcXJ0KE1hdGgucG93KHRoaXMuY3ViZS5kZWx0YVgsIDIpICsgTWF0aC5wb3codGhpcy5jdWJlLmRlbHRhWSwgMikpO1xyXG5cdHZhciBzcGVlZCA9IGRlbHRhRGlzdCAqIDUwO1xyXG5cdG5ldyBCdWxsZXQodGhpcy5nYW1lU3RhdGUsIHRoaXMuY3ViZS54ICsgMzAqZGlyZWN0aW9uWzBdLCB0aGlzLmN1YmUueSArIDMwKmRpcmVjdGlvblsxXSwgXHJcblx0XHRcdCAgIGRpcmVjdGlvbiwgc3BlZWQsICdwbGF5ZXJCdWxsZXQnKTtcclxufVxyXG4qL1xyXG5cclxuZnVuY3Rpb24gZ3VuVXBkYXRlKCkge1xyXG4gICBpZiAoIXRoaXMuY3ViZS5teUNvbm5lY3Rpb24gfHwgIXRoaXMuYWN0KSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgfVxyXG4gICBpZiAodGhpcy50aW1lciA8PSAwKSB7XHJcbiAgICAgIHZhciBhbmdsZSA9IHRoaXMuY3ViZS5ib2R5LnJvdGF0aW9uICUgKDIqTWF0aC5QSSk7XHJcbiAgICAgIHZhciBkaXJlY3Rpb24gPSBbTWF0aC5zaW4oYW5nbGUpLCAtTWF0aC5jb3MoYW5nbGUpXTtcclxuICAgICAgLy92YXIgZGVsdGEgPSBbdGhpcy5jdWJlLngtdGhpcy5jdWJlLmJvZHkucHJldi54LCB0aGlzLmN1YmUueSAtIHRoaXMuY3ViZS5ib2R5LnByZXYueV07XHJcbiAgICAgIHZhciBkZWx0YURpc3QgPSBNYXRoLnNxcnQoTWF0aC5wb3codGhpcy5jdWJlLmRlbHRhWCwgMikgKyBNYXRoLnBvdyh0aGlzLmN1YmUuZGVsdGFZLCAyKSk7XHJcbiAgICAgIHZhciBzcGVlZCA9IGRlbHRhRGlzdCAqIDUwO1xyXG4gICAgICBuZXcgQnVsbGV0KHRoaXMuZ2FtZVN0YXRlLCB0aGlzLmN1YmUueCArIDMwKmRpcmVjdGlvblswXSwgdGhpcy5jdWJlLnkgKyAzMCpkaXJlY3Rpb25bMV0sIFxyXG4gICAgICAgICAgICAgICBkaXJlY3Rpb24sIHNwZWVkLCAncGxheWVyQnVsbGV0Jyk7XHJcbiAgICAgIHRoaXMudGltZXIgPSA2MDA7XHJcbiAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMudGltZXIgLT0gdGhpcy5nYW1lU3RhdGUuZ2FtZS50aW1lLmVsYXBzZWQ7XHJcbiAgIH1cclxufVxyXG4vKiogRW5kIG1vZHVsZSBmdW5jdGlvbnMgKiovXHJcblxyXG4vL2NhbGwgdGhpcyBmdW5jdGlvbiBmcm9tIE1vZHVsZUJ1aWxkZXIgdG8gY29uc3RydWN0IG1vZHVsZXNcclxuLy9UWVBFUzogJ2NvcmUnICdzaGllbGQnICd0aHJ1c3RlcicgJ3NvbGFyUGFubmVsJyAnaGFja2VyJ1xyXG5Nb2R1bGVCdWlsZGVyLnByb3RvdHlwZS5idWlsZCA9IGZ1bmN0aW9uKHR5cGUsIHgsIHksIGZvclBsYXllcikge1x0XHJcblx0Ly9DcmVhdGUgY3ViZSBvYmplY3QgdG8gYmUgc3RvcmVkIHdpdGhpbiBtb2R1bGVcclxuXHQvL1Nwcml0ZSBuYW1lcyBmb3IgbW9kdWxlcyBhcmUgZGlyZWN0bHkgbWFwcGVkIHRvIG1vZHVsZSBuYW1lcywgc28ganVzdCBwYXNzICd0eXBlJyBhcyBzcHJpdGUgbmFtZVxyXG5cdHZhciBuZXdDdWJlID0gbmV3IEN1YmUodGhpcy5nYW1lU3RhdGUsIHgsIHksIHR5cGUpO1xyXG4gICAgdmFyIHNjYWxlID0gMC41O1xyXG4gICAgbmV3Q3ViZS5uYW1lID0gdGhpcy5nYW1lU3RhdGUuZGVidWdOdW0rKztcclxuICAgIG5ld0N1YmUuc2NhbGUuc2V0VG8oc2NhbGUsIHNjYWxlKTtcclxuICAgIG5ld0N1YmUuYW5jaG9yLnNldFRvKDAuNSwgMC41KTtcclxuXHRcclxuXHQvL0NyZWF0ZSBwaHlzaWNzIGZvciBuZXcgY3ViZVxyXG4gICAgdGhpcy5nYW1lU3RhdGUuZ2FtZS5waHlzaWNzLnAyLmVuYWJsZShuZXdDdWJlKTtcclxuXHRuZXdDdWJlLmJvZHkuc2V0Q29sbGlzaW9uR3JvdXAodGhpcy5nYW1lU3RhdGUuY29sbGlzaW9uR3JvdXApO1xyXG5cdG5ld0N1YmUuYm9keS5jb2xsaWRlcyh0aGlzLmdhbWVTdGF0ZS5jb2xsaXNpb25Hcm91cCk7XHJcblx0bmV3Q3ViZS5ib2R5Lm9uQmVnaW5Db250YWN0LmFkZChuZXdDdWJlLmN1YmVDb2xsaWRlLCBuZXdDdWJlKTtcclxuICAgIG5ld0N1YmUuYm9keS5kYW1waW5nID0gMC45O1xyXG4gICAgbmV3Q3ViZS5ib2R5LmFuZ3VsYXJEYW1waW5nID0gMC45O1xyXG4gXHJcbiAgIHZhciBjSW5kaWNhdG9yID0gdGhpcy5nYW1lU3RhdGUuYWRkLnNwcml0ZSgwLCAwLCAnY29ubmVjdGlvbnMnLCAnY29ubmVjdGlvbl9saW5lLnBuZycpO1xyXG4gICBjSW5kaWNhdG9yLmFuY2hvci5zZXRUbygwLjUsIDAuNSk7XHJcbiAgIGNJbmRpY2F0b3IuYW5pbWF0aW9ucy5hZGQoJ2VuZCcsIFsnY29ubmVjdGlvbl9lbmQucG5nJ10sIDYwLCB0cnVlKTtcclxuICAgY0luZGljYXRvci5hbmltYXRpb25zLmFkZCgnbGluZScsIFsnY29ubmVjdGlvbl9saW5lLnBuZyddLCA2MCwgdHJ1ZSk7XHJcbiAgIGNJbmRpY2F0b3IuYW5pbWF0aW9ucy5hZGQoJ3JpZ2h0JywgWydjb25uZWN0aW9uX3JpZ2h0LnBuZyddLCA2MCwgdHJ1ZSk7XHJcbiAgIG5ld0N1YmUuYWRkQ2hpbGQoY0luZGljYXRvcik7XHJcbiAgIG5ld0N1YmUuY0luZGljYXRvciA9IGNJbmRpY2F0b3I7XHJcbiAgIGNJbmRpY2F0b3IuYWxwaGEgPSAwO1xyXG5cdFxyXG5cdC8vQ3JlYXRlIG1vZHVsZSB0byB3cmFwIGFyb3VuZCBjdWJlIGNsYXNzXHJcblx0dmFyIG5ld01vZHVsZSA9IG5ldyBNb2R1bGUodHlwZSwgbmV3Q3ViZSwgdGhpcy5nYW1lU3RhdGUpO1xyXG5cdFx0XHJcblx0Ly9UT0RPOiBlZGl0IHNwZWNpYWwgbW9kdWxlIGF0cmlidXRlcyBiYXNlZCBvbiAndHlwZSdcclxuXHRpZih0eXBlID09PSAnaGFja2VyJykge1xyXG5cdFx0bmV3TW9kdWxlLmN5Y2xlID0gNjtcclxuXHRcdG5ld01vZHVsZS5jb3VudCA9IDA7XHJcblx0XHRuZXdNb2R1bGUuY3ViZS5hbmltYXRpb25zLmFkZCgnaGFja2VyJywgWzAsMSwyLDMsNF0sIDEwLCB0cnVlKTtcclxuXHR9XHJcblx0XHJcblx0Ly9TdG9yZSBtb2R1bGUgaWYgaXQgaXMgY29yZVxyXG5cdGlmKHR5cGUgPT09ICdjb3JlJylcclxuXHR7XHJcblx0XHRuZXdNb2R1bGUuY3ViZS5hbmltYXRpb25zLmFkZCgnY29yZScsIFswLDEsMl0sIDIwLCB0cnVlKTtcclxuXHRcdG5ld01vZHVsZS5jdWJlLmFuaW1hdGlvbnMucGxheSgnY29yZScpO1xyXG5cdFx0dGhpcy5jb3JlID0gbmV3TW9kdWxlO1xyXG5cdFx0dGhpcy5jb3JlRXhpc3RzID0gdHJ1ZTtcclxuXHR9XHJcbiAgIC8vIHNvbGFyIHBhbmVsIHRlc3RpbmdcclxuICAgaWYgKHR5cGUgPT09ICdzb2xhclBhbmVsJykge1xyXG4gICAgICBuZXdNb2R1bGUuZ2l2ZVRhcmdldCA9IHNvbGFyUGFuZWxHaXZlVGFyZ2V0O1xyXG4gICAgICBuZXdNb2R1bGUubW91c2VPdmVyID0gc29sYXJQYW5lbE1vdXNlT3ZlcjtcclxuICAgICAgbmV3TW9kdWxlLm9uUmVtb3ZlID0gc29sYXJQYW5lbE9uUmVtb3ZlO1xyXG4gICB9XHJcbiAgIFxyXG4gICAvL1RocnVzdGVyIG1vZHVsZSBldmVudHNcclxuXHRpZih0eXBlID09PSAndGhydXN0ZXInKSB7XHJcbiAgICAgIGlmIChmb3JQbGF5ZXIpIHtcclxuICAgICAgICAgdmFyIHRocnVzdGVyS2V5ID0gdGhpcy5nYW1lU3RhdGUuaW5wdXQua2V5Ym9hcmQuYWRkS2V5KFBoYXNlci5LZXlib2FyZC5XKTsgXHJcbiAgICAgICAgIHRoaXMuZ2FtZVN0YXRlLmlucHV0LmtleWJvYXJkLmFkZEtleUNhcHR1cmUoW3RocnVzdGVyS2V5XSk7XHJcbiAgICAgICAgIHRocnVzdGVyS2V5Lm9uRG93bi5hZGQoYmVnaW5BY3QsIG5ld01vZHVsZSk7XHJcbiAgICAgICAgIHRocnVzdGVyS2V5Lm9uVXAuYWRkKGVuZEFjdCwgbmV3TW9kdWxlKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgLy8gbmV3TW9kdWxlLnRocnVzdCA9IGZhbHNlO1xyXG4gICAgICAgICBuZXdNb2R1bGUuYmVnaW5BY3QgPSBiZWdpbkFjdDtcclxuICAgICAgICAgbmV3TW9kdWxlLmVuZEFjdCA9IGVuZEFjdDtcclxuICAgICAgfVxyXG4gICAgICBuZXdNb2R1bGUudXBkYXRlID0gdGhydXN0ZXJVcGRhdGU7XHJcbiAgICAgIG5ld01vZHVsZS50aHJ1c3RlckhhbHQgPSB0aHJ1c3RlckhhbHQ7XHJcblx0fVxyXG5cclxuXHQvL0d1biBtb2R1bGUgZXZlbnRzXHJcblx0aWYodHlwZSA9PT0gJ2d1bicpIHtcclxuXHRcdC8vIG5ld01vZHVsZS5maXJlID0gZ3VuRmlyZTtcclxuICAgICAgbmV3TW9kdWxlLnVwZGF0ZSA9IGd1blVwZGF0ZTtcclxuICAgICAgaWYgKGZvclBsYXllcikge1xyXG4gICAgICAgICB2YXIgYWN0S2V5ID0gdGhpcy5nYW1lU3RhdGUuaW5wdXQua2V5Ym9hcmQuYWRkS2V5KFBoYXNlci5LZXlib2FyZC5TUEFDRUJBUik7XHJcbiAgICAgICAgIHRoaXMuZ2FtZVN0YXRlLmlucHV0LmtleWJvYXJkLmFkZEtleUNhcHR1cmUoW2FjdEtleV0pO1xyXG4gICAgICAgICBhY3RLZXkub25Eb3duLmFkZChiZWdpbkFjdCwgbmV3TW9kdWxlKTtcclxuICAgICAgICAgYWN0S2V5Lm9uVXAuYWRkKGVuZEFjdCwgbmV3TW9kdWxlKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgbmV3TW9kdWxlLmJlZ2luQWN0ID0gYmVnaW5BY3Q7XHJcbiAgICAgICAgIG5ld01vZHVsZS5lbmRBY3QgPSBlbmRBY3Q7XHJcbiAgICAgIH1cclxuXHR9XHJcblx0XHJcblx0Ly9SZXR1cm4gdGhlIG1vZHVsZSBvYmplY3RcclxuXHRyZXR1cm4gbmV3TW9kdWxlO1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBNb2R1bGVCdWlsZGVyO1xyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4iLCIvKlxyXG5EZWZpbmVzIGEgY3ViZS5cclxuKi9cclxuXHJcbnZhciBDdWJlID0gZnVuY3Rpb24gKGdhbWVTdGF0ZSwgeCwgeSwgc3ByaXRlKSB7XHJcbiAgICBQaGFzZXIuU3ByaXRlLmNhbGwodGhpcywgZ2FtZVN0YXRlLmdhbWUsIHgsIHksIHNwcml0ZSk7XHJcblx0IHRoaXMudGFnID0gJ21vZHVsZSc7XHQvL3RhZyBpcyB1c2VkIHRvIGRldGVjdCBvYmplY3QgdHlwZSBkdXJpbmcgY29sbGlzaW9uIGNoZWNraW5nXHJcbiAgICB0aGlzLmdhbWUgPSBnYW1lU3RhdGUuZ2FtZTtcclxuXHR0aGlzLmdhbWVTdGF0ZSA9IGdhbWVTdGF0ZTtcclxuICAgIHRoaXMuZ2FtZS5hZGQuZXhpc3RpbmcodGhpcyk7XHJcbiAgICB0aGlzLmdyb3VwID0gdW5kZWZpbmVkO1xyXG4gICAgdGhpcy5tb2R1bGUgPSB1bmRlZmluZWQ7XHJcbiAgICB0aGlzLmluZGljYXRvckZhZGUgPSAwLjAyO1xyXG4gICAgdGhpcy5oZWFsdGhCYXIgPSBnYW1lU3RhdGUudWlCdWlsZGVyLmJ1aWxkUHJvZ3Jlc3NCYXIoJ3Nocmlua2luZycsIDAsIDAsIDIwLCA0LCAzKTtcclxuXHR0aGlzLmhlYWx0aEJhci5zZXRTdHlsZSgwLCAweEZGRkZGRiwgMHgzNjM2MzYsIDAsIDAsIDAsIDB4RkZGRkZGLCAweDIwQ0MyMCk7XHJcblx0dGhpcy5oZWFsdGhCYXIuY3ViZSA9IHRoaXM7XHJcblx0Ly9zZXQgdXBkYXRlIGZ1bmN0aW9uIG9mIGhlYWx0aCBiYXJcclxuXHR0aGlzLmhlYWx0aEJhci51cGRhdGUgPSBmdW5jdGlvbigpIHtcclxuXHRcdHRoaXMuc2V0TG9jYXRpb24odGhpcy5jdWJlLngsIHRoaXMuY3ViZS55KzEwKTtcclxuXHR9O1xyXG5cdC8vb25FdmVudCBjYWxsZWQgd2hlbiBjdWJlIHJ1bnMgb3V0IG9mIGhlYWx0aFxyXG5cdHRoaXMuaGVhbHRoQmFyLm9uRXZlbnQgPSBmdW5jdGlvbigpIHtcclxuXHRcdHRoaXMuY3ViZS5keWluZyA9IHRydWU7XHJcblx0XHR0aGlzLmN1YmUubGlmZSA9IDUwO1xyXG5cdFx0Ly8gdGhpcy5ncm91cC5jb3VudEN1YmVzKCk7XHJcblx0XHQvLyB0aGlzLmRlc3Ryb3koKTtcclxuXHR9O1xyXG5cdHRoaXMuY29uc3RyYWludHMgPSBbXTtcclxufTtcclxuXHJcbkN1YmUucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShQaGFzZXIuU3ByaXRlLnByb3RvdHlwZSk7XHJcbkN1YmUucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gQ3ViZTtcclxuXHJcbi8qKlxyXG4gKiBBdXRvbWF0aWNhbGx5IGNhbGxlZCBieSBXb3JsZC51cGRhdGVcclxuICovXHJcbkN1YmUucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICBpZiAodGhpcy5jSW5kaWNhdG9yICYmIHRoaXMuY0luZGljYXRvci5hbHBoYSA+IDApIHtcclxuICAgICAgdGhpcy5jSW5kaWNhdG9yLmFscGhhIC09IHRoaXMuaW5kaWNhdG9yRmFkZTtcclxuICAgfVxyXG4gICBpZiAodGhpcy5tb2R1bGUudXBkYXRlKSB7XHJcbiAgICAgIHRoaXMubW9kdWxlLnVwZGF0ZSgpO1xyXG4gICB9XHJcbiAgIGlmICh0aGlzLmR5aW5nKSB7XHJcbiAgICAgIHRoaXMubGlmZSAtPSB0aGlzLmdhbWUudGltZS5lbGFwc2VkO1xyXG4gICAgICBpZiAodGhpcy5saWZlIDwgMCkge1xyXG4gICAgICAgICB0aGlzLmR5aW5nID0gZmFsc2U7XHJcbiAgICAgICAgIHRoaXMuaGVhbHRoQmFyLmRlc3Ryb3koKTtcclxuICAgICAgICAgaWYgKHRoaXMuZ3JvdXApIHtcclxuXHRcdFx0aWYodGhpcy50YWcgPT09ICdlbmVteV9tb2R1bGUnKSB7XHJcblx0XHRcdFx0aWYodGhpcy5rZXkgPT09ICd0aHJ1c3RlcicpIHtcclxuXHRcdFx0XHRcdHRoaXMuZ2FtZVN0YXRlLm1vbmV5ICs9IDM1O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRlbHNlIGlmKHRoaXMua2V5ID09PSAnc2hpZWxkJykge1xyXG5cdFx0XHRcdFx0dGhpcy5nYW1lU3RhdGUubW9uZXkgKz0gMTA7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGVsc2UgaWYodGhpcy5rZXkgPT09ICdndW4nKSB7XHJcblx0XHRcdFx0XHR0aGlzLmdhbWVTdGF0ZS5tb25leSArPSA1MDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZWxzZSBpZih0aGlzLmtleSA9PT0gJ3NvbGFyUGFuZWwnKSB7XHJcblx0XHRcdFx0XHR0aGlzLmdhbWVTdGF0ZS5tb25leSArPSAyNTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0dGhpcy5nYW1lU3RhdGUubW9uZXlUZXh0LnRleHQgPSB0aGlzLmdhbWVTdGF0ZS5tb25leTtcclxuXHRcdFx0fVxyXG4gICAgICAgICAgICB0aGlzLmdyb3VwLmRlc3Ryb3lDdWJlKHRoaXMpO1xyXG4gICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmRlc3Ryb3koKTtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgIH1cclxufTtcclxuXHJcbkN1YmUucHJvdG90eXBlLmN1YmVDb2xsaWRlID0gZnVuY3Rpb24ob3RoZXIpIHtcclxuICAgLyppZiAodGhpcy5ncm91cCAmJiB0aGlzLmdyb3VwLmlzUGxheWVyKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdQTEFZRVInKTtcclxuICAgfSBlbHNlIHtcclxuICAgICAgY29uc29sZS5sb2coJ09USEVSJyk7XHJcbiAgIH0qL1xyXG4gICBpZiAoIXRoaXMuZ3JvdXAgfHwgIW90aGVyIHx8ICFvdGhlci5zcHJpdGUgfHwgb3RoZXIuc3ByaXRlLnRhZyAhPT0gJ21vZHVsZScpIHtcclxuICAgICAgLy8gY29uc29sZS5sb2coJ2JhZCBjb2xsaXNpb24gY3ViZTogJywgdGhpcy5ncm91cCwgb3RoZXIsIG90aGVyLnNwcml0ZSwgb3RoZXIuc3ByaXRlLnRhZyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgfVxyXG5cdHRoaXMuZ3JvdXAuaGFuZGxlQ29sbGlzaW9uKHRoaXMsIG90aGVyLnNwcml0ZSk7XHJcblx0dGhpcy5ncm91cC5jb3VudEN1YmVzKCk7XHJcbn07XHJcblxyXG5DdWJlLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uKCkge1xyXG4gICB2YXIgc3RyaW5nID0gJyc7XHJcbiAgIHN0cmluZyArPSB0aGlzLmNvbmNhdCgnbmFtZScsIHRoaXMubmFtZSk7XHJcbiAgIHJldHVybiBzdHJpbmc7XHJcbn07XHJcblxyXG5DdWJlLnByb3RvdHlwZS5jb25jYXQgPSBmdW5jdGlvbihzdHJpbmcsIHZhbCkge1xyXG4gICByZXR1cm4gc3RyaW5nICsgJzogJyArIHZhbCArICdcXG4nO1xyXG59O1xyXG5DdWJlLnByb3RvdHlwZS5kaXNwbGF5SW5kaWNhdG9yID0gZnVuY3Rpb24oKSB7XHJcbiAgdGhpcy5jSW5kaWNhdG9yLmFscGhhID0gMTsgXHJcbn07XHJcblxyXG5DdWJlLnByb3RvdHlwZS50YWtlRGFtYWdlID0gZnVuY3Rpb24oYW10KSB7XHJcbiAgIHRoaXMuaGVhbHRoQmFyLmFkZFZhbHVlKC1hbXQpO1xyXG59O1xyXG5cclxuQ3ViZS5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24oKSB7XHJcbiAgIGlmICghdGhpcy5ncm91cCkge1xyXG4gICAgICByZXR1cm47XHJcbiAgIH1cclxuICAgdGhpcy5ncm91cC5yZW1vdmUodGhpcyk7XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEN1YmU7XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuIiwidmFyIEFzdGFyID0gcmVxdWlyZSgnLi4vbGlicy9qYXZhc2NyaXB0LWFzdGFyL2FzdGFyJyk7XHJcbnZhciBFbmVteUFJID0gcmVxdWlyZSgnLi9lbmVteV9haScpO1xyXG5cclxuLypcclxuRGVmaW5lcyBhIGN1YmUgZ3JvdXAuXHJcbiovXHJcblxyXG52YXIgQ3ViZUdyb3VwID0gZnVuY3Rpb24gKGdhbWUsIHJvb3QpIHtcclxuICAgdGhpcy5nYW1lID0gZ2FtZTtcclxuICAgdGhpcy5yb290ID0gcm9vdDtcclxuICAgdGhpcy5jdWJlcyA9IFtdO1xyXG4gICB2YXIgY29sID0gW107XHJcbiAgIGNvbC5wdXNoKHRoaXMucm9vdCk7XHJcbiAgIHRoaXMuY3ViZXMucHVzaChjb2wpO1xyXG4gICBpZiAodGhpcy5yb290KSB7XHJcbiAgICAgIHRoaXMucm9vdC5ncm91cCA9IHRoaXM7XHJcbiAgIH1cclxuICAgdGhpcy5ESVIgPSB7Tk9SVEg6IDAsIEVBU1Q6IDEsIFNPVVRIOiAyLCBXRVNUOiAzfTtcclxuICAgdGhpcy5vZmZzZXQgPSAyO1xyXG5cdHRoaXMuYWN0aXZlSGFja2VyTW9kdWxlcyA9IFtdO1x0Ly9saXN0IG9mIGhhY2tlciBtb2R1bGVzIGluIHRoaXMgZ3JvdXBcclxuXHR0aGlzLmFjdGl2ZUd1bnMgPSBbXTtcclxuXHJcbiAgIHRoaXMubnVtQ3ViZXMgPSAxO1xyXG4gICB0aGlzLmJvdW5jZUJhY2tGb3JjZSA9IDMwO1xyXG4gICB0aGlzLm1pblJhbVZlbCA9IDMwMDtcclxufTtcclxuXHJcbkN1YmVHcm91cC5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBDdWJlR3JvdXA7XHJcblxyXG4vKipcclxuICogQXV0b21hdGljYWxseSBjYWxsZWQgYnkgV29ybGQudXBkYXRlXHJcbiAqL1xyXG5DdWJlR3JvdXAucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICBpZiAodGhpcy5BSSkge1xyXG4gICAgICB0aGlzLkFJLnVwZGF0ZSgpO1xyXG4gICB9XHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLmNhbGwgPSBmdW5jdGlvbihmdW4pIHtcclxuICAgZm9yICh2YXIgcm93ID0gMDsgcm93IDwgdGhpcy5jdWJlc1dpZHRoKCk7IHJvdysrKSB7XHJcbiAgICAgIGZvciAodmFyIGNvbCA9IDA7IGNvbCA8IHRoaXMuY3ViZXNIZWlnaHQoKTsgY29sKyspIHtcclxuICAgICAgICAgdmFyIGN1YmUgPSB0aGlzLmN1YmVzW3Jvd11bY29sXTtcclxuICAgICAgICAgaWYgKGN1YmUgJiYgY3ViZS5oYXNPd25Qcm9wZXJ0eShmdW4pKSB7XHJcbiAgICAgICAgICAgIC8vIGlmIGN1YmVzIG5lZWQgZnVuY3Rpb25zIGNhbGxlZFxyXG4gICAgICAgICB9IGVsc2UgaWYgKGN1YmUgJiYgY3ViZS5tb2R1bGUgJiYgY3ViZS5tb2R1bGUuaGFzT3duUHJvcGVydHkoZnVuKSkge1xyXG4gICAgICAgICAgICB2YXIgZm4gPSBjdWJlLm1vZHVsZVtmdW5dO1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGZuID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgIGZuLmNhbGwoY3ViZS5tb2R1bGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICB9XHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLmNhbGxPblR5cGUgPSBmdW5jdGlvbihmdW4sIHR5cGUpIHtcclxuICAgZm9yICh2YXIgcm93ID0gMDsgcm93IDwgdGhpcy5jdWJlc1dpZHRoKCk7IHJvdysrKSB7XHJcbiAgICAgIGZvciAodmFyIGNvbCA9IDA7IGNvbCA8IHRoaXMuY3ViZXNIZWlnaHQoKTsgY29sKyspIHtcclxuICAgICAgICAgdmFyIGN1YmUgPSB0aGlzLmN1YmVzW3Jvd11bY29sXTtcclxuICAgICAgICAgaWYgKGN1YmUgJiYgY3ViZS5oYXNPd25Qcm9wZXJ0eShmdW4pKSB7XHJcbiAgICAgICAgICAgIC8vIGlmIGN1YmVzIG5lZWQgZnVuY3Rpb25zIGNhbGxlZFxyXG4gICAgICAgICB9IGVsc2UgaWYgKGN1YmUgJiYgY3ViZS5tb2R1bGUgJiYgY3ViZS5tb2R1bGUudHlwZSA9PT0gdHlwZSAmJiBjdWJlLm1vZHVsZS5oYXNPd25Qcm9wZXJ0eShmdW4pKSB7XHJcbiAgICAgICAgICAgIHZhciBmbiA9IGN1YmUubW9kdWxlW2Z1bl07XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZm4gPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgICAgZm4uY2FsbChjdWJlLm1vZHVsZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgIH1cclxufTtcclxuXHJcbkN1YmVHcm91cC5wcm90b3R5cGUuZ2V0TW9kdWxlcyA9IGZ1bmN0aW9uKHR5cGUpIHtcclxuICAgdmFyIG1vZHVsZXMgPSBbXTtcclxuICAgZm9yICh2YXIgcm93ID0gMDsgcm93IDwgdGhpcy5jdWJlc1dpZHRoKCk7IHJvdysrKSB7XHJcbiAgICAgIGZvciAodmFyIGNvbCA9IDA7IGNvbCA8IHRoaXMuY3ViZXNIZWlnaHQoKTsgY29sKyspIHtcclxuICAgICAgICAgdmFyIGN1YmUgPSB0aGlzLmN1YmVzW3Jvd11bY29sXTtcclxuICAgICAgICAgaWYgKGN1YmUgJiYgY3ViZS5tb2R1bGUudHlwZSA9PT0gdHlwZSkge1xyXG4gICAgICAgICAgICBtb2R1bGVzLnB1c2goY3ViZS5tb2R1bGUpO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICByZXR1cm4gbW9kdWxlcztcclxufTtcclxuXHJcbkN1YmVHcm91cC5wcm90b3R5cGUuZ2l2ZUFJID0gZnVuY3Rpb24odHlwZSwgcGxheWVyKSB7XHJcbiAgIHRoaXMuQUkgPSBuZXcgRW5lbXlBSSh0aGlzLmdhbWUsIHRoaXMsIHR5cGUsIHBsYXllcik7XHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uKGN1YmUsIHBvaW50KSB7XHJcbiAgaWYgKCF0aGlzLnJvb3QgJiYgY3ViZS5tb2R1bGUudHlwZSA9PT0gJ2NvcmUnKSB7XHJcbiAgICAgdGhpcy5yb290ID0gY3ViZTtcclxuICB9XHJcbiAgY3ViZS5ncm91cCA9IHRoaXM7XHJcbiAgdGhpcy5zZXQoY3ViZSwgcG9pbnQpO1xyXG4gIHRoaXMuY3JlYXRlQ29uc3RyYWludHMoY3ViZSwgcG9pbnQpO1xyXG59O1xyXG5cclxuQ3ViZUdyb3VwLnByb3RvdHlwZS5oYW5kbGVDb2xsaXNpb24gPSBmdW5jdGlvbihvcmlnaW4sIG90aGVyKSB7XHJcbiAgIC8vY29uc29sZS5sb2coJ2NvbGxpc2lvbiBldmVudCBncm91cCcpO1xyXG4gICAvL3RoaXMuZGlzcGxheUN1YmVzKCk7XHJcbiAgIC8vIHN0b3AgaWYgb3RoZXIgZG9lcyBub3QgZXhpc3QsIGVpdGhlciBpcyBub3QgYSBjdWJlLCBib3RoIGFyZSBpbiBzYW1lIGdyb3VwXHJcbiAgIGlmIChvdGhlciA9PT0gbnVsbCB8fCBvcmlnaW4ucHJvdG90eXBlICE9PSBvdGhlci5wcm90b3R5cGUpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICB9XHJcbiAgIC8vIGlmIChvdGhlci5ncm91cCAmJiBvdGhlci5ncm91cCAhPT0gdGhpcyAmJiBvcmlnaW4ucmFtRGVsYXkgPD0gMCkge1xyXG4gICB2YXIgc3VtVmVsID0gTWF0aC5hYnMob3JpZ2luLmJvZHkudmVsb2NpdHkueCkgKyBNYXRoLmFicyhvcmlnaW4uYm9keS52ZWxvY2l0eS55KTtcclxuICAgaWYgKG90aGVyLmdyb3VwICYmIG90aGVyLmdyb3VwICE9PSB0aGlzICYmIHN1bVZlbCA+PSB0aGlzLm1pblJhbVZlbCkge1xyXG4gICAgICAvL2NvbnNvbGUubG9nKCdjb2xsaXNpb24nKTtcclxuICAgICAgaWYgKHRoaXMuZ2FtZS5qdWljeSkge1xyXG4gICAgICAgICB0aGlzLmdhbWUuanVpY3kuc2hha2UoKTtcclxuICAgICAgfVxyXG4gICAgICBvdGhlci50YWtlRGFtYWdlKDMpO1xyXG4gICAgICB0aGlzLmNhbGwoJ3RocnVzdGVySGFsdCcpO1xyXG4gICB9IGVsc2UgaWYgKCFvdGhlci5ncm91cCAmJiB0aGlzLmlzUGxheWVyKSB7XHJcbiAgICAgIC8vY29uc29sZS5sb2coJ2NvbnRpbnVpbmcgY29sbGlzaW9uIGV2ZW50IGdyb3VwJyk7XHJcbiAgICAgIHZhciByZWxTaWRlID0gdGhpcy5yZWxhdGl2ZVNpZGUob3JpZ2luLmJvZHksIG90aGVyLmJvZHkpO1xyXG4gICAgICB2YXIgb3JpZ2luTG9jID0gdGhpcy5maW5kKG9yaWdpbik7XHJcbiAgICAgIHZhciBvdGhlckxvYyA9IHRoaXMuYWRqdXN0KG9yaWdpbkxvYywgcmVsU2lkZSk7XHJcbiAgICAgIHRoaXMuc2V0KG90aGVyLCBvdGhlckxvYyk7XHJcbiAgICAgIG90aGVyTG9jID0gdGhpcy5maW5kKG90aGVyKTsgLy8gdXBkYXRlIHBvc2l0aW9uIHNpbmNlIHNldCBjYW4gc2hpZnQgZ3JpZFxyXG4gICAgICBpZiAoIW90aGVyTG9jKSB7XHJcbiAgICAgICAgIGNvbnNvbGUubG9nKCdoYW5kbGVDb2xsaXNpb24oKTogb3RoZXJMb2MgRE9FJyk7XHJcbiAgICAgICAgIC8vdGhpcy5kaXNwbGF5Q3ViZXMoKTtcclxuICAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIC8vY29uc29sZS5sb2cocmVsU2lkZSwgb3JpZ2luTG9jLngsIG9yaWdpbkxvYy55LCBvdGhlckxvYy54LCBvdGhlckxvYy55KTtcclxuICAgICAgdmFyIG90aGVyUmVsU2lkZSA9IHRoaXMucmVsYXRpdmVTaWRlKG90aGVyLmJvZHksIG9yaWdpbi5ib2R5KTtcclxuICAgICAgdmFyIGNvbnN0cmFpbnRBbmdsZSA9IHRoaXMuZGVjaWRlQ29uc3RyYWludEFuZ2xlKHJlbFNpZGUsIG90aGVyUmVsU2lkZSk7XHJcbiAgICAgIHRoaXMuY3JlYXRlQ29uc3RyYWludHMob3RoZXIsIG90aGVyTG9jLCBjb25zdHJhaW50QW5nbGUpO1xyXG4gICAgICAvL3RoaXMuZGlzcGxheUN1YmVzKCk7XHJcbiAgIH1cclxufTtcclxuXHJcbkN1YmVHcm91cC5wcm90b3R5cGUuZGVjaWRlQ29uc3RyYWludEFuZ2xlID0gZnVuY3Rpb24oc2lkZUEsIHNpZGVCKSB7XHJcbiAgaWYgKHNpZGVBID09PSAwKSB7XHJcbiAgICAgaWYgKHNpZGVCID09PSAwKSB7XHJcbiAgICAgICAgcmV0dXJuIE1hdGguUEk7XHJcbiAgICAgfSBlbHNlIGlmIChzaWRlQiA9PT0gMSkge1xyXG4gICAgICAgICByZXR1cm4gTWF0aC5QSSAvIDI7XHJcbiAgICAgfSBlbHNlIGlmIChzaWRlQiA9PT0gMikge1xyXG4gICAgICAgICByZXR1cm4gMDtcclxuICAgICB9IGVsc2UgaWYgKHNpZGVCID09PSAzKSB7XHJcbiAgICAgICAgIHJldHVybiAzIC8gMiAqIE1hdGguUEk7XHJcbiAgICAgfVxyXG4gIH0gZWxzZSBpZiAoc2lkZUEgPT09IDEpIHtcclxuICAgICBpZiAoc2lkZUIgPT09IDApIHtcclxuICAgICAgICByZXR1cm4gMyAvIDIgKiBNYXRoLlBJO1xyXG4gICAgIH0gZWxzZSBpZiAoc2lkZUIgPT09IDEpIHtcclxuICAgICAgICAgcmV0dXJuIE1hdGguUEk7XHJcbiAgICAgfSBlbHNlIGlmIChzaWRlQiA9PT0gMikge1xyXG4gICAgICAgICByZXR1cm4gMSAvIDIgKiBNYXRoLlBJO1xyXG4gICAgIH0gZWxzZSBpZiAoc2lkZUIgPT09IDMpIHtcclxuICAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgfVxyXG4gIH0gZWxzZSBpZiAoc2lkZUEgPT09IDIpIHtcclxuICAgICAgaWYgKHNpZGVCID09PSAwKSB7XHJcbiAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgfSBlbHNlIGlmIChzaWRlQiA9PT0gMSkge1xyXG4gICAgICAgICByZXR1cm4gMyAvIDIgKiBNYXRoLlBJO1xyXG4gICAgIH0gZWxzZSBpZiAoc2lkZUIgPT09IDIpIHtcclxuICAgICAgICAgcmV0dXJuIE1hdGguUEk7XHJcbiAgICAgfSBlbHNlIGlmIChzaWRlQiA9PT0gMykge1xyXG4gICAgICAgICByZXR1cm4gMSAvIDIgKiBNYXRoLlBJO1xyXG4gICAgIH1cclxuICB9IGVsc2UgaWYgKHNpZGVBID09PSAzKSB7XHJcbiAgICAgaWYgKHNpZGVCID09PSAwKSB7XHJcbiAgICAgICAgcmV0dXJuIDEgLyAyICogTWF0aC5QSTtcclxuICAgICB9IGVsc2UgaWYgKHNpZGVCID09PSAxKSB7XHJcbiAgICAgICAgIHJldHVybiAwO1xyXG4gICAgIH0gZWxzZSBpZiAoc2lkZUIgPT09IDIpIHtcclxuICAgICAgICAgcmV0dXJuIDMgLyAyICogTWF0aC5QSTtcclxuICAgICB9IGVsc2UgaWYgKHNpZGVCID09PSAzKSB7XHJcbiAgICAgICAgIHJldHVybiBNYXRoLlBJO1xyXG4gICAgIH1cclxuICB9XHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLmNyZWF0ZUNvbnN0cmFpbnRzID0gZnVuY3Rpb24obWUsIHBvaW50LCBhbmdsZSkge1xyXG4gICB2YXIgbXlOb3J0aCA9IHRoaXMuZ2V0KHRoaXMuYWRqdXN0KHBvaW50LCB0aGlzLkRJUi5OT1JUSCkpO1xyXG4gICB2YXIgbXlFYXN0ID0gdGhpcy5nZXQodGhpcy5hZGp1c3QocG9pbnQsIHRoaXMuRElSLkVBU1QpKTtcclxuICAgdmFyIG15U291dGggPSB0aGlzLmdldCh0aGlzLmFkanVzdChwb2ludCwgdGhpcy5ESVIuU09VVEgpKTtcclxuICAgdmFyIG15V2VzdCA9IHRoaXMuZ2V0KHRoaXMuYWRqdXN0KHBvaW50LCB0aGlzLkRJUi5XRVNUKSk7XHJcbiAgIHZhciBjb25zdHJhaW50O1xyXG4gICBpZiAobXlOb3J0aCkge1xyXG4gICAgICBjb25zdHJhaW50ID0gdGhpcy5nYW1lLnBoeXNpY3MucDIuY3JlYXRlTG9ja0NvbnN0cmFpbnQobXlOb3J0aC5ib2R5LCBtZS5ib2R5LCBbMCwgLShtZS53aWR0aCArIHRoaXMub2Zmc2V0KV0sIGFuZ2xlKTsgLy8gbm9ydGggLSBtZVxyXG4gICAgICBtZS5jb25zdHJhaW50cy5wdXNoKGNvbnN0cmFpbnQpO1xyXG4gICAgICBteU5vcnRoLmNvbnN0cmFpbnRzLnB1c2goY29uc3RyYWludCk7XHJcbiAgIH1cclxuICAgaWYgKG15RWFzdCkge1xyXG4gICAgICBjb25zdHJhaW50ID0gdGhpcy5nYW1lLnBoeXNpY3MucDIuY3JlYXRlTG9ja0NvbnN0cmFpbnQobXlFYXN0LmJvZHksIG1lLmJvZHksIFttZS53aWR0aCArIHRoaXMub2Zmc2V0LCAwXSwgYW5nbGUpOyAvLyBlYXN0IC0gbWVcclxuICAgICAgbWUuY29uc3RyYWludHMucHVzaChjb25zdHJhaW50KTtcclxuICAgICAgbXlFYXN0LmNvbnN0cmFpbnRzLnB1c2goY29uc3RyYWludCk7XHJcbiAgIH1cclxuICAgaWYgKG15U291dGgpIHtcclxuICAgICAgY29uc3RyYWludCA9IHRoaXMuZ2FtZS5waHlzaWNzLnAyLmNyZWF0ZUxvY2tDb25zdHJhaW50KG15U291dGguYm9keSwgbWUuYm9keSwgWzAsIG1lLndpZHRoICsgdGhpcy5vZmZzZXRdLCBhbmdsZSk7IC8vIHNvdXRoIC0gbWVcclxuICAgICAgbWUuY29uc3RyYWludHMucHVzaChjb25zdHJhaW50KTtcclxuICAgICAgbXlTb3V0aC5jb25zdHJhaW50cy5wdXNoKGNvbnN0cmFpbnQpO1xyXG4gICB9XHJcbiAgIGlmIChteVdlc3QpIHtcclxuICAgICAgY29uc3RyYWludCA9IHRoaXMuZ2FtZS5waHlzaWNzLnAyLmNyZWF0ZUxvY2tDb25zdHJhaW50KG15V2VzdC5ib2R5LCBtZS5ib2R5LCBbLW1lLndpZHRoIC0gdGhpcy5vZmZzZXQsIDBdLCBhbmdsZSk7IC8vIHdlc3QgLSBtZVxyXG4gICAgICBtZS5jb25zdHJhaW50cy5wdXNoKGNvbnN0cmFpbnQpO1xyXG4gICAgICBteVdlc3QuY29uc3RyYWludHMucHVzaChjb25zdHJhaW50KTtcclxuICAgfVxyXG59O1xyXG5cclxuQ3ViZUdyb3VwLnByb3RvdHlwZS5yZWxhdGl2ZVNpZGUgPSBmdW5jdGlvbih0aGlzQm9keSwgb3RoZXJCb2R5KSB7XHJcbiAgdmFyIHRoaXNQb2ludCA9IG5ldyBQaGFzZXIuUG9pbnQodGhpc0JvZHkueCwgdGhpc0JvZHkueSk7XHJcbiAgdmFyIG90aGVyUG9pbnQgPSBuZXcgUGhhc2VyLlBvaW50KG90aGVyQm9keS54LCBvdGhlckJvZHkueSk7XHJcbiAgdmFyIGFuZ2xlVG9PdGhlciA9IHRoaXMuYW5nbGVCZXR3ZWVuUG9pbnRzKHRoaXNQb2ludCwgb3RoZXJQb2ludCk7XHJcbiAgdmFyIGRpZmZBbmdsZSA9IGFuZ2xlVG9PdGhlciAtIHRoaXNCb2R5LnJvdGF0aW9uO1xyXG4gIGlmIChkaWZmQW5nbGUgPj0gMCkge1xyXG4gICAgIGRpZmZBbmdsZSAlPSAyICogTWF0aC5QSTtcclxuICB9IGVsc2Uge1xyXG4gICAgIGRpZmZBbmdsZSAqPSAtMTtcclxuICAgICBkaWZmQW5nbGUgJT0gMiAqIE1hdGguUEk7XHJcbiAgICAgZGlmZkFuZ2xlICo9IC0xO1xyXG4gIH1cclxuICAvL2NvbnNvbGUubG9nKHRoaXNQb2ludCwgb3RoZXJQb2ludCwgYW5nbGVUb090aGVyLCB0aGlzQm9keS5yb3RhdGlvbiwgZGlmZkFuZ2xlKTtcclxuICAgaWYgKChkaWZmQW5nbGUgPj0gLTEgLyA0ICogTWF0aC5QSSAmJiBkaWZmQW5nbGUgPCAxIC8gNCAqIE1hdGguUEkpIHx8IGRpZmZBbmdsZSA+IDcgLyA0ICogTWF0aC5QSSkgeyAvLyBub3J0aFxyXG4gICAgIHJldHVybiB0aGlzLkRJUi5OT1JUSDtcclxuICB9IGVsc2UgaWYgKGRpZmZBbmdsZSA+PSAxIC8gNCAqIE1hdGguUEkgJiYgZGlmZkFuZ2xlIDwgMyAvIDQgKiBNYXRoLlBJKSB7IC8vIGVhc3RcclxuICAgICByZXR1cm4gdGhpcy5ESVIuRUFTVDtcclxuICB9IGVsc2UgaWYgKGRpZmZBbmdsZSA+PSAzIC8gNCAqIE1hdGguUEkgJiYgZGlmZkFuZ2xlIDwgNSAvIDQgKiBNYXRoLlBJKSB7IC8vIHNvdXRoXHJcbiAgICAgcmV0dXJuIHRoaXMuRElSLlNPVVRIO1xyXG4gIH0gZWxzZSBpZiAoZGlmZkFuZ2xlID49IDUgLyA0ICogTWF0aC5QSSAmJiBkaWZmQW5nbGUgPCA3IC8gNCAqIE1hdGguUEkpIHsgLy8gd2VzdFxyXG4gICAgIHJldHVybiB0aGlzLkRJUi5XRVNUO1xyXG4gIH0gZWxzZSBpZiAoZGlmZkFuZ2xlID49IC0zIC8gNCAqIE1hdGguUEkgJiYgZGlmZkFuZ2xlIDwgLTEgLyA0ICogTWF0aC5QSSkge1xyXG4gICAgIHJldHVybiB0aGlzLkRJUi5XRVNUO1xyXG4gIH0gZWxzZSBpZiAoZGlmZkFuZ2xlID49IC01IC8gNCAqIE1hdGguUEkgJiYgZGlmZkFuZ2xlIDwgLTMgLyA0ICogTWF0aC5QSSkge1xyXG4gICAgIHJldHVybiB0aGlzLkRJUi5TT1VUSDtcclxuICB9IGVsc2UgaWYgKGRpZmZBbmdsZSA+PSAtNyAvIDQgKiBNYXRoLlBJICYmIGRpZmZBbmdsZSA8IC01IC8gNCAqIE1hdGguUEkpIHtcclxuICAgICByZXR1cm4gdGhpcy5ESVIuRUFTVDtcclxuICB9IGVsc2UgaWYgKGRpZmZBbmdsZSA8IC03IC8gNCAqIE1hdGguUEkpIHtcclxuICAgICByZXR1cm4gdGhpcy5ESVIuTk9SVEg7XHJcbiAgfVxyXG59O1xyXG5cclxuQ3ViZUdyb3VwLnByb3RvdHlwZS5hbmdsZUJldHdlZW5Qb2ludHMgPSBmdW5jdGlvbih0aGlzUG9pbnQsIG90aGVyUG9pbnQpIHtcclxuICB2YXIgYW5nbGVUb090aGVyID0gUGhhc2VyLlBvaW50LmFuZ2xlKHRoaXNQb2ludCwgb3RoZXJQb2ludCk7XHJcbiAgaWYgKGFuZ2xlVG9PdGhlciA8IDApIHsgLy8gZml4IGR1bWIgcGFydCBvZiBQaGFzZXIuUG9pbnQuYW5nbGUoKVxyXG4gICAgIGFuZ2xlVG9PdGhlciA9IDIgKiBNYXRoLlBJICsgYW5nbGVUb090aGVyO1xyXG4gIH1cclxuICBhbmdsZVRvT3RoZXIgPSAoYW5nbGVUb090aGVyICsgMy8yICogTWF0aC5QSSkgJSAoMiAqIE1hdGguUEkpOyAvLyByb3RhdGUgOTAgZCBjbG9ja3dpc2VcclxuICAgcmV0dXJuIGFuZ2xlVG9PdGhlcjtcclxufTtcclxuXHJcbkN1YmVHcm91cC5wcm90b3R5cGUuZmluZCA9IGZ1bmN0aW9uKGN1YmUpIHtcclxuICAgZm9yICh2YXIgcm93ID0gMDsgcm93IDwgdGhpcy5jdWJlc1dpZHRoKCk7IHJvdysrKSB7XHJcbiAgICAgIGZvciAodmFyIGNvbCA9IDA7IGNvbCA8IHRoaXMuY3ViZXNIZWlnaHQoKTsgY29sKyspIHtcclxuICAgICAgICAgaWYgKHRoaXMuY3ViZXNbcm93XVtjb2xdID09PSBjdWJlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUGhhc2VyLlBvaW50KHJvdywgY29sKTtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgIH1cclxuICAgcmV0dXJuIHVuZGVmaW5lZDtcclxufTtcclxuXHJcbkN1YmVHcm91cC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24ocG9pbnQpIHtcclxuICBpZiAoIXBvaW50IHx8IHRoaXMub3V0T2ZCb3VuZHMocG9pbnQpKSB7XHJcbiAgICAgIHJldHVybjtcclxuICB9XHJcbiAgcmV0dXJuIHRoaXMuY3ViZXNbcG9pbnQueF1bcG9pbnQueV07XHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLmN1YmVzV2lkdGggPSBmdW5jdGlvbigpIHtcclxuICAgcmV0dXJuIHRoaXMuY3ViZXMubGVuZ3RoO1xyXG59O1xyXG5cclxuQ3ViZUdyb3VwLnByb3RvdHlwZS5jdWJlc0hlaWdodCA9IGZ1bmN0aW9uKCkge1xyXG4gICByZXR1cm4gdGhpcy5jdWJlc1swXS5sZW5ndGg7XHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLmFkZFRvcFJvdyA9IGZ1bmN0aW9uKCkge1xyXG4gICBmb3IgKHZhciByb3cgPSAwOyByb3cgPCB0aGlzLmN1YmVzV2lkdGgoKTsgcm93KyspIHtcclxuICAgICAgdGhpcy5jdWJlc1tyb3ddLnB1c2godW5kZWZpbmVkKTtcclxuICAgfVxyXG59O1xyXG5cclxuQ3ViZUdyb3VwLnByb3RvdHlwZS5hZGRSaWdodENvbCA9IGZ1bmN0aW9uKCkge1xyXG4gICB2YXIgbmV3Q29sID0gW107XHJcbiAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5jdWJlc0hlaWdodCgpOyBpKyspIHtcclxuICAgICAgbmV3Q29sLnB1c2godW5kZWZpbmVkKTtcclxuICAgfVxyXG4gICB0aGlzLmN1YmVzLnB1c2gobmV3Q29sKTtcclxufTtcclxuXHJcbkN1YmVHcm91cC5wcm90b3R5cGUuYWRkQm90Um93ID0gZnVuY3Rpb24oKSB7XHJcbiAgIGZvciAodmFyIHJvdyA9IDA7IHJvdyA8IHRoaXMuY3ViZXNXaWR0aCgpOyByb3crKykge1xyXG4gICAgICB0aGlzLmN1YmVzW3Jvd10udW5zaGlmdCh1bmRlZmluZWQpO1xyXG4gICB9XHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLmFkZExlZnRDb2wgPSBmdW5jdGlvbigpIHtcclxuICAgdmFyIG5ld0NvbCA9IG5ldyBBcnJheSh0aGlzLmN1YmVzSGVpZ2h0KCkpO1xyXG4gICB0aGlzLmN1YmVzLnVuc2hpZnQobmV3Q29sKTtcclxufTtcclxuXHJcbkN1YmVHcm91cC5wcm90b3R5cGUuZ2V0Q3ViZSA9IGZ1bmN0aW9uKHBvaW50KSB7XHJcbiAgIGlmICghcG9pbnQgfHwgdGhpcy5vdXRPZkJvdW5kcyhwb2ludCkpIHtcclxuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgfVxyXG4gICByZXR1cm4gdGhpcy5jdWJlc1twb2ludC54XVtwb2ludC55XTtcclxufTtcclxuXHJcbkN1YmVHcm91cC5wcm90b3R5cGUuYWRqdXN0ID0gZnVuY3Rpb24ocG9pbnQsIGRpcikge1xyXG4gIGlmICghcG9pbnQpIHtcclxuICAgICByZXR1cm47XHJcbiAgfVxyXG4gIHZhciBuZXdQb2ludCA9IG5ldyBQaGFzZXIuUG9pbnQocG9pbnQueCwgcG9pbnQueSk7XHJcbiAgLy8gY29uc29sZS5sb2coJ0FESlVTVCBJTjogJywgbmV3UG9pbnQueCwgbmV3UG9pbnQueSwgZGlyKTtcclxuICBzd2l0Y2ggKGRpcikge1xyXG4gICAgICBjYXNlIHRoaXMuRElSLk5PUlRIOlxyXG4gICAgICBuZXdQb2ludC55Kys7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIHRoaXMuRElSLkVBU1Q6XHJcbiAgICAgIG5ld1BvaW50LngrKztcclxuICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgdGhpcy5ESVIuU09VVEg6XHJcbiAgICAgIG5ld1BvaW50LnktLTtcclxuICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgdGhpcy5ESVIuV0VTVDpcclxuICAgICAgbmV3UG9pbnQueC0tO1xyXG4gICAgICBicmVhaztcclxuICAgfVxyXG4gICAvLyBjb25zb2xlLmxvZygnQURKVVNUIE9VVDogJywgbmV3UG9pbnQueCwgbmV3UG9pbnQueSk7XHJcbiAgIHJldHVybiBuZXdQb2ludDtcclxufTtcclxuXHJcbkN1YmVHcm91cC5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24oY3ViZSwgcG9pbnQpIHtcclxuICAgaWYgKCFwb2ludCkge1xyXG4gICAgICBjb25zb2xlLmxvZygnc2V0IGdpdmVuIHVuZGVmaW5lZCBwb2ludCcpO1xyXG4gICAgICByZXR1cm47XHJcbiAgIH1cclxuICAgaWYgKHBvaW50LnggPCAwKSB7XHJcbiAgICAgIC8vY29uc29sZS5sb2coJ2FkZCBsZWZ0IGNvbCcpO1xyXG4gICAgICB0aGlzLmFkZExlZnRDb2woKTtcclxuICAgICAgcG9pbnQueCA9IDA7XHJcbiAgIH0gZWxzZSBpZiAocG9pbnQueCA+PSB0aGlzLmN1YmVzV2lkdGgoKSkge1xyXG4gICAgICAvL2NvbnNvbGUubG9nKCdhZGQgcmlnaHQgY29sJyk7XHJcbiAgICAgIHRoaXMuYWRkUmlnaHRDb2woKTtcclxuICAgICAgcG9pbnQueCA9IHRoaXMuY3ViZXNXaWR0aCgpIC0gMTtcclxuICAgfSBlbHNlIGlmIChwb2ludC55IDwgMCkge1xyXG4gICAgICAvL2NvbnNvbGUubG9nKCdhZGQgYm90IHJvdycpO1xyXG4gICAgICB0aGlzLmFkZEJvdFJvdygpO1xyXG4gICAgICBwb2ludC55ID0gMDtcclxuICAgfSBlbHNlIGlmIChwb2ludC55ID49IHRoaXMuY3ViZXNIZWlnaHQoKSkge1xyXG4gICAgICAvL2NvbnNvbGUubG9nKCdhZGQgdG9wIHJvdycpO1xyXG4gICAgICB0aGlzLmFkZFRvcFJvdygpO1xyXG4gICAgICBwb2ludC55ID0gdGhpcy5jdWJlc0hlaWdodCgpIC0gMTtcclxuICAgfVxyXG4gICBpZiAodGhpcy5nZXQocG9pbnQpKSB7XHJcbiAgICAgIC8vIGNvbnNvbGUubG9nKCd0cmllZCB0byBzZXQgdG8gZmlsbGVkIHBvc2l0aW9uJyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgfVxyXG4gICB0aGlzLmN1YmVzW3BvaW50LnhdW3BvaW50LnldID0gY3ViZTtcclxuICAgY3ViZS5ncm91cCA9IHRoaXM7XHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLm91dE9mQm91bmRzID0gZnVuY3Rpb24ocG9pbnQpIHtcclxuICAgaWYgKCFwb2ludCkge1xyXG4gICAgICBjb25zb2xlLmxvZygnb3V0IG9mIGJvdW5kcyBnaXZlbiB1bmRlZmluZWQgcG9pbnQnKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICB9XHJcbiAgIGlmIChwb2ludC54IDwgMCB8fCBwb2ludC54ID49IHRoaXMuY3ViZXNXaWR0aCgpIHx8IHBvaW50LnkgPCAwIHx8IHBvaW50LnkgPj0gdGhpcy5jdWJlc0hlaWdodCgpKSB7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICB9XHJcbiAgIHJldHVybiBmYWxzZTtcclxufTtcclxuXHJcbkN1YmVHcm91cC5wcm90b3R5cGUuZGlzcGxheUN1YmVzID0gZnVuY3Rpb24oKSB7XHJcbiAgIGNvbnNvbGUubG9nKCc9PT09PT09PT09PT09PT09Jyk7XHJcbiAgIHZhciBvdXRwdXQgPSAnRGlzcGxheSBDdWJlc1xcbic7XHJcbiAgIHZhciByb3cgPSAwO1xyXG4gICB2YXIgY29sID0gdGhpcy5jdWJlc0hlaWdodCgpIC0gMTtcclxuICAgd2hpbGUgKGNvbCA+PSAwKSB7XHJcbiAgICAgIHdoaWxlIChyb3cgPCB0aGlzLmN1YmVzV2lkdGgoKSkge1xyXG4gICAgICAgICB2YXIgY3ViZSA9IHRoaXMuY3ViZXNbcm93XVtjb2xdO1xyXG4gICAgICAgICBpZiAoY3ViZSkge1xyXG4gICAgICAgICAgICBvdXRwdXQgKz0gJyMgJztcclxuICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgb3V0cHV0ICs9ICdfICc7XHJcbiAgICAgICAgIH1cclxuICAgICAgICAgcm93Kys7XHJcbiAgICAgIH1cclxuICAgICAgcm93ID0gMDtcclxuICAgICAgY29sLS07XHJcbiAgICAgIG91dHB1dCArPSAnXFxuJztcclxuICAgfVxyXG4gICBjb25zb2xlLmxvZyhvdXRwdXQpO1xyXG4gICBjb25zb2xlLmxvZygnLS0tLS0tLS0tLS0tLS0tJyk7XHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLmRpc3BsYXlDb25uZWN0aW9uID0gZnVuY3Rpb24oY29ubmVjdGlvbikge1xyXG4gICB2YXIgZ3JhcGggPSBuZXcgQXN0YXIuR3JhcGgodGhpcy5jdWJlc1RvR3JhcGgoKSk7XHJcbiAgIHZhciBzdGFydFBvaW50ID0gdGhpcy5maW5kKGNvbm5lY3Rpb24uc3RhcnQpO1xyXG4gICB2YXIgZW5kUG9pbnQgPSB0aGlzLmZpbmQoY29ubmVjdGlvbi5lbmQpO1xyXG4gICBpZiAoIXN0YXJ0UG9pbnQgfHwgIWVuZFBvaW50KSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdkaXNwbGF5Q29ubmVjdGlvbiBmYWlsZWQgdG8gZ2V0IHBvaW50cycpO1xyXG4gICAgICByZXR1cm47XHJcbiAgIH1cclxuICAgdmFyIHN0YXJ0ID0gZ3JhcGguZ3JpZFtzdGFydFBvaW50LnhdW3N0YXJ0UG9pbnQueV07XHJcbiAgIHZhciBlbmQgPSBncmFwaC5ncmlkW2VuZFBvaW50LnhdW2VuZFBvaW50LnldO1xyXG4gICB2YXIgcmVzdWx0ID0gQXN0YXIuYXN0YXIuc2VhcmNoKGdyYXBoLCBzdGFydCwgZW5kKTtcclxuICAgcmVzdWx0LnVuc2hpZnQoc3RhcnQpO1xyXG4gICB2YXIgcHJldmlvdXM7XHJcbiAgIGZvcih2YXIgaSA9IDA7IGkgPCByZXN1bHQubGVuZ3RoOyBpKyspIHtcclxuICAgICAgdmFyIGN1clBvaW50ID0gbmV3IFBoYXNlci5Qb2ludChyZXN1bHRbaV0ueCwgcmVzdWx0W2ldLnkpO1xyXG4gICAgICB2YXIgY3VyID0gdGhpcy5nZXQoY3VyUG9pbnQpO1xyXG4gICAgICB2YXIgaW5kaWNhdG9yID0gY3VyLmNJbmRpY2F0b3I7XHJcbiAgICAgIHZhciBkaXI7XHJcbiAgICAgIHZhciBwcmV2UG9pbnQ7XHJcbiAgICAgIHZhciBuZXh0UG9pbnQ7XHJcbiAgICAgIGlmICghcHJldmlvdXMpIHtcclxuICAgICAgICAgaW5kaWNhdG9yLmFuaW1hdGlvbnMucGxheSgnZW5kJyk7XHJcbiAgICAgICAgIG5leHRQb2ludCA9IG5ldyBQaGFzZXIuUG9pbnQocmVzdWx0W2krMV0ueCwgcmVzdWx0W2krMV0ueSk7XHJcbiAgICAgICAgIGRpciA9IHRoaXMuZGlyQmV0d2VlbihjdXJQb2ludCwgbmV4dFBvaW50KTtcclxuICAgICAgICAgaW5kaWNhdG9yLnJvdGF0aW9uID0gdGhpcy5kaXJUb0FuZ2xlKGRpcik7XHJcbiAgICAgIH0gZWxzZSBpZiAoaSA9PT0gcmVzdWx0Lmxlbmd0aCAtIDEpIHtcclxuICAgICAgICAgaW5kaWNhdG9yLmFuaW1hdGlvbnMucGxheSgnZW5kJyk7XHJcbiAgICAgICAgIHByZXZQb2ludCA9IG5ldyBQaGFzZXIuUG9pbnQocHJldmlvdXMueCwgcHJldmlvdXMueSk7XHJcbiAgICAgICAgIGRpciA9IHRoaXMuZGlyQmV0d2VlbihjdXJQb2ludCwgcHJldlBvaW50KTtcclxuICAgICAgICAgaW5kaWNhdG9yLnJvdGF0aW9uID0gdGhpcy5kaXJUb0FuZ2xlKGRpcik7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgIGluZGljYXRvci5hbmltYXRpb25zLnBsYXkoJ2xpbmUnKTtcclxuICAgICAgICAgcHJldlBvaW50ID0gbmV3IFBoYXNlci5Qb2ludChwcmV2aW91cy54LCBwcmV2aW91cy55KTtcclxuICAgICAgICAgdmFyIHByZXZEaXIgPSB0aGlzLmRpckJldHdlZW4oY3VyUG9pbnQsIHByZXZQb2ludCk7XHJcbiAgICAgICAgIG5leHRQb2ludCA9IG5ldyBQaGFzZXIuUG9pbnQocmVzdWx0W2krMV0ueCwgcmVzdWx0W2krMV0ueSk7XHJcbiAgICAgICAgIHZhciBuZXh0RGlyID0gdGhpcy5kaXJCZXR3ZWVuKGN1clBvaW50LCBuZXh0UG9pbnQpO1xyXG4gICAgICAgICB0aGlzLm1hbmFnZUluZGljYXRvcihpbmRpY2F0b3IsIHByZXZEaXIsIG5leHREaXIpO1xyXG4gICAgICB9XHJcbiAgICAgIHByZXZpb3VzID0gcmVzdWx0W2ldO1xyXG4gICAgICBjdXIuZGlzcGxheUluZGljYXRvcigpO1xyXG4gICAgfVxyXG59O1xyXG5cclxuQ3ViZUdyb3VwLnByb3RvdHlwZS5tYW5hZ2VJbmRpY2F0b3IgPSBmdW5jdGlvbihpbmRpY2F0b3IsIHByZXZEaXIsIG5leHREaXIpIHtcclxuICBpbmRpY2F0b3Iuc2NhbGUuc2V0VG8oTWF0aC5hYnMoaW5kaWNhdG9yLnNjYWxlLngpLCBpbmRpY2F0b3Iuc2NhbGUueSk7XHJcbiAgaWYgKHByZXZEaXIgPT09IHRoaXMuRElSLk5PUlRIICYmIG5leHREaXIgPT09IHRoaXMuRElSLlNPVVRIKSB7IC8vIDJcclxuICAgICAgaW5kaWNhdG9yLnJvdGF0aW9uID0gTWF0aC5QSTtcclxuICAgfSBlbHNlIGlmIChwcmV2RGlyID09PSB0aGlzLkRJUi5TT1VUSCAmJiBuZXh0RGlyID09PSB0aGlzLkRJUi5OT1JUSCkgeyAvLyAxXHJcbiAgICAgIGluZGljYXRvci5yb3RhdGlvbiA9IDA7XHJcbiAgIH0gZWxzZSBpZiAocHJldkRpciA9PT0gdGhpcy5ESVIuRUFTVCAmJiBuZXh0RGlyID09PSB0aGlzLkRJUi5XRVNUKSB7IC8vIDRcclxuICAgICAgaW5kaWNhdG9yLnJvdGF0aW9uID0gMSAvIDIgKiBNYXRoLlBJO1xyXG4gICB9IGVsc2UgaWYgKHByZXZEaXIgPT09IHRoaXMuRElSLldFU1QgJiYgbmV4dERpciA9PT0gdGhpcy5ESVIuRUFTVCkgeyAvLyAzXHJcbiAgICAgIGluZGljYXRvci5yb3RhdGlvbiA9IDMgLyAyICAqIE1hdGguUEk7XHJcbiAgIH0gZWxzZSB7XHJcbiAgICAgIGluZGljYXRvci5hbmltYXRpb25zLnBsYXkoJ3JpZ2h0Jyk7XHJcbiAgICAgIGlmIChwcmV2RGlyID09PSB0aGlzLkRJUi5TT1VUSCAmJiBuZXh0RGlyID09PSB0aGlzLkRJUi5FQVNUKSB7IC8vIDVcclxuICAgICAgICAgaW5kaWNhdG9yLnJvdGF0aW9uID0gMDtcclxuICAgICAgfSBlbHNlIGlmIChwcmV2RGlyID09PSB0aGlzLkRJUi5XRVNUICYmIG5leHREaXIgPT09IHRoaXMuRElSLlNPVVRIKSB7IC8vIDZcclxuICAgICAgICAgaW5kaWNhdG9yLnJvdGF0aW9uID0gMSAvIDIgKiBNYXRoLlBJO1xyXG4gICAgICB9IGVsc2UgaWYgKHByZXZEaXIgPT09IHRoaXMuRElSLk5PUlRIICYmIG5leHREaXIgPT09IHRoaXMuRElSLldFU1QpIHsgLy8gN1xyXG4gICAgICAgICBpbmRpY2F0b3Iucm90YXRpb24gPSBNYXRoLlBJO1xyXG4gICAgICB9IGVsc2UgaWYgKHByZXZEaXIgPT09IHRoaXMuRElSLkVBU1QgJiYgbmV4dERpciA9PT0gdGhpcy5ESVIuTk9SVEgpIHsgLy8gOFxyXG4gICAgICAgICBpbmRpY2F0b3Iucm90YXRpb24gPSAzIC8gMiAqIE1hdGguUEk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgIGluZGljYXRvci5zY2FsZS5zZXRUbygtTWF0aC5hYnMoaW5kaWNhdG9yLnNjYWxlLngpLCBpbmRpY2F0b3Iuc2NhbGUueSk7XHJcbiAgICAgICAgIGlmIChwcmV2RGlyID09PSB0aGlzLkRJUi5TT1VUSCAmJiBuZXh0RGlyID09PSB0aGlzLkRJUi5XRVNUKSB7IC8vIDlcclxuICAgICAgICAgICAgaW5kaWNhdG9yLnJvdGF0aW9uID0gMDtcclxuICAgICAgICAgfSBlbHNlIGlmIChwcmV2RGlyID09PSB0aGlzLkRJUi5XRVNUICYmIG5leHREaXIgPT09IHRoaXMuRElSLk5PUlRIKSB7IC8vIDEwXHJcbiAgICAgICAgICAgIGluZGljYXRvci5yb3RhdGlvbiA9IDEgLyAyICogTWF0aC5QSTtcclxuICAgICAgICAgfSBlbHNlIGlmIChwcmV2RGlyID09PSB0aGlzLkRJUi5OT1JUSCAmJiBuZXh0RGlyID09PSB0aGlzLkRJUi5FQVNUKSB7IC8vIDExXHJcbiAgICAgICAgICAgIGluZGljYXRvci5yb3RhdGlvbiA9IE1hdGguUEk7XHJcbiAgICAgICAgIH0gZWxzZSBpZiAocHJldkRpciA9PT0gdGhpcy5ESVIuRUFTVCAmJiBuZXh0RGlyID09PSB0aGlzLkRJUi5TT1VUSCkgeyAvLyAxMlxyXG4gICAgICAgICAgICBpbmRpY2F0b3Iucm90YXRpb24gPSAzIC8gMiAqIE1hdGguUEk7XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gICB9IFxyXG59O1xyXG5cclxuQ3ViZUdyb3VwLnByb3RvdHlwZS5jdWJlc1RvR3JhcGggPSBmdW5jdGlvbigpIHtcclxuICB2YXIgZ3JhcGggPSBbXTtcclxuICBmb3IgKHZhciByb3cgPSAwOyByb3cgPCB0aGlzLmN1YmVzV2lkdGgoKTsgcm93KyspIHtcclxuICAgICB2YXIgbmV3Q29sID0gW107XHJcbiAgICAgIGZvciAodmFyIGNvbCA9IDA7IGNvbCA8IHRoaXMuY3ViZXNIZWlnaHQoKTsgY29sKyspIHtcclxuICAgICAgICAgaWYgKHRoaXMuY3ViZXNbcm93XVtjb2xdKSB7XHJcbiAgICAgICAgICAgIG5ld0NvbC5wdXNoKDEpO1xyXG4gICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBuZXdDb2wucHVzaCgwKTtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGdyYXBoLnB1c2gobmV3Q29sKTtcclxuICAgfVxyXG4gICByZXR1cm4gZ3JhcGg7XHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLmRpckJldHdlZW4gPSBmdW5jdGlvbihhLCBiKSB7XHJcbiAgIHZhciBkZWx0YVggPSBhLnggLSBiLng7XHJcbiAgIHZhciBkZWx0YVkgPSBhLnkgLSBiLnk7XHJcbiAgIGlmIChkZWx0YVggPiAwKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLkRJUi5XRVNUO1xyXG4gICB9XHJcbiAgIGlmIChkZWx0YVggPCAwKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLkRJUi5FQVNUO1xyXG4gICB9XHJcbiAgIGlmIChkZWx0YVkgPiAwKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLkRJUi5TT1VUSDtcclxuICAgfVxyXG4gICBpZiAoZGVsdGFZIDwgMCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5ESVIuTk9SVEg7XHJcbiAgIH1cclxuICAgcmV0dXJuIHRoaXMuRElSLk5PUlRIO1xyXG59O1xyXG5cclxuQ3ViZUdyb3VwLnByb3RvdHlwZS5kaXJUb0FuZ2xlID0gZnVuY3Rpb24oZGlyKSB7XHJcbiAgc3dpdGNoIChkaXIpIHtcclxuICAgY2FzZSB0aGlzLkRJUi5OT1JUSDpcclxuICAgcmV0dXJuIE1hdGguUEk7XHJcbiAgIGNhc2UgdGhpcy5ESVIuRUFTVDpcclxuICAgcmV0dXJuIDMgLyAyICogTWF0aC5QSTtcclxuICAgY2FzZSB0aGlzLkRJUi5TT1VUSDpcclxuICAgcmV0dXJuIDA7XHJcbiAgIGNhc2UgdGhpcy5ESVIuV0VTVDpcclxuICAgcmV0dXJuIDEgLyAyICogTWF0aC5QSTtcclxuICB9ICBcclxufTtcclxuXHJcbkN1YmVHcm91cC5wcm90b3R5cGUuZGVzdHJveUN1YmUgPSBmdW5jdGlvbihjdWJlKSB7XHJcbiAgdmFyIGxvYyA9IHRoaXMuZmluZChjdWJlKTtcclxuICBpZiAoIWxvYykge1xyXG4gICAgIGNvbnNvbGUubG9nKCdhdHRlbXB0IHRvIGRlc3Ryb3kgY3ViZSBub3QgaW4gZ3JvdXAnKTtcclxuICAgICByZXR1cm47XHJcbiAgfVxyXG4gIC8vIHJlbW92ZSBjdWJlIGZyb20gZ3JvdXBcclxuICB0aGlzLnJlbW92ZShjdWJlKTtcclxuICAvLyBkZXN0cm95IGN1YmVcclxuICBjdWJlLmtpbGwodHJ1ZSk7XHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uKGN1YmUpIHtcclxuICAgLy8gY29uc29sZS5sb2coJ3JlbW92ZScpO1xyXG4gICBpZiAodGhpcy5yb290ID09PSBjdWJlKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgfVxyXG4gICAvLyByZW1vdmUgY3ViZSBmcm9tIGFycmF5XHJcbiAgIHZhciByb3csIGNvbDtcclxuICAgZm9yIChyb3cgPSAwOyByb3cgPCB0aGlzLmN1YmVzV2lkdGgoKTsgcm93KyspIHtcclxuICAgICAgZm9yIChjb2wgPSAwOyBjb2wgPCB0aGlzLmN1YmVzSGVpZ2h0KCk7IGNvbCsrKSB7XHJcbiAgICAgICAgIGlmICh0aGlzLmN1YmVzW3Jvd11bY29sXSA9PT0gY3ViZSkge1xyXG4gICAgICAgICAgICAvLyB0aGlzLmN1YmVzW3Jvd11bY29sXS5ncm91cCA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgdGhpcy5jdWJlc1tyb3ddW2NvbF0gPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICAvLyByZW1vdmUgY29uc3RyYWludHMgZnJvbSBjdWJlXHJcbiAgIHRoaXMucmVtb3ZlQ29uc3RyYWludHMoY3ViZSk7XHJcbiAgIGN1YmUuZ3JvdXAgPSB1bmRlZmluZWQ7XHJcbiAgIGlmIChjdWJlLm1vZHVsZSAmJiBjdWJlLm1vZHVsZS5oYXNPd25Qcm9wZXJ0eSgnb25SZW1vdmUnKSkge1xyXG4gICAgICBjdWJlLm1vZHVsZS5vblJlbW92ZSgpO1xyXG4gICB9XHJcbiAgIC8vIHRlc3QgZm9yIGV4aWxlc1xyXG4gICBmb3IgKHJvdyA9IDA7IHJvdyA8IHRoaXMuY3ViZXNXaWR0aCgpOyByb3crKykge1xyXG4gICAgICBmb3IgKGNvbCA9IDA7IGNvbCA8IHRoaXMuY3ViZXNIZWlnaHQoKTsgY29sKyspIHtcclxuICAgICAgICAgdmFyIGV4aWxlID0gdGhpcy5jdWJlc1tyb3ddW2NvbF07XHJcbiAgICAgICAgIGlmIChleGlsZSAmJiB0aGlzLmlzRXhpbGUoZXhpbGUpKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlKGV4aWxlKTtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgIH1cclxuICAgLy8gdGhpcy5kaXNwbGF5Q3ViZXMoKTtcclxufTtcclxuXHJcbkN1YmVHcm91cC5wcm90b3R5cGUucmVtb3ZlTmVpZ2hib3JzQ29uc3RyYWludCA9IGZ1bmN0aW9uKGNvbnN0cmFpbnQsIGN1YmUpIHtcclxuICAgLy8gY29uc29sZS5sb2coJ3JlbW92ZU5laWdoYm9yc0NvbnN0cmFpbnQnKTtcclxuICAgdmFyIG5laWdoYm9ycyA9IHRoaXMuZ2V0TmVpZ2hib3JzKGN1YmUpO1xyXG4gICBmb3IgKHZhciBpID0gMDsgaSA8IG5laWdoYm9ycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICB2YXIgbmVpZ2hib3IgPSBuZWlnaGJvcnNbaV07XHJcbiAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbmVpZ2hib3IuY29uc3RyYWludHMubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgaWYgKG5laWdoYm9yLmNvbnN0cmFpbnRzW2pdID09PSBjb25zdHJhaW50KSB7XHJcbiAgICAgICAgICAgIG5laWdoYm9yLmNvbnN0cmFpbnRzLnNwbGljZShqLCAxKTtcclxuICAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgIH1cclxufTtcclxuXHJcbkN1YmVHcm91cC5wcm90b3R5cGUuZ2V0TmVpZ2hib3JzID0gZnVuY3Rpb24oY3ViZSkge1xyXG4gICB2YXIgbG9jID0gdGhpcy5maW5kKGN1YmUpO1xyXG4gICB2YXIgbm9ydGggPSB0aGlzLmdldCh0aGlzLmFkanVzdChsb2MsIHRoaXMuRElSLk5PUlRIKSk7XHJcbiAgIHZhciBlYXN0ID0gdGhpcy5nZXQodGhpcy5hZGp1c3QobG9jLCB0aGlzLkRJUi5FQVNUKSk7XHJcbiAgIHZhciBzb3V0aCA9IHRoaXMuZ2V0KHRoaXMuYWRqdXN0KGxvYywgdGhpcy5ESVIuU09VVEgpKTtcclxuICAgdmFyIHdlc3QgPSB0aGlzLmdldCh0aGlzLmFkanVzdChsb2MsIHRoaXMuRElSLldFU1QpKTtcclxuICAgdmFyIG5laWdoYm9ycyA9IFtdO1xyXG4gICBpZiAobm9ydGgpIHtcclxuICAgICAgbmVpZ2hib3JzLnB1c2gobm9ydGgpO1xyXG4gICB9XHJcbiAgIGlmIChlYXN0KSB7XHJcbiAgICAgIG5laWdoYm9ycy5wdXNoKGVhc3QpO1xyXG4gICB9XHJcbiAgIGlmIChzb3V0aCkge1xyXG4gICAgICBuZWlnaGJvcnMucHVzaChzb3V0aCk7XHJcbiAgIH1cclxuICAgaWYgKHdlc3QpIHtcclxuICAgICAgbmVpZ2hib3JzLnB1c2god2VzdCk7XHJcbiAgIH1cclxuICAgcmV0dXJuIG5laWdoYm9ycztcclxufTtcclxuXHJcbkN1YmVHcm91cC5wcm90b3R5cGUucmVtb3ZlQ29uc3RyYWludHMgPSBmdW5jdGlvbihjdWJlKSB7XHJcbiAgIC8vIGNvbnNvbGUubG9nKCdyZW1vdmVDb25zdHJhaW50cycpO1xyXG4gICB3aGlsZSAoY3ViZS5jb25zdHJhaW50cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIHRoaXMucmVtb3ZlTmVpZ2hib3JzQ29uc3RyYWludChjdWJlLmNvbnN0cmFpbnRzWzBdLCBjdWJlKTtcclxuICAgICAgdGhpcy5nYW1lLnBoeXNpY3MucDIucmVtb3ZlQ29uc3RyYWludChjdWJlLmNvbnN0cmFpbnRzWzBdKTtcclxuICAgICAgY3ViZS5jb25zdHJhaW50cy5zcGxpY2UoMCwgMSk7XHJcbiAgIH1cclxufTtcclxuXHJcbi8vIG9ubHkgdXNlZCB0byB0ZXN0IEFzdGFyXHJcbkN1YmVHcm91cC5wcm90b3R5cGUudGVzdFBhdGggPSBmdW5jdGlvbigpIHtcclxuICB2YXIgZ3JhcGggPSBuZXcgQXN0YXIuR3JhcGgoW1xyXG4gICAgICAgIFsxLDEsMSwxXSxcclxuICAgICAgICBbMCwxLDEsMF0sXHJcbiAgICAgICAgWzAsMCwwLDFdXHJcbiAgICBdKTtcclxuICAgdmFyIHN0YXJ0ID0gZ3JhcGguZ3JpZFswXVswXTtcclxuICAgdmFyIGVuZCA9IGdyYXBoLmdyaWRbMl1bM107XHJcbiAgIHZhciByZXN1bHQgPSBBc3Rhci5hc3Rhci5zZWFyY2goZ3JhcGgsIHN0YXJ0LCBlbmQpO1xyXG4gICByZXN1bHQudW5zaGlmdChzdGFydCk7XHJcbiAgIGZvcih2YXIgaSA9IDA7IGkgPCByZXN1bHQubGVuZ3RoOyBpKyspIHtcclxuICAgICAgY29uc29sZS5sb2cocmVzdWx0W2ldLngsIHJlc3VsdFtpXS55KTtcclxuICAgIH0gXHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLmlzRXhpbGUgPSBmdW5jdGlvbihjdWJlKSB7XHJcbiAgIGlmIChjdWJlID09PSB0aGlzLnJvb3QpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICB9XHJcbiAgIHZhciBncmFwaCA9IG5ldyBBc3Rhci5HcmFwaCh0aGlzLmN1YmVzVG9HcmFwaCgpKTtcclxuICAgdmFyIHN0YXJ0UG9pbnQgPSB0aGlzLmZpbmQodGhpcy5yb290KTtcclxuICAgdmFyIGVuZFBvaW50ID0gdGhpcy5maW5kKGN1YmUpO1xyXG4gICB2YXIgc3RhcnQgPSBncmFwaC5ncmlkW3N0YXJ0UG9pbnQueF1bc3RhcnRQb2ludC55XTtcclxuICAgdmFyIGVuZCA9IGdyYXBoLmdyaWRbZW5kUG9pbnQueF1bZW5kUG9pbnQueV07XHJcbiAgIHZhciByZXN1bHQgPSBBc3Rhci5hc3Rhci5zZWFyY2goZ3JhcGgsIHN0YXJ0LCBlbmQpO1xyXG4gICAvLyBpZiBubyBwYXRoIGlzIGZvdW5kLCB0aGUgY3ViZSBpcyBhbiBleGlsZVxyXG4gICBpZiAocmVzdWx0Lmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgfVxyXG4gICByZXR1cm4gZmFsc2U7XHJcbn07XHJcblxyXG5DdWJlR3JvdXAucHJvdG90eXBlLmNvdW50Q3ViZXMgPSBmdW5jdGlvbigpIHtcclxuXHR2YXIgcm93LCBjb2w7XHJcblx0dmFyIG51bSAgPSAwO1xyXG5cdGZvciAocm93ID0gMDsgcm93IDwgdGhpcy5jdWJlc1dpZHRoKCk7IHJvdysrKSB7XHJcblx0XHRmb3IgKGNvbCA9IDA7IGNvbCA8IHRoaXMuY3ViZXNIZWlnaHQoKTsgY29sKyspIHtcclxuXHRcdFx0aWYgKHRoaXMuY3ViZXNbcm93XVtjb2xdICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0XHRudW0rKztcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHQvL2NvbnNvbGUubG9nKG51bSk7XHJcblx0dGhpcy5udW1DdWJlcyA9IG51bTtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gQ3ViZUdyb3VwO1xyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuIiwidmFyIFV0aWxzID0gcmVxdWlyZSgnLi4vdXRpbHMuanMnKTtcclxuXHJcbnZhciBFbmVteUFJID0gZnVuY3Rpb24oZ2FtZSwgZ3JvdXAsIHR5cGUsIHBsYXllckdyb3VwKSB7XHJcbiAgIHRoaXMuZ2FtZSA9IGdhbWU7XHJcbiAgIHRoaXMuZ3JvdXAgPSBncm91cDtcclxuICAgdGhpcy50eXBlID0gdHlwZTtcclxuICAgdGhpcy5wbGF5ZXJHcm91cCA9IHBsYXllckdyb3VwO1xyXG4gICB0aGlzLnBsYXllciA9IHRoaXMucGxheWVyR3JvdXAucm9vdDtcclxuICAgdGhpcy5yYW1EaXN0ID0gNTAwO1xyXG4gICB0aGlzLnNob290RGlzdCA9IDUwMDtcclxuICAgdGhpcy5yb3RhdGlvbkZvcmNlID0gNTA7XHJcbiAgIHRoaXMuZmFjaW5nQWxsb3dhbmNlID0gTWF0aC5QSSAvIDE1O1xyXG4gICB0aGlzLmFjdGluZyA9IGZhbHNlO1xyXG4gICBzd2l0Y2ggKHRoaXMudHlwZSkge1xyXG4gICAgICBjYXNlICdyYW0nOlxyXG4gICAgICB0aGlzLmFsbG9jYXRlVG8oJ3RocnVzdGVyJyk7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICdzaG9vdCc6XHJcbiAgICAgIHRoaXMuYWxsb2NhdGVUbygnZ3VuJyk7XHJcbiAgIH1cclxufTtcclxuXHJcbkVuZW15QUkucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gRW5lbXlBSTtcclxuXHJcbkVuZW15QUkucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICBzd2l0Y2ggKHRoaXMudHlwZSkge1xyXG4gICAgICBjYXNlICdyYW0nOlxyXG4gICAgICB0aGlzLmN1c3RvbVVwZGF0ZSgndGhydXN0ZXInLCB0aGlzLnJhbURpc3QpO1xyXG4gICAgICBicmVhaztcclxuICAgICAgY2FzZSAnc2hvb3QnOlxyXG4gICAgICB0aGlzLmN1c3RvbVVwZGF0ZSgnZ3VuJywgdGhpcy5zaG9vdERpc3QpO1xyXG4gICB9XHJcbn07XHJcblxyXG5FbmVteUFJLnByb3RvdHlwZS5jdXN0b21VcGRhdGUgPSBmdW5jdGlvbih0eXBlLCB0aHJlc2hvbGQpIHtcclxuICAgaWYgKCF0aGlzLmdyb3VwLnJvb3QpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICB9XHJcbiAgIHZhciByb290ID0gdGhpcy5ncm91cC5yb290O1xyXG4gICB2YXIgbXlQb3MgPSBuZXcgUGhhc2VyLlBvaW50KHJvb3QueCwgcm9vdC55KTtcclxuICAgdmFyIHBsYXllclBvcyA9IG5ldyBQaGFzZXIuUG9pbnQodGhpcy5wbGF5ZXIueCwgdGhpcy5wbGF5ZXIueSk7XHJcbiAgIHZhciBkaXN0ID0gVXRpbHMuZGlzdGFuY2UobXlQb3MueCwgbXlQb3MueSwgcGxheWVyUG9zLngsIHBsYXllclBvcy55KTtcclxuICAgaWYgKGRpc3QgPD0gdGhyZXNob2xkKSB7XHJcbiAgICAgIHZhciBhbmdsZVRvID0gdGhpcy5hbmdsZVRvKG15UG9zLCBwbGF5ZXJQb3MpO1xyXG4gICAgICB2YXIgZGlmZkFuZ2xlID0gYW5nbGVUbyAtIHJvb3QuYm9keS5yb3RhdGlvbjtcclxuICAgICAgaWYgKGRpZmZBbmdsZSA+IDApIHtcclxuICAgICAgICAgcm9vdC5ib2R5LmFuZ3VsYXJGb3JjZSA9IHRoaXMucm90YXRpb25Gb3JjZTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgcm9vdC5ib2R5LmFuZ3VsYXJGb3JjZSA9IC10aGlzLnJvdGF0aW9uRm9yY2U7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKE1hdGguYWJzKGRpZmZBbmdsZSkgPD0gdGhpcy5mYWNpbmdBbGxvd2FuY2UgJiYgIXRoaXMuYWN0aW5nKSB7XHJcbiAgICAgICAgIC8vIHRoaXMuZ3JvdXAuY2FsbCgnYmVnaW5BY3QnKTtcclxuICAgICAgICAgdGhpcy5ncm91cC5jYWxsT25UeXBlKCdiZWdpbkFjdCcsIHR5cGUpO1xyXG4gICAgICAgICB0aGlzLmFjdGluZyA9IHRydWU7XHJcbiAgICAgICAgIC8vIHRoaXMuYWxsb2NhdGVUbyh0eXBlKTtcclxuICAgICAgfSBlbHNlIGlmIChNYXRoLmFicyhkaWZmQW5nbGUpID4gdGhpcy5mYWNpbmdBbGxvd2FuY2UgJiYgdGhpcy5hY3Rpbmcpe1xyXG4gICAgICAgICAvLyB0aGlzLmdyb3VwLmNhbGwoJ2VuZEFjdCcpO1xyXG4gICAgICAgICB0aGlzLmdyb3VwLmNhbGxPblR5cGUoJ2VuZEFjdCcsIHR5cGUpO1xyXG4gICAgICAgICB0aGlzLmFjdGluZyA9IGZhbHNlO1xyXG4gICAgICB9XHJcbiAgIH1cclxufTtcclxuXHJcbkVuZW15QUkucHJvdG90eXBlLmFsbG9jYXRlVG8gPSBmdW5jdGlvbih0eXBlKSB7XHJcbiAgIHZhciBwYW5lbHMgPSBbXTtcclxuICAgdmFyIHR5cGVzID0gW107XHJcbiAgIGZvciAodmFyIHJvdyA9IDA7IHJvdyA8IHRoaXMuZ3JvdXAuY3ViZXNXaWR0aCgpOyByb3crKykge1xyXG4gICAgICBmb3IgKHZhciBjb2wgPSAwOyBjb2wgPCB0aGlzLmdyb3VwLmN1YmVzSGVpZ2h0KCk7IGNvbCsrKSB7XHJcbiAgICAgICAgIHZhciBjdWJlID0gdGhpcy5ncm91cC5jdWJlc1tyb3ddW2NvbF07XHJcbiAgICAgICAgIGlmIChjdWJlICYmIGN1YmUubW9kdWxlKSB7XHJcbiAgICAgICAgICAgIGlmIChjdWJlLm1vZHVsZS50eXBlID09PSAnc29sYXJQYW5lbCcgJiYgIWN1YmUubXlDb25uZWN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgIHBhbmVscy5wdXNoKGN1YmUubW9kdWxlKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChjdWJlLm1vZHVsZS50eXBlID09PSB0eXBlICYmICFjdWJlLm15Q29ubmVjdGlvbikge1xyXG4gICAgICAgICAgICAgICB0eXBlcy5wdXNoKGN1YmUubW9kdWxlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgfVxyXG4gICB2YXIgaSA9IDA7XHJcbiAgIHdoaWxlIChpIDwgdHlwZXMubGVuZ3RoICYmIGkgPCBwYW5lbHMubGVuZ3RoKSB7XHJcbiAgICAgIHZhciB0YXJQYW5lbCA9IHBhbmVsc1tpXTtcclxuICAgICAgdmFyIHRhclR5cGUgPSB0eXBlc1tpXTtcclxuICAgICAgdmFyIG5ld0Nvbm5lY3Rpb24gPSB7c3RhcnQ6IHRhclBhbmVsLmN1YmUsIGVuZDogdGFyVHlwZS5jdWJlfTtcclxuICAgICAgdGFyUGFuZWwuY3ViZS5teUNvbm5lY3Rpb24gPSBuZXdDb25uZWN0aW9uO1xyXG4gICAgICB0YXJUeXBlLmN1YmUubXlDb25uZWN0aW9uID0gbmV3Q29ubmVjdGlvbjtcclxuICAgICAgdGhpcy5ncm91cC5kaXNwbGF5Q29ubmVjdGlvbih0YXJQYW5lbC5jdWJlLm15Q29ubmVjdGlvbik7XHJcbiAgICAgIGkrKztcclxuICAgfVxyXG59O1xyXG5cclxuRW5lbXlBSS5wcm90b3R5cGUuYW5nbGVUbyA9IGZ1bmN0aW9uKGZyb20sIHRvKSB7XHJcbiAgdmFyIGFuZ2xlVG9PdGhlciA9IFBoYXNlci5Qb2ludC5hbmdsZShmcm9tLCB0byk7XHJcbiAgaWYgKGFuZ2xlVG9PdGhlciA8IDApIHsgLy8gZml4IGR1bWIgcGFydCBvZiBQaGFzZXIuUG9pbnQuYW5nbGUoKVxyXG4gICAgIGFuZ2xlVG9PdGhlciA9IDIgKiBNYXRoLlBJICsgYW5nbGVUb090aGVyO1xyXG4gIH1cclxuICBhbmdsZVRvT3RoZXIgPSAoYW5nbGVUb090aGVyICsgMy8yICogTWF0aC5QSSkgJSAoMiAqIE1hdGguUEkpOyAvLyByb3RhdGUgOTAgZCBjbG9ja3dpc2VcclxuICByZXR1cm4gYW5nbGVUb090aGVyO1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBFbmVteUFJO1xyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuIiwidmFyIFV0aWxzID0gcmVxdWlyZSgnLi4vdXRpbHMuanMnKTtcclxuXHJcbnZhciBNb3VzZSA9IGZ1bmN0aW9uKGdhbWUsIGlucHV0LCBwbGF5ZXJHcm91cCkge1xyXG4gICB0aGlzLmdhbWUgPSBnYW1lO1xyXG4gICB0aGlzLmlucHV0ID0gaW5wdXQ7XHJcblx0dGhpcy5ib2R5ID0gbmV3IHAyLkJvZHkoKTsgLy8ganNoaW50IGlnbm9yZTpsaW5lXHJcbiAgIHRoaXMuZ2FtZS5waHlzaWNzLnAyLndvcmxkLmFkZEJvZHkodGhpcy5ib2R5KTtcclxuICAgLy8gdGhpcy5nYW1lLnBoeXNpY3MucDIuZW5hYmxlKHRoaXMpO1xyXG4gICBcclxuICAgdGhpcy5pbnB1dC5vbkRvd24uYWRkKHRoaXMuY2xpY2ssIHRoaXMpO1xyXG4gICB0aGlzLmlucHV0Lm9uVXAuYWRkKHRoaXMucmVsZWFzZSwgdGhpcyk7XHJcbiAgIHRoaXMuaW5wdXQuYWRkTW92ZUNhbGxiYWNrKHRoaXMubW92ZSwgdGhpcyk7XHJcbiAgIHRoaXMueCA9IDA7XHJcbiAgIHRoaXMueSA9IDA7XHJcbiAgIFxyXG4gICB0aGlzLmdyYWJiZWQgPSB1bmRlZmluZWQ7XHJcbiAgIHRoaXMubGFzdENsaWNrZWQgPSB1bmRlZmluZWQ7XHJcbiAgIHRoaXMubGluZSA9IG5ldyBQaGFzZXIuTGluZSgwLCAwLCAwLCAwKTtcclxuICAgXHJcbiAgIHRoaXMucmVtb3ZlVGhyZXNob2xkID0gNDAwOyAvLyB0aW1lIGluIG1pbGxpc2Vjb25kc1xyXG4gICB0aGlzLnJlbW92ZVRpbWUgPSAwOyAvLyB0aW1lIHRpbGwgdGhyZXNob2xkXHJcbiAgIFxyXG4gICB0aGlzLnBsYXllckdyb3VwID0gcGxheWVyR3JvdXA7XHJcbn07XHJcblxyXG5Nb3VzZS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBNb3VzZTtcclxuXHJcbk1vdXNlLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHtcclxuICAgaWYgKHRoaXMuZ3JhYmJlZCkge1xyXG4gICAgICB2YXIgYW5nbGUgPSBNYXRoLmF0YW4yKHRoaXMuZ3JhYmJlZC5zcHJpdGUueSAtICh0aGlzLmlucHV0LnBvc2l0aW9uLnkgKyB0aGlzLmdhbWUuY2FtZXJhLnkpLCB0aGlzLmdyYWJiZWQuc3ByaXRlLnggLSAodGhpcy5pbnB1dC5wb3NpdGlvbi54KyB0aGlzLmdhbWUuY2FtZXJhLngpKSArIE1hdGguUEk7XHJcbiAgICAgIHZhciBkaXN0ID0gVXRpbHMuZGlzdGFuY2UodGhpcy5ncmFiYmVkLnNwcml0ZS54LCB0aGlzLmdyYWJiZWQuc3ByaXRlLnksICh0aGlzLmlucHV0LnBvc2l0aW9uLngrIHRoaXMuZ2FtZS5jYW1lcmEueCksICh0aGlzLmlucHV0LnBvc2l0aW9uLnkgKyB0aGlzLmdhbWUuY2FtZXJhLnkpKTtcclxuICAgICAgdmFyIHdlaWdodDtcclxuXHQgIGlmKHRoaXMuZ3JhYmJlZC5zcHJpdGUua2V5ID09PSAnYXN0ZXJvaWQnKSB7XHJcblx0XHR3ZWlnaHQgPSAxO1xyXG5cdCAgfVxyXG5cdCAgZWxzZSB7XHJcblx0XHR3ZWlnaHQgPSAxMDtcclxuXHQgIH1cclxuXHQgIGlmICghdGhpcy5ncmFiYmVkLnNwcml0ZS5ncm91cCkge1xyXG4gICAgICAgICB0aGlzLmdyYWJiZWQuZm9yY2UueCA9IE1hdGguY29zKGFuZ2xlKSAqIGRpc3QgKiB3ZWlnaHQ7XHJcbiAgICAgICAgIHRoaXMuZ3JhYmJlZC5mb3JjZS55ID0gTWF0aC5zaW4oYW5nbGUpICogZGlzdCAqIHdlaWdodDtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLmxpbmUuc2V0VG8odGhpcy5ncmFiYmVkLnNwcml0ZS54LCB0aGlzLmdyYWJiZWQuc3ByaXRlLnksICh0aGlzLmlucHV0LnBvc2l0aW9uLngrIHRoaXMuZ2FtZS5jYW1lcmEueCksICh0aGlzLmlucHV0LnBvc2l0aW9uLnkgKyB0aGlzLmdhbWUuY2FtZXJhLnkpKTtcclxuICAgICAgdGhpcy5yZW1vdmVUaW1lICs9IHRoaXMuZ2FtZS50aW1lLmVsYXBzZWQ7XHJcbiAgICAgIGlmKHRoaXMuZ3JhYmJlZC5zcHJpdGUudGFnID09PSAnbW9kdWxlJykge1xyXG5cdFx0ICBpZiAodGhpcy5yZW1vdmVUaW1lID49IHRoaXMucmVtb3ZlVGhyZXNob2xkICYmIHRoaXMuZ3JhYmJlZC5zcHJpdGUua2V5ICE9PSAnYXN0ZXJvaWQnKSB7XHJcblx0XHRcdCB0aGlzLmdyYWJiZWQuc3ByaXRlLnJlbW92ZSgpO1xyXG5cdFx0XHQgdGhpcy5yZW1vdmVUaW1lID0gMDtcclxuXHRcdCAgfVxyXG5cdCAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgIHRoaXMubGluZS5zZXRUbygwLCAwLCAwLCAwKTtcclxuICAgIH1cclxuICAgIHZhciBwb2ludCA9IG5ldyBQaGFzZXIuUG9pbnQodGhpcy54LCB0aGlzLnkpO1xyXG4gICAgdmFyIGJvZGllcyA9IHRoaXMuZ2FtZS5waHlzaWNzLnAyLmhpdFRlc3QocG9pbnQpO1xyXG4gICAgaWYgKGJvZGllcy5sZW5ndGgpXHJcbiAgICB7XHJcbiAgICAgICAgdmFyIGhvdmVyID0gYm9kaWVzWzBdLnBhcmVudDtcclxuICAgICAgICBpZiAoaG92ZXIuc3ByaXRlLm1vZHVsZSAmJiBob3Zlci5zcHJpdGUubW9kdWxlLm1vdXNlT3Zlcikge1xyXG4gICAgICAgICAgIGhvdmVyLnNwcml0ZS5tb2R1bGUubW91c2VPdmVyKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG5cclxuTW91c2UucHJvdG90eXBlLmNsaWNrID0gZnVuY3Rpb24ocG9pbnRlcikge1xyXG4gICB2YXIgcG9pbnQgPSBuZXcgUGhhc2VyLlBvaW50KHBvaW50ZXIueCArIHRoaXMuZ2FtZS5jYW1lcmEueCwgcG9pbnRlci55ICsgdGhpcy5nYW1lLmNhbWVyYS55KTtcclxuICAgdmFyIGJvZGllcyA9IHRoaXMuZ2FtZS5waHlzaWNzLnAyLmhpdFRlc3QocG9pbnQpO1xyXG4gICBpZiAoYm9kaWVzLmxlbmd0aClcclxuICAge1xyXG4gICAgIHZhciB0ZW1wID0gYm9kaWVzWzBdLnBhcmVudDtcclxuICAgICB0aGlzLmdyYWJiZWQgPSB0ZW1wO1xyXG4gICAgIGlmICh0aGlzLmdyYWJiZWQuc3ByaXRlLm1vZHVsZSAmJiB0aGlzLmdyYWJiZWQuc3ByaXRlLm1vZHVsZS5oYXNPd25Qcm9wZXJ0eSgnbW91c2VEb3duJykpIHtcclxuICAgICAgIHRoaXMuZ3JhYmJlZC5zcHJpdGUubW9kdWxlLm1vdXNlRG93bigpO1xyXG4gICAgIH1cclxuICAgICBpZiAodGhpcy5sYXN0Q2xpY2tlZCAmJiB0aGlzLmxhc3RDbGlja2VkLnNwcml0ZSAmJiB0aGlzLmxhc3RDbGlja2VkLnNwcml0ZS5tb2R1bGUgJiZcclxuICAgICB0aGlzLmxhc3RDbGlja2VkLnNwcml0ZS5tb2R1bGUuZ2l2ZVRhcmdldCkge1xyXG4gICAgICAgIHRoaXMubGFzdENsaWNrZWQuc3ByaXRlLm1vZHVsZS5naXZlVGFyZ2V0KHRoaXMuZ3JhYmJlZC5zcHJpdGUubW9kdWxlKTtcclxuICAgICB9XHJcbiAgICAgaWYgKHRlbXAuc3ByaXRlICYmIHRlbXAuc3ByaXRlLm1vZHVsZSAmJiB0ZW1wLnNwcml0ZS5tb2R1bGUudHlwZSA9PT0gJ2NvcmUnKSB7XHJcbiAgICAgICAgdGhpcy5ncmFiYmVkID0gdW5kZWZpbmVkO1xyXG4gICAgIH1cclxuICAgICBpZiAodGVtcC5zcHJpdGUgJiYgdGVtcC5zcHJpdGUuZ3JvdXAgJiYgdGVtcC5zcHJpdGUuZ3JvdXAgIT09IHRoaXMucGxheWVyR3JvdXApIHtcclxuICAgICAgICB0aGlzLmdyYWJiZWQgPSB1bmRlZmluZWQ7XHJcbiAgICAgfVxyXG4gICAgIHRoaXMucmVtb3ZlVGltZSA9IDA7XHJcbiAgICAgdGhpcy5sYXN0Q2xpY2tlZCA9IHRlbXA7XHJcbiAgIH1cclxufTtcclxuICBcclxuIE1vdXNlLnByb3RvdHlwZS5yZWxlYXNlID0gZnVuY3Rpb24oKSB7XHJcbiAgIGlmICh0aGlzLmdyYWJiZWQpIHtcclxuICAgICB0aGlzLmdyYWJiZWQgPSB1bmRlZmluZWQ7XHJcbiAgIH1cclxufTtcclxuICBcclxuTW91c2UucHJvdG90eXBlLm1vdmUgPSBmdW5jdGlvbihwb2ludGVyKSB7XHJcbiAgIC8vIHAyIHVzZXMgZGlmZmVyZW50IGNvb3JkaW5hdGUgc3lzdGVtLCBzbyBjb252ZXJ0IHRoZSBwb2ludGVyIHBvc2l0aW9uIHRvIHAyJ3MgY29vcmRpbmF0ZSBzeXN0ZW1cclxuICAgdGhpcy5ib2R5LnBvc2l0aW9uWzBdID0gdGhpcy5nYW1lLnBoeXNpY3MucDIucHhtaShwb2ludGVyLnBvc2l0aW9uLngpO1xyXG4gICB0aGlzLmJvZHkucG9zaXRpb25bMV0gPSB0aGlzLmdhbWUucGh5c2ljcy5wMi5weG1pKHBvaW50ZXIucG9zaXRpb24ueSk7XHJcbiAgIHRoaXMueCA9IHBvaW50ZXIucG9zaXRpb24ueCArIHRoaXMuZ2FtZS5jYW1lcmEueDtcclxuICAgdGhpcy55ID0gcG9pbnRlci5wb3NpdGlvbi55ICsgdGhpcy5nYW1lLmNhbWVyYS55O1xyXG59O1xyXG5cclxuTW91c2UucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uKCkge1xyXG4gICB0aGlzLmdhbWUuZGVidWcuZ2VvbSh0aGlzLmxpbmUpO1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBNb3VzZTtcclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4iLCJ2YXIgUmVuZGVyYWJsZXMgPSBmdW5jdGlvbigpIHtcclxuXHRpZihSZW5kZXJhYmxlcy5wcm90b3R5cGUuZXhpc3RzKSB7XHJcblx0XHRyZXR1cm4gUmVuZGVyYWJsZXMucHJvdG90eXBlLmV4aXN0aW5nUmVmZXJlbmNlO1xyXG5cdH1cclxuXHRcclxuXHR0aGlzLmxpc3QgPSBbXTtcclxuXHRSZW5kZXJhYmxlcy5wcm90b3R5cGUuZXhpc3RzID0gdHJ1ZTtcclxuXHRSZW5kZXJhYmxlcy5wcm90b3R5cGUuZXhpc3RpbmdSZWZlcmVuY2UgPSB0aGlzO1xyXG59O1xyXG5cclxuUmVuZGVyYWJsZXMucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gUmVuZGVyYWJsZXM7XHJcbi8vVGhlc2UgdmFyJ3MgaGVscCBjcmVhdGUgdGhlIHNpbmdsZXRvbiBmdW5jdGlvbmFsaXR5XHJcblJlbmRlcmFibGVzLnByb3RvdHlwZS5leGlzdHMgPSBmYWxzZTtcclxuUmVuZGVyYWJsZXMucHJvdG90eXBlLmV4aXN0aW5nUmVmZXJlbmNlID0gbnVsbDtcclxuXHJcblJlbmRlcmFibGVzLnByb3RvdHlwZS5zdWJzY3JpYmUgPSBmdW5jdGlvbihzdWJzY3JpYmVyKSB7XHJcblx0dGhpcy5saXN0LnB1c2goc3Vic2NyaWJlcik7XHJcbn07XHJcblxyXG5SZW5kZXJhYmxlcy5wcm90b3R5cGUudW5zdWJzY3JpYmUgPSBmdW5jdGlvbih1bnN1YnNjcmliZXIpIHtcclxuXHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5saXN0Lmxlbmd0aDsgaSsrKSB7XHJcblx0XHRpZih0aGlzLmxpc3RbaV0gPT09IHVuc3Vic2NyaWJlcikge1xyXG5cdFx0XHR0aGlzLmxpc3RbaV0gPSBmYWxzZTtcclxuXHRcdH1cclxuXHR9XHJcbn07XHJcblxyXG5SZW5kZXJhYmxlcy5wcm90b3R5cGUucmVuZGVyQWxsID0gZnVuY3Rpb24oKSB7XHJcblx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMubGlzdC5sZW5ndGg7IGkrKykge1xyXG5cdFx0aWYodGhpcy5saXN0W2ldID09PSBmYWxzZSkge1xyXG5cdFx0XHRjb250aW51ZTtcclxuXHRcdH1cclxuXHRcdHRoaXMubGlzdFtpXS5yZW5kZXIoKTtcclxuXHR9XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFJlbmRlcmFibGVzOyIsIi8vIGphdmFzY3JpcHQtYXN0YXIgMC40LjBcclxuLy8gaHR0cDovL2dpdGh1Yi5jb20vYmdyaW5zL2phdmFzY3JpcHQtYXN0YXJcclxuLy8gRnJlZWx5IGRpc3RyaWJ1dGFibGUgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4vLyBJbXBsZW1lbnRzIHRoZSBhc3RhciBzZWFyY2ggYWxnb3JpdGhtIGluIGphdmFzY3JpcHQgdXNpbmcgYSBCaW5hcnkgSGVhcC5cclxuLy8gSW5jbHVkZXMgQmluYXJ5IEhlYXAgKHdpdGggbW9kaWZpY2F0aW9ucykgZnJvbSBNYXJpam4gSGF2ZXJiZWtlLlxyXG4vLyBodHRwOi8vZWxvcXVlbnRqYXZhc2NyaXB0Lm5ldC9hcHBlbmRpeDIuaHRtbFxyXG5cclxuKGZ1bmN0aW9uKGRlZmluaXRpb24pIHtcclxuICAgIC8qIGdsb2JhbCBtb2R1bGUsIGRlZmluZSAqL1xyXG4gICAgaWYodHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZS5leHBvcnRzID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgIG1vZHVsZS5leHBvcnRzID0gZGVmaW5pdGlvbigpO1xyXG4gICAgfSBlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xyXG4gICAgICAgIGRlZmluZShbXSwgZGVmaW5pdGlvbik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHZhciBleHBvcnRzID0gZGVmaW5pdGlvbigpO1xyXG4gICAgICAgIHdpbmRvdy5hc3RhciA9IGV4cG9ydHMuYXN0YXI7XHJcbiAgICAgICAgd2luZG93LkdyYXBoID0gZXhwb3J0cy5HcmFwaDtcclxuICAgIH1cclxufSkoZnVuY3Rpb24oKSB7XHJcblxyXG5mdW5jdGlvbiBwYXRoVG8obm9kZSl7XHJcbiAgICB2YXIgY3VyciA9IG5vZGUsXHJcbiAgICAgICAgcGF0aCA9IFtdO1xyXG4gICAgd2hpbGUoY3Vyci5wYXJlbnQpIHtcclxuICAgICAgICBwYXRoLnB1c2goY3Vycik7XHJcbiAgICAgICAgY3VyciA9IGN1cnIucGFyZW50O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHBhdGgucmV2ZXJzZSgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRIZWFwKCkge1xyXG4gICAgcmV0dXJuIG5ldyBCaW5hcnlIZWFwKGZ1bmN0aW9uKG5vZGUpIHtcclxuICAgICAgICByZXR1cm4gbm9kZS5mO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbnZhciBhc3RhciA9IHtcclxuICAgIC8qKlxyXG4gICAgKiBQZXJmb3JtIGFuIEEqIFNlYXJjaCBvbiBhIGdyYXBoIGdpdmVuIGEgc3RhcnQgYW5kIGVuZCBub2RlLlxyXG4gICAgKiBAcGFyYW0ge0dyYXBofSBncmFwaFxyXG4gICAgKiBAcGFyYW0ge0dyaWROb2RlfSBzdGFydFxyXG4gICAgKiBAcGFyYW0ge0dyaWROb2RlfSBlbmRcclxuICAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXVxyXG4gICAgKiBAcGFyYW0ge2Jvb2x9IFtvcHRpb25zLmNsb3Nlc3RdIFNwZWNpZmllcyB3aGV0aGVyIHRvIHJldHVybiB0aGVcclxuICAgICAgICAgICAgICAgcGF0aCB0byB0aGUgY2xvc2VzdCBub2RlIGlmIHRoZSB0YXJnZXQgaXMgdW5yZWFjaGFibGUuXHJcbiAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtvcHRpb25zLmhldXJpc3RpY10gSGV1cmlzdGljIGZ1bmN0aW9uIChzZWVcclxuICAgICogICAgICAgICAgYXN0YXIuaGV1cmlzdGljcykuXHJcbiAgICAqL1xyXG4gICAgc2VhcmNoOiBmdW5jdGlvbihncmFwaCwgc3RhcnQsIGVuZCwgb3B0aW9ucykge1xyXG4gICAgICAgIGdyYXBoLmNsZWFuRGlydHkoKTtcclxuICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcclxuICAgICAgICB2YXIgaGV1cmlzdGljID0gb3B0aW9ucy5oZXVyaXN0aWMgfHwgYXN0YXIuaGV1cmlzdGljcy5tYW5oYXR0YW4sXHJcbiAgICAgICAgICAgIGNsb3Nlc3QgPSBvcHRpb25zLmNsb3Nlc3QgfHwgZmFsc2U7XHJcblxyXG4gICAgICAgIHZhciBvcGVuSGVhcCA9IGdldEhlYXAoKSxcclxuICAgICAgICAgICAgY2xvc2VzdE5vZGUgPSBzdGFydDsgLy8gc2V0IHRoZSBzdGFydCBub2RlIHRvIGJlIHRoZSBjbG9zZXN0IGlmIHJlcXVpcmVkXHJcblxyXG4gICAgICAgIHN0YXJ0LmggPSBoZXVyaXN0aWMoc3RhcnQsIGVuZCk7XHJcblxyXG4gICAgICAgIG9wZW5IZWFwLnB1c2goc3RhcnQpO1xyXG5cclxuICAgICAgICB3aGlsZShvcGVuSGVhcC5zaXplKCkgPiAwKSB7XHJcblxyXG4gICAgICAgICAgICAvLyBHcmFiIHRoZSBsb3dlc3QgZih4KSB0byBwcm9jZXNzIG5leHQuICBIZWFwIGtlZXBzIHRoaXMgc29ydGVkIGZvciB1cy5cclxuICAgICAgICAgICAgdmFyIGN1cnJlbnROb2RlID0gb3BlbkhlYXAucG9wKCk7XHJcblxyXG4gICAgICAgICAgICAvLyBFbmQgY2FzZSAtLSByZXN1bHQgaGFzIGJlZW4gZm91bmQsIHJldHVybiB0aGUgdHJhY2VkIHBhdGguXHJcbiAgICAgICAgICAgIGlmKGN1cnJlbnROb2RlID09PSBlbmQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBwYXRoVG8oY3VycmVudE5vZGUpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBOb3JtYWwgY2FzZSAtLSBtb3ZlIGN1cnJlbnROb2RlIGZyb20gb3BlbiB0byBjbG9zZWQsIHByb2Nlc3MgZWFjaCBvZiBpdHMgbmVpZ2hib3JzLlxyXG4gICAgICAgICAgICBjdXJyZW50Tm9kZS5jbG9zZWQgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgLy8gRmluZCBhbGwgbmVpZ2hib3JzIGZvciB0aGUgY3VycmVudCBub2RlLlxyXG4gICAgICAgICAgICB2YXIgbmVpZ2hib3JzID0gZ3JhcGgubmVpZ2hib3JzKGN1cnJlbnROb2RlKTtcclxuXHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBpbCA9IG5laWdoYm9ycy5sZW5ndGg7IGkgPCBpbDsgKytpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbmVpZ2hib3IgPSBuZWlnaGJvcnNbaV07XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKG5laWdoYm9yLmNsb3NlZCB8fCBuZWlnaGJvci5pc1dhbGwoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIE5vdCBhIHZhbGlkIG5vZGUgdG8gcHJvY2Vzcywgc2tpcCB0byBuZXh0IG5laWdoYm9yLlxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8vIFRoZSBnIHNjb3JlIGlzIHRoZSBzaG9ydGVzdCBkaXN0YW5jZSBmcm9tIHN0YXJ0IHRvIGN1cnJlbnQgbm9kZS5cclxuICAgICAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gY2hlY2sgaWYgdGhlIHBhdGggd2UgaGF2ZSBhcnJpdmVkIGF0IHRoaXMgbmVpZ2hib3IgaXMgdGhlIHNob3J0ZXN0IG9uZSB3ZSBoYXZlIHNlZW4geWV0LlxyXG4gICAgICAgICAgICAgICAgdmFyIGdTY29yZSA9IGN1cnJlbnROb2RlLmcgKyBuZWlnaGJvci5nZXRDb3N0KGN1cnJlbnROb2RlKSxcclxuICAgICAgICAgICAgICAgICAgICBiZWVuVmlzaXRlZCA9IG5laWdoYm9yLnZpc2l0ZWQ7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCFiZWVuVmlzaXRlZCB8fCBnU2NvcmUgPCBuZWlnaGJvci5nKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIEZvdW5kIGFuIG9wdGltYWwgKHNvIGZhcikgcGF0aCB0byB0aGlzIG5vZGUuICBUYWtlIHNjb3JlIGZvciBub2RlIHRvIHNlZSBob3cgZ29vZCBpdCBpcy5cclxuICAgICAgICAgICAgICAgICAgICBuZWlnaGJvci52aXNpdGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBuZWlnaGJvci5wYXJlbnQgPSBjdXJyZW50Tm9kZTtcclxuICAgICAgICAgICAgICAgICAgICBuZWlnaGJvci5oID0gbmVpZ2hib3IuaCB8fCBoZXVyaXN0aWMobmVpZ2hib3IsIGVuZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbmVpZ2hib3IuZyA9IGdTY29yZTtcclxuICAgICAgICAgICAgICAgICAgICBuZWlnaGJvci5mID0gbmVpZ2hib3IuZyArIG5laWdoYm9yLmg7XHJcbiAgICAgICAgICAgICAgICAgICAgZ3JhcGgubWFya0RpcnR5KG5laWdoYm9yKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY2xvc2VzdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgbmVpZ2hib3VyIGlzIGNsb3NlciB0aGFuIHRoZSBjdXJyZW50IGNsb3Nlc3ROb2RlIG9yIGlmIGl0J3MgZXF1YWxseSBjbG9zZSBidXQgaGFzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGEgY2hlYXBlciBwYXRoIHRoYW4gdGhlIGN1cnJlbnQgY2xvc2VzdCBub2RlIHRoZW4gaXQgYmVjb21lcyB0aGUgY2xvc2VzdCBub2RlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZWlnaGJvci5oIDwgY2xvc2VzdE5vZGUuaCB8fCAobmVpZ2hib3IuaCA9PT0gY2xvc2VzdE5vZGUuaCAmJiBuZWlnaGJvci5nIDwgY2xvc2VzdE5vZGUuZykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb3Nlc3ROb2RlID0gbmVpZ2hib3I7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghYmVlblZpc2l0ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUHVzaGluZyB0byBoZWFwIHdpbGwgcHV0IGl0IGluIHByb3BlciBwbGFjZSBiYXNlZCBvbiB0aGUgJ2YnIHZhbHVlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvcGVuSGVhcC5wdXNoKG5laWdoYm9yKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFscmVhZHkgc2VlbiB0aGUgbm9kZSwgYnV0IHNpbmNlIGl0IGhhcyBiZWVuIHJlc2NvcmVkIHdlIG5lZWQgdG8gcmVvcmRlciBpdCBpbiB0aGUgaGVhcFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvcGVuSGVhcC5yZXNjb3JlRWxlbWVudChuZWlnaGJvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoY2xvc2VzdCkge1xyXG4gICAgICAgICAgICByZXR1cm4gcGF0aFRvKGNsb3Nlc3ROb2RlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIE5vIHJlc3VsdCB3YXMgZm91bmQgLSBlbXB0eSBhcnJheSBzaWduaWZpZXMgZmFpbHVyZSB0byBmaW5kIHBhdGguXHJcbiAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfSxcclxuICAgIC8vIFNlZSBsaXN0IG9mIGhldXJpc3RpY3M6IGh0dHA6Ly90aGVvcnkuc3RhbmZvcmQuZWR1L35hbWl0cC9HYW1lUHJvZ3JhbW1pbmcvSGV1cmlzdGljcy5odG1sXHJcbiAgICBoZXVyaXN0aWNzOiB7XHJcbiAgICAgICAgbWFuaGF0dGFuOiBmdW5jdGlvbihwb3MwLCBwb3MxKSB7XHJcbiAgICAgICAgICAgIHZhciBkMSA9IE1hdGguYWJzKHBvczEueCAtIHBvczAueCk7XHJcbiAgICAgICAgICAgIHZhciBkMiA9IE1hdGguYWJzKHBvczEueSAtIHBvczAueSk7XHJcbiAgICAgICAgICAgIHJldHVybiBkMSArIGQyO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZGlhZ29uYWw6IGZ1bmN0aW9uKHBvczAsIHBvczEpIHtcclxuICAgICAgICAgICAgdmFyIEQgPSAxO1xyXG4gICAgICAgICAgICB2YXIgRDIgPSBNYXRoLnNxcnQoMik7XHJcbiAgICAgICAgICAgIHZhciBkMSA9IE1hdGguYWJzKHBvczEueCAtIHBvczAueCk7XHJcbiAgICAgICAgICAgIHZhciBkMiA9IE1hdGguYWJzKHBvczEueSAtIHBvczAueSk7XHJcbiAgICAgICAgICAgIHJldHVybiAoRCAqIChkMSArIGQyKSkgKyAoKEQyIC0gKDIgKiBEKSkgKiBNYXRoLm1pbihkMSwgZDIpKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgY2xlYW5Ob2RlOmZ1bmN0aW9uKG5vZGUpe1xyXG4gICAgICAgIG5vZGUuZiA9IDA7XHJcbiAgICAgICAgbm9kZS5nID0gMDtcclxuICAgICAgICBub2RlLmggPSAwO1xyXG4gICAgICAgIG5vZGUudmlzaXRlZCA9IGZhbHNlO1xyXG4gICAgICAgIG5vZGUuY2xvc2VkID0gZmFsc2U7XHJcbiAgICAgICAgbm9kZS5wYXJlbnQgPSBudWxsO1xyXG4gICAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiogQSBncmFwaCBtZW1vcnkgc3RydWN0dXJlXHJcbiogQHBhcmFtIHtBcnJheX0gZ3JpZEluIDJEIGFycmF5IG9mIGlucHV0IHdlaWdodHNcclxuKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdXHJcbiogQHBhcmFtIHtib29sfSBbb3B0aW9ucy5kaWFnb25hbF0gU3BlY2lmaWVzIHdoZXRoZXIgZGlhZ29uYWwgbW92ZXMgYXJlIGFsbG93ZWRcclxuKi9cclxuZnVuY3Rpb24gR3JhcGgoZ3JpZEluLCBvcHRpb25zKSB7XHJcbiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcclxuICAgIHRoaXMubm9kZXMgPSBbXTtcclxuICAgIHRoaXMuZGlhZ29uYWwgPSAhIW9wdGlvbnMuZGlhZ29uYWw7XHJcbiAgICB0aGlzLmdyaWQgPSBbXTtcclxuICAgIGZvciAodmFyIHggPSAwOyB4IDwgZ3JpZEluLmxlbmd0aDsgeCsrKSB7XHJcbiAgICAgICAgdGhpcy5ncmlkW3hdID0gW107XHJcblxyXG4gICAgICAgIGZvciAodmFyIHkgPSAwLCByb3cgPSBncmlkSW5beF07IHkgPCByb3cubGVuZ3RoOyB5KyspIHtcclxuICAgICAgICAgICAgdmFyIG5vZGUgPSBuZXcgR3JpZE5vZGUoeCwgeSwgcm93W3ldKTtcclxuICAgICAgICAgICAgdGhpcy5ncmlkW3hdW3ldID0gbm9kZTtcclxuICAgICAgICAgICAgdGhpcy5ub2Rlcy5wdXNoKG5vZGUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHRoaXMuaW5pdCgpO1xyXG59XHJcblxyXG5HcmFwaC5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdGhpcy5kaXJ0eU5vZGVzID0gW107XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubm9kZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBhc3Rhci5jbGVhbk5vZGUodGhpcy5ub2Rlc1tpXSk7XHJcbiAgICB9XHJcbn07XHJcblxyXG5HcmFwaC5wcm90b3R5cGUuY2xlYW5EaXJ0eSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmRpcnR5Tm9kZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBhc3Rhci5jbGVhbk5vZGUodGhpcy5kaXJ0eU5vZGVzW2ldKTtcclxuICAgIH1cclxuICAgIHRoaXMuZGlydHlOb2RlcyA9IFtdO1xyXG59O1xyXG5cclxuR3JhcGgucHJvdG90eXBlLm1hcmtEaXJ0eSA9IGZ1bmN0aW9uKG5vZGUpIHtcclxuICAgIHRoaXMuZGlydHlOb2Rlcy5wdXNoKG5vZGUpO1xyXG59O1xyXG5cclxuR3JhcGgucHJvdG90eXBlLm5laWdoYm9ycyA9IGZ1bmN0aW9uKG5vZGUpIHtcclxuICAgIHZhciByZXQgPSBbXSxcclxuICAgICAgICB4ID0gbm9kZS54LFxyXG4gICAgICAgIHkgPSBub2RlLnksXHJcbiAgICAgICAgZ3JpZCA9IHRoaXMuZ3JpZDtcclxuXHJcbiAgICAvLyBXZXN0XHJcbiAgICBpZihncmlkW3gtMV0gJiYgZ3JpZFt4LTFdW3ldKSB7XHJcbiAgICAgICAgcmV0LnB1c2goZ3JpZFt4LTFdW3ldKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBFYXN0XHJcbiAgICBpZihncmlkW3grMV0gJiYgZ3JpZFt4KzFdW3ldKSB7XHJcbiAgICAgICAgcmV0LnB1c2goZ3JpZFt4KzFdW3ldKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBTb3V0aFxyXG4gICAgaWYoZ3JpZFt4XSAmJiBncmlkW3hdW3ktMV0pIHtcclxuICAgICAgICByZXQucHVzaChncmlkW3hdW3ktMV0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIE5vcnRoXHJcbiAgICBpZihncmlkW3hdICYmIGdyaWRbeF1beSsxXSkge1xyXG4gICAgICAgIHJldC5wdXNoKGdyaWRbeF1beSsxXSk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHRoaXMuZGlhZ29uYWwpIHtcclxuICAgICAgICAvLyBTb3V0aHdlc3RcclxuICAgICAgICBpZihncmlkW3gtMV0gJiYgZ3JpZFt4LTFdW3ktMV0pIHtcclxuICAgICAgICAgICAgcmV0LnB1c2goZ3JpZFt4LTFdW3ktMV0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gU291dGhlYXN0XHJcbiAgICAgICAgaWYoZ3JpZFt4KzFdICYmIGdyaWRbeCsxXVt5LTFdKSB7XHJcbiAgICAgICAgICAgIHJldC5wdXNoKGdyaWRbeCsxXVt5LTFdKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIE5vcnRod2VzdFxyXG4gICAgICAgIGlmKGdyaWRbeC0xXSAmJiBncmlkW3gtMV1beSsxXSkge1xyXG4gICAgICAgICAgICByZXQucHVzaChncmlkW3gtMV1beSsxXSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBOb3J0aGVhc3RcclxuICAgICAgICBpZihncmlkW3grMV0gJiYgZ3JpZFt4KzFdW3krMV0pIHtcclxuICAgICAgICAgICAgcmV0LnB1c2goZ3JpZFt4KzFdW3krMV0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gcmV0O1xyXG59O1xyXG5cclxuR3JhcGgucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgZ3JhcGhTdHJpbmcgPSBbXSxcclxuICAgICAgICBub2RlcyA9IHRoaXMuZ3JpZCwgLy8gd2hlbiB1c2luZyBncmlkXHJcbiAgICAgICAgcm93RGVidWcsIHJvdywgeSwgbDtcclxuICAgIGZvciAodmFyIHggPSAwLCBsZW4gPSBub2Rlcy5sZW5ndGg7IHggPCBsZW47IHgrKykge1xyXG4gICAgICAgIHJvd0RlYnVnID0gW107XHJcbiAgICAgICAgcm93ID0gbm9kZXNbeF07XHJcbiAgICAgICAgZm9yICh5ID0gMCwgbCA9IHJvdy5sZW5ndGg7IHkgPCBsOyB5KyspIHtcclxuICAgICAgICAgICAgcm93RGVidWcucHVzaChyb3dbeV0ud2VpZ2h0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZ3JhcGhTdHJpbmcucHVzaChyb3dEZWJ1Zy5qb2luKCcgJykpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGdyYXBoU3RyaW5nLmpvaW4oJ1xcbicpO1xyXG59O1xyXG5cclxuZnVuY3Rpb24gR3JpZE5vZGUoeCwgeSwgd2VpZ2h0KSB7XHJcbiAgICB0aGlzLnggPSB4O1xyXG4gICAgdGhpcy55ID0geTtcclxuICAgIHRoaXMud2VpZ2h0ID0gd2VpZ2h0O1xyXG59XHJcblxyXG5HcmlkTm9kZS5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiAnWycgKyB0aGlzLnggKyAnICcgKyB0aGlzLnkgKyAnXSc7XHJcbn07XHJcblxyXG5HcmlkTm9kZS5wcm90b3R5cGUuZ2V0Q29zdCA9IGZ1bmN0aW9uKGZyb21OZWlnaGJvcikge1xyXG4gICAgLy8gVGFrZSBkaWFnb25hbCB3ZWlnaHQgaW50byBjb25zaWRlcmF0aW9uLlxyXG4gICAgaWYgKGZyb21OZWlnaGJvciAmJiBmcm9tTmVpZ2hib3IueCAhPT0gdGhpcy54ICYmIGZyb21OZWlnaGJvci55ICE9PSB0aGlzLnkpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy53ZWlnaHQgKiAxLjQxNDIxO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRoaXMud2VpZ2h0O1xyXG59O1xyXG5cclxuR3JpZE5vZGUucHJvdG90eXBlLmlzV2FsbCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIHRoaXMud2VpZ2h0ID09PSAwO1xyXG59O1xyXG5cclxuZnVuY3Rpb24gQmluYXJ5SGVhcChzY29yZUZ1bmN0aW9uKXtcclxuICAgIHRoaXMuY29udGVudCA9IFtdO1xyXG4gICAgdGhpcy5zY29yZUZ1bmN0aW9uID0gc2NvcmVGdW5jdGlvbjtcclxufVxyXG5cclxuQmluYXJ5SGVhcC5wcm90b3R5cGUgPSB7XHJcbiAgICBwdXNoOiBmdW5jdGlvbihlbGVtZW50KSB7XHJcbiAgICAgICAgLy8gQWRkIHRoZSBuZXcgZWxlbWVudCB0byB0aGUgZW5kIG9mIHRoZSBhcnJheS5cclxuICAgICAgICB0aGlzLmNvbnRlbnQucHVzaChlbGVtZW50KTtcclxuXHJcbiAgICAgICAgLy8gQWxsb3cgaXQgdG8gc2luayBkb3duLlxyXG4gICAgICAgIHRoaXMuc2lua0Rvd24odGhpcy5jb250ZW50Lmxlbmd0aCAtIDEpO1xyXG4gICAgfSxcclxuICAgIHBvcDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgLy8gU3RvcmUgdGhlIGZpcnN0IGVsZW1lbnQgc28gd2UgY2FuIHJldHVybiBpdCBsYXRlci5cclxuICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5jb250ZW50WzBdO1xyXG4gICAgICAgIC8vIEdldCB0aGUgZWxlbWVudCBhdCB0aGUgZW5kIG9mIHRoZSBhcnJheS5cclxuICAgICAgICB2YXIgZW5kID0gdGhpcy5jb250ZW50LnBvcCgpO1xyXG4gICAgICAgIC8vIElmIHRoZXJlIGFyZSBhbnkgZWxlbWVudHMgbGVmdCwgcHV0IHRoZSBlbmQgZWxlbWVudCBhdCB0aGVcclxuICAgICAgICAvLyBzdGFydCwgYW5kIGxldCBpdCBidWJibGUgdXAuXHJcbiAgICAgICAgaWYgKHRoaXMuY29udGVudC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGVudFswXSA9IGVuZDtcclxuICAgICAgICAgICAgdGhpcy5idWJibGVVcCgwKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH0sXHJcbiAgICByZW1vdmU6IGZ1bmN0aW9uKG5vZGUpIHtcclxuICAgICAgICB2YXIgaSA9IHRoaXMuY29udGVudC5pbmRleE9mKG5vZGUpO1xyXG5cclxuICAgICAgICAvLyBXaGVuIGl0IGlzIGZvdW5kLCB0aGUgcHJvY2VzcyBzZWVuIGluICdwb3AnIGlzIHJlcGVhdGVkXHJcbiAgICAgICAgLy8gdG8gZmlsbCB1cCB0aGUgaG9sZS5cclxuICAgICAgICB2YXIgZW5kID0gdGhpcy5jb250ZW50LnBvcCgpO1xyXG5cclxuICAgICAgICBpZiAoaSAhPT0gdGhpcy5jb250ZW50Lmxlbmd0aCAtIDEpIHtcclxuICAgICAgICAgICAgdGhpcy5jb250ZW50W2ldID0gZW5kO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMuc2NvcmVGdW5jdGlvbihlbmQpIDwgdGhpcy5zY29yZUZ1bmN0aW9uKG5vZGUpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNpbmtEb3duKGkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5idWJibGVVcChpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBzaXplOiBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb250ZW50Lmxlbmd0aDtcclxuICAgIH0sXHJcbiAgICByZXNjb3JlRWxlbWVudDogZnVuY3Rpb24obm9kZSkge1xyXG4gICAgICAgIHRoaXMuc2lua0Rvd24odGhpcy5jb250ZW50LmluZGV4T2Yobm9kZSkpO1xyXG4gICAgfSxcclxuICAgIHNpbmtEb3duOiBmdW5jdGlvbihuKSB7XHJcbiAgICAgICAgLy8gRmV0Y2ggdGhlIGVsZW1lbnQgdGhhdCBoYXMgdG8gYmUgc3Vuay5cclxuICAgICAgICB2YXIgZWxlbWVudCA9IHRoaXMuY29udGVudFtuXTtcclxuXHJcbiAgICAgICAgLy8gV2hlbiBhdCAwLCBhbiBlbGVtZW50IGNhbiBub3Qgc2luayBhbnkgZnVydGhlci5cclxuICAgICAgICB3aGlsZSAobiA+IDApIHtcclxuXHJcbiAgICAgICAgICAgIC8vIENvbXB1dGUgdGhlIHBhcmVudCBlbGVtZW50J3MgaW5kZXgsIGFuZCBmZXRjaCBpdC5cclxuICAgICAgICAgICAgdmFyIHBhcmVudE4gPSAoKG4gKyAxKSA+PiAxKSAtIDEsIHBhcmVudCA9IHRoaXMuY29udGVudFtwYXJlbnROXTsgLy8ganNoaW50IGlnbm9yZTpsaW5lXHJcbiAgICAgICAgICAgIC8vIFN3YXAgdGhlIGVsZW1lbnRzIGlmIHRoZSBwYXJlbnQgaXMgZ3JlYXRlci5cclxuICAgICAgICAgICAgaWYgKHRoaXMuc2NvcmVGdW5jdGlvbihlbGVtZW50KSA8IHRoaXMuc2NvcmVGdW5jdGlvbihwYXJlbnQpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRlbnRbcGFyZW50Tl0gPSBlbGVtZW50O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb250ZW50W25dID0gcGFyZW50O1xyXG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlICduJyB0byBjb250aW51ZSBhdCB0aGUgbmV3IHBvc2l0aW9uLlxyXG4gICAgICAgICAgICAgICAgbiA9IHBhcmVudE47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gRm91bmQgYSBwYXJlbnQgdGhhdCBpcyBsZXNzLCBubyBuZWVkIHRvIHNpbmsgYW55IGZ1cnRoZXIuXHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgYnViYmxlVXA6IGZ1bmN0aW9uKG4pIHtcclxuICAgICAgICAvLyBMb29rIHVwIHRoZSB0YXJnZXQgZWxlbWVudCBhbmQgaXRzIHNjb3JlLlxyXG4gICAgICAgIHZhciBsZW5ndGggPSB0aGlzLmNvbnRlbnQubGVuZ3RoLFxyXG4gICAgICAgICAgICBlbGVtZW50ID0gdGhpcy5jb250ZW50W25dLFxyXG4gICAgICAgICAgICBlbGVtU2NvcmUgPSB0aGlzLnNjb3JlRnVuY3Rpb24oZWxlbWVudCk7XHJcblxyXG4gICAgICAgIHdoaWxlKHRydWUpIHtcclxuICAgICAgICAgICAgLy8gQ29tcHV0ZSB0aGUgaW5kaWNlcyBvZiB0aGUgY2hpbGQgZWxlbWVudHMuXHJcbiAgICAgICAgICAgIHZhciBjaGlsZDJOID0gKG4gKyAxKSA8PCAxLCBjaGlsZDFOID0gY2hpbGQyTiAtIDE7IC8vIGpzaGludCBpZ25vcmU6bGluZVxyXG4gICAgICAgICAgICAvLyBUaGlzIGlzIHVzZWQgdG8gc3RvcmUgdGhlIG5ldyBwb3NpdGlvbiBvZiB0aGUgZWxlbWVudCwgaWYgYW55LlxyXG4gICAgICAgICAgICB2YXIgc3dhcCA9IG51bGwsXHJcbiAgICAgICAgICAgICAgICBjaGlsZDFTY29yZTtcclxuICAgICAgICAgICAgLy8gSWYgdGhlIGZpcnN0IGNoaWxkIGV4aXN0cyAoaXMgaW5zaWRlIHRoZSBhcnJheSkuLi5cclxuICAgICAgICAgICAgaWYgKGNoaWxkMU4gPCBsZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIC8vIExvb2sgaXQgdXAgYW5kIGNvbXB1dGUgaXRzIHNjb3JlLlxyXG4gICAgICAgICAgICAgICAgdmFyIGNoaWxkMSA9IHRoaXMuY29udGVudFtjaGlsZDFOXTtcclxuICAgICAgICAgICAgICAgIGNoaWxkMVNjb3JlID0gdGhpcy5zY29yZUZ1bmN0aW9uKGNoaWxkMSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlIHNjb3JlIGlzIGxlc3MgdGhhbiBvdXIgZWxlbWVudCdzLCB3ZSBuZWVkIHRvIHN3YXAuXHJcbiAgICAgICAgICAgICAgICBpZiAoY2hpbGQxU2NvcmUgPCBlbGVtU2NvcmUpe1xyXG4gICAgICAgICAgICAgICAgICAgIHN3YXAgPSBjaGlsZDFOO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBEbyB0aGUgc2FtZSBjaGVja3MgZm9yIHRoZSBvdGhlciBjaGlsZC5cclxuICAgICAgICAgICAgaWYgKGNoaWxkMk4gPCBsZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBjaGlsZDIgPSB0aGlzLmNvbnRlbnRbY2hpbGQyTl0sXHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGQyU2NvcmUgPSB0aGlzLnNjb3JlRnVuY3Rpb24oY2hpbGQyKTtcclxuICAgICAgICAgICAgICAgIGlmIChjaGlsZDJTY29yZSA8IChzd2FwID09PSBudWxsID8gZWxlbVNjb3JlIDogY2hpbGQxU2NvcmUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3dhcCA9IGNoaWxkMk47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIElmIHRoZSBlbGVtZW50IG5lZWRzIHRvIGJlIG1vdmVkLCBzd2FwIGl0LCBhbmQgY29udGludWUuXHJcbiAgICAgICAgICAgIGlmIChzd2FwICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRlbnRbbl0gPSB0aGlzLmNvbnRlbnRbc3dhcF07XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRlbnRbc3dhcF0gPSBlbGVtZW50O1xyXG4gICAgICAgICAgICAgICAgbiA9IHN3YXA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gT3RoZXJ3aXNlLCB3ZSBhcmUgZG9uZS5cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuXHJcbnJldHVybiB7XHJcbiAgICBhc3RhcjogYXN0YXIsXHJcbiAgICBHcmFwaDogR3JhcGhcclxufTtcclxuXHJcbn0pO1xyXG4iLCJ2YXIgQm9vdCA9IGZ1bmN0aW9uICgpIHt9O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBCb290O1xyXG5cclxuQm9vdC5wcm90b3R5cGUgPSB7XHJcblxyXG4gIHByZWxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMubG9hZC5pbWFnZSgncHJlbG9hZGVyJywgJ2Fzc2V0cy9pbWFnZXMvcHJlbG9hZGVyLmdpZicpO1xyXG4gIH0sXHJcblxyXG4gIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5nYW1lLmlucHV0Lm1heFBvaW50ZXJzID0gMTtcclxuXHJcbiAgICBpZiAodGhpcy5nYW1lLmRldmljZS5kZXNrdG9wKSB7XHJcbiAgICAgIC8vdGhpcy5nYW1lLnN0YWdlLnNjYWxlLnBhZ2VBbGlnbkhvcml6b250YWxseSA9IHRydWU7XHJcbiAgICAgIHRoaXMuZ2FtZS5zY2FsZS5zY2FsZU1vZGUgPSBQaGFzZXIuU2NhbGVNYW5hZ2VyLlJFU0laRTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuZ2FtZS5zY2FsZS5zY2FsZU1vZGUgPSBQaGFzZXIuU2NhbGVNYW5hZ2VyLlNIT1dfQUxMO1xyXG4gICAgICB0aGlzLmdhbWUuc2NhbGUubWluV2lkdGggPSAgNDgwO1xyXG4gICAgICB0aGlzLmdhbWUuc2NhbGUubWluSGVpZ2h0ID0gMjYwO1xyXG4gICAgICB0aGlzLmdhbWUuc2NhbGUubWF4V2lkdGggPSA2NDA7XHJcbiAgICAgIHRoaXMuZ2FtZS5zY2FsZS5tYXhIZWlnaHQgPSA0ODA7XHJcbiAgICAgIHRoaXMuZ2FtZS5zY2FsZS5mb3JjZUxhbmRzY2FwZSA9IHRydWU7XHJcbiAgICAgIHRoaXMuZ2FtZS5zY2FsZS5wYWdlQWxpZ25Ib3Jpem9udGFsbHkgPSB0cnVlO1xyXG4gICAgICB0aGlzLmdhbWUuc2NhbGUuc2V0U2NyZWVuU2l6ZSh0cnVlKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQoJ1ByZWxvYWRlcicpO1xyXG4gIH1cclxufTtcclxuIiwiLypcclxuTWFpbiB0ZXN0aW5nIGVudmlyb25tZW50LlxyXG4qL1xyXG5cclxudmFyIFJlbmRlcmFibGVzID0gcmVxdWlyZSgnLi4vZnVuY3Rpb25BY2Nlc3MvUmVuZGVyYWJsZXMnKTtcclxudmFyIFVJQnVpbGRlciA9IHJlcXVpcmUoJy4uL3VpL1VJQnVpbGRlcicpO1xyXG4vLyB2YXIgQ3ViZSA9IHJlcXVpcmUoJy4uL2VudGl0aWVzL2N1YmUnKTtcclxudmFyIE1vZHVsZUJ1aWxkZXIgPSByZXF1aXJlKCcuLi9lbnRpdGllcy9Nb2R1bGVCdWlsZGVyJyk7XHJcbi8vIHZhciBVdGlscyA9IHJlcXVpcmUoJy4uL3V0aWxzJyk7XHJcbnZhciBDdWJlR3JvdXAgPSByZXF1aXJlKCcuLi9lbnRpdGllcy9jdWJlX2dyb3VwJyk7XHJcbnZhciBIYWNrYWJsZSA9IHJlcXVpcmUoJy4uL2VudGl0aWVzL0hhY2thYmxlJyk7XHJcbnZhciBFbWl0dGVyID0gcmVxdWlyZSgnLi4vZWZmZWN0cy9FbWl0dGVyJyk7XHJcbi8vIHZhciBtb3VzZUJvZHk7IC8vIHBoeXNpY3MgYm9keSBmb3IgbW91c2VcclxudmFyIE1vdXNlID0gcmVxdWlyZSgnLi4vZW50aXRpZXMvbW91c2UnKTtcclxudmFyIEJ1bGxldCA9IHJlcXVpcmUoJy4uL2VudGl0aWVzL0J1bGxldCcpO1xyXG5cclxudmFyIGJnLCBiZzI7XHJcbnZhciBudW1Sb2lkcztcclxudmFyIG1heFJvaWRzID0gMTAwO1xyXG52YXIgbmV3TW9kdWxlU3BlZWQgPSAxMDAwO1xyXG52YXIgYXN0ZXJvaWRzLCBhc3Rlcm9pZExpc3Q7XHJcbnZhciBsZWZ0S2V5LCByaWdodEtleSwgY3dLZXksIGNjd0tleTtcclxudmFyIHdhcm5pbmc7XHJcbnZhciB0aW1lcjtcclxudmFyIHNob3BQYW5lbCwgc2hvcE1lbnVPcGVuaW5nID0gZmFsc2UsIHNob3BNZW51Q2xvc2luZyA9IGZhbHNlO1xyXG52YXIgZGlmZjtcclxudmFyIHNoaWVsZEJ1dHRvbiwgc29sYXJQYW5lbEJ1dHRvbiwgdGhydXN0ZXJCdXR0b24sIGd1bkJ1dHRvbiwgaGFja0J1dHRvbjtcclxuXHJcbnZhciBHYW1lID0gZnVuY3Rpb24gKCkge1xyXG4gIHRoaXMudGVzdGVudGl0eSA9IG51bGw7XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEdhbWU7XHJcblxyXG5HYW1lLnByb3RvdHlwZSA9IHtcclxuXHRcclxuICBjcmVhdGU6IGZ1bmN0aW9uICgpIHtcclxuXHR0aGlzLmdhbWUud29ybGQuc2V0Qm91bmRzKDAsIDAsIDgwMDAsIDQwMDApO1xyXG5cdFxyXG5cdG51bVJvaWRzID0gMDtcclxuXHRkaWZmID0gMDtcclxuXHR0aGlzLm1vbmV5ID0gNTAwO1xyXG5cdFxyXG5cdC8vQ3JlYXRlIHRoZSB0d28gYmFja2dyb3VuZCBpbWFnZXNcclxuICAgIGJnID0gdGhpcy5nYW1lLmFkZC5zcHJpdGUoMCwgMCwgJ2VhcnRoTmlnaHQnKTtcclxuXHRiZzIgPSB0aGlzLmdhbWUuYWRkLnNwcml0ZSgtODAwMCwgMCwgJ2VhcnRoTmlnaHQnKTtcclxuXHRcclxuXHQvL0xvYWQgaW4gc291bmQgZWZmZWN0c1xyXG5cdHRoaXMuaG92ZXJDbGljayA9IHRoaXMuZ2FtZS5hZGQuYXVkaW8oJ2hvdmVyQ2xpY2snKTtcclxuXHR0aGlzLmRvd25DbGljayA9IHRoaXMuZ2FtZS5hZGQuYXVkaW8oJ2Rvd25DbGljaycpO1xyXG5cdHRoaXMuY2FzaFJlZ2lzdGVyID0gdGhpcy5nYW1lLmFkZC5hdWRpbygnY2FzaFJlZ2lzdGVyJyk7XHJcblx0dGhpcy5jYXNoUmVnaXN0ZXIuYWxsb3dNdWx0aXBsZSA9IHRydWU7XHJcblx0dGhpcy5lcnJvciA9IHRoaXMuZ2FtZS5hZGQuYXVkaW8oJ2Vycm9yJyk7XHJcblx0XHJcblx0Ly9TZXQgdXAgcGh5c2ljc1xyXG5cdHRoaXMuZ2FtZS5waHlzaWNzLnN0YXJ0U3lzdGVtKFBoYXNlci5QaHlzaWNzLlAySlMpO1xyXG5cdHRoaXMuZ2FtZS5waHlzaWNzLnAyLnNldEltcGFjdEV2ZW50cyh0cnVlKTtcclxuXHQvL2FkZCBjb2xsaXNpb24gZ3JvdXBcclxuXHR0aGlzLmNvbGxpc2lvbkdyb3VwID0gdGhpcy5nYW1lLnBoeXNpY3MucDIuY3JlYXRlQ29sbGlzaW9uR3JvdXAoKTtcclxuXHRcclxuXHRcclxuXHR0aGlzLm1vdXNlID0gbmV3IE1vdXNlKHRoaXMuZ2FtZSwgdGhpcy5pbnB1dCk7XHJcbiAgIFxyXG5cdHRoaXMudXBkYXRlRGVwZW5kZW50cyA9IFtdO1xyXG5cclxuXHQvL2NyZWF0ZSBSZW5kZXJhYmxlcyBjbGFzc1xyXG5cdHRoaXMucmVuZGVyYWJsZXMgPSBuZXcgUmVuZGVyYWJsZXMoKTtcclxuXHQvL2NyZWF0ZSB0aGUgVUlCdWlsZGVyXHJcblx0dGhpcy51aUJ1aWxkZXIgPSBuZXcgVUlCdWlsZGVyKHRoaXMsIHRoaXMucmVuZGVyYWJsZXMpOyAgIFxyXG5cdC8vY3JlYXRlIE1vZHVsZUJ1aWxkZXIgYW5kIHN0b3JlIGl0IGluIHRoaXMgZ2FtZSBzdGF0ZSBvYmplY3RcclxuXHR0aGlzLm1vZHVsZUJ1aWxkZXIgPSBuZXcgTW9kdWxlQnVpbGRlcih0aGlzKTtcclxuXHQvL2NyZWF0ZSBhbmQgc3RvcmUgdGhlIGNvcmUgbW9kdWxlXHJcblx0dGhpcy5jb3JlTW9kdWxlID0gdGhpcy5tb2R1bGVCdWlsZGVyLmJ1aWxkKCdjb3JlJywgMTIwMCwgMTIwMCwgdHJ1ZSk7XHJcblx0dGhpcy5jdWJlV2lkdGggPSB0aGlzLmNvcmVNb2R1bGUuY3ViZS53aWR0aDtcclxuXHR0aGlzLmN1YmVCdWZmZXIgPSAyO1xyXG5cdHRoaXMudGVzdFZhciA9IDc7XHJcblx0dmFyIHBsYXllckdyb3VwID0gbmV3IEN1YmVHcm91cCh0aGlzLCB0aGlzLmNvcmVNb2R1bGUuY3ViZSk7XHJcblx0dGhpcy51cGRhdGVEZXBlbmRlbnRzLnB1c2gocGxheWVyR3JvdXApO1xyXG5cdHRoaXMucGxheWVyID0gcGxheWVyR3JvdXA7XHJcblx0dGhpcy5wbGF5ZXIuaXNQbGF5ZXIgPSB0cnVlO1xyXG4gICBcclxuXHR0aGlzLm1vdXNlID0gbmV3IE1vdXNlKHRoaXMuZ2FtZSwgdGhpcy5pbnB1dCwgcGxheWVyR3JvdXApO1xyXG5cdHRoaXMucGxheWVyLmlzUGxheWVyID0gdHJ1ZTtcclxuXHRcclxuXHQvL0NyZWF0ZSB0aGUgZW1pdHRlciBmb3IgdGhlIGJpbmFyeSBwYXJ0aWNsZSBlZmZlY3RzXHJcblx0dGhpcy5CaW5hcnlFbWl0dGVyID0gbmV3IEVtaXR0ZXIodGhpcyk7XHJcblx0XHJcblx0Ly90ZXN0IGhhY2thYmxlIG9iamVjdFxyXG5cdHRoaXMudGVzdEhhY2sgPSBuZXcgSGFja2FibGUodGhpcywgMTYwMCwgMTIwMCwgJ2hhY2thYmxlMScsIDQwMCk7XHJcblx0XHJcblx0YXN0ZXJvaWRzID0gdGhpcy5nYW1lLmFkZC5ncm91cCgpO1xyXG5cdGFzdGVyb2lkcy5lbmFibGVCb2R5ID0gdHJ1ZTtcclxuXHRhc3Rlcm9pZHMucGh5c2ljc0JvZHlUeXBlID0gUGhhc2VyLlBoeXNpY3MuUDJKUztcclxuXHRhc3Rlcm9pZExpc3QgPSBuZXcgUGhhc2VyLkFycmF5U2V0KCk7XHJcblx0dGhpcy5nZW5lcmF0ZUFzdGVyb2lkcygpO1xyXG5cdFxyXG5cdHRpbWVyID0gdGhpcy5nYW1lLnRpbWUuY3JlYXRlKGZhbHNlKTtcclxuXHR3YXJuaW5nID0gdGhpcy5nYW1lLmFkZC5pbWFnZSh0aGlzLmdhbWUuY2FtZXJhLngsIHRoaXMuZ2FtZS5jYW1lcmEueSwgJ3dhcm5pbmcnKTtcclxuXHR3YXJuaW5nLmtpbGwoKTtcclxuXHRcclxuXHRsZWZ0S2V5ID0gdGhpcy5nYW1lLmlucHV0LmtleWJvYXJkLmFkZEtleShQaGFzZXIuS2V5Ym9hcmQuQSk7XHJcblx0cmlnaHRLZXkgPSB0aGlzLmdhbWUuaW5wdXQua2V5Ym9hcmQuYWRkS2V5KFBoYXNlci5LZXlib2FyZC5EKTtcclxuXHRjY3dLZXkgPSB0aGlzLmdhbWUuaW5wdXQua2V5Ym9hcmQuYWRkS2V5KFBoYXNlci5LZXlib2FyZC5RKTtcclxuXHRjd0tleSA9IHRoaXMuZ2FtZS5pbnB1dC5rZXlib2FyZC5hZGRLZXkoUGhhc2VyLktleWJvYXJkLkUpO1xyXG5cdFxyXG5cdHRoaXMuc2hvcEtleSA9IHRoaXMuZ2FtZS5pbnB1dC5rZXlib2FyZC5hZGRLZXkoUGhhc2VyLktleWJvYXJkLlIpO1xyXG5cdHRoaXMuc2hvcEtleS5vbkRvd24uYWRkKHRoaXMudXNlU2hvcEJ1dHRvbiwgdGhpcyk7XHJcblx0XHJcblx0Ly9ERUJVR0dJTkcgTElTVEVORVJTLSBhbGxvdyB5b3UgdG8gY3JlYXRlIG1vZHVsZXMgYnkgcHJlc3Npbmcga2V5c1xyXG5cdC8qIE1vZHVsZSBkZWJ1ZyBidXR0b25zIGFyZSBicm9rZW4gYW5kIG9ic29sZXRlIHdpdGggdGhlIHB1cmNoYXNpbmcgbWVudVxyXG5cdC8vY29yZVxyXG5cdHRoaXMucGxhY2VDb3JlS2V5ID0gdGhpcy5nYW1lLmlucHV0LmtleWJvYXJkLmFkZEtleShQaGFzZXIuS2V5Ym9hcmQuUCk7XHJcblx0dGhpcy5wbGFjZUNvcmVLZXkub25Eb3duLmFkZCh0aGlzLmFkZENvcmUsIHRoaXMpO1xyXG5cdC8vc2hpZWxkXHJcblx0dGhpcy5wbGFjZVNoaWVsZEtleSA9IHRoaXMuZ2FtZS5pbnB1dC5rZXlib2FyZC5hZGRLZXkoUGhhc2VyLktleWJvYXJkLk8pO1xyXG4gICAgdGhpcy5wbGFjZVNoaWVsZEtleS5vbkRvd24uYWRkKHRoaXMuYWRkU2hpZWxkLCB0aGlzKTtcclxuXHQvL3RocnVzdGVyXHJcblx0dGhpcy5wbGFjZVRocnVzdGVyS2V5ID0gdGhpcy5nYW1lLmlucHV0LmtleWJvYXJkLmFkZEtleShQaGFzZXIuS2V5Ym9hcmQuSSk7XHJcbiAgICB0aGlzLnBsYWNlVGhydXN0ZXJLZXkub25Eb3duLmFkZCh0aGlzLmFkZFRocnVzdGVyLCB0aGlzKTtcclxuXHQvL3NvbGFyUGFuZWxcclxuXHR0aGlzLnBsYWNlU1BLZXkgPSB0aGlzLmdhbWUuaW5wdXQua2V5Ym9hcmQuYWRkS2V5KFBoYXNlci5LZXlib2FyZC5VKTtcclxuICAgIHRoaXMucGxhY2VTUEtleS5vbkRvd24uYWRkKHRoaXMuYWRkU1AsIHRoaXMpO1xyXG5cdC8vaGFja2VyXHJcblx0dGhpcy5wbGFjZUhhY2tLZXkgPSB0aGlzLmdhbWUuaW5wdXQua2V5Ym9hcmQuYWRkS2V5KFBoYXNlci5LZXlib2FyZC5ZKTtcclxuXHR0aGlzLnBsYWNlSGFja0tleS5vbkRvd24uYWRkKHRoaXMuYWRkSGFjaywgdGhpcyk7XHJcblx0Ly9ndW5cclxuXHR0aGlzLnBsYWNlR3VuS2V5ID0gdGhpcy5nYW1lLmlucHV0LmtleWJvYXJkLmFkZEtleShQaGFzZXIuS2V5Ym9hcmQuVCk7XHJcbiAgICB0aGlzLnBsYWNlR3VuS2V5Lm9uRG93bi5hZGQodGhpcy5hZGRHdW4sIHRoaXMpO1xyXG5cdCovXHJcblx0Ly9yZXNldCBnYW1lXHJcblx0dGhpcy5yZXNldEtleSA9IHRoaXMuZ2FtZS5pbnB1dC5rZXlib2FyZC5hZGRLZXkoUGhhc2VyLktleWJvYXJkLk0pO1xyXG4gICAgdGhpcy5yZXNldEtleS5vbkRvd24uYWRkKHRoaXMucmVzdGFydExldmVsLCB0aGlzKTtcclxuXHQvL2FkZCBtb25leVxyXG5cdHRoaXMuYWRkTW9uZXlLZXkgPSB0aGlzLmdhbWUuaW5wdXQua2V5Ym9hcmQuYWRkS2V5KFBoYXNlci5LZXlib2FyZC5LKTtcclxuXHR0aGlzLmFkZE1vbmV5S2V5Lm9uRG93bi5hZGQodGhpcy5hZGRNb25leSwgdGhpcyk7XHJcblx0Ly9FTkRcclxuICAgIFxyXG4gICAgLy8gRGVidWcgY29udHJvbGxlclxyXG4gICAgdGhpcy5kZWJ1Z0tleSA9IHRoaXMuZ2FtZS5pbnB1dC5rZXlib2FyZC5hZGRLZXkoUGhhc2VyLktleWJvYXJkLkgpO1xyXG4gICAgdGhpcy5kZWJ1Z0tleS5vbkRvd24uYWRkKHRoaXMuZGVidWcsIHRoaXMpO1xyXG5cclxuICAgIHRoaXMubGV2ZWxEYXRhID0gSlNPTi5wYXJzZSh0aGlzLmdhbWUuY2FjaGUuZ2V0VGV4dCgnbGV2ZWxfb25lJykpO1xyXG4gICAgdGhpcy5sb2FkRGF0YSgpO1xyXG4gICAgXHJcblx0Ly9CdXR0b25zICYgQnV0dG9uIEV2ZW50c1xyXG5cdHNob3BQYW5lbCA9IHRoaXMuZ2FtZS5hZGQuaW1hZ2UodGhpcy5nYW1lLmNhbWVyYS54ICsgdGhpcy5nYW1lLmNhbWVyYS53aWR0aCArIDI1NiArIDE2LCB0aGlzLmdhbWUuY2FtZXJhLnkgKyAxNiwgJ3Nob3BQYW5lbCcpO1xyXG5cdHNob3BQYW5lbC5raWxsKCk7XHJcblx0c2hpZWxkQnV0dG9uID0gdGhpcy5nYW1lLmFkZC5idXR0b24odGhpcy5nYW1lLmNhbWVyYS54ICsgdGhpcy5nYW1lLmNhbWVyYS53aWR0aCAtIGRpZmYsIHRoaXMuZ2FtZS5jYW1lcmEueSArIDUyICsgKDg4ICogMSksICdzaGllbGRCdXR0b24nLCB0aGlzLnB1cmNoYXNlTW9kdWxlLCB7c3RhdGU6IHRoaXMsIGtleTogJ3NoaWVsZCd9LCAxLCAwLCAyKTtcclxuXHRzaGllbGRCdXR0b24ua2lsbCgpO1xyXG5cdHNoaWVsZEJ1dHRvbi5vbklucHV0T3Zlci5hZGQodGhpcy5wbGF5SG92ZXJDbGljaywgdGhpcyk7XHJcblx0c2hpZWxkQnV0dG9uLm9uSW5wdXREb3duLmFkZCh0aGlzLnBsYXlEb3duQ2xpY2ssIHRoaXMpO1xyXG5cdHNvbGFyUGFuZWxCdXR0b24gPSB0aGlzLmdhbWUuYWRkLmJ1dHRvbih0aGlzLmdhbWUuY2FtZXJhLnggKyB0aGlzLmdhbWUuY2FtZXJhLndpZHRoIC0gZGlmZiwgdGhpcy5nYW1lLmNhbWVyYS55ICsgNTIgKyAoODggKiAyKSwgJ3NvbGFyUGFuZWxCdXR0b24nLCB0aGlzLnB1cmNoYXNlTW9kdWxlLCB7c3RhdGU6IHRoaXMsIGtleTogJ3NvbGFyUGFuZWwnfSwgMSwgMCwgMik7XHJcblx0c29sYXJQYW5lbEJ1dHRvbi5raWxsKCk7XHJcblx0c29sYXJQYW5lbEJ1dHRvbi5vbklucHV0T3Zlci5hZGQodGhpcy5wbGF5SG92ZXJDbGljaywgdGhpcyk7XHJcblx0c29sYXJQYW5lbEJ1dHRvbi5vbklucHV0RG93bi5hZGQodGhpcy5wbGF5RG93bkNsaWNrLCB0aGlzKTtcclxuXHR0aHJ1c3RlckJ1dHRvbiA9IHRoaXMuZ2FtZS5hZGQuYnV0dG9uKHRoaXMuZ2FtZS5jYW1lcmEueCArIHRoaXMuZ2FtZS5jYW1lcmEud2lkdGggLSBkaWZmLCB0aGlzLmdhbWUuY2FtZXJhLnkgKyA1MiArICg4OCAqIDMpLCAndGhydXN0ZXJCdXR0b24nLCB0aGlzLnB1cmNoYXNlTW9kdWxlLCB7c3RhdGU6IHRoaXMsIGtleTogJ3RocnVzdGVyJ30sIDEsIDAsIDIpO1xyXG5cdHRocnVzdGVyQnV0dG9uLmtpbGwoKTtcclxuXHR0aHJ1c3RlckJ1dHRvbi5vbklucHV0T3Zlci5hZGQodGhpcy5wbGF5SG92ZXJDbGljaywgdGhpcyk7XHJcblx0dGhydXN0ZXJCdXR0b24ub25JbnB1dERvd24uYWRkKHRoaXMucGxheURvd25DbGljaywgdGhpcyk7XHJcblx0Z3VuQnV0dG9uID0gdGhpcy5nYW1lLmFkZC5idXR0b24odGhpcy5nYW1lLmNhbWVyYS54ICsgdGhpcy5nYW1lLmNhbWVyYS53aWR0aCAtIGRpZmYsIHRoaXMuZ2FtZS5jYW1lcmEueSArIDUyICsgKDg4ICogNCksICdndW5CdXR0b24nLCB0aGlzLnB1cmNoYXNlTW9kdWxlLCB7c3RhdGU6IHRoaXMsIGtleTogJ2d1bid9LCAxLCAwLCAyKTtcclxuXHRndW5CdXR0b24ua2lsbCgpO1xyXG5cdGd1bkJ1dHRvbi5vbklucHV0T3Zlci5hZGQodGhpcy5wbGF5SG92ZXJDbGljaywgdGhpcyk7XHJcblx0Z3VuQnV0dG9uLm9uSW5wdXREb3duLmFkZCh0aGlzLnBsYXlEb3duQ2xpY2ssIHRoaXMpO1xyXG5cdGhhY2tCdXR0b24gPSB0aGlzLmdhbWUuYWRkLmJ1dHRvbih0aGlzLmdhbWUuY2FtZXJhLnggKyB0aGlzLmdhbWUuY2FtZXJhLndpZHRoIC0gZGlmZiwgdGhpcy5nYW1lLmNhbWVyYS55ICsgNTIgKyAoODggKiA1KSwgJ2hhY2tCdXR0b24nLCB0aGlzLnB1cmNoYXNlTW9kdWxlLCB7c3RhdGU6IHRoaXMsIGtleTogJ2hhY2snfSwgMSwgMCwgMik7XHJcblx0aGFja0J1dHRvbi5raWxsKCk7XHJcblx0aGFja0J1dHRvbi5vbklucHV0T3Zlci5hZGQodGhpcy5wbGF5SG92ZXJDbGljaywgdGhpcyk7XHJcblx0aGFja0J1dHRvbi5vbklucHV0RG93bi5hZGQodGhpcy5wbGF5RG93bkNsaWNrLCB0aGlzKTtcclxuXHR0aGlzLmdhbWUuY2FtZXJhLmZvbGxvdyh0aGlzLmNvcmVNb2R1bGUuY3ViZSk7XHJcblx0dGhpcy5zaG9wQnV0dG9uID0gdGhpcy5nYW1lLmFkZC5idXR0b24odGhpcy5nYW1lLmNhbWVyYS54ICsgdGhpcy5nYW1lLmNhbWVyYS53aWR0aCAtIDQ4LCAxNiwgJ3Nob3BCdXR0b24nLCB0aGlzLnVzZVNob3BCdXR0b24sIHRoaXMsIDEsIDAsIDIpO1xyXG5cdHRoaXMuc2hvcEJ1dHRvbi5vbklucHV0T3Zlci5hZGQodGhpcy5wbGF5SG92ZXJDbGljaywgdGhpcyk7XHJcblx0dGhpcy5zaG9wQnV0dG9uLm9uSW5wdXREb3duLmFkZCh0aGlzLnBsYXlEb3duQ2xpY2ssIHRoaXMpO1xyXG4gICBcclxuICAgIHRoaXMuanVpY3kgPSB0aGlzLmdhbWUucGx1Z2lucy5hZGQobmV3IFBoYXNlci5QbHVnaW4uSnVpY3kodGhpcykpO1xyXG4gICAgdGhpcy5nYW1lLmNhbWVyYS5mb2xsb3codGhpcy5jb3JlTW9kdWxlLmN1YmUpO1xyXG4gICAgXHJcblx0dGhpcy5oZWxwQmFubmVyID0gdGhpcy51aUJ1aWxkZXIuYnVpbGRCYW5uZXIoMC41LCAwLjUsICd0dXRvcmlhbF90ZXh0Jyk7XHJcblx0dGhpcy5oZWxwQnV0dG9uID0gdGhpcy5nYW1lLmFkZC5idXR0b24oMCwgMCwgJ2hlbHBCdXR0b24nLCB0aGlzLmhlbHBCYW5uZXIudG9nZ2xlLCB0aGlzLmhlbHBCYW5uZXIsIDEsIDAsIDIpO1xyXG5cdHRoaXMuaGVscEJ1dHRvbi5vbklucHV0T3Zlci5hZGQodGhpcy5wbGF5SG92ZXJDbGljaywgdGhpcyk7XHJcblx0dGhpcy5oZWxwQnV0dG9uLm9uSW5wdXREb3duLmFkZCh0aGlzLnBsYXlEb3duQ2xpY2ssIHRoaXMpO1xyXG5cdFxyXG5cdHRoaXMubW9uZXlUZXh0ID0gdGhpcy5nYW1lLmFkZC50ZXh0KHRoaXMuc2hvcEJ1dHRvbi54IC0gOCwgdGhpcy5zaG9wQnV0dG9uLnkgKyA0OCwgdGhpcy5tb25leSk7XHJcbiAgICB0aGlzLm1vbmV5VGV4dC5mb250ID0gJ1ZUMzIzJztcclxuICAgIHRoaXMubW9uZXlUZXh0LmZvbnRTaXplID0gMjQ7XHJcbiAgICB0aGlzLm1vbmV5VGV4dC5maWxsID0gJyNmZmZmZmYnO1xyXG5cdHRoaXMuYmUgPSB0aGlzLmdhbWUuYWRkLmltYWdlKHRoaXMubW9uZXlUZXh0LnggKyB0aGlzLm1vbmV5VGV4dC53aWR0aCArIDgsIHRoaXMubW9uZXlUZXh0LnksICdiZScpO1xyXG5cdFxyXG5cdHRoaXMubWFpblNvbmcgPSB0aGlzLmdhbWUuYWRkLmF1ZGlvKCdtYWluU29uZycsIDEsIHRydWUpO1xyXG5cdHRoaXMubWFpblNvbmcucGxheSgnJywwLDEsdHJ1ZSx0cnVlKTtcclxuICB9LFxyXG4gIFxyXG4gIHJlc3RhcnRMZXZlbDogZnVuY3Rpb24oKSB7XHJcblx0dGhpcy5tYWluU29uZy5zdG9wKCk7XHJcblx0dGhpcy5nYW1lLnN0YXRlLnN0YXJ0KHBsYXllclN0YXRlLmN1cnJlbnRMZXZlbCk7XHJcbiAgfSxcclxuICBcclxuICBsb2FkRGF0YTogZnVuY3Rpb24oKSB7XHJcbiAgICAgLy8vL1xyXG4gICAgIHRoaXMubGluZXMgPSBbXTtcclxuICAgICB0aGlzLmxpbmVUYXJnZXRzID0gW107XHJcbiAgICAgLy8vL1xyXG4gICAgICB2YXIgbXlMZXZlbCA9IHRoaXMubGV2ZWxEYXRhWydsZXZlbF9vbmUnXTtcclxuICAgICAgZm9yICh2YXIga2V5IGluIG15TGV2ZWwpIHtcclxuICAgICAgICAgaWYgKG15TGV2ZWwuaGFzT3duUHJvcGVydHkoa2V5KSkge1xyXG4gICAgICAgICAgICB2YXIgZWxlbWVudCA9IG15TGV2ZWxba2V5XTtcclxuICAgICAgICAgICAgaWYgKGVsZW1lbnQuaGFzT3duUHJvcGVydHkoJ2JsdWVwcmludCcpKSB7IC8vIGVuZW15IHR5cGVcclxuICAgICAgICAgICAgICAgdmFyIGVuZW15WCA9IGVsZW1lbnRbJ3hfcG9zJ107XHJcbiAgICAgICAgICAgICAgIHZhciBlbmVteVkgPSBlbGVtZW50Wyd5X3BvcyddO1xyXG4gICAgICAgICAgICAgICB2YXIgZW5lbXlHcm91cCA9IG5ldyBDdWJlR3JvdXAodGhpcywgdW5kZWZpbmVkKTtcclxuICAgICAgICAgICAgICAgdGhpcy51cGRhdGVEZXBlbmRlbnRzLnB1c2goZW5lbXlHcm91cCk7XHJcbiAgICAgICAgICAgICAgIHZhciBibHVlcHJpbnQgPSBlbGVtZW50WydibHVlcHJpbnQnXTtcclxuICAgICAgICAgICAgICAgZm9yICh2YXIgcm93ID0gMDsgcm93IDwgYmx1ZXByaW50Lmxlbmd0aDsgcm93KyspIHtcclxuICAgICAgICAgICAgICAgICAgZm9yICh2YXIgY29sID0gMDsgY29sIDwgYmx1ZXByaW50W3Jvd10ubGVuZ3RoOyBjb2wrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICB2YXIgdHlwZSA9IGJsdWVwcmludFtyb3ddW2NvbF07XHJcbiAgICAgICAgICAgICAgICAgICAgIHZhciBuZXdNb2R1bGUgPSB0aGlzLm1vZHVsZUJ1aWxkZXIuYnVpbGQodHlwZSwgZW5lbXlYICsgcm93ICogKHRoaXMuY3ViZVdpZHRoICsgdGhpcy5jdWJlQnVmZmVyKSxcclxuICAgICAgICAgICAgICAgICAgICAgZW5lbXlZIC0gY29sICogKHRoaXMuY3ViZVdpZHRoICsgdGhpcy5jdWJlQnVmZmVyKSwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICBuZXdNb2R1bGUuY3ViZS50YWcgPSAnZW5lbXlfbW9kdWxlJztcclxuICAgICAgICAgICAgICAgICAgICAgdmFyIHBvaW50ID0gbmV3IFBoYXNlci5Qb2ludChyb3csIGNvbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgIGVuZW15R3JvdXAuYWRkKG5ld01vZHVsZS5jdWJlLCBwb2ludCk7XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICB2YXIgYWlUeXBlID0gZWxlbWVudFsndHlwZSddO1xyXG4gICAgICAgICAgICAgICBlbmVteUdyb3VwLmdpdmVBSShhaVR5cGUsIHRoaXMucGxheWVyKTtcclxuICAgICAgICAgICAgICAgdGhpcy5saW5lcy5wdXNoKG5ldyBQaGFzZXIuTGluZSgwLCAwLCAwLCAwKSk7XHJcbiAgICAgICAgICAgICAgIHRoaXMubGluZVRhcmdldHMucHVzaChlbmVteUdyb3VwLnJvb3QpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgIH1cclxuICAgICAgfVxyXG4gIH0sXHJcbiAgXHJcblx0cGxheUhvdmVyQ2xpY2s6IGZ1bmN0aW9uKCkge1xyXG5cdFx0dGhpcy5ob3ZlckNsaWNrLnBsYXkoKTtcclxuXHR9LFxyXG5cdFxyXG5cdHBsYXlEb3duQ2xpY2s6IGZ1bmN0aW9uKCkge1xyXG5cdFx0dGhpcy5kb3duQ2xpY2sucGxheSgpO1xyXG5cdH0sXHJcbiAgXHJcblx0dXNlU2hvcEJ1dHRvbjogZnVuY3Rpb24oKSB7XHJcblx0XHR0aGlzLmRvd25DbGljay5wbGF5KCk7XHJcblx0XHRpZighc2hvcFBhbmVsLmFsaXZlICYmICFzaG9wTWVudU9wZW5pbmcgJiYgIXNob3BNZW51Q2xvc2luZykge1xyXG5cdFx0XHRzaG9wUGFuZWwucmV2aXZlKCk7XHJcblx0XHRcdGRpZmYgPSAwO1xyXG5cdFx0XHRzaG9wTWVudU9wZW5pbmcgPSB0cnVlO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSBpZihzaG9wUGFuZWwuYWxpdmUmJiAhc2hvcE1lbnVDbG9zaW5nICYmICFzaG9wTWVudU9wZW5pbmcpIHtcclxuXHRcdFx0c2hvcE1lbnVDbG9zaW5nID0gdHJ1ZTtcclxuXHRcdH1cclxuXHR9LFxyXG5cdFxyXG5cdGFkZFNob3BCdXR0b25zOiBmdW5jdGlvbigpIHtcclxuXHRcdHNoaWVsZEJ1dHRvbi5yZXZpdmUoKTtcclxuXHRcdHNvbGFyUGFuZWxCdXR0b24ucmV2aXZlKCk7XHJcblx0XHR0aHJ1c3RlckJ1dHRvbi5yZXZpdmUoKTtcclxuXHRcdGd1bkJ1dHRvbi5yZXZpdmUoKTtcclxuXHRcdGhhY2tCdXR0b24ucmV2aXZlKCk7XHJcblx0fSxcclxuXHRcclxuXHRwdXJjaGFzZU1vZHVsZTogZnVuY3Rpb24oKSB7XHJcblx0XHR2YXIgcmFuZFkgPSB0aGlzLnN0YXRlLmdhbWUucm5kLmludGVnZXJJblJhbmdlKDEwMCwgdGhpcy5zdGF0ZS5nYW1lLmNhbWVyYS5oZWlnaHQgLSAxMDApO1xyXG5cdFx0aWYodGhpcy5rZXkgPT09ICdzaGllbGQnICYmIHRoaXMuc3RhdGUubW91c2UueCA+IHNoaWVsZEJ1dHRvbi54ICYmIHRoaXMuc3RhdGUubW91c2UueCA8IHNoaWVsZEJ1dHRvbi54ICsgMjU2ICYmIHRoaXMuc3RhdGUubW91c2UueSA+IHNoaWVsZEJ1dHRvbi55ICYmIHRoaXMuc3RhdGUubW91c2UueSA8IHNoaWVsZEJ1dHRvbi55ICsgODIpIHtcclxuXHRcdFx0aWYodGhpcy5zdGF0ZS5tb25leSA+PSA0NSkge1xyXG5cdFx0XHRcdHRoaXMuc3RhdGUuYWRkU2hpZWxkKHRoaXMuc3RhdGUuZ2FtZS5jYW1lcmEueCArIHRoaXMuc3RhdGUuZ2FtZS5jYW1lcmEud2lkdGggKyA4MCwgdGhpcy5zdGF0ZS5nYW1lLmNhbWVyYS55ICsgcmFuZFkpO1xyXG5cdFx0XHRcdHRoaXMuc3RhdGUubW9uZXkgLT0gNDU7XHJcblx0XHRcdFx0dGhpcy5zdGF0ZS5jYXNoUmVnaXN0ZXIucGxheSgpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdHRoaXMuc3RhdGUuZXJyb3IucGxheSgpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRlbHNlIGlmKHRoaXMua2V5ID09PSAnc29sYXJQYW5lbCcgJiYgdGhpcy5zdGF0ZS5tb3VzZS54ID4gc29sYXJQYW5lbEJ1dHRvbi54ICYmIHRoaXMuc3RhdGUubW91c2UueCA8IHNvbGFyUGFuZWxCdXR0b24ueCArIDI1NiAmJiB0aGlzLnN0YXRlLm1vdXNlLnkgPiBzb2xhclBhbmVsQnV0dG9uLnkgJiYgdGhpcy5zdGF0ZS5tb3VzZS55IDwgc29sYXJQYW5lbEJ1dHRvbi55ICsgODIpIHtcclxuXHRcdFx0aWYodGhpcy5zdGF0ZS5tb25leSA+PSAxMDUpIHtcclxuXHRcdFx0XHR0aGlzLnN0YXRlLmFkZFNQKHRoaXMuc3RhdGUuZ2FtZS5jYW1lcmEueCArIHRoaXMuc3RhdGUuZ2FtZS5jYW1lcmEud2lkdGggKyA4MCwgdGhpcy5zdGF0ZS5nYW1lLmNhbWVyYS55ICsgcmFuZFkpO1xyXG5cdFx0XHRcdHRoaXMuc3RhdGUubW9uZXkgLT0gMTA1O1xyXG5cdFx0XHRcdHRoaXMuc3RhdGUuY2FzaFJlZ2lzdGVyLnBsYXkoKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIHtcclxuXHRcdFx0XHR0aGlzLnN0YXRlLmVycm9yLnBsYXkoKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0ZWxzZSBpZih0aGlzLmtleSA9PT0gJ3RocnVzdGVyJyAmJiB0aGlzLnN0YXRlLm1vdXNlLnggPiB0aHJ1c3RlckJ1dHRvbi54ICYmIHRoaXMuc3RhdGUubW91c2UueCA8IHRocnVzdGVyQnV0dG9uLnggKyAyNTYgJiYgdGhpcy5zdGF0ZS5tb3VzZS55ID4gdGhydXN0ZXJCdXR0b24ueSAmJiB0aGlzLnN0YXRlLm1vdXNlLnkgPCB0aHJ1c3RlckJ1dHRvbi55ICsgODIpIHtcclxuXHRcdFx0aWYodGhpcy5zdGF0ZS5tb25leSA+PSA5MCkge1xyXG5cdFx0XHRcdHRoaXMuc3RhdGUuYWRkVGhydXN0ZXIodGhpcy5zdGF0ZS5nYW1lLmNhbWVyYS54ICsgdGhpcy5zdGF0ZS5nYW1lLmNhbWVyYS53aWR0aCArIDgwLCB0aGlzLnN0YXRlLmdhbWUuY2FtZXJhLnkgKyByYW5kWSk7XHJcblx0XHRcdFx0dGhpcy5zdGF0ZS5tb25leSAtPSA5MDtcclxuXHRcdFx0XHR0aGlzLnN0YXRlLmNhc2hSZWdpc3Rlci5wbGF5KCk7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0dGhpcy5zdGF0ZS5lcnJvci5wbGF5KCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGVsc2UgaWYodGhpcy5rZXkgPT09ICdndW4nICYmIHRoaXMuc3RhdGUubW91c2UueCA+IGd1bkJ1dHRvbi54ICYmIHRoaXMuc3RhdGUubW91c2UueCA8IGd1bkJ1dHRvbi54ICsgMjU2ICYmIHRoaXMuc3RhdGUubW91c2UueSA+IGd1bkJ1dHRvbi55ICYmIHRoaXMuc3RhdGUubW91c2UueSA8IGd1bkJ1dHRvbi55ICsgODIpIHtcclxuXHRcdFx0aWYodGhpcy5zdGF0ZS5tb25leSA+PSAxMjApIHtcclxuXHRcdFx0XHR0aGlzLnN0YXRlLmFkZEd1bih0aGlzLnN0YXRlLmdhbWUuY2FtZXJhLnggKyB0aGlzLnN0YXRlLmdhbWUuY2FtZXJhLndpZHRoICsgODAsIHRoaXMuc3RhdGUuZ2FtZS5jYW1lcmEueSArIHJhbmRZKTtcclxuXHRcdFx0XHR0aGlzLnN0YXRlLm1vbmV5IC09IDEyMDtcclxuXHRcdFx0XHR0aGlzLnN0YXRlLmNhc2hSZWdpc3Rlci5wbGF5KCk7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0dGhpcy5zdGF0ZS5lcnJvci5wbGF5KCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGVsc2UgaWYodGhpcy5rZXkgPT09ICdoYWNrJyAmJiB0aGlzLnN0YXRlLm1vdXNlLnggPiBoYWNrQnV0dG9uLnggJiYgdGhpcy5zdGF0ZS5tb3VzZS54IDwgaGFja0J1dHRvbi54ICsgMjU2ICYmIHRoaXMuc3RhdGUubW91c2UueSA+IGhhY2tCdXR0b24ueSAmJiB0aGlzLnN0YXRlLm1vdXNlLnkgPCBoYWNrQnV0dG9uLnkgKyA4Mikge1xyXG5cdFx0XHRpZih0aGlzLnN0YXRlLm1vbmV5ID49IDIwMCkge1xyXG5cdFx0XHRcdHRoaXMuc3RhdGUuYWRkSGFjayh0aGlzLnN0YXRlLmdhbWUuY2FtZXJhLnggKyB0aGlzLnN0YXRlLmdhbWUuY2FtZXJhLndpZHRoICsgODAsIHRoaXMuc3RhdGUuZ2FtZS5jYW1lcmEueSArIHJhbmRZKTtcclxuXHRcdFx0XHR0aGlzLnN0YXRlLm1vbmV5IC09IDIwMDtcclxuXHRcdFx0XHR0aGlzLnN0YXRlLmNhc2hSZWdpc3Rlci5wbGF5KCk7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0dGhpcy5zdGF0ZS5lcnJvci5wbGF5KCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHRoaXMuc3RhdGUubW9uZXlUZXh0LnRleHQgPSB0aGlzLnN0YXRlLm1vbmV5O1xyXG5cdH0sXHJcblxyXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xyXG5cdGlmKGxlZnRLZXkuaXNEb3duKSB7XHJcblx0XHRpZih0aGlzLmNvcmVNb2R1bGUuY3ViZS5ib2R5LmFuZ3VsYXJWZWxvY2l0eSA+IC05KSB7IFxyXG5cdFx0XHR0aGlzLmNvcmVNb2R1bGUuY3ViZS5ib2R5LmFuZ3VsYXJGb3JjZSArPSAtNy41ICogTWF0aC5wb3codGhpcy5wbGF5ZXIubnVtQ3ViZXMsIDEuNjUpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRcclxuXHRpZihyaWdodEtleS5pc0Rvd24pIHtcclxuXHRcdGlmKHRoaXMuY29yZU1vZHVsZS5jdWJlLmJvZHkuYW5ndWxhclZlbG9jaXR5IDwgOSkge1xyXG5cdFx0XHR0aGlzLmNvcmVNb2R1bGUuY3ViZS5ib2R5LmFuZ3VsYXJGb3JjZSArPSA3LjUgKiBNYXRoLnBvdyh0aGlzLnBsYXllci5udW1DdWJlcywgMS42NSk7XHJcblx0XHR9XHJcblx0fVxyXG5cdFxyXG5cdGlmKGNjd0tleS5pc0Rvd24pIHtcclxuXHRcdGlmKHRoaXMubW91c2UuZ3JhYmJlZCAhPT0gdW5kZWZpbmVkICYmIHRoaXMubW91c2UuZ3JhYmJlZC5zcHJpdGUuZ3JvdXAgPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHR0aGlzLm1vdXNlLmdyYWJiZWQuYW5ndWxhckZvcmNlICs9IC01O1xyXG5cdFx0fVxyXG5cdH1cclxuXHRcclxuXHRpZihjd0tleS5pc0Rvd24pIHtcclxuXHRcdGlmKHRoaXMubW91c2UuZ3JhYmJlZCAhPT0gdW5kZWZpbmVkICYmIHRoaXMubW91c2UuZ3JhYmJlZC5zcHJpdGUuZ3JvdXAgPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHR0aGlzLm1vdXNlLmdyYWJiZWQuYW5ndWxhckZvcmNlICs9IDU7XHJcblx0XHR9XHJcblx0fVxyXG5cdFxyXG5cdHRoaXMubW91c2UudXBkYXRlKCk7XHJcblx0dGhpcy5zY3JvbGxCRygpO1xyXG4gICBcclxuXHRmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMudXBkYXRlRGVwZW5kZW50cy5sZW5ndGg7IGkrKykge1xyXG5cdFx0aWYgKHRoaXMudXBkYXRlRGVwZW5kZW50c1tpXS51cGRhdGUpIHtcclxuXHRcdFx0dGhpcy51cGRhdGVEZXBlbmRlbnRzW2ldLnVwZGF0ZSgpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRcclxuXHQvL1dhcm5pbmcgQ29kZVxyXG5cdGlmKHRoaXMuY29yZU1vZHVsZS5jdWJlLnggKyAoTWF0aC5tYXgodGhpcy5wbGF5ZXIuY3ViZXNXaWR0aCgpLCB0aGlzLnBsYXllci5jdWJlc0hlaWdodCgpKSAvIDIgKiA2NCkgPiA4MDAwIHx8XHJcblx0dGhpcy5jb3JlTW9kdWxlLmN1YmUueCAtIChNYXRoLm1heCh0aGlzLnBsYXllci5jdWJlc1dpZHRoKCksIHRoaXMucGxheWVyLmN1YmVzSGVpZ2h0KCkpIC8gMiAqIDY0KSA8IDAgfHxcclxuXHR0aGlzLmNvcmVNb2R1bGUuY3ViZS55ICsgKE1hdGgubWF4KHRoaXMucGxheWVyLmN1YmVzV2lkdGgoKSwgdGhpcy5wbGF5ZXIuY3ViZXNIZWlnaHQoKSkgLyAyICogNjQpID4gNDAwMCB8fFxyXG5cdHRoaXMuY29yZU1vZHVsZS5jdWJlLnkgLSAoTWF0aC5tYXgodGhpcy5wbGF5ZXIuY3ViZXNXaWR0aCgpLCB0aGlzLnBsYXllci5jdWJlc0hlaWdodCgpKSAvIDIgKiA2NCkgPCAwKSB7XHJcblx0XHRpZih0aW1lci5sZW5ndGggPT09IDApIHtcclxuXHRcdFx0d2FybmluZy5yZXZpdmUoKTtcclxuXHRcdFx0dGltZXIubG9vcChQaGFzZXIuVGltZXIuU0VDT05EICogNSwgdGhpcy5yZXNldFBsYXllciwgdGhpcyk7XHJcblx0XHRcdHRpbWVyLnN0YXJ0KCk7XHJcblx0XHR9XHJcblx0fVxyXG5cdGVsc2Uge1xyXG5cdFx0aWYod2FybmluZy5hbGl2ZSA9PT0gdHJ1ZSkge1xyXG5cdFx0XHR3YXJuaW5nLmtpbGwoKTtcclxuXHRcdH1cclxuXHRcdGlmKHRpbWVyLmxlbmd0aCA+IDApIHtcclxuXHRcdFx0dGltZXIuc3RvcCh0cnVlKTtcclxuXHRcdH1cclxuXHR9XHJcblx0d2FybmluZy54ID0gdGhpcy5nYW1lLmNhbWVyYS54O1xyXG5cdHdhcm5pbmcueSA9IHRoaXMuZ2FtZS5jYW1lcmEueTtcclxuXHRcclxuXHQvL1Nob3AgTW92ZW1lbnQgQ29kZVxyXG5cdGlmKHNob3BNZW51T3BlbmluZyA9PT0gdHJ1ZSkge1x0XHJcblx0XHRkaWZmICs9IDQ7XHJcblx0XHRpZihkaWZmID49IDI3Nikge1xyXG5cdFx0XHRzaG9wTWVudU9wZW5pbmcgPSBmYWxzZTtcclxuXHRcdFx0dGhpcy5hZGRTaG9wQnV0dG9ucygpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRlbHNlIGlmKHNob3BNZW51Q2xvc2luZyA9PT0gdHJ1ZSkge1xyXG5cdFx0ZGlmZiAtPSA0O1xyXG5cdFx0aWYoZGlmZiA8PSAwKSB7XHJcblx0XHRcdHNob3BQYW5lbC5raWxsKCk7XHJcblx0XHRcdHNob3BNZW51Q2xvc2luZyA9IGZhbHNlO1xyXG5cdFx0fVxyXG5cdH1cclxuXHQvL1Bvc2l0aW9uIFVwZGF0ZXNcclxuXHR0aGlzLnNob3BCdXR0b24ueCA9IHRoaXMuZ2FtZS5jYW1lcmEueCArIHRoaXMuZ2FtZS5jYW1lcmEud2lkdGggLSA0OCAtIGRpZmY7XHJcblx0dGhpcy5zaG9wQnV0dG9uLnkgPSB0aGlzLmdhbWUuY2FtZXJhLnkgKyAxNjtcclxuXHR0aGlzLmhlbHBCdXR0b24ueCA9IHRoaXMuZ2FtZS5jYW1lcmEueCArIDE2O1xyXG5cdHRoaXMuaGVscEJ1dHRvbi55ID0gdGhpcy5nYW1lLmNhbWVyYS55ICsgMTY7XHJcblx0c2hvcFBhbmVsLnggPSB0aGlzLmdhbWUuY2FtZXJhLnggKyB0aGlzLmdhbWUuY2FtZXJhLndpZHRoICsgMTYgLSBkaWZmO1xyXG5cdHNob3BQYW5lbC55ID0gdGhpcy5nYW1lLmNhbWVyYS55ICsgMTY7XHJcblx0c2hpZWxkQnV0dG9uLnggPSB0aGlzLmdhbWUuY2FtZXJhLnggKyB0aGlzLmdhbWUuY2FtZXJhLndpZHRoICsgMTYgLSBkaWZmO1xyXG5cdHNoaWVsZEJ1dHRvbi55ID0gdGhpcy5nYW1lLmNhbWVyYS55ICsgNzAgKyAoODYgKiAwKTtcclxuXHRzb2xhclBhbmVsQnV0dG9uLnggPSB0aGlzLmdhbWUuY2FtZXJhLnggKyB0aGlzLmdhbWUuY2FtZXJhLndpZHRoICsgMTYgLSBkaWZmO1xyXG5cdHNvbGFyUGFuZWxCdXR0b24ueSA9IHRoaXMuZ2FtZS5jYW1lcmEueSArIDcwICsgKDg2ICogMSk7XHJcblx0dGhydXN0ZXJCdXR0b24ueCA9IHRoaXMuZ2FtZS5jYW1lcmEueCArIHRoaXMuZ2FtZS5jYW1lcmEud2lkdGggKyAxNiAtIGRpZmY7XHJcblx0dGhydXN0ZXJCdXR0b24ueSA9IHRoaXMuZ2FtZS5jYW1lcmEueSArIDcwICsgKDg2ICogMik7XHJcblx0Z3VuQnV0dG9uLnggPSB0aGlzLmdhbWUuY2FtZXJhLnggKyB0aGlzLmdhbWUuY2FtZXJhLndpZHRoICsgMTYgLSBkaWZmO1xyXG5cdGd1bkJ1dHRvbi55ID0gdGhpcy5nYW1lLmNhbWVyYS55ICsgNzAgKyAoODYgKiAzKTtcclxuXHRoYWNrQnV0dG9uLnggPSB0aGlzLmdhbWUuY2FtZXJhLnggKyB0aGlzLmdhbWUuY2FtZXJhLndpZHRoICsgMTYgLSBkaWZmO1xyXG5cdGhhY2tCdXR0b24ueSA9IHRoaXMuZ2FtZS5jYW1lcmEueSArIDcwICsgKDg2ICogNCk7XHJcblx0dGhpcy5tb25leVRleHQueCA9IHRoaXMuc2hvcEJ1dHRvbi54IC0gMTY7XHJcblx0dGhpcy5tb25leVRleHQueSA9IHRoaXMuc2hvcEJ1dHRvbi55ICsgNDg7XHJcblx0dGhpcy5iZS54ID0gdGhpcy5tb25leVRleHQueCArIHRoaXMubW9uZXlUZXh0LndpZHRoICsgODtcclxuXHR0aGlzLmJlLnkgPSB0aGlzLm1vbmV5VGV4dC55O1xyXG4gICBcclxuICAgLy8vL1xyXG4gICBpZiAodGhpcy5wbGF5ZXIucm9vdCkge1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubGluZVRhcmdldHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgaWYgKCF0aGlzLmxpbmVUYXJnZXRzW2ldKSB7XHJcbiAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIHZhciBwb2ludEEgPSBuZXcgUGhhc2VyLlBvaW50KHRoaXMucGxheWVyLnJvb3QueCwgdGhpcy5wbGF5ZXIucm9vdC55KTtcclxuICAgICAgICAgdmFyIHBvaW50QiA9IG5ldyBQaGFzZXIuUG9pbnQodGhpcy5saW5lVGFyZ2V0c1tpXS54LCB0aGlzLmxpbmVUYXJnZXRzW2ldLnkpO1xyXG4gICAgICAgICB0aGlzLmxpbmVzW2ldLnNldFRvKHBvaW50QS54LCBwb2ludEEueSwgcG9pbnRCLngsIHBvaW50Qi55KTtcclxuICAgICAgfVxyXG4gICB9XHJcbiAgIC8vLy9cclxuICB9LFxyXG4gIFxyXG4gIHJlbmRlcjogZnVuY3Rpb24gKCkge1xyXG5cdHRoaXMubW91c2UucmVuZGVyKCk7XHJcblx0dGhpcy5yZW5kZXJhYmxlcy5yZW5kZXJBbGwoKTtcclxuICAgLy8vL1xyXG4gICBpZiAoIXRoaXMuaGVscEJhbm5lci52aXNpYmxlKSB7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5saW5lVGFyZ2V0cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgIHRoaXMuZ2FtZS5kZWJ1Zy5nZW9tKHRoaXMubGluZXNbaV0pO1xyXG4gICAgICB9XHJcbiAgIH1cclxuICAgLy8vL1xyXG4gIH0sXHJcbiAgXHJcblx0c2Nyb2xsQkc6IGZ1bmN0aW9uKCkge1xyXG5cdFx0YmcueCArPSAwLjEyNTtcclxuXHRcdGlmKGJnLnggPj0gODAwMCkge1xyXG5cdFx0XHRiZy54ID0gMDtcclxuXHRcdH1cclxuXHRcdGJnMi54ICs9IDAuMTI1O1xyXG5cdFx0aWYoYmcyLnggPj0gODAwMCkge1xyXG5cdFx0XHRiZzIueCA9IDA7XHJcblx0XHR9XHJcblx0fSxcclxuXHRcclxuXHRnZW5lcmF0ZUFzdGVyb2lkczogZnVuY3Rpb24oKSB7XHJcblx0XHRmb3IoO251bVJvaWRzIDwgbWF4Um9pZHM7IG51bVJvaWRzKyspIHtcclxuXHRcdFx0dmFyIHJhbmRYID0gdGhpcy5nYW1lLnJuZC5pbnRlZ2VySW5SYW5nZSgwLCB0aGlzLmdhbWUud29ybGQud2lkdGgpO1xyXG5cdFx0XHR2YXIgcmFuZFkgPSB0aGlzLmdhbWUucm5kLmludGVnZXJJblJhbmdlKDAsIHRoaXMuZ2FtZS53b3JsZC5oZWlnaHQpO1xyXG5cdFx0XHRcclxuXHRcdFx0d2hpbGUocmFuZFggPCB0aGlzLmNvcmVNb2R1bGUuY3ViZS54IC0gKHRoaXMucGxheWVyLmN1YmVzV2lkdGgoKSAvIDIgKyAxMDApICYmIHJhbmRYID4gdGhpcy5jb3JlTW9kdWxlLmN1YmUueCArICh0aGlzLnBsYXllci5jdWJlc1dpZHRoKCkgLyAyICsgMTAwKSAmJlxyXG5cdFx0XHRyYW5kWSA8IHRoaXMuY29yZU1vZHVsZS5jdWJlLnkgLSAodGhpcy5wbGF5ZXIuY3ViZXNIZWlnaHQoKSAvIDIgKyAxMDApICYmIHJhbmRZID4gdGhpcy5jb3JlTW9kdWxlLmN1YmUueSArICh0aGlzLnBsYXllci5jdWJlc0hlaWdodCgpIC8gMiArIDEwMCkpIHtcclxuXHRcdFx0XHRyYW5kWCA9IHRoaXMuZ2FtZS5ybmQuaW50ZWdlckluUmFuZ2UoMCwgdGhpcy5nYW1lLndvcmxkLndpZHRoKTtcclxuXHRcdFx0XHRyYW5kWSA9IHRoaXMuZ2FtZS5ybmQuaW50ZWdlckluUmFuZ2UoMCwgdGhpcy5nYW1lLndvcmxkLmhlaWdodCk7XHJcblx0XHRcdH1cclxuXHRcdFx0XHJcblx0XHRcdHZhciBhc3Rlcm9pZCA9IGFzdGVyb2lkcy5jcmVhdGUocmFuZFgsIHJhbmRZLCAnYXN0ZXJvaWQnKTtcclxuXHRcdFx0XHJcblx0XHRcdGFzdGVyb2lkLmJvZHkuY2xlYXJTaGFwZXMoKTsgXHJcblx0XHRcdGFzdGVyb2lkLmJvZHkubG9hZFBvbHlnb24oJ2FzdGVyb2lkUG9seWdvbicsICdhc3Rlcm9pZCcpOyAvL0NoYW5nZSB0aGUgY29sbGlzaW9uIGRldGVjdGlvbiBmcm9tIGFuIEFBQkIgdG8gYSBwb2x5Z29uXHJcblx0XHRcdGFzdGVyb2lkLmJvZHkuZGFtcGluZyA9IHRoaXMuZ2FtZS5ybmQucmVhbEluUmFuZ2UoMCwgMC4zKSAqIHRoaXMuZ2FtZS5ybmQuaW50ZWdlckluUmFuZ2UoMCwgMSkgKiB0aGlzLmdhbWUucm5kLmludGVnZXJJblJhbmdlKDAsIDEpO1xyXG5cdFx0XHRhc3Rlcm9pZC5ib2R5LnJvdGF0aW9uID0gdGhpcy5nYW1lLnJuZC5yZWFsSW5SYW5nZSgwLCAyICogTWF0aC5QSSk7XHJcblx0XHRcdGFzdGVyb2lkLmJvZHkuZm9yY2UueCA9IHRoaXMuZ2FtZS5ybmQuaW50ZWdlckluUmFuZ2UoLTEwLCAxMCkgKiA3NTA7XHJcblx0XHRcdGFzdGVyb2lkLmJvZHkuZm9yY2UueSA9IHRoaXMuZ2FtZS5ybmQuaW50ZWdlckluUmFuZ2UoLTEwLCAxMCkgKiA3NTA7XHJcblx0XHRcdGFzdGVyb2lkLmJvZHkuc2V0Q29sbGlzaW9uR3JvdXAodGhpcy5jb2xsaXNpb25Hcm91cCk7XHJcblx0XHRcdGFzdGVyb2lkLmJvZHkuY29sbGlkZXModGhpcy5jb2xsaXNpb25Hcm91cCk7XHJcblx0XHRcdGFzdGVyb2lkLmJvZHkuY29sbGlkZVdvcmxkQm91bmRzID0gZmFsc2U7XHJcblx0XHRcdGFzdGVyb2lkLmF1dG9DdWxsID0gdHJ1ZTtcclxuXHRcdFx0YXN0ZXJvaWQuY2hlY2tXb3JsZEJvdW5kcyA9IHRydWU7XHJcblx0XHRcdGFzdGVyb2lkLmV2ZW50cy5vbk91dE9mQm91bmRzLmFkZCh0aGlzLnJlc2V0QXN0ZXJvaWQsIHtyb2lkOiBhc3Rlcm9pZCwgY29yZU1vZHVsZTogdGhpcy5jb3JlTW9kdWxlLCBwbGF5ZXI6IHRoaXMucGxheWVyLCBnYW1lOiB0aGlzLmdhbWV9KTtcclxuXHRcdFx0YXN0ZXJvaWRMaXN0LmFkZChhc3Rlcm9pZCk7XHJcblx0XHR9XHJcblx0fSxcclxuXHRcclxuXHRyZXNldEFzdGVyb2lkOiBmdW5jdGlvbigpIHtcclxuXHRcdHZhciByYW5kWCA9IHRoaXMuZ2FtZS5ybmQuaW50ZWdlckluUmFuZ2UoMCwgdGhpcy5nYW1lLndvcmxkLndpZHRoKTtcclxuXHRcdHZhciByYW5kWSA9IHRoaXMuZ2FtZS5ybmQuaW50ZWdlckluUmFuZ2UoMCwgdGhpcy5nYW1lLndvcmxkLmhlaWdodCk7XHJcblx0XHRcdFxyXG5cdFx0d2hpbGUocmFuZFggPCB0aGlzLmNvcmVNb2R1bGUuY3ViZS54IC0gKHRoaXMucGxheWVyLmN1YmVzV2lkdGgoKSAvIDIgKyAxMDApICYmIHJhbmRYID4gdGhpcy5jb3JlTW9kdWxlLmN1YmUueCArICh0aGlzLnBsYXllci5jdWJlc1dpZHRoKCkgLyAyICsgMTAwKSAmJlxyXG5cdFx0XHRyYW5kWSA8IHRoaXMuY29yZU1vZHVsZS5jdWJlLnkgLSAodGhpcy5wbGF5ZXIuY3ViZXNIZWlnaHQoKSAvIDIgKyAxMDApICYmIHJhbmRZID4gdGhpcy5jb3JlTW9kdWxlLmN1YmUueSArICh0aGlzLnBsYXllci5jdWJlc0hlaWdodCgpIC8gMiArIDEwMCkpIHtcclxuXHRcdFx0XHRyYW5kWCA9IHRoaXMuZ2FtZS5ybmQuaW50ZWdlckluUmFuZ2UoMCwgdGhpcy5nYW1lLndvcmxkLndpZHRoKTtcclxuXHRcdFx0XHRyYW5kWSA9IHRoaXMuZ2FtZS5ybmQuaW50ZWdlckluUmFuZ2UoMCwgdGhpcy5nYW1lLndvcmxkLmhlaWdodCk7XHJcblx0XHR9XHJcblx0XHR0aGlzLnJvaWQueCA9IHJhbmRYO1xyXG5cdFx0dGhpcy5yb2lkLnkgPSByYW5kWTtcclxuXHRcdHRoaXMucm9pZC5ib2R5LnJvdGF0aW9uID0gdGhpcy5nYW1lLnJuZC5yZWFsSW5SYW5nZSgwLCAyICogTWF0aC5QSSk7XHJcblx0XHR0aGlzLnJvaWQuYm9keS5mb3JjZS54ID0gdGhpcy5nYW1lLnJuZC5pbnRlZ2VySW5SYW5nZSgtMTAsIDEwKSAqIDc1MDtcclxuXHRcdHRoaXMucm9pZC5ib2R5LmZvcmNlLnkgPSB0aGlzLmdhbWUucm5kLmludGVnZXJJblJhbmdlKC0xMCwgMTApICogNzUwO1xyXG5cdH0sXHJcblx0XHJcblx0cmVzZXRQbGF5ZXI6IGZ1bmN0aW9uKCkge1xyXG5cdFx0aWYodGhpcy5jb3JlTW9kdWxlLmN1YmUueCArIChNYXRoLm1heCh0aGlzLnBsYXllci5jdWJlc1dpZHRoKCksIHRoaXMucGxheWVyLmN1YmVzSGVpZ2h0KCkpIC8gMiAqIDY0KSA+IDgwMDApIHtcclxuXHRcdFx0dGhpcy5jb3JlTW9kdWxlLmN1YmUuYm9keS5tb3ZlTGVmdCh0aGlzLnBsYXllci5udW1DdWJlcyAqIDc1MCk7XHJcblx0XHR9XHJcblx0XHRpZih0aGlzLmNvcmVNb2R1bGUuY3ViZS54IC0gKE1hdGgubWF4KHRoaXMucGxheWVyLmN1YmVzV2lkdGgoKSwgdGhpcy5wbGF5ZXIuY3ViZXNIZWlnaHQoKSkgLyAyICogNjQpIDwgMCkge1xyXG5cdFx0XHR0aGlzLmNvcmVNb2R1bGUuY3ViZS5ib2R5Lm1vdmVSaWdodCh0aGlzLnBsYXllci5udW1DdWJlcyAqIDc1MCk7XHJcblx0XHR9XHJcblx0XHRpZih0aGlzLmNvcmVNb2R1bGUuY3ViZS55ICsgKE1hdGgubWF4KHRoaXMucGxheWVyLmN1YmVzV2lkdGgoKSwgdGhpcy5wbGF5ZXIuY3ViZXNIZWlnaHQoKSkgLyAyICogNjQpID4gNDAwMCkge1xyXG5cdFx0XHR0aGlzLmNvcmVNb2R1bGUuY3ViZS5ib2R5Lm1vdmVVcCh0aGlzLnBsYXllci5udW1DdWJlcyAqIDc1MCk7XHJcblx0XHR9XHJcblx0XHRlbHNlIGlmKHRoaXMuY29yZU1vZHVsZS5jdWJlLnkgLSAoTWF0aC5tYXgodGhpcy5wbGF5ZXIuY3ViZXNXaWR0aCgpLCB0aGlzLnBsYXllci5jdWJlc0hlaWdodCgpKSAvIDIgKiA2NCkgPCAwKSB7XHJcblx0XHRcdHRoaXMuY29yZU1vZHVsZS5jdWJlLmJvZHkubW92ZURvd24odGhpcy5wbGF5ZXIubnVtQ3ViZXMgKiA3NTApO1xyXG5cdFx0fVxyXG5cdH0sXHJcblx0XHJcbiAgLy9ERUJVRyBGVU5DVElPTlMtIGV2ZW50IGZ1bmN0aW9ucyBjYWxsZWQgZnJvbSBsaXN0ZW5lcnMgdGhhdCBhbGxvdyB5b3UgdG8gY3JlYXRlIG1vZHVsZXMgd2l0aCBrZXkgcHJlc3Nlc1xyXG4gIGFkZENvcmU6IGZ1bmN0aW9uICh4LCB5KSB7IFxyXG5cdC8vQXR0ZW1wdHMgdG8gY3JlYXRlIG1vcmUgY29yZSBtb2R1bGVzIGhlcmUgd2lsbCBvbmx5IHJldHVybiB0aGUgZXhpc3RpbmcgY29yZVxyXG5cdHZhciBuZXdNb2R1bGUgPSB0aGlzLm1vZHVsZUJ1aWxkZXIuYnVpbGQoJ2NvcmUnLCB4LCB5LCB0cnVlKTtcclxuXHQvL25ld01vZHVsZS5jdWJlLmJvZHkuc2V0Q29sbGlzaW9uR3JvdXAodGhpcy5jb2xsaXNpb25Hcm91cCk7XHJcblx0Ly9uZXdNb2R1bGUuY3ViZS5ib2R5LmNvbGxpZGVzKHRoaXMuY29sbGlzaW9uR3JvdXApO1xyXG4gIH0sXHJcbiAgYWRkU2hpZWxkOiBmdW5jdGlvbiAoeCwgeSkge1xyXG5cdHZhciBuZXdNb2R1bGUgPSB0aGlzLm1vZHVsZUJ1aWxkZXIuYnVpbGQoJ3NoaWVsZCcsIHgsIHksIHRydWUpO1xyXG5cdC8vbmV3TW9kdWxlLmN1YmUuYm9keS5zZXRDb2xsaXNpb25Hcm91cCh0aGlzLmNvbGxpc2lvbkdyb3VwKTtcclxuXHQvL25ld01vZHVsZS5jdWJlLmJvZHkuY29sbGlkZXModGhpcy5jb2xsaXNpb25Hcm91cCk7XHJcblx0bmV3TW9kdWxlLmN1YmUuYm9keS5tb3ZlTGVmdChuZXdNb2R1bGVTcGVlZCk7XHJcbiAgfSxcclxuICBhZGRUaHJ1c3RlcjogZnVuY3Rpb24gKHgsIHkpIHtcclxuXHR2YXIgbmV3TW9kdWxlID0gdGhpcy5tb2R1bGVCdWlsZGVyLmJ1aWxkKCd0aHJ1c3RlcicsIHgsIHksIHRydWUpO1xyXG5cdC8vbmV3TW9kdWxlLmN1YmUuYm9keS5zZXRDb2xsaXNpb25Hcm91cCh0aGlzLmNvbGxpc2lvbkdyb3VwKTtcclxuXHQvL25ld01vZHVsZS5jdWJlLmJvZHkuY29sbGlkZXModGhpcy5jb2xsaXNpb25Hcm91cCk7XHJcblx0bmV3TW9kdWxlLmN1YmUuYm9keS5tb3ZlTGVmdChuZXdNb2R1bGVTcGVlZCk7XHJcbiAgfSxcclxuICBhZGRTUDogZnVuY3Rpb24gKHgsIHkpIHtcclxuXHR2YXIgbmV3TW9kdWxlID0gdGhpcy5tb2R1bGVCdWlsZGVyLmJ1aWxkKCdzb2xhclBhbmVsJywgeCwgeSwgdHJ1ZSk7XHJcblx0Ly9uZXdNb2R1bGUuY3ViZS5ib2R5LnNldENvbGxpc2lvbkdyb3VwKHRoaXMuY29sbGlzaW9uR3JvdXApO1xyXG5cdC8vbmV3TW9kdWxlLmN1YmUuYm9keS5jb2xsaWRlcyh0aGlzLmNvbGxpc2lvbkdyb3VwKTtcclxuXHRuZXdNb2R1bGUuY3ViZS5ib2R5Lm1vdmVMZWZ0KG5ld01vZHVsZVNwZWVkKTtcclxuICB9LFxyXG4gIGFkZEhhY2s6IGZ1bmN0aW9uICh4LCB5KSB7XHJcblx0dmFyIG5ld01vZHVsZSA9IHRoaXMubW9kdWxlQnVpbGRlci5idWlsZCgnaGFja2VyJywgeCwgeSwgdHJ1ZSk7XHJcblx0Ly9uZXdNb2R1bGUuY3ViZS5ib2R5LnNldENvbGxpc2lvbkdyb3VwKHRoaXMuY29sbGlzaW9uR3JvdXApO1xyXG5cdC8vbmV3TW9kdWxlLmN1YmUuYm9keS5jb2xsaWRlcyh0aGlzLmNvbGxpc2lvbkdyb3VwKTtcclxuXHRuZXdNb2R1bGUuY3ViZS5ib2R5Lm1vdmVMZWZ0KG5ld01vZHVsZVNwZWVkKTtcclxuICB9LFxyXG4gIGFkZEd1bjogZnVuY3Rpb24gKHgsIHkpIHtcclxuXHR2YXIgbmV3TW9kdWxlID0gdGhpcy5tb2R1bGVCdWlsZGVyLmJ1aWxkKCdndW4nLCB4LCB5LCB0cnVlKTtcclxuXHQvL25ld01vZHVsZS5jdWJlLmJvZHkuc2V0Q29sbGlzaW9uR3JvdXAodGhpcy5jb2xsaXNpb25Hcm91cCk7XHJcblx0Ly9uZXdNb2R1bGUuY3ViZS5ib2R5LmNvbGxpZGVzKHRoaXMuY29sbGlzaW9uR3JvdXApO1xyXG5cdG5ld01vZHVsZS5jdWJlLmJvZHkubW92ZUxlZnQobmV3TW9kdWxlU3BlZWQpO1xyXG4gIH0sXHJcbiAgXHJcblx0YWRkTW9uZXk6IGZ1bmN0aW9uKCkge1xyXG5cdFx0dGhpcy5tb25leSArPSAxMDA7XHJcblx0XHR0aGlzLm1vbmV5VGV4dC50ZXh0ID0gdGhpcy5tb25leTtcclxuXHRcdHRoaXMuY2FzaFJlZ2lzdGVyLnBsYXkoKTtcclxuXHR9LFxyXG4gIFxyXG4gIGRlYnVnOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgXHJcbiAgfVxyXG59O1xyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4iLCJ2YXIgTWVudSA9IGZ1bmN0aW9uICgpIHtcclxuICB0aGlzLnRleHQgPSBudWxsO1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBNZW51O1xyXG5cclxuTWVudS5wcm90b3R5cGUgPSB7XHJcblx0XHJcbiAgcG9zOiBbLTI1LCAyNSwgNzVdLFxyXG4gIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHggPSB0aGlzLmdhbWUud2lkdGggLyAyO1xyXG4gICAgdmFyIHkgPSB0aGlzLmdhbWUuaGVpZ2h0IC8gMjtcclxuICAgIFxyXG4gICAgdGhpcy50aXRsZSA9IHRoaXMuYWRkLmltYWdlKHRoaXMud29ybGQuY2VudGVyWCwgdGhpcy53b3JsZC5jZW50ZXJZIC0gOTUsICdtZW51X3RpdGxlJyk7XHJcbiAgICB0aGlzLnRpdGxlLmFuY2hvci5zZXRUbygwLjUsIDAuNSk7XHJcbiAgICBcclxuICAgIHRoaXMuc2VsZWN0ID0gdGhpcy5hZGRCdXR0b24oMSwgJ21lbnVfc2VsZWN0JywgdGhpcy5jaGFuZ2VUb0dhbWUpO1xyXG4gIFx0dGhpcy5zZWxlY3QuYW5jaG9yLnNldFRvKDAuNSwgMC41KTtcclxuICBcdFxyXG4gIFx0dGhpcy5tYW51YWwgPSB0aGlzLmFkZEJ1dHRvbigyLCAnbWVudV9tYW51YWwnLCB0aGlzLmNoYW5nZVRvTWVudSk7XHJcbiAgXHR0aGlzLm1hbnVhbC5hbmNob3Iuc2V0VG8oMC41LCAwLjUpO1xyXG4gIFx0XHJcbiAgXHR0aGlzLmNyZWRpdHMgPSB0aGlzLmFkZEJ1dHRvbigzLCAnbWVudV9jcmVkaXRzJywgdGhpcy5jaGFuZ2VUb01lbnUpO1xyXG4gIFx0dGhpcy5jcmVkaXRzLmFuY2hvci5zZXRUbygwLjUsIDAuNSk7XHJcbiAgfSxcclxuXHJcbiAgYWRkQnV0dG9uOiBmdW5jdGlvbihidXR0b24sIGltZywgZnVuYyl7XHJcbiAgICByZXR1cm4gdGhpcy5hZGQuYnV0dG9uKHRoaXMud29ybGQuY2VudGVyWCwgdGhpcy53b3JsZC5jZW50ZXJZICsgdGhpcy5wb3NbYnV0dG9uIC0gMV0sIGltZywgZnVuYyk7XHJcbiAgfSxcclxuICBcclxuICBkcmF3OiBmdW5jdGlvbigpe1xyXG4gIH0sXHJcbiAgXHJcbiAgY2hhbmdlVG9HYW1lOiBmdW5jdGlvbigpe1xyXG4gIFx0dGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdHYW1lJyk7XHJcbiAgfSwgIFxyXG4gIFxyXG4gIGNoYW5nZVRvTWVudTogZnVuY3Rpb24oKXtcclxuICBcdHRoaXMuZ2FtZS5zdGF0ZS5zdGFydCgnTWVudScpO1xyXG4gIH0sICBcclxuICAvKlxyXG4gIGNoYW5nZVN0YXRlOiBmdW5jdGlvbihzdGF0ZSl7XHJcbiAgXHRzd2l0Y2goc3RhdGUpe1xyXG4gIFx0XHRjYXNlICdnYW1lJzpcclxuICBcdFx0XHR0aGlzLmdhbWUuc3RhdGUuc3RhcnQoJ0dhbWUnKTtcclxuICBcdFx0XHRicmVhaztcclxuICBcdFx0Y2FzZSAnbWVudSc6XHJcbiAgXHRcdFx0dGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdNZW51Jyk7XHJcbiAgXHRcdFx0YnJlYWs7XHJcbiAgXHRcdGRlZmF1bHQ6XHJcbiAgXHRcdFx0YnJlYWs7XHJcbiAgXHR9XHJcbiAgfSxcclxuICAqL1xyXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xyXG4gIH0sXHJcblxyXG59O1xyXG4iLCJ2YXIgUHJlbG9hZGVyID0gZnVuY3Rpb24gKGdhbWUpIHtcclxuICBnYW1lID0gbnVsbDtcclxuICB0aGlzLmFzc2V0ID0gbnVsbDtcclxuICB0aGlzLnJlYWR5ID0gZmFsc2U7XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFByZWxvYWRlcjtcclxuXHJcblByZWxvYWRlci5wcm90b3R5cGUgPSB7XHJcblxyXG4gIHByZWxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMuYXNzZXQgPSB0aGlzLmFkZC5zcHJpdGUoNjQwLCAzNjAsICdwcmVsb2FkZXInKTtcclxuICAgIHRoaXMuYXNzZXQuYW5jaG9yLnNldFRvKDAuNSwgMC41KTtcclxuXHJcbiAgICB0aGlzLmxvYWQub25Mb2FkQ29tcGxldGUuYWRkT25jZSh0aGlzLm9uTG9hZENvbXBsZXRlLCB0aGlzKTtcclxuICAgIHRoaXMubG9hZC5zZXRQcmVsb2FkU3ByaXRlKHRoaXMuYXNzZXQpO1xyXG5cdFxyXG5cdC8vTG9hZCBTcHJpdGVzaGVldHNcclxuXHR0aGlzLmxvYWQuc3ByaXRlc2hlZXQoJ2NvcmUnLCAnYXNzZXRzL2ltYWdlcy9jb3JlU2hlZXQucG5nJywgNjQsIDY0KTsgXHJcblx0dGhpcy5sb2FkLnNwcml0ZXNoZWV0KCd0aHJ1c3RlcicsICdhc3NldHMvaW1hZ2VzL3RocnVzdGVyU2hlZXQucG5nJywgNjQsIDY0KTtcclxuXHR0aGlzLmxvYWQuc3ByaXRlc2hlZXQoJ2d1bicsICdhc3NldHMvaW1hZ2VzL2d1blNoZWV0LnBuZycsIDY0LCA2NCk7XHJcblx0dGhpcy5sb2FkLnNwcml0ZXNoZWV0KCdoYWNrZXInLCAnYXNzZXRzL2ltYWdlcy9oYWNrU2hlZXQucG5nJywgNjQsIDY0KTtcclxuXHR0aGlzLmxvYWQuc3ByaXRlc2hlZXQoJ3NoaWVsZEJ1dHRvbicsICdhc3NldHMvaW1hZ2VzL3NoaWVsZEJ1dHRvblNoZWV0LnBuZycsIDI1NiwgODIpO1xyXG5cdHRoaXMubG9hZC5zcHJpdGVzaGVldCgnc29sYXJQYW5lbEJ1dHRvbicsICdhc3NldHMvaW1hZ2VzL3NvbGFyUGFuZWxCdXR0b25TaGVldC5wbmcnLCAyNTYsIDgyKTtcclxuXHR0aGlzLmxvYWQuc3ByaXRlc2hlZXQoJ3RocnVzdGVyQnV0dG9uJywgJ2Fzc2V0cy9pbWFnZXMvdGhydXN0ZXJCdXR0b25TaGVldC5wbmcnLCAyNTYsIDgyKTtcclxuXHR0aGlzLmxvYWQuc3ByaXRlc2hlZXQoJ2d1bkJ1dHRvbicsICdhc3NldHMvaW1hZ2VzL2d1bkJ1dHRvblNoZWV0LnBuZycsIDI1NiwgODIpO1xyXG5cdHRoaXMubG9hZC5zcHJpdGVzaGVldCgnaGFja0J1dHRvbicsICdhc3NldHMvaW1hZ2VzL2hhY2tCdXR0b25TaGVldC5wbmcnLCAyNTYsIDgyKTtcclxuXHR0aGlzLmxvYWQuc3ByaXRlc2hlZXQoJ2hhY2thYmxlMScsICdhc3NldHMvaW1hZ2VzL2hhY2thYmxlMS5wbmcnLCAyNTYsIDI1Nik7XHJcblx0dGhpcy5sb2FkLnNwcml0ZXNoZWV0KCdzaG9wQnV0dG9uJywgJ2Fzc2V0cy9pbWFnZXMvc2hvcEJ1dHRvblNoZWV0LnBuZycsIDMyLCAzMik7XHJcblx0XHJcblx0Ly9Mb2FkIEltYWdlc1xyXG5cdHRoaXMubG9hZC5pbWFnZSgnZWFydGhOaWdodCcsICdhc3NldHMvaW1hZ2VzL2JnX2VhcnRoTmlnaHRTbWFsbC5qcGcnKTtcclxuXHR0aGlzLmxvYWQuaW1hZ2UoJ2J1bGxldCcsICdhc3NldHMvaW1hZ2VzL2J1bGxldC5wbmcnKTtcclxuXHR0aGlzLmxvYWQuaW1hZ2UoJ3NoaWVsZCcsICdhc3NldHMvaW1hZ2VzL3NoaWVsZC5wbmcnKTtcclxuXHR0aGlzLmxvYWQuaW1hZ2UoJ3NvbGFyUGFuZWwnLCAnYXNzZXRzL2ltYWdlcy9zb2xhclBhbmVsLnBuZycpO1xyXG5cdHRoaXMubG9hZC5pbWFnZSgnYXN0ZXJvaWQnLCAnYXNzZXRzL2ltYWdlcy9hc3Rlcm9pZC5wbmcnKTtcclxuXHR0aGlzLmxvYWQuaW1hZ2UoJ3Nob3BQYW5lbCcsICdhc3NldHMvaW1hZ2VzL3Nob3BCYWNrUGFuZWwucG5nJyk7XHJcblx0dGhpcy5sb2FkLmltYWdlKCd3YXJuaW5nJywgJ2Fzc2V0cy9pbWFnZXMvd2FybmluZy5wbmcnKTtcclxuXHR0aGlzLmxvYWQuaW1hZ2UoJ2JlJywgJ2Fzc2V0cy9pbWFnZXMvYmUucG5nJyk7XHJcbiAgICBcclxuXHQvL0xvYWQgRm9udHNcclxuXHR0aGlzLmxvYWQuc2NyaXB0KCd3ZWJmb250JywgJy8vYWpheC5nb29nbGVhcGlzLmNvbS9hamF4L2xpYnMvd2ViZm9udC8xLjQuNy93ZWJmb250LmpzJyk7XHJcblx0XHJcblx0Ly9Mb2FkIEpTT04gRmlsZXNcclxuXHR0aGlzLmxvYWQuYXRsYXNKU09OSGFzaCgnY29ubmVjdGlvbnMnLCAnYXNzZXRzL2ltYWdlcy9jb25uZWN0aW9ucy5wbmcnLCAnYXNzZXRzL2pzb24vY29ubmVjdGlvbnMuanNvbicpO1xyXG5cdHRoaXMubG9hZC5hdGxhc0pTT05IYXNoKCdjb25uZWN0aW9ucycsICdhc3NldHMvaW1hZ2VzL2Nvbm5lY3Rpb25zLnBuZycsICdhc3NldHMvanNvbi9jb25uZWN0aW9ucy5qc29uJyk7XHJcblx0dGhpcy5sb2FkLmF0bGFzSlNPTkhhc2goJ2hlbHBCdXR0b24nLCAnYXNzZXRzL2ltYWdlcy9oZWxwQnV0dG9uU2hlZXQucG5nJywgJ2Fzc2V0cy9qc29uL2hlbHBfYnV0dG9uLmpzb24nKTtcclxuXHR0aGlzLmxvYWQuYXRsYXNKU09OSGFzaCgnYXJyb3dCdXR0b24nLCAnYXNzZXRzL2ltYWdlcy9hcnJvd0J1dHRvblNoZWV0LnBuZycsICdhc3NldHMvanNvbi9hcnJvd19idXR0b24uanNvbicpO1xyXG5cdHRoaXMubG9hZC5waHlzaWNzKCdtb2R1bGVfcGh5c2ljcycsICdhc3NldHMvanNvbi9tb2R1bGVfcGh5c2ljcy5qc29uJyk7XHJcblx0dGhpcy5sb2FkLnBoeXNpY3MoJ2FzdGVyb2lkUG9seWdvbicsICdhc3NldHMvanNvbi9hc3Rlcm9pZFBvbHlnb24uanNvbicpO1xyXG5cdHRoaXMubG9hZC50ZXh0KCdsZXZlbF9vbmUnLCAnYXNzZXRzL2pzb24vbGV2ZWxfb25lLmpzb24nKTtcclxuXHR0aGlzLmxvYWQudGV4dCgndHV0b3JpYWxfdGV4dCcsICdhc3NldHMvanNvbi90dXRvcmlhbF90ZXh0Lmpzb24nKTtcclxuXHRcclxuXHQvL0xvYWQgU291bmQgRWZmZWN0c1xyXG5cdHRoaXMubG9hZC5hdWRpbygnZG93bkNsaWNrJywgJ2Fzc2V0cy9zb3VuZC9kb3duQ2xpY2sub2dnJyk7XHJcblx0dGhpcy5sb2FkLmF1ZGlvKCdob3ZlckNsaWNrJywgJ2Fzc2V0cy9zb3VuZC9ob3ZlckNsaWNrLm9nZycpO1xyXG5cdHRoaXMubG9hZC5hdWRpbygnZXJyb3InLCAnYXNzZXRzL3NvdW5kL2Vycm9yLm9nZycpO1xyXG5cdFxyXG5cdHRoaXMubG9hZC50ZXh0KCd0dXRvcmlhbF90ZXh0JywgJ2Fzc2V0cy9qc29uL3R1dG9yaWFsX3RleHQuanNvbicpO1xyXG5cdHRoaXMubG9hZC5zY3JpcHQoJ3dlYmZvbnQnLCAnLy9hamF4Lmdvb2dsZWFwaXMuY29tL2FqYXgvbGlicy93ZWJmb250LzEuNC43L3dlYmZvbnQuanMnKTtcclxuXHR0aGlzLmxvYWQuYXRsYXNKU09OSGFzaCgnaGVscEJ1dHRvbicsICdhc3NldHMvaW1hZ2VzL2hlbHBCdXR0b25TaGVldC5wbmcnLCAnYXNzZXRzL2pzb24vaGVscF9idXR0b24uanNvbicpO1xyXG5cdHRoaXMubG9hZC5hdGxhc0pTT05IYXNoKCdhcnJvd0J1dHRvbicsICdhc3NldHMvaW1hZ2VzL2Fycm93QnV0dG9uU2hlZXQucG5nJywgJ2Fzc2V0cy9qc29uL2Fycm93X2J1dHRvbi5qc29uJyk7XHJcblx0Ly9tZW51IGJ1dHRvbnNcclxuXHR0aGlzLmxvYWQuaW1hZ2UoJ21lbnVfdGl0bGUnLCAnYXNzZXRzL2ltYWdlcy9hdGljX21lbnVfdGl0bGVULnBuZycpO1xyXG5cdHRoaXMubG9hZC5pbWFnZSgnbWVudV9zZWxlY3QnLCAnYXNzZXRzL2ltYWdlcy9hdGljX21lbnVfc2VsZWN0VC5wbmcnKTtcclxuXHR0aGlzLmxvYWQuaW1hZ2UoJ21lbnVfbWFudWFsJywgJ2Fzc2V0cy9pbWFnZXMvYXRpY19tZW51X21hbnVhbFQucG5nJyk7XHJcblx0dGhpcy5sb2FkLmltYWdlKCdtZW51X2NyZWRpdHMnLCAnYXNzZXRzL2ltYWdlcy9hdGljX21lbnVfY3JlZGl0c1QucG5nJyk7XHJcblxyXG5cdHRoaXMubG9hZC5hdWRpbygnY2FzaFJlZ2lzdGVyJywgJ2Fzc2V0cy9zb3VuZC9jYXNoUmVnaXN0ZXIub2dnJyk7XHJcblx0XHJcblx0Ly9Mb2FkIE11c2ljXHJcblx0Ly90aGlzLmxvYWQuYXVkaW8oJ21lbnVTb25nJywgJ2Fzc2V0cy9zb3VuZC9ZZXQgQW5vdGhlci5vZ2cnKTtcclxuXHR0aGlzLmxvYWQuYXVkaW8oJ21haW5Tb25nJywgJ2Fzc2V0cy9zb3VuZC9Ub3AgKGRvd24pIE5pZ2h0Lm9nZycpO1xyXG5cclxuICB9LFxyXG5cclxuICBjcmVhdGU6IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMuYXNzZXQuY3JvcEVuYWJsZWQgPSBmYWxzZTtcclxuICB9LFxyXG5cclxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcclxuICAgIGlmICghIXRoaXMucmVhZHkpIHtcclxuICAgICAgdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdNZW51Jyk7XHJcbiAgICAgIC8vdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KHBsYXllclN0YXRlLmN1cnJlbnRMZXZlbCk7IC8vIGpzaGludCBpZ25vcmU6bGluZVxyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIG9uTG9hZENvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLnJlYWR5ID0gdHJ1ZTtcclxuICB9XHJcbn07XHJcbiIsInZhciBTcGxhc2ggPSBmdW5jdGlvbiAoKSB7XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFNwbGFzaDtcclxuXHJcblNwbGFzaC5wcm90b3R5cGUgPSB7XHJcbiAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgfVxyXG59OyIsIi8vTk9URTogRE9OJ1QgVVNFIHRoaXMgY29kZSB0byBjcmVhdGUgYSBQcm9ncmVzc0Jhci4gSW5zdGVhZCwgdXNlIHRoZSBVSUJ1aWxkZXIgb2JqZWN0IGFuZCBjYWxsIGJ1aWxkUHJvZ3Jlc3NCYXJcclxuXHJcbnZhciBQcm9ncmVzc0JhciA9IGZ1bmN0aW9uKHNldFR5cGUsIHNldE1heFZhbHVlLCBzZXRHcmFwaGljcywgc2V0UmVuZGVyYWJsZXMpIHtcclxuXHR0aGlzLnR5cGUgPSBzZXRUeXBlOyAvL1R3byB0eXBlcywgXCJncm93aW5nXCIgKHN0YXJ0cyBhdCAwLCB0cmlnZ2VycyBldmVudCB3aGVuIGZ1bGwpIFxyXG5cdFx0XHRcdFx0XHQgLy9hbmQgXCJzaHJpbmtpbmdcIiAoc3RhcnRzIGZ1bGwsIHRyaWdnZXJzIGF0IDApXHJcblx0dGhpcy5iZ0JvcmRlclNpemUgPSAyO1x0XHRcdC8vZGVmYXVsdCBzaXplIG9mIGJhY2tncm91bmQgYm9yZGVyXHJcblx0dGhpcy5iZ0JvcmRlckNvbG9yID0gMHhBQUFBQUE7XHQvL2RlZmF1bHQgY29sb3Igb2YgYmFja2dyb3VuZCBib3JkZXJcclxuXHR0aGlzLmJnQ29sb3IgPSAweDg4ODg4ODtcdFx0Ly9kZWZhdWx0IGNvbG9yIG9mIGJhY2tncm91bmRcclxuXHR0aGlzLnBhZGRpbmdIb3JpeiA9IDU7XHRcdFx0Ly9kZWZhdWx0IHN1bSBvZiBwYWRkaW5nIG9uIGxlZnQgYW5kIHJpZ2h0IHNpZGUgaW5uZXIgdmFsdWUgYmFyXHJcblx0dGhpcy5wYWRkaW5nVmVydCA9IDU7XHRcdFx0Ly9kZWZhdWx0IHN1bSAoaS5lLiBoYWxmIG9uIGVhY2ggc2lkZSkgb2YgdmVydGljYWwgcGFkZGluZyBvZiBpbm5lciB2YWx1ZSBiYXJcclxuXHR0aGlzLnZhbHVlQm9yZGVyU2l6ZSA9IDE7XHRcdC8vZGVmYXVsdCBzaXplIG9mIHZhbHVlIGJvcmRlclxyXG5cdHRoaXMudmFsdWVCb3JkZXJDb2xvciA9IDB4ODg4OEZGOyAvL2RlZmF1bHQgY29sb3Igb2YgdmFsdWUgYm9yZGVyXHJcblx0dGhpcy52YWx1ZUNvbG9yID0gMHgwMDAwOTk7XHRcdC8vZGVmYXVsdCBjb2xvciBvZiBpbm5lciB2YWx1ZSBiYXJcclxuXHR0aGlzLnggPSBudWxsO1xyXG5cdHRoaXMueSA9IG51bGw7XHJcblx0dGhpcy53aWR0aCA9IG51bGw7XHJcblx0dGhpcy5oZWlnaHQgPSBudWxsO1xyXG5cdHRoaXMubWF4VmFsdWUgPSBzZXRNYXhWYWx1ZTtcclxuXHR0aGlzLmdyYXBoaWNzID0gc2V0R3JhcGhpY3M7IC8vc3RvcmUgZ3JhcGhpY3MgY2xhc3MgKHVzZWQgdG8gZHJhdyBiYXIpXHJcblx0dGhpcy5yZW5kZXJhYmxlcyA9IHNldFJlbmRlcmFibGVzO1xyXG5cdFxyXG5cdHRoaXMub25FdmVudCA9IGZ1bmN0aW9uKCkge307IC8vb3ZlcndyaXRlIHRoaXMgZnVuY3Rpb24gdG8gbWFrZSB3aGF0ZXZlciB5b3Ugd2FudCBoYXBwZW4gd2hlbiBwcm9ncmVzc0JhciByZWFjaGVzIGxpbWl0XHJcblx0XHJcblx0Ly9zd2l0Y2godGhpcy50eXBlKSB7XHJcblx0Ly9jYXNlICdncm93aW5nJyA6IFxyXG5cdGlmKHNldFR5cGUgPT09ICdncm93aW5nJykge1xyXG5cdFx0dGhpcy52YWx1ZSA9IDA7XHJcblx0XHQvL3RyeVRyaWdnZXIgaXMgY2FsbGVkIGF1dG9tYXRpY2FsbHkgd2hlbiB5b3UgYWRkL3N1YnRyYWN0IHZhbHVlLCBhbmQgd2lsbCB0cmlnZ2VyIHRoZSBvbkV2ZW50KCkgZnVuY3Rpb25cclxuXHRcdHRoaXMudHJ5VHJpZ2dlciA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRpZih0aGlzLnZhbHVlID49IHRoaXMubWF4VmFsdWUpIHtcclxuXHRcdFx0XHR0aGlzLm9uRXZlbnQoKTtcclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHRcdC8vYnJlYWs7XHJcblx0fVxyXG5cdGVsc2UgaWYoc2V0VHlwZSA9PT0gJ3Nocmlua2luZycpIHtcclxuXHQvL2Nhc2UgJ3Nocmlua2luZycgOlxyXG5cdFx0dGhpcy52YWx1ZSA9IHRoaXMubWF4VmFsdWU7XHJcblx0XHR0aGlzLnRyeVRyaWdnZXIgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0aWYodGhpcy52YWx1ZSA8PSAwKSB7XHJcblx0XHRcdFx0dGhpcy5vbkV2ZW50KCk7XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0Ly99XHJcblx0fVxyXG59O1xyXG5cclxuUHJvZ3Jlc3NCYXIucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gUHJvZ3Jlc3NCYXI7XHJcblxyXG5Qcm9ncmVzc0Jhci5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uKCkge1xyXG5cdHRoaXMuZ3JhcGhpY3MuY2xlYXIoKTtcclxuXHR0aGlzLnJlbmRlcmFibGVzLnVuc3Vic2NyaWJlKHRoaXMpO1xyXG59O1xyXG5cclxuLy9UbyBzdWJ0cmFjdCB2YWx1ZSwganVzdCB1c2UgbmVnYXRpdmUgbnVtYmVycyBhcyBhcmd1bWVudCBpLmUuIGZvby5hZGRWYWx1ZSgtNSk7XHJcblByb2dyZXNzQmFyLnByb3RvdHlwZS5hZGRWYWx1ZSA9IGZ1bmN0aW9uIChhZGRUaGlzKSB7XHJcblx0dGhpcy52YWx1ZSArPSBhZGRUaGlzO1xyXG5cdGlmKHRoaXMudmFsdWUgPiB0aGlzLm1heFZhbHVlKSB7XHJcblx0XHR0aGlzLnZhbHVlID0gdGhpcy5tYXhWYWx1ZTtcclxuXHR9XHJcblx0aWYodGhpcy52YWx1ZSA8IDApIHtcclxuXHRcdHRoaXMudmFsdWUgPSAwO1xyXG5cdH1cclxuXHR0aGlzLnRyeVRyaWdnZXIoKTtcclxufTtcclxuXHJcbi8vU2V0cyB0aGUgbG9jYXRpb24gd2hlcmUgcHJvZ3Jlc3MgYmFyIGlzIHJlbmRlcmVkXHJcblByb2dyZXNzQmFyLnByb3RvdHlwZS5zZXRMb2NhdGlvbiA9IGZ1bmN0aW9uKHNldFgsIHNldFkpIHtcclxuXHR0aGlzLnggPSBzZXRYO1xyXG5cdHRoaXMueSA9IHNldFk7XHJcbn07XHJcblxyXG4vL1NldHMgdGhlIHNpemUgb2YgdGhlIHByb2dyZXNzIGJhclxyXG5Qcm9ncmVzc0Jhci5wcm90b3R5cGUuc2V0U2l6ZSA9IGZ1bmN0aW9uKHNldFdpZHRoLCBzZXRIZWlnaHQpIHtcclxuXHR0aGlzLndpZHRoID0gc2V0V2lkdGg7XHJcblx0dGhpcy5oZWlnaHQgPSBzZXRIZWlnaHQ7XHJcbn07XHJcblxyXG5Qcm9ncmVzc0Jhci5wcm90b3R5cGUuc2V0U3R5bGUgPSBmdW5jdGlvbihiZ0JvcmRlclNpemUsIGJnQm9yZGVyQ29sb3IsIGJnQ29sb3IsIHBhZGRpbmdIb3JpeiwgcGFkZGluZ1ZlcnQsIHZhbHVlQm9yZGVyU2l6ZSwgdmFsdWVCb3JkZXJDb2xvciwgdmFsdWVDb2xvcikge1xyXG5cdHRoaXMuYmdCb3JkZXJTaXplID0gYmdCb3JkZXJTaXplO1xyXG5cdHRoaXMuYmdCb3JkZXJDb2xvciA9IGJnQm9yZGVyQ29sb3I7XHJcblx0dGhpcy5iZ0NvbG9yID0gYmdDb2xvcjtcclxuXHR0aGlzLnBhZGRpbmdIb3JpeiA9IHBhZGRpbmdIb3JpejtcclxuXHR0aGlzLnBhZGRpbmdWZXJ0ID0gcGFkZGluZ1ZlcnQ7XHJcblx0dGhpcy52YWx1ZUJvcmRlclNpemUgPSB2YWx1ZUJvcmRlclNpemU7XHJcblx0dGhpcy52YWx1ZUJvcmRlckNvbG9yID0gdmFsdWVCb3JkZXJDb2xvcjtcclxuXHR0aGlzLnZhbHVlQ29sb3IgPSB2YWx1ZUNvbG9yO1xyXG59O1xyXG5cclxuLy91cGRhdGUgZm9yIHByb2dyZXNzIGJhciwgY2FsbGVkIGp1c3QgYmVmb3JlIGRyYXdpbmcgcHJvZ3Jlc3MgYmFyXHJcbi8vT3ZlcndyaXRlIHRoaXMgZnVuY3Rpb24gaWYgZGVzaXJlZFxyXG5Qcm9ncmVzc0Jhci5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7fTtcclxuXHJcbi8vUmVuZGVycyBwcm9ncmVzc0JhclxyXG5Qcm9ncmVzc0Jhci5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24oKSB7XHJcblx0dGhpcy51cGRhdGUoKTtcclxuXHR0aGlzLmdyYXBoaWNzLmNsZWFyKCk7XHJcblx0Ly9EcmF3IGJhY2tncm91bmQgb2YgYmFyXHJcblx0dGhpcy5ncmFwaGljcy5saW5lU3R5bGUodGhpcy5iZ0JvcmRlclNpemUsIHRoaXMuYmdCb3JkZXJDb2xvciwgMSk7IC8vc2V0cyBib3JkZXIgY29sb3IgYW5kIHNpemVcclxuXHR0aGlzLmdyYXBoaWNzLmJlZ2luRmlsbCh0aGlzLmJnQ29sb3IpOyAvL3NldHMgY29sb3Igb2YgYmFja2dyb3VuZCBmaWxsXHJcblx0dGhpcy5ncmFwaGljcy5kcmF3UmVjdCh0aGlzLngtdGhpcy53aWR0aC8yLCB0aGlzLnktdGhpcy5oZWlnaHQvMiwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xyXG5cdHRoaXMuZ3JhcGhpY3MuZW5kRmlsbCgpO1xyXG5cdC8vRHJhdyB2YWx1ZSBvZiBiYXJcclxuXHR2YXIgcGVyY2VudGFnZSA9IHRoaXMudmFsdWUgLyB0aGlzLm1heFZhbHVlO1xyXG5cdHZhciBiYXJXaWR0aCA9IHRoaXMud2lkdGggLSB0aGlzLnBhZGRpbmdIb3JpejtcclxuXHR2YXIgYmFySGVpZ2h0ID0gdGhpcy5oZWlnaHQgLSB0aGlzLnBhZGRpbmdWZXJ0O1xyXG5cdHRoaXMuZ3JhcGhpY3MubGluZVN0eWxlKHRoaXMudmFsdWVCb3JkZXJTaXplLCB0aGlzLnZhbHVlQm9yZGVyQ29sb3IsIDEpO1xyXG5cdHRoaXMuZ3JhcGhpY3MuYmVnaW5GaWxsKHRoaXMudmFsdWVDb2xvcik7XHJcblx0dGhpcy5ncmFwaGljcy5kcmF3UmVjdCh0aGlzLngtKGJhcldpZHRoLzIpLCB0aGlzLnktKGJhckhlaWdodC8yKSwgYmFyV2lkdGgqcGVyY2VudGFnZSwgYmFySGVpZ2h0KTtcclxuXHR0aGlzLmdyYXBoaWNzLmVuZEZpbGwoKTtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gUHJvZ3Jlc3NCYXI7IiwidmFyIFByb2dyZXNzQmFyID0gcmVxdWlyZSgnLi9Qcm9ncmVzc0JhcicpO1xyXG52YXIgQmFubmVyID0gcmVxdWlyZSgnLi9iYW5uZXInKTtcclxuXHJcbnZhciBVSUJ1aWxkZXIgPSBmdW5jdGlvbihzZXRHYW1lU3RhdGUsIHNldFJlbmRlcmFibGVzKSB7XHJcblx0Ly9FbnN1cmUgdGhhdCBjYW5ub3QgY3JlYXRlIG11bHRpcGxlIGluc3RhbmNlcyBvZiB0aGlzIGNsYXNzXHJcblx0aWYoVUlCdWlsZGVyLnByb3RvdHlwZS5leGlzdHMpIHtcclxuXHRcdHJldHVybiBVSUJ1aWxkZXIucHJvdG90eXBlLmV4aXN0aW5nUmVmZXJlbmNlO1xyXG5cdH1cclxuXHRcclxuXHR0aGlzLmdhbWVTdGF0ZSA9IHNldEdhbWVTdGF0ZTtcclxuXHR0aGlzLnJlbmRlcmFibGVzID0gc2V0UmVuZGVyYWJsZXM7XHJcblx0Ly9DcmVhdGUgYW5kIHN0b3JlIGEgZ3JhcGhpY3Mgb2JqZWN0ICh1c2VkIGZvciBzdHVmZiBsaWtlIGRyYXdpbmcgcmVjdGFuZ2xlcylcclxuXHRVSUJ1aWxkZXIucHJvdG90eXBlLmV4aXN0cyA9IHRydWU7XHJcblx0VUlCdWlsZGVyLnByb3RvdHlwZS5leGlzdGluZ1JlZmVyZW5jZSA9IHRoaXM7XHJcbn07XHJcblxyXG5VSUJ1aWxkZXIucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gVUlCdWlsZGVyO1xyXG4vL1RoZXNlIHZhcidzIGhlbHAgY3JlYXRlIHRoZSBzaW5nbGV0b24gZnVuY3Rpb25hbGl0eVxyXG5VSUJ1aWxkZXIucHJvdG90eXBlLmV4aXN0cyA9IGZhbHNlO1xyXG5VSUJ1aWxkZXIucHJvdG90eXBlLmV4aXN0aW5nUmVmZXJlbmNlID0gbnVsbDtcclxuXHJcbi8vVXNlIHRoaXMgZnVuY3Rpb24gdG8gY3JlYXRlIGEgcHJvZ3Jlc3MgYmFyXHJcbi8vVXNhZ2U6IHR5cGU6IGNhbiBiZSBcImdyb3dpbmdcIiBvciBcInNocmlua2luZ1wiLCB0aGlzIHdpbGwgZWZmZWN0IGlmIGJhciBzdGFydHMgYXQgMCBhbmQgZ29lcyB1cCBvciB2aXMgdmVyc2FcclxuLy9cdFx0IG1heFZhbHVlOiBzZXRzIHRoZSBtYXggdmFsdWUgb2YgdGhlIHByb2dyZXNzIGJhciwgaS5lLiB1c2luZyAxMDAgY3JlYXRlcyBhIGJhciBmcm9tIDAgdG8gMTAwXHJcbi8vXHRcdCB4LHk6IHNldHMgbG9jYXRpb25cclxuLy9cdFx0IERPTidUIEZPUkdFVCB0byBvdmVyd3JpdGUgdGhlIG9uRXZlbnQoKSBmdW5jdGlvbiBmb3IgdGhlIHByb2dyZXNzIGJhciBhZnRlciBjcmVhdGluZyBpdFxyXG4vL1x0XHRcdC1vbkV2ZW50KCkgaXMgYXV0b21hdGljYWxseSBjYWxsZWQgd2hlbiBiYXIgZmlsbHMvc2hyaW5rcyBwYXN0IGxpbWl0IChkZXBlbmRpbmcgb24gYmFyIHR5cGUpXHJcblVJQnVpbGRlci5wcm90b3R5cGUuYnVpbGRQcm9ncmVzc0JhciA9IGZ1bmN0aW9uKHR5cGUsIHgsIHksIHdpZHRoLCBoZWlnaHQsIG1heFZhbHVlKSB7XHJcblx0Ly9jcmVhdGUgYW5kIGZvcm1hdCBuZXcgcHJvZyBiYXJcclxuXHR2YXIgZ3JhcGhpY3MgPSB0aGlzLmdhbWVTdGF0ZS5nYW1lLmFkZC5ncmFwaGljcygwLDApO1xyXG5cdHZhciBuZXdQcm9nQmFyID0gbmV3IFByb2dyZXNzQmFyKHR5cGUsIG1heFZhbHVlLCBncmFwaGljcywgdGhpcy5yZW5kZXJhYmxlcyk7XHJcblx0bmV3UHJvZ0Jhci5zZXRMb2NhdGlvbih4LHkpO1xyXG5cdG5ld1Byb2dCYXIuc2V0U2l6ZSh3aWR0aCwgaGVpZ2h0KTtcclxuXHQvL3N1YnNjcmliZSB0byAncmVuZGVyYWJsZXMnIHNvIHRoYXQgcmVuZGVyKCkgaXMgY2FsbGVkIGF1dG9tYXRpY2FsbHlcclxuXHR0aGlzLnJlbmRlcmFibGVzLnN1YnNjcmliZShuZXdQcm9nQmFyKTtcclxuXHRyZXR1cm4gbmV3UHJvZ0JhcjtcclxufTtcclxuXHJcblVJQnVpbGRlci5wcm90b3R5cGUuYnVpbGRCYW5uZXIgPSBmdW5jdGlvbih4UmF0aW8sIHlSYXRpbywgdGV4dHMpIHtcclxuICAgdmFyIGdyYXBoaWNzID0gdGhpcy5nYW1lU3RhdGUuZ2FtZS5hZGQuZ3JhcGhpY3MoMCwgMCk7XHJcbiAgIHZhciBuZXdCYW5uZXIgPSBuZXcgQmFubmVyKHRoaXMuZ2FtZVN0YXRlLCB4UmF0aW8sIHlSYXRpbywgdGV4dHMsIGdyYXBoaWNzLCB0aGlzLnJlbmRlcmFibGVzKTtcclxuICAgdGhpcy5yZW5kZXJhYmxlcy5zdWJzY3JpYmUobmV3QmFubmVyKTtcclxuICAgcmV0dXJuIG5ld0Jhbm5lcjtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gVUlCdWlsZGVyOyIsInZhciBVdGlscyA9IHJlcXVpcmUoJy4uL3V0aWxzJyk7XHJcblxyXG4vL05PVEU6IERPTidUIFVTRSB0aGlzIGNvZGUgdG8gY3JlYXRlIGEgQmFubmVyLiBJbnN0ZWFkLCB1c2UgdGhlIFVJQnVpbGRlciBvYmplY3QgYW5kIGNhbGwgYnVpbGRCYW5uZXJcclxudmFyIEJhbm5lciA9IGZ1bmN0aW9uKGdhbWVTdGF0ZSwgeFJhdGlvLCB5UmF0aW8sIHRleHRKU09OLCBncmFwaGljcywgcmVuZGVyYWJsZXMpIHtcclxuICAgdGhpcy5iZ0JvcmRlclNpemUgPSA2O1x0XHRcdC8vZGVmYXVsdCBzaXplIG9mIGJhY2tncm91bmQgYm9yZGVyXHJcblx0dGhpcy5iZ0JvcmRlckNvbG9yID0gMHhmZmZmZmY7XHQvL2RlZmF1bHQgY29sb3Igb2YgYmFja2dyb3VuZCBib3JkZXJcclxuXHR0aGlzLmJnQ29sb3IgPSAweDRhNGE0YTtcdFx0Ly9kZWZhdWx0IGNvbG9yIG9mIGJhY2tncm91bmRcclxuICAgdGhpcy5zaGFkb3dPZmZzZXRYID0gMztcclxuICAgdGhpcy5zaGFkb3dPZmZzZXRZID0gMztcclxuICAgdGhpcy5zaGFkb3dDb2xvciA9ICdyZ2JhKDAsMCwwLDAuOSknO1xyXG4gICB0aGlzLnNoYWRvd0JsdXIgPSA1O1xyXG4gICB0aGlzLm5vcm1hbFRleHQgPSAnI2ZmZmZmZic7XHJcbiAgIHRoaXMuaGlnaGxpZ2h0VGV4dCA9ICcjMDBmZjAwJztcclxuICAgdGhpcy50ZXh0V3JhcFBhZGRpbmcgPSAxMDtcclxuICAgdGhpcy5vZmZTY3JlZW5QYWRkaW5nID0gLTIwMDtcclxuICAgdGhpcy50ZXh0SlNPTiA9IHRleHRKU09OO1xyXG4gICB0aGlzLmdhbWVTdGF0ZSA9IGdhbWVTdGF0ZTtcclxuICAgdGhpcy5nYW1lID0gZ2FtZVN0YXRlLmdhbWU7XHJcbiAgIHRoaXMuY2FtID0gdGhpcy5nYW1lLmNhbWVyYTtcclxuICAgdGhpcy54UmF0aW8gPSB4UmF0aW87XHJcbiAgIHRoaXMueVJhdGlvID0geVJhdGlvO1xyXG4gICB0aGlzLmdyYXBoaWNzID0gZ3JhcGhpY3M7XHJcbiAgIHRoaXMucmVuZGVyYWJsZXMgPSByZW5kZXJhYmxlcztcclxuICAgdGhpcy53aWR0aCA9IDQwMDtcclxuICAgdGhpcy5oZWlnaHQgPSAyMDA7XHJcbiAgIHRoaXMuaW5kZXggPSAwO1xyXG4gICB0aGlzLnggPSAwO1xyXG4gICB0aGlzLmhpZGVCdWZmZXIgPSAtNTA7XHJcbiAgIHRoaXMuaGlkZUhlaWdodCA9IC10aGlzLmhlaWdodCAtIHRoaXMuaGlkZUJ1ZmZlcjtcclxuICAgdGhpcy55ID0gdGhpcy5oaWRlSGVpZ2h0O1xyXG4gICB0aGlzLnNsaWRlWSA9IDA7XHJcbiAgIHRoaXMuZ29hbFkgPSB0aGlzLnk7XHJcbiAgIHRoaXMuc2xpZGVSYXRlID0gMC4yO1xyXG4gICB0aGlzLnZpc2libGUgPSBmYWxzZTtcclxuICAgLy8gYWRkIGJ1dHRvbnNcclxuICAgdGhpcy5yaWdodEJ1dHRvbiA9IHRoaXMuZ2FtZS5hZGQuYnV0dG9uKDAsIDAsICdhcnJvd0J1dHRvbicsIHRoaXMubmV4dEluZGV4LCB0aGlzLCAxLCAwLCAyKTtcclxuXHR0aGlzLnJpZ2h0QnV0dG9uLm9uSW5wdXRPdmVyLmFkZCh0aGlzLmdhbWVTdGF0ZS5wbGF5SG92ZXJDbGljaywgdGhpcy5nYW1lU3RhdGUpO1xyXG5cdHRoaXMucmlnaHRCdXR0b24ub25JbnB1dERvd24uYWRkKHRoaXMuZ2FtZVN0YXRlLnBsYXlEb3duQ2xpY2ssIHRoaXMuZ2FtZVN0YXRlKTtcclxuICAgdGhpcy5sZWZ0QnV0dG9uID0gdGhpcy5nYW1lLmFkZC5idXR0b24oMCwgMCwgJ2Fycm93QnV0dG9uJywgdGhpcy5wcmV2SW5kZXgsIHRoaXMsIDEsIDAsIDIpO1xyXG5cdHRoaXMubGVmdEJ1dHRvbi5vbklucHV0T3Zlci5hZGQodGhpcy5nYW1lU3RhdGUucGxheUhvdmVyQ2xpY2ssIHRoaXMuZ2FtZVN0YXRlKTtcclxuXHR0aGlzLmxlZnRCdXR0b24ub25JbnB1dERvd24uYWRkKHRoaXMuZ2FtZVN0YXRlLnBsYXlEb3duQ2xpY2ssIHRoaXMuZ2FtZVN0YXRlKTtcclxuICAgdGhpcy5sZWZ0QnV0dG9uLnNjYWxlLnggPSAtMTtcclxuICAgdGhpcy5ncm91cCA9IG5ldyBQaGFzZXIuR3JvdXAodGhpcy5nYW1lKTtcclxuICAgdGhpcy5ncm91cC5hZGQodGhpcy5ncmFwaGljcyk7XHJcbiAgIHRoaXMuZ3JvdXAuYWRkKHRoaXMucmlnaHRCdXR0b24pO1xyXG4gICB0aGlzLmdyb3VwLmFkZCh0aGlzLmxlZnRCdXR0b24pO1xyXG4gICB0aGlzLmFkZFRleHRzKCk7XHJcbiAgIHRoaXMuZ2FtZS53b3JsZC5icmluZ1RvVG9wKHRoaXMuZ3JvdXApO1xyXG59O1xyXG5cclxuQmFubmVyLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IEJhbm5lcjtcclxuXHJcbkJhbm5lci5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uKCkge1xyXG5cdHRoaXMuZ3JhcGhpY3MuY2xlYXIoKTtcclxuXHR0aGlzLnJlbmRlcmFibGVzLnVuc3Vic2NyaWJlKHRoaXMpO1xyXG59O1xyXG5cclxuQmFubmVyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHtcclxuICAgLy8gVE9ETzogYWRkIGxheWVyIGdyb3VwcyB0byBvdGhlciB0aGluZ3NcclxuICAgdGhpcy5nYW1lLndvcmxkLmJyaW5nVG9Ub3AodGhpcy5ncm91cCk7XHJcbiAgIC8vIG15IHBvc1xyXG4gICB0aGlzLnggPSB0aGlzLmNhbS54ICsgdGhpcy5jYW0ud2lkdGggKiB0aGlzLnhSYXRpbztcclxuICAgaWYgKHRoaXMudmlzaWJsZSkge1xyXG4gICAgICB0aGlzLmdvYWxZID0gdGhpcy5jYW0uaGVpZ2h0IC8gMjtcclxuICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5nb2FsWSA9IHRoaXMuaGlkZUhlaWdodDtcclxuICAgfVxyXG4gICB0aGlzLnNsaWRlWSA9IFV0aWxzLmxlcnAodGhpcy5zbGlkZVksIHRoaXMuZ29hbFksIHRoaXMuc2xpZGVSYXRlKTtcclxuICAgdGhpcy55ID0gdGhpcy5jYW0ueSArIHRoaXMuc2xpZGVZO1xyXG4gICAvLyB0ZXh0IHBvc1xyXG4gICB2YXIgY3VyVGV4dCA9IHRoaXMudGV4dE9ianNbdGhpcy5pbmRleF07XHJcbiAgIGN1clRleHQueCA9IHRoaXMueDtcclxuICAgY3VyVGV4dC55ID0gdGhpcy55O1xyXG4gICAvLyBidXR0b24gcG9zXHJcbiAgIHRoaXMucmlnaHRCdXR0b24ueCA9IHRoaXMueCArIHRoaXMud2lkdGggLyAyICsgdGhpcy5yaWdodEJ1dHRvbi53aWR0aCAvIDI7XHJcbiAgIHRoaXMucmlnaHRCdXR0b24ueSA9IHRoaXMueSAtIHRoaXMucmlnaHRCdXR0b24uaGVpZ2h0IC8gMjtcclxuICAgdGhpcy5sZWZ0QnV0dG9uLnggPSB0aGlzLnggLSB0aGlzLndpZHRoIC8gMiArIHRoaXMubGVmdEJ1dHRvbi53aWR0aCAvIDI7XHJcbiAgIHRoaXMubGVmdEJ1dHRvbi55ID0gdGhpcy55IC0gdGhpcy5sZWZ0QnV0dG9uLmhlaWdodCAvIDI7XHJcbn07XHJcblxyXG5CYW5uZXIucHJvdG90eXBlLmFkZFRleHRzID0gZnVuY3Rpb24oKSB7XHJcbiAgIGlmICghdGhpcy50ZXh0T2JzKSB7XHJcbiAgICAgIHRoaXMudGV4dE9ianMgPSBbXTtcclxuICAgfVxyXG4gICB2YXIgdGV4dERlZnMgPSBKU09OLnBhcnNlKHRoaXMuZ2FtZS5jYWNoZS5nZXRUZXh0KHRoaXMudGV4dEpTT04pKTtcclxuICAgdmFyIHRleHRBcnJheSA9IHRleHREZWZzWyd0ZXh0J107XHJcbiAgIHZhciB0ZXh0Q29sb3JzID0gdGV4dERlZnNbJ2NvbG9ycyddO1xyXG4gICBmb3IgKHZhciBpID0gMDsgaSA8IHRleHRBcnJheS5sZW5ndGg7IGkrKykge1xyXG4gICAgICB2YXIgdGV4dCA9IHRleHRBcnJheVtpXTtcclxuICAgICAgdmFyIG5ld1RleHQgPSB0aGlzLmdhbWUuYWRkLnRleHQodGhpcy5vZmZTY3JlZW5QYWRkaW5nLCB0aGlzLm9mZlNjcmVlblBhZGRpbmcsIHRleHQpO1xyXG4gICAgICBuZXdUZXh0LmZvbnQgPSAnUm9ib3RvJztcclxuICAgICAgbmV3VGV4dC5mb250U2l6ZSA9IDI0O1xyXG4gICAgICBuZXdUZXh0LmFsaWduID0gJ2NlbnRlcic7XHJcbiAgICAgIG5ld1RleHQuZmlsbCA9IHRoaXMubm9ybWFsVGV4dDtcclxuICAgICAgbmV3VGV4dC53b3JkV3JhcCA9IHRydWU7XHJcbiAgICAgIG5ld1RleHQud29yZFdyYXBXaWR0aCA9IHRoaXMud2lkdGggLSB0aGlzLnRleHRXcmFwUGFkZGluZztcclxuICAgICAgbmV3VGV4dC5hbmNob3Iuc2V0KDAuNSk7XHJcbiAgICAgIG5ld1RleHQuc2V0U2hhZG93KHRoaXMuc2hhZG93T2Zmc2V0WCwgdGhpcy5zaGFkb3dPZmZzZXRZLCB0aGlzLnNoYWRvd0NvbG9yLCB0aGlzLnNoYWRvd0JsdXIpO1xyXG4gICAgICB2YXIgbmV3Q29sb3JzID0gdGV4dENvbG9yc1tpXTtcclxuICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBuZXdDb2xvcnMubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgbmV3VGV4dC5hZGRDb2xvcih0aGlzLmhpZ2hsaWdodFRleHQsIG5ld0NvbG9yc1tqXSk7XHJcbiAgICAgICAgIGorKztcclxuICAgICAgICAgbmV3VGV4dC5hZGRDb2xvcih0aGlzLm5vcm1hbFRleHQsIG5ld0NvbG9yc1tqXSk7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy50ZXh0T2Jqcy5wdXNoKG5ld1RleHQpO1xyXG4gICAgICB0aGlzLmdyb3VwLmFkZChuZXdUZXh0KTtcclxuICAgfVxyXG59O1xyXG5cclxuQmFubmVyLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbigpIHtcclxuXHR0aGlzLnVwZGF0ZSgpO1xyXG5cdHRoaXMuZ3JhcGhpY3MuY2xlYXIoKTtcclxuXHQvL0RyYXcgYmFja2dyb3VuZFxyXG5cdHRoaXMuZ3JhcGhpY3MubGluZVN0eWxlKHRoaXMuYmdCb3JkZXJTaXplLCB0aGlzLmJnQm9yZGVyQ29sb3IsIDEpOyAvL3NldHMgYm9yZGVyIGNvbG9yIGFuZCBzaXplXHJcblx0dGhpcy5ncmFwaGljcy5iZWdpbkZpbGwodGhpcy5iZ0NvbG9yKTsgLy9zZXRzIGNvbG9yIG9mIGJhY2tncm91bmQgZmlsbFxyXG5cdHRoaXMuZ3JhcGhpY3MuZHJhd1JlY3QodGhpcy54LXRoaXMud2lkdGgvMiwgdGhpcy55LXRoaXMuaGVpZ2h0LzIsIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KTtcclxuXHR0aGlzLmdyYXBoaWNzLmVuZEZpbGwoKTtcclxufTtcclxuXHJcbkJhbm5lci5wcm90b3R5cGUuc2hvdyA9IGZ1bmN0aW9uKCkge1xyXG4gICAvLyB0aGlzLmdvYWxZID0gdGhpcy5jYW0ueSArIHRoaXMuY2FtLmhlaWdodCAqIHRoaXMueVJhdGlvO1xyXG4gICB0aGlzLnZpc2libGUgPSB0cnVlO1xyXG59O1xyXG5cclxuQmFubmVyLnByb3RvdHlwZS5oaWRlID0gZnVuY3Rpb24oKSB7XHJcbiAgIC8vIHRoaXMuZ29hbFkgPSB0aGlzLmhpZGVIZWlnaHQ7XHJcbiAgIHRoaXMudmlzaWJsZSA9IGZhbHNlO1xyXG59O1xyXG5cclxuQmFubmVyLnByb3RvdHlwZS50b2dnbGUgPSBmdW5jdGlvbigpIHtcclxuICBpZiAodGhpcy52aXNpYmxlKSB7XHJcbiAgICAgdGhpcy5oaWRlKCk7XHJcbiAgfSBlbHNlIHtcclxuICAgICB0aGlzLnNob3coKTtcclxuICB9ICBcclxufTtcclxuXHJcbkJhbm5lci5wcm90b3R5cGUuaGlkZUN1clRleHQgPSBmdW5jdGlvbigpIHtcclxuICB0aGlzLnRleHRPYmpzW3RoaXMuaW5kZXhdLnggPSB0aGlzLnRleHRPYmpzW3RoaXMuaW5kZXhdLnkgPSAwOyBcclxufTtcclxuXHJcbkJhbm5lci5wcm90b3R5cGUubmV4dEluZGV4ID0gZnVuY3Rpb24oKSB7XHJcbiAgIHRoaXMuaGlkZUN1clRleHQoKTtcclxuICAgdGhpcy5pbmRleCsrO1xyXG4gICBpZiAodGhpcy5pbmRleCA+PSB0aGlzLnRleHRPYmpzLmxlbmd0aCkge1xyXG4gICAgICB0aGlzLmluZGV4ID0gMDtcclxuICAgfVxyXG59O1xyXG5cclxuQmFubmVyLnByb3RvdHlwZS5wcmV2SW5kZXggPSBmdW5jdGlvbigpIHtcclxuICAgdGhpcy5oaWRlQ3VyVGV4dCgpO1xyXG4gICB0aGlzLmluZGV4LS07XHJcbiAgIGlmICh0aGlzLmluZGV4IDwgMCkge1xyXG4gICAgICB0aGlzLmluZGV4ID0gdGhpcy50ZXh0T2Jqcy5sZW5ndGggLSAxO1xyXG4gICB9XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEJhbm5lcjtcclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4iLCIvKlxyXG5Db2xsZWN0aW9uIG9mIHV0aWxpdHkgZnVuY3Rpb25zLlxyXG4qL1xyXG5cclxudmFyIFV0aWxzID0ge1xyXG4gICAgY29udGFpbnNPYmplY3Q6IGZ1bmN0aW9uKG9iaiwgbGlzdCkge1xyXG4gICAgICAgIHZhciBpO1xyXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChsaXN0W2ldID09PSBvYmopIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9LFxyXG4gICAgZGlzdGFuY2U6IGZ1bmN0aW9uKHgxLCB5MSwgeDIsIHkyKSB7XHJcbiAgICAgICByZXR1cm4gTWF0aC5zcXJ0KE1hdGgucG93KHgxIC0geDIsIDIpICsgTWF0aC5wb3coeTEgLSB5MiwgMikpO1xyXG4gICAgfSxcclxuICAgIGxlcnA6IGZ1bmN0aW9uKGEsIGIsIHQpIHtcclxuICAgICAgIGlmICh0IDwgMCB8fCB0ID4gMSkge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coJ2JhZCByYW5nZSBmb3IgVXRpbHMubGVycCgpLCBtdXN0IGJlIGJldHdlZW4gMCBhbmQgMScpO1xyXG4gICAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgICB9XHJcbiAgICAgICByZXR1cm4gYSArIHQgKiAoYiAtIGEpO1xyXG4gICAgfVxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBVdGlsczsiXX0=
>>>>>>> origin/gh-pages
